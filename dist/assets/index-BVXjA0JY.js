(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var h1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wy(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Gy={exports:{}},xu={},Ky={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oa=Symbol.for("react.element"),f1=Symbol.for("react.portal"),p1=Symbol.for("react.fragment"),m1=Symbol.for("react.strict_mode"),g1=Symbol.for("react.profiler"),y1=Symbol.for("react.provider"),v1=Symbol.for("react.context"),x1=Symbol.for("react.forward_ref"),_1=Symbol.for("react.suspense"),w1=Symbol.for("react.memo"),E1=Symbol.for("react.lazy"),im=Symbol.iterator;function b1(t){return t===null||typeof t!="object"?null:(t=im&&t[im]||t["@@iterator"],typeof t=="function"?t:null)}var Qy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Xy=Object.assign,Yy={};function Ai(t,e,n){this.props=t,this.context=e,this.refs=Yy,this.updater=n||Qy}Ai.prototype.isReactComponent={};Ai.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ai.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Jy(){}Jy.prototype=Ai.prototype;function bh(t,e,n){this.props=t,this.context=e,this.refs=Yy,this.updater=n||Qy}var Th=bh.prototype=new Jy;Th.constructor=bh;Xy(Th,Ai.prototype);Th.isPureReactComponent=!0;var om=Array.isArray,Zy=Object.prototype.hasOwnProperty,Ih={current:null},e0={key:!0,ref:!0,__self:!0,__source:!0};function t0(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Zy.call(e,r)&&!e0.hasOwnProperty(r)&&(s[r]=e[r]);var u=arguments.length-2;if(u===1)s.children=n;else if(1<u){for(var c=Array(u),d=0;d<u;d++)c[d]=arguments[d+2];s.children=c}if(t&&t.defaultProps)for(r in u=t.defaultProps,u)s[r]===void 0&&(s[r]=u[r]);return{$$typeof:oa,type:t,key:i,ref:o,props:s,_owner:Ih.current}}function T1(t,e){return{$$typeof:oa,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Nh(t){return typeof t=="object"&&t!==null&&t.$$typeof===oa}function I1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var am=/\/+/g;function vc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?I1(""+t.key):e.toString(36)}function ll(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case oa:case f1:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+vc(o,0):r,om(s)?(n="",t!=null&&(n=t.replace(am,"$&/")+"/"),ll(s,e,n,"",function(d){return d})):s!=null&&(Nh(s)&&(s=T1(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(am,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",om(t))for(var u=0;u<t.length;u++){i=t[u];var c=r+vc(i,u);o+=ll(i,e,n,c,s)}else if(c=b1(t),typeof c=="function")for(t=c.call(t),u=0;!(i=t.next()).done;)i=i.value,c=r+vc(i,u++),o+=ll(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Fa(t,e,n){if(t==null)return t;var r=[],s=0;return ll(t,r,"","",function(i){return e.call(n,i,s++)}),r}function N1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Mt={current:null},ul={transition:null},S1={ReactCurrentDispatcher:Mt,ReactCurrentBatchConfig:ul,ReactCurrentOwner:Ih};be.Children={map:Fa,forEach:function(t,e,n){Fa(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Fa(t,function(){e++}),e},toArray:function(t){return Fa(t,function(e){return e})||[]},only:function(t){if(!Nh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};be.Component=Ai;be.Fragment=p1;be.Profiler=g1;be.PureComponent=bh;be.StrictMode=m1;be.Suspense=_1;be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=S1;be.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Xy({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Ih.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)Zy.call(e,c)&&!e0.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&u!==void 0?u[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){u=Array(c);for(var d=0;d<c;d++)u[d]=arguments[d+2];r.children=u}return{$$typeof:oa,type:t.type,key:s,ref:i,props:r,_owner:o}};be.createContext=function(t){return t={$$typeof:v1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:y1,_context:t},t.Consumer=t};be.createElement=t0;be.createFactory=function(t){var e=t0.bind(null,t);return e.type=t,e};be.createRef=function(){return{current:null}};be.forwardRef=function(t){return{$$typeof:x1,render:t}};be.isValidElement=Nh;be.lazy=function(t){return{$$typeof:E1,_payload:{_status:-1,_result:t},_init:N1}};be.memo=function(t,e){return{$$typeof:w1,type:t,compare:e===void 0?null:e}};be.startTransition=function(t){var e=ul.transition;ul.transition={};try{t()}finally{ul.transition=e}};be.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};be.useCallback=function(t,e){return Mt.current.useCallback(t,e)};be.useContext=function(t){return Mt.current.useContext(t)};be.useDebugValue=function(){};be.useDeferredValue=function(t){return Mt.current.useDeferredValue(t)};be.useEffect=function(t,e){return Mt.current.useEffect(t,e)};be.useId=function(){return Mt.current.useId()};be.useImperativeHandle=function(t,e,n){return Mt.current.useImperativeHandle(t,e,n)};be.useInsertionEffect=function(t,e){return Mt.current.useInsertionEffect(t,e)};be.useLayoutEffect=function(t,e){return Mt.current.useLayoutEffect(t,e)};be.useMemo=function(t,e){return Mt.current.useMemo(t,e)};be.useReducer=function(t,e,n){return Mt.current.useReducer(t,e,n)};be.useRef=function(t){return Mt.current.useRef(t)};be.useState=function(t){return Mt.current.useState(t)};be.useSyncExternalStore=function(t,e,n){return Mt.current.useSyncExternalStore(t,e,n)};be.useTransition=function(){return Mt.current.useTransition()};be.version="18.2.0";Ky.exports=be;var B=Ky.exports;const Ws=Wy(B);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C1=B,k1=Symbol.for("react.element"),A1=Symbol.for("react.fragment"),P1=Object.prototype.hasOwnProperty,R1=C1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,j1={key:!0,ref:!0,__self:!0,__source:!0};function n0(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)P1.call(e,r)&&!j1.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:k1,type:t,key:i,ref:o,props:s,_owner:R1.current}}xu.Fragment=A1;xu.jsx=n0;xu.jsxs=n0;Gy.exports=xu;var l=Gy.exports,r0={exports:{}},nn={},s0={exports:{}},i0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,q){var X=z.length;z.push(q);e:for(;0<X;){var G=X-1>>>1,k=z[G];if(0<s(k,q))z[G]=q,z[X]=k,X=G;else break e}}function n(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var q=z[0],X=z.pop();if(X!==q){z[0]=X;e:for(var G=0,k=z.length,O=k>>>1;G<O;){var K=2*(G+1)-1,se=z[K],F=K+1,H=z[F];if(0>s(se,X))F<k&&0>s(H,se)?(z[G]=H,z[F]=X,G=F):(z[G]=se,z[K]=X,G=K);else if(F<k&&0>s(H,X))z[G]=H,z[F]=X,G=F;else break e}}return q}function s(z,q){var X=z.sortIndex-q.sortIndex;return X!==0?X:z.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,u=o.now();t.unstable_now=function(){return o.now()-u}}var c=[],d=[],f=1,y=null,g=3,w=!1,S=!1,P=!1,R=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(z){for(var q=n(d);q!==null;){if(q.callback===null)r(d);else if(q.startTime<=z)r(d),q.sortIndex=q.expirationTime,e(c,q);else break;q=n(d)}}function j(z){if(P=!1,I(z),!S)if(n(c)!==null)S=!0,Ie(M);else{var q=n(d);q!==null&&te(j,q.startTime-z)}}function M(z,q){S=!1,P&&(P=!1,b(p),p=-1),w=!0;var X=g;try{for(I(q),y=n(c);y!==null&&(!(y.expirationTime>q)||z&&!C());){var G=y.callback;if(typeof G=="function"){y.callback=null,g=y.priorityLevel;var k=G(y.expirationTime<=q);q=t.unstable_now(),typeof k=="function"?y.callback=k:y===n(c)&&r(c),I(q)}else r(c);y=n(c)}if(y!==null)var O=!0;else{var K=n(d);K!==null&&te(j,K.startTime-q),O=!1}return O}finally{y=null,g=X,w=!1}}var V=!1,T=null,p=-1,v=5,_=-1;function C(){return!(t.unstable_now()-_<v)}function A(){if(T!==null){var z=t.unstable_now();_=z;var q=!0;try{q=T(!0,z)}finally{q?N():(V=!1,T=null)}}else V=!1}var N;if(typeof x=="function")N=function(){x(A)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,ie=me.port2;me.port1.onmessage=A,N=function(){ie.postMessage(null)}}else N=function(){R(A,0)};function Ie(z){T=z,V||(V=!0,N())}function te(z,q){p=R(function(){z(t.unstable_now())},q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){S||w||(S=!0,Ie(M))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):v=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(z){switch(g){case 1:case 2:case 3:var q=3;break;default:q=g}var X=g;g=q;try{return z()}finally{g=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,q){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var X=g;g=z;try{return q()}finally{g=X}},t.unstable_scheduleCallback=function(z,q,X){var G=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?G+X:G):X=G,z){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=X+k,z={id:f++,callback:q,priorityLevel:z,startTime:X,expirationTime:k,sortIndex:-1},X>G?(z.sortIndex=X,e(d,z),n(c)===null&&z===n(d)&&(P?(b(p),p=-1):P=!0,te(j,X-G))):(z.sortIndex=k,e(c,z),S||w||(S=!0,Ie(M))),z},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(z){var q=g;return function(){var X=g;g=q;try{return z.apply(this,arguments)}finally{g=X}}}})(i0);s0.exports=i0;var D1=s0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o0=B,tn=D1;function W(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a0=new Set,Ro={};function As(t,e){yi(t,e),yi(t+"Capture",e)}function yi(t,e){for(Ro[t]=e,t=0;t<e.length;t++)a0.add(e[t])}var Xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rd=Object.prototype.hasOwnProperty,O1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,lm={},um={};function L1(t){return rd.call(um,t)?!0:rd.call(lm,t)?!1:O1.test(t)?um[t]=!0:(lm[t]=!0,!1)}function V1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function M1(t,e,n,r){if(e===null||typeof e>"u"||V1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ft(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){xt[t]=new Ft(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];xt[e]=new Ft(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){xt[t]=new Ft(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){xt[t]=new Ft(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){xt[t]=new Ft(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){xt[t]=new Ft(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){xt[t]=new Ft(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){xt[t]=new Ft(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){xt[t]=new Ft(t,5,!1,t.toLowerCase(),null,!1,!1)});var Sh=/[\-:]([a-z])/g;function Ch(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Sh,Ch);xt[e]=new Ft(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Sh,Ch);xt[e]=new Ft(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Sh,Ch);xt[e]=new Ft(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){xt[t]=new Ft(t,1,!1,t.toLowerCase(),null,!1,!1)});xt.xlinkHref=new Ft("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){xt[t]=new Ft(t,1,!1,t.toLowerCase(),null,!0,!0)});function kh(t,e,n,r){var s=xt.hasOwnProperty(e)?xt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(M1(e,n,s,r)&&(n=null),r||s===null?L1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ir=o0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ua=Symbol.for("react.element"),Gs=Symbol.for("react.portal"),Ks=Symbol.for("react.fragment"),Ah=Symbol.for("react.strict_mode"),sd=Symbol.for("react.profiler"),l0=Symbol.for("react.provider"),u0=Symbol.for("react.context"),Ph=Symbol.for("react.forward_ref"),id=Symbol.for("react.suspense"),od=Symbol.for("react.suspense_list"),Rh=Symbol.for("react.memo"),pr=Symbol.for("react.lazy"),c0=Symbol.for("react.offscreen"),cm=Symbol.iterator;function eo(t){return t===null||typeof t!="object"?null:(t=cm&&t[cm]||t["@@iterator"],typeof t=="function"?t:null)}var Ge=Object.assign,xc;function lo(t){if(xc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);xc=e&&e[1]||""}return`
`+xc+t}var _c=!1;function wc(t,e){if(!t||_c)return"";_c=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,u=i.length-1;1<=o&&0<=u&&s[o]!==i[u];)u--;for(;1<=o&&0<=u;o--,u--)if(s[o]!==i[u]){if(o!==1||u!==1)do if(o--,u--,0>u||s[o]!==i[u]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=u);break}}}finally{_c=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?lo(t):""}function F1(t){switch(t.tag){case 5:return lo(t.type);case 16:return lo("Lazy");case 13:return lo("Suspense");case 19:return lo("SuspenseList");case 0:case 2:case 15:return t=wc(t.type,!1),t;case 11:return t=wc(t.type.render,!1),t;case 1:return t=wc(t.type,!0),t;default:return""}}function ad(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ks:return"Fragment";case Gs:return"Portal";case sd:return"Profiler";case Ah:return"StrictMode";case id:return"Suspense";case od:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case u0:return(t.displayName||"Context")+".Consumer";case l0:return(t._context.displayName||"Context")+".Provider";case Ph:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Rh:return e=t.displayName||null,e!==null?e:ad(t.type)||"Memo";case pr:e=t._payload,t=t._init;try{return ad(t(e))}catch{}}return null}function U1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ad(e);case 8:return e===Ah?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function zr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function d0(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function z1(t){var e=d0(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function za(t){t._valueTracker||(t._valueTracker=z1(t))}function h0(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=d0(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Al(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ld(t,e){var n=e.checked;return Ge({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function dm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=zr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function f0(t,e){e=e.checked,e!=null&&kh(t,"checked",e,!1)}function ud(t,e){f0(t,e);var n=zr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?cd(t,e.type,n):e.hasOwnProperty("defaultValue")&&cd(t,e.type,zr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function hm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function cd(t,e,n){(e!=="number"||Al(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var uo=Array.isArray;function oi(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+zr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function dd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(W(91));return Ge({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function fm(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(W(92));if(uo(n)){if(1<n.length)throw Error(W(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:zr(n)}}function p0(t,e){var n=zr(e.value),r=zr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function pm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function m0(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function hd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?m0(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ba,g0=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ba=Ba||document.createElement("div"),Ba.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ba.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function jo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var yo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},B1=["Webkit","ms","Moz","O"];Object.keys(yo).forEach(function(t){B1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),yo[e]=yo[t]})});function y0(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||yo.hasOwnProperty(t)&&yo[t]?(""+e).trim():e+"px"}function v0(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=y0(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var $1=Ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fd(t,e){if(e){if($1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(W(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(W(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(e.style!=null&&typeof e.style!="object")throw Error(W(62))}}function pd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var md=null;function jh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var gd=null,ai=null,li=null;function mm(t){if(t=ua(t)){if(typeof gd!="function")throw Error(W(280));var e=t.stateNode;e&&(e=Tu(e),gd(t.stateNode,t.type,e))}}function x0(t){ai?li?li.push(t):li=[t]:ai=t}function _0(){if(ai){var t=ai,e=li;if(li=ai=null,mm(t),e)for(t=0;t<e.length;t++)mm(e[t])}}function w0(t,e){return t(e)}function E0(){}var Ec=!1;function b0(t,e,n){if(Ec)return t(e,n);Ec=!0;try{return w0(t,e,n)}finally{Ec=!1,(ai!==null||li!==null)&&(E0(),_0())}}function Do(t,e){var n=t.stateNode;if(n===null)return null;var r=Tu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(W(231,e,typeof n));return n}var yd=!1;if(Xn)try{var to={};Object.defineProperty(to,"passive",{get:function(){yd=!0}}),window.addEventListener("test",to,to),window.removeEventListener("test",to,to)}catch{yd=!1}function q1(t,e,n,r,s,i,o,u,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(f){this.onError(f)}}var vo=!1,Pl=null,Rl=!1,vd=null,H1={onError:function(t){vo=!0,Pl=t}};function W1(t,e,n,r,s,i,o,u,c){vo=!1,Pl=null,q1.apply(H1,arguments)}function G1(t,e,n,r,s,i,o,u,c){if(W1.apply(this,arguments),vo){if(vo){var d=Pl;vo=!1,Pl=null}else throw Error(W(198));Rl||(Rl=!0,vd=d)}}function Ps(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function T0(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function gm(t){if(Ps(t)!==t)throw Error(W(188))}function K1(t){var e=t.alternate;if(!e){if(e=Ps(t),e===null)throw Error(W(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return gm(s),t;if(i===r)return gm(s),e;i=i.sibling}throw Error(W(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,u=s.child;u;){if(u===n){o=!0,n=s,r=i;break}if(u===r){o=!0,r=s,n=i;break}u=u.sibling}if(!o){for(u=i.child;u;){if(u===n){o=!0,n=i,r=s;break}if(u===r){o=!0,r=i,n=s;break}u=u.sibling}if(!o)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?t:e}function I0(t){return t=K1(t),t!==null?N0(t):null}function N0(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=N0(t);if(e!==null)return e;t=t.sibling}return null}var S0=tn.unstable_scheduleCallback,ym=tn.unstable_cancelCallback,Q1=tn.unstable_shouldYield,X1=tn.unstable_requestPaint,Je=tn.unstable_now,Y1=tn.unstable_getCurrentPriorityLevel,Dh=tn.unstable_ImmediatePriority,C0=tn.unstable_UserBlockingPriority,jl=tn.unstable_NormalPriority,J1=tn.unstable_LowPriority,k0=tn.unstable_IdlePriority,_u=null,kn=null;function Z1(t){if(kn&&typeof kn.onCommitFiberRoot=="function")try{kn.onCommitFiberRoot(_u,t,void 0,(t.current.flags&128)===128)}catch{}}var _n=Math.clz32?Math.clz32:nE,eE=Math.log,tE=Math.LN2;function nE(t){return t>>>=0,t===0?32:31-(eE(t)/tE|0)|0}var $a=64,qa=4194304;function co(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Dl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var u=o&~s;u!==0?r=co(u):(i&=o,i!==0&&(r=co(i)))}else o=n&~s,o!==0?r=co(o):i!==0&&(r=co(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-_n(e),s=1<<n,r|=t[n],e&=~s;return r}function rE(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sE(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-_n(i),u=1<<o,c=s[o];c===-1?(!(u&n)||u&r)&&(s[o]=rE(u,e)):c<=e&&(t.expiredLanes|=u),i&=~u}}function xd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function A0(){var t=$a;return $a<<=1,!($a&4194240)&&($a=64),t}function bc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function aa(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-_n(e),t[e]=n}function iE(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-_n(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Oh(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-_n(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Re=0;function P0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var R0,Lh,j0,D0,O0,_d=!1,Ha=[],Ir=null,Nr=null,Sr=null,Oo=new Map,Lo=new Map,gr=[],oE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vm(t,e){switch(t){case"focusin":case"focusout":Ir=null;break;case"dragenter":case"dragleave":Nr=null;break;case"mouseover":case"mouseout":Sr=null;break;case"pointerover":case"pointerout":Oo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lo.delete(e.pointerId)}}function no(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=ua(e),e!==null&&Lh(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function aE(t,e,n,r,s){switch(e){case"focusin":return Ir=no(Ir,t,e,n,r,s),!0;case"dragenter":return Nr=no(Nr,t,e,n,r,s),!0;case"mouseover":return Sr=no(Sr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Oo.set(i,no(Oo.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Lo.set(i,no(Lo.get(i)||null,t,e,n,r,s)),!0}return!1}function L0(t){var e=cs(t.target);if(e!==null){var n=Ps(e);if(n!==null){if(e=n.tag,e===13){if(e=T0(n),e!==null){t.blockedOn=e,O0(t.priority,function(){j0(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function cl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=wd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);md=r,n.target.dispatchEvent(r),md=null}else return e=ua(n),e!==null&&Lh(e),t.blockedOn=n,!1;e.shift()}return!0}function xm(t,e,n){cl(t)&&n.delete(e)}function lE(){_d=!1,Ir!==null&&cl(Ir)&&(Ir=null),Nr!==null&&cl(Nr)&&(Nr=null),Sr!==null&&cl(Sr)&&(Sr=null),Oo.forEach(xm),Lo.forEach(xm)}function ro(t,e){t.blockedOn===e&&(t.blockedOn=null,_d||(_d=!0,tn.unstable_scheduleCallback(tn.unstable_NormalPriority,lE)))}function Vo(t){function e(s){return ro(s,t)}if(0<Ha.length){ro(Ha[0],t);for(var n=1;n<Ha.length;n++){var r=Ha[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ir!==null&&ro(Ir,t),Nr!==null&&ro(Nr,t),Sr!==null&&ro(Sr,t),Oo.forEach(e),Lo.forEach(e),n=0;n<gr.length;n++)r=gr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<gr.length&&(n=gr[0],n.blockedOn===null);)L0(n),n.blockedOn===null&&gr.shift()}var ui=ir.ReactCurrentBatchConfig,Ol=!0;function uE(t,e,n,r){var s=Re,i=ui.transition;ui.transition=null;try{Re=1,Vh(t,e,n,r)}finally{Re=s,ui.transition=i}}function cE(t,e,n,r){var s=Re,i=ui.transition;ui.transition=null;try{Re=4,Vh(t,e,n,r)}finally{Re=s,ui.transition=i}}function Vh(t,e,n,r){if(Ol){var s=wd(t,e,n,r);if(s===null)jc(t,e,r,Ll,n),vm(t,r);else if(aE(s,t,e,n,r))r.stopPropagation();else if(vm(t,r),e&4&&-1<oE.indexOf(t)){for(;s!==null;){var i=ua(s);if(i!==null&&R0(i),i=wd(t,e,n,r),i===null&&jc(t,e,r,Ll,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else jc(t,e,r,null,n)}}var Ll=null;function wd(t,e,n,r){if(Ll=null,t=jh(r),t=cs(t),t!==null)if(e=Ps(t),e===null)t=null;else if(n=e.tag,n===13){if(t=T0(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ll=t,null}function V0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Y1()){case Dh:return 1;case C0:return 4;case jl:case J1:return 16;case k0:return 536870912;default:return 16}default:return 16}}var Er=null,Mh=null,dl=null;function M0(){if(dl)return dl;var t,e=Mh,n=e.length,r,s="value"in Er?Er.value:Er.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return dl=s.slice(t,1<r?1-r:void 0)}function hl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Wa(){return!0}function _m(){return!1}function rn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(n=t[u],this[u]=n?n(i):i[u]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Wa:_m,this.isPropagationStopped=_m,this}return Ge(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Wa)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Wa)},persist:function(){},isPersistent:Wa}),e}var Pi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fh=rn(Pi),la=Ge({},Pi,{view:0,detail:0}),dE=rn(la),Tc,Ic,so,wu=Ge({},la,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==so&&(so&&t.type==="mousemove"?(Tc=t.screenX-so.screenX,Ic=t.screenY-so.screenY):Ic=Tc=0,so=t),Tc)},movementY:function(t){return"movementY"in t?t.movementY:Ic}}),wm=rn(wu),hE=Ge({},wu,{dataTransfer:0}),fE=rn(hE),pE=Ge({},la,{relatedTarget:0}),Nc=rn(pE),mE=Ge({},Pi,{animationName:0,elapsedTime:0,pseudoElement:0}),gE=rn(mE),yE=Ge({},Pi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),vE=rn(yE),xE=Ge({},Pi,{data:0}),Em=rn(xE),_E={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},EE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=EE[t])?!!e[t]:!1}function Uh(){return bE}var TE=Ge({},la,{key:function(t){if(t.key){var e=_E[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=hl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?wE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uh,charCode:function(t){return t.type==="keypress"?hl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?hl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),IE=rn(TE),NE=Ge({},wu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bm=rn(NE),SE=Ge({},la,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uh}),CE=rn(SE),kE=Ge({},Pi,{propertyName:0,elapsedTime:0,pseudoElement:0}),AE=rn(kE),PE=Ge({},wu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),RE=rn(PE),jE=[9,13,27,32],zh=Xn&&"CompositionEvent"in window,xo=null;Xn&&"documentMode"in document&&(xo=document.documentMode);var DE=Xn&&"TextEvent"in window&&!xo,F0=Xn&&(!zh||xo&&8<xo&&11>=xo),Tm=" ",Im=!1;function U0(t,e){switch(t){case"keyup":return jE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function z0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Qs=!1;function OE(t,e){switch(t){case"compositionend":return z0(e);case"keypress":return e.which!==32?null:(Im=!0,Tm);case"textInput":return t=e.data,t===Tm&&Im?null:t;default:return null}}function LE(t,e){if(Qs)return t==="compositionend"||!zh&&U0(t,e)?(t=M0(),dl=Mh=Er=null,Qs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return F0&&e.locale!=="ko"?null:e.data;default:return null}}var VE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!VE[t.type]:e==="textarea"}function B0(t,e,n,r){x0(r),e=Vl(e,"onChange"),0<e.length&&(n=new Fh("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var _o=null,Mo=null;function ME(t){Z0(t,0)}function Eu(t){var e=Js(t);if(h0(e))return t}function FE(t,e){if(t==="change")return e}var $0=!1;if(Xn){var Sc;if(Xn){var Cc="oninput"in document;if(!Cc){var Sm=document.createElement("div");Sm.setAttribute("oninput","return;"),Cc=typeof Sm.oninput=="function"}Sc=Cc}else Sc=!1;$0=Sc&&(!document.documentMode||9<document.documentMode)}function Cm(){_o&&(_o.detachEvent("onpropertychange",q0),Mo=_o=null)}function q0(t){if(t.propertyName==="value"&&Eu(Mo)){var e=[];B0(e,Mo,t,jh(t)),b0(ME,e)}}function UE(t,e,n){t==="focusin"?(Cm(),_o=e,Mo=n,_o.attachEvent("onpropertychange",q0)):t==="focusout"&&Cm()}function zE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Eu(Mo)}function BE(t,e){if(t==="click")return Eu(e)}function $E(t,e){if(t==="input"||t==="change")return Eu(e)}function qE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var bn=typeof Object.is=="function"?Object.is:qE;function Fo(t,e){if(bn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!rd.call(e,s)||!bn(t[s],e[s]))return!1}return!0}function km(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Am(t,e){var n=km(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=km(n)}}function H0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?H0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function W0(){for(var t=window,e=Al();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Al(t.document)}return e}function Bh(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function HE(t){var e=W0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&H0(n.ownerDocument.documentElement,n)){if(r!==null&&Bh(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Am(n,i);var o=Am(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var WE=Xn&&"documentMode"in document&&11>=document.documentMode,Xs=null,Ed=null,wo=null,bd=!1;function Pm(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;bd||Xs==null||Xs!==Al(r)||(r=Xs,"selectionStart"in r&&Bh(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),wo&&Fo(wo,r)||(wo=r,r=Vl(Ed,"onSelect"),0<r.length&&(e=new Fh("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Xs)))}function Ga(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ys={animationend:Ga("Animation","AnimationEnd"),animationiteration:Ga("Animation","AnimationIteration"),animationstart:Ga("Animation","AnimationStart"),transitionend:Ga("Transition","TransitionEnd")},kc={},G0={};Xn&&(G0=document.createElement("div").style,"AnimationEvent"in window||(delete Ys.animationend.animation,delete Ys.animationiteration.animation,delete Ys.animationstart.animation),"TransitionEvent"in window||delete Ys.transitionend.transition);function bu(t){if(kc[t])return kc[t];if(!Ys[t])return t;var e=Ys[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in G0)return kc[t]=e[n];return t}var K0=bu("animationend"),Q0=bu("animationiteration"),X0=bu("animationstart"),Y0=bu("transitionend"),J0=new Map,Rm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Jr(t,e){J0.set(t,e),As(e,[t])}for(var Ac=0;Ac<Rm.length;Ac++){var Pc=Rm[Ac],GE=Pc.toLowerCase(),KE=Pc[0].toUpperCase()+Pc.slice(1);Jr(GE,"on"+KE)}Jr(K0,"onAnimationEnd");Jr(Q0,"onAnimationIteration");Jr(X0,"onAnimationStart");Jr("dblclick","onDoubleClick");Jr("focusin","onFocus");Jr("focusout","onBlur");Jr(Y0,"onTransitionEnd");yi("onMouseEnter",["mouseout","mouseover"]);yi("onMouseLeave",["mouseout","mouseover"]);yi("onPointerEnter",["pointerout","pointerover"]);yi("onPointerLeave",["pointerout","pointerover"]);As("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));As("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));As("onBeforeInput",["compositionend","keypress","textInput","paste"]);As("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));As("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));As("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ho="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QE=new Set("cancel close invalid load scroll toggle".split(" ").concat(ho));function jm(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,G1(r,e,void 0,t),t.currentTarget=null}function Z0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var u=r[o],c=u.instance,d=u.currentTarget;if(u=u.listener,c!==i&&s.isPropagationStopped())break e;jm(s,u,d),i=c}else for(o=0;o<r.length;o++){if(u=r[o],c=u.instance,d=u.currentTarget,u=u.listener,c!==i&&s.isPropagationStopped())break e;jm(s,u,d),i=c}}}if(Rl)throw t=vd,Rl=!1,vd=null,t}function Fe(t,e){var n=e[Cd];n===void 0&&(n=e[Cd]=new Set);var r=t+"__bubble";n.has(r)||(ev(e,t,2,!1),n.add(r))}function Rc(t,e,n){var r=0;e&&(r|=4),ev(n,t,r,e)}var Ka="_reactListening"+Math.random().toString(36).slice(2);function Uo(t){if(!t[Ka]){t[Ka]=!0,a0.forEach(function(n){n!=="selectionchange"&&(QE.has(n)||Rc(n,!1,t),Rc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ka]||(e[Ka]=!0,Rc("selectionchange",!1,e))}}function ev(t,e,n,r){switch(V0(e)){case 1:var s=uE;break;case 4:s=cE;break;default:s=Vh}n=s.bind(null,e,n,t),s=void 0,!yd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function jc(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var u=r.stateNode.containerInfo;if(u===s||u.nodeType===8&&u.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;u!==null;){if(o=cs(u),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}u=u.parentNode}}r=r.return}b0(function(){var d=i,f=jh(n),y=[];e:{var g=J0.get(t);if(g!==void 0){var w=Fh,S=t;switch(t){case"keypress":if(hl(n)===0)break e;case"keydown":case"keyup":w=IE;break;case"focusin":S="focus",w=Nc;break;case"focusout":S="blur",w=Nc;break;case"beforeblur":case"afterblur":w=Nc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=wm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=fE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=CE;break;case K0:case Q0:case X0:w=gE;break;case Y0:w=AE;break;case"scroll":w=dE;break;case"wheel":w=RE;break;case"copy":case"cut":case"paste":w=vE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=bm}var P=(e&4)!==0,R=!P&&t==="scroll",b=P?g!==null?g+"Capture":null:g;P=[];for(var x=d,I;x!==null;){I=x;var j=I.stateNode;if(I.tag===5&&j!==null&&(I=j,b!==null&&(j=Do(x,b),j!=null&&P.push(zo(x,j,I)))),R)break;x=x.return}0<P.length&&(g=new w(g,S,null,n,f),y.push({event:g,listeners:P}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",g&&n!==md&&(S=n.relatedTarget||n.fromElement)&&(cs(S)||S[Yn]))break e;if((w||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,w?(S=n.relatedTarget||n.toElement,w=d,S=S?cs(S):null,S!==null&&(R=Ps(S),S!==R||S.tag!==5&&S.tag!==6)&&(S=null)):(w=null,S=d),w!==S)){if(P=wm,j="onMouseLeave",b="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(P=bm,j="onPointerLeave",b="onPointerEnter",x="pointer"),R=w==null?g:Js(w),I=S==null?g:Js(S),g=new P(j,x+"leave",w,n,f),g.target=R,g.relatedTarget=I,j=null,cs(f)===d&&(P=new P(b,x+"enter",S,n,f),P.target=I,P.relatedTarget=R,j=P),R=j,w&&S)t:{for(P=w,b=S,x=0,I=P;I;I=Us(I))x++;for(I=0,j=b;j;j=Us(j))I++;for(;0<x-I;)P=Us(P),x--;for(;0<I-x;)b=Us(b),I--;for(;x--;){if(P===b||b!==null&&P===b.alternate)break t;P=Us(P),b=Us(b)}P=null}else P=null;w!==null&&Dm(y,g,w,P,!1),S!==null&&R!==null&&Dm(y,R,S,P,!0)}}e:{if(g=d?Js(d):window,w=g.nodeName&&g.nodeName.toLowerCase(),w==="select"||w==="input"&&g.type==="file")var M=FE;else if(Nm(g))if($0)M=$E;else{M=zE;var V=UE}else(w=g.nodeName)&&w.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(M=BE);if(M&&(M=M(t,d))){B0(y,M,n,f);break e}V&&V(t,g,d),t==="focusout"&&(V=g._wrapperState)&&V.controlled&&g.type==="number"&&cd(g,"number",g.value)}switch(V=d?Js(d):window,t){case"focusin":(Nm(V)||V.contentEditable==="true")&&(Xs=V,Ed=d,wo=null);break;case"focusout":wo=Ed=Xs=null;break;case"mousedown":bd=!0;break;case"contextmenu":case"mouseup":case"dragend":bd=!1,Pm(y,n,f);break;case"selectionchange":if(WE)break;case"keydown":case"keyup":Pm(y,n,f)}var T;if(zh)e:{switch(t){case"compositionstart":var p="onCompositionStart";break e;case"compositionend":p="onCompositionEnd";break e;case"compositionupdate":p="onCompositionUpdate";break e}p=void 0}else Qs?U0(t,n)&&(p="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(p="onCompositionStart");p&&(F0&&n.locale!=="ko"&&(Qs||p!=="onCompositionStart"?p==="onCompositionEnd"&&Qs&&(T=M0()):(Er=f,Mh="value"in Er?Er.value:Er.textContent,Qs=!0)),V=Vl(d,p),0<V.length&&(p=new Em(p,t,null,n,f),y.push({event:p,listeners:V}),T?p.data=T:(T=z0(n),T!==null&&(p.data=T)))),(T=DE?OE(t,n):LE(t,n))&&(d=Vl(d,"onBeforeInput"),0<d.length&&(f=new Em("onBeforeInput","beforeinput",null,n,f),y.push({event:f,listeners:d}),f.data=T))}Z0(y,e)})}function zo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Vl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Do(t,n),i!=null&&r.unshift(zo(t,i,s)),i=Do(t,e),i!=null&&r.push(zo(t,i,s))),t=t.return}return r}function Us(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Dm(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var u=n,c=u.alternate,d=u.stateNode;if(c!==null&&c===r)break;u.tag===5&&d!==null&&(u=d,s?(c=Do(n,i),c!=null&&o.unshift(zo(n,c,u))):s||(c=Do(n,i),c!=null&&o.push(zo(n,c,u)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var XE=/\r\n?/g,YE=/\u0000|\uFFFD/g;function Om(t){return(typeof t=="string"?t:""+t).replace(XE,`
`).replace(YE,"")}function Qa(t,e,n){if(e=Om(e),Om(t)!==e&&n)throw Error(W(425))}function Ml(){}var Td=null,Id=null;function Nd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Sd=typeof setTimeout=="function"?setTimeout:void 0,JE=typeof clearTimeout=="function"?clearTimeout:void 0,Lm=typeof Promise=="function"?Promise:void 0,ZE=typeof queueMicrotask=="function"?queueMicrotask:typeof Lm<"u"?function(t){return Lm.resolve(null).then(t).catch(eb)}:Sd;function eb(t){setTimeout(function(){throw t})}function Dc(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Vo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Vo(e)}function Cr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Vm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ri=Math.random().toString(36).slice(2),Cn="__reactFiber$"+Ri,Bo="__reactProps$"+Ri,Yn="__reactContainer$"+Ri,Cd="__reactEvents$"+Ri,tb="__reactListeners$"+Ri,nb="__reactHandles$"+Ri;function cs(t){var e=t[Cn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Yn]||n[Cn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Vm(t);t!==null;){if(n=t[Cn])return n;t=Vm(t)}return e}t=n,n=t.parentNode}return null}function ua(t){return t=t[Cn]||t[Yn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Js(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(W(33))}function Tu(t){return t[Bo]||null}var kd=[],Zs=-1;function Zr(t){return{current:t}}function Be(t){0>Zs||(t.current=kd[Zs],kd[Zs]=null,Zs--)}function Ve(t,e){Zs++,kd[Zs]=t.current,t.current=e}var Br={},At=Zr(Br),Wt=Zr(!1),xs=Br;function vi(t,e){var n=t.type.contextTypes;if(!n)return Br;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Gt(t){return t=t.childContextTypes,t!=null}function Fl(){Be(Wt),Be(At)}function Mm(t,e,n){if(At.current!==Br)throw Error(W(168));Ve(At,e),Ve(Wt,n)}function tv(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(W(108,U1(t)||"Unknown",s));return Ge({},n,r)}function Ul(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Br,xs=At.current,Ve(At,t),Ve(Wt,Wt.current),!0}function Fm(t,e,n){var r=t.stateNode;if(!r)throw Error(W(169));n?(t=tv(t,e,xs),r.__reactInternalMemoizedMergedChildContext=t,Be(Wt),Be(At),Ve(At,t)):Be(Wt),Ve(Wt,n)}var qn=null,Iu=!1,Oc=!1;function nv(t){qn===null?qn=[t]:qn.push(t)}function rb(t){Iu=!0,nv(t)}function es(){if(!Oc&&qn!==null){Oc=!0;var t=0,e=Re;try{var n=qn;for(Re=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}qn=null,Iu=!1}catch(s){throw qn!==null&&(qn=qn.slice(t+1)),S0(Dh,es),s}finally{Re=e,Oc=!1}}return null}var ei=[],ti=0,zl=null,Bl=0,sn=[],on=0,_s=null,Hn=1,Wn="";function as(t,e){ei[ti++]=Bl,ei[ti++]=zl,zl=t,Bl=e}function rv(t,e,n){sn[on++]=Hn,sn[on++]=Wn,sn[on++]=_s,_s=t;var r=Hn;t=Wn;var s=32-_n(r)-1;r&=~(1<<s),n+=1;var i=32-_n(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Hn=1<<32-_n(e)+s|n<<s|r,Wn=i+t}else Hn=1<<i|n<<s|r,Wn=t}function $h(t){t.return!==null&&(as(t,1),rv(t,1,0))}function qh(t){for(;t===zl;)zl=ei[--ti],ei[ti]=null,Bl=ei[--ti],ei[ti]=null;for(;t===_s;)_s=sn[--on],sn[on]=null,Wn=sn[--on],sn[on]=null,Hn=sn[--on],sn[on]=null}var en=null,Jt=null,$e=!1,yn=null;function sv(t,e){var n=ln(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Um(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,en=t,Jt=Cr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,en=t,Jt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=_s!==null?{id:Hn,overflow:Wn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ln(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,en=t,Jt=null,!0):!1;default:return!1}}function Ad(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Pd(t){if($e){var e=Jt;if(e){var n=e;if(!Um(t,e)){if(Ad(t))throw Error(W(418));e=Cr(n.nextSibling);var r=en;e&&Um(t,e)?sv(r,n):(t.flags=t.flags&-4097|2,$e=!1,en=t)}}else{if(Ad(t))throw Error(W(418));t.flags=t.flags&-4097|2,$e=!1,en=t}}}function zm(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;en=t}function Xa(t){if(t!==en)return!1;if(!$e)return zm(t),$e=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Nd(t.type,t.memoizedProps)),e&&(e=Jt)){if(Ad(t))throw iv(),Error(W(418));for(;e;)sv(t,e),e=Cr(e.nextSibling)}if(zm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(W(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Jt=Cr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Jt=null}}else Jt=en?Cr(t.stateNode.nextSibling):null;return!0}function iv(){for(var t=Jt;t;)t=Cr(t.nextSibling)}function xi(){Jt=en=null,$e=!1}function Hh(t){yn===null?yn=[t]:yn.push(t)}var sb=ir.ReactCurrentBatchConfig;function mn(t,e){if(t&&t.defaultProps){e=Ge({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var $l=Zr(null),ql=null,ni=null,Wh=null;function Gh(){Wh=ni=ql=null}function Kh(t){var e=$l.current;Be($l),t._currentValue=e}function Rd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ci(t,e){ql=t,Wh=ni=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ht=!0),t.firstContext=null)}function dn(t){var e=t._currentValue;if(Wh!==t)if(t={context:t,memoizedValue:e,next:null},ni===null){if(ql===null)throw Error(W(308));ni=t,ql.dependencies={lanes:0,firstContext:t}}else ni=ni.next=t;return e}var ds=null;function Qh(t){ds===null?ds=[t]:ds.push(t)}function ov(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Qh(e)):(n.next=s.next,s.next=n),e.interleaved=n,Jn(t,r)}function Jn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var mr=!1;function Xh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function av(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Qn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function kr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Se&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Jn(t,n)}return s=r.interleaved,s===null?(e.next=e,Qh(r)):(e.next=s.next,s.next=e),r.interleaved=e,Jn(t,n)}function fl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Oh(t,n)}}function Bm(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Hl(t,e,n,r){var s=t.updateQueue;mr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,u=s.shared.pending;if(u!==null){s.shared.pending=null;var c=u,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var f=t.alternate;f!==null&&(f=f.updateQueue,u=f.lastBaseUpdate,u!==o&&(u===null?f.firstBaseUpdate=d:u.next=d,f.lastBaseUpdate=c))}if(i!==null){var y=s.baseState;o=0,f=d=c=null,u=i;do{var g=u.lane,w=u.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:w,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var S=t,P=u;switch(g=e,w=n,P.tag){case 1:if(S=P.payload,typeof S=="function"){y=S.call(w,y,g);break e}y=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=P.payload,g=typeof S=="function"?S.call(w,y,g):S,g==null)break e;y=Ge({},y,g);break e;case 2:mr=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[u]:g.push(u))}else w={eventTime:w,lane:g,tag:u.tag,payload:u.payload,callback:u.callback,next:null},f===null?(d=f=w,c=y):f=f.next=w,o|=g;if(u=u.next,u===null){if(u=s.shared.pending,u===null)break;g=u,u=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(f===null&&(c=y),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Es|=o,t.lanes=o,t.memoizedState=y}}function $m(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(W(191,s));s.call(r)}}}var lv=new o0.Component().refs;function jd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ge({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Nu={isMounted:function(t){return(t=t._reactInternals)?Ps(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Lt(),s=Pr(t),i=Qn(r,s);i.payload=e,n!=null&&(i.callback=n),e=kr(t,i,s),e!==null&&(wn(e,t,s,r),fl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Lt(),s=Pr(t),i=Qn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=kr(t,i,s),e!==null&&(wn(e,t,s,r),fl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Lt(),r=Pr(t),s=Qn(n,r);s.tag=2,e!=null&&(s.callback=e),e=kr(t,s,r),e!==null&&(wn(e,t,r,n),fl(e,t,r))}};function qm(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Fo(n,r)||!Fo(s,i):!0}function uv(t,e,n){var r=!1,s=Br,i=e.contextType;return typeof i=="object"&&i!==null?i=dn(i):(s=Gt(e)?xs:At.current,r=e.contextTypes,i=(r=r!=null)?vi(t,s):Br),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Nu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Hm(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Nu.enqueueReplaceState(e,e.state,null)}function Dd(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=lv,Xh(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=dn(i):(i=Gt(e)?xs:At.current,s.context=vi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(jd(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Nu.enqueueReplaceState(s,s.state,null),Hl(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function io(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var u=s.refs;u===lv&&(u=s.refs={}),o===null?delete u[i]:u[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,t))}return t}function Ya(t,e){throw t=Object.prototype.toString.call(e),Error(W(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Wm(t){var e=t._init;return e(t._payload)}function cv(t){function e(b,x){if(t){var I=b.deletions;I===null?(b.deletions=[x],b.flags|=16):I.push(x)}}function n(b,x){if(!t)return null;for(;x!==null;)e(b,x),x=x.sibling;return null}function r(b,x){for(b=new Map;x!==null;)x.key!==null?b.set(x.key,x):b.set(x.index,x),x=x.sibling;return b}function s(b,x){return b=Rr(b,x),b.index=0,b.sibling=null,b}function i(b,x,I){return b.index=I,t?(I=b.alternate,I!==null?(I=I.index,I<x?(b.flags|=2,x):I):(b.flags|=2,x)):(b.flags|=1048576,x)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function u(b,x,I,j){return x===null||x.tag!==6?(x=Bc(I,b.mode,j),x.return=b,x):(x=s(x,I),x.return=b,x)}function c(b,x,I,j){var M=I.type;return M===Ks?f(b,x,I.props.children,j,I.key):x!==null&&(x.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===pr&&Wm(M)===x.type)?(j=s(x,I.props),j.ref=io(b,x,I),j.return=b,j):(j=xl(I.type,I.key,I.props,null,b.mode,j),j.ref=io(b,x,I),j.return=b,j)}function d(b,x,I,j){return x===null||x.tag!==4||x.stateNode.containerInfo!==I.containerInfo||x.stateNode.implementation!==I.implementation?(x=$c(I,b.mode,j),x.return=b,x):(x=s(x,I.children||[]),x.return=b,x)}function f(b,x,I,j,M){return x===null||x.tag!==7?(x=ms(I,b.mode,j,M),x.return=b,x):(x=s(x,I),x.return=b,x)}function y(b,x,I){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Bc(""+x,b.mode,I),x.return=b,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ua:return I=xl(x.type,x.key,x.props,null,b.mode,I),I.ref=io(b,null,x),I.return=b,I;case Gs:return x=$c(x,b.mode,I),x.return=b,x;case pr:var j=x._init;return y(b,j(x._payload),I)}if(uo(x)||eo(x))return x=ms(x,b.mode,I,null),x.return=b,x;Ya(b,x)}return null}function g(b,x,I,j){var M=x!==null?x.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return M!==null?null:u(b,x,""+I,j);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Ua:return I.key===M?c(b,x,I,j):null;case Gs:return I.key===M?d(b,x,I,j):null;case pr:return M=I._init,g(b,x,M(I._payload),j)}if(uo(I)||eo(I))return M!==null?null:f(b,x,I,j,null);Ya(b,I)}return null}function w(b,x,I,j,M){if(typeof j=="string"&&j!==""||typeof j=="number")return b=b.get(I)||null,u(x,b,""+j,M);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Ua:return b=b.get(j.key===null?I:j.key)||null,c(x,b,j,M);case Gs:return b=b.get(j.key===null?I:j.key)||null,d(x,b,j,M);case pr:var V=j._init;return w(b,x,I,V(j._payload),M)}if(uo(j)||eo(j))return b=b.get(I)||null,f(x,b,j,M,null);Ya(x,j)}return null}function S(b,x,I,j){for(var M=null,V=null,T=x,p=x=0,v=null;T!==null&&p<I.length;p++){T.index>p?(v=T,T=null):v=T.sibling;var _=g(b,T,I[p],j);if(_===null){T===null&&(T=v);break}t&&T&&_.alternate===null&&e(b,T),x=i(_,x,p),V===null?M=_:V.sibling=_,V=_,T=v}if(p===I.length)return n(b,T),$e&&as(b,p),M;if(T===null){for(;p<I.length;p++)T=y(b,I[p],j),T!==null&&(x=i(T,x,p),V===null?M=T:V.sibling=T,V=T);return $e&&as(b,p),M}for(T=r(b,T);p<I.length;p++)v=w(T,b,p,I[p],j),v!==null&&(t&&v.alternate!==null&&T.delete(v.key===null?p:v.key),x=i(v,x,p),V===null?M=v:V.sibling=v,V=v);return t&&T.forEach(function(C){return e(b,C)}),$e&&as(b,p),M}function P(b,x,I,j){var M=eo(I);if(typeof M!="function")throw Error(W(150));if(I=M.call(I),I==null)throw Error(W(151));for(var V=M=null,T=x,p=x=0,v=null,_=I.next();T!==null&&!_.done;p++,_=I.next()){T.index>p?(v=T,T=null):v=T.sibling;var C=g(b,T,_.value,j);if(C===null){T===null&&(T=v);break}t&&T&&C.alternate===null&&e(b,T),x=i(C,x,p),V===null?M=C:V.sibling=C,V=C,T=v}if(_.done)return n(b,T),$e&&as(b,p),M;if(T===null){for(;!_.done;p++,_=I.next())_=y(b,_.value,j),_!==null&&(x=i(_,x,p),V===null?M=_:V.sibling=_,V=_);return $e&&as(b,p),M}for(T=r(b,T);!_.done;p++,_=I.next())_=w(T,b,p,_.value,j),_!==null&&(t&&_.alternate!==null&&T.delete(_.key===null?p:_.key),x=i(_,x,p),V===null?M=_:V.sibling=_,V=_);return t&&T.forEach(function(A){return e(b,A)}),$e&&as(b,p),M}function R(b,x,I,j){if(typeof I=="object"&&I!==null&&I.type===Ks&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case Ua:e:{for(var M=I.key,V=x;V!==null;){if(V.key===M){if(M=I.type,M===Ks){if(V.tag===7){n(b,V.sibling),x=s(V,I.props.children),x.return=b,b=x;break e}}else if(V.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===pr&&Wm(M)===V.type){n(b,V.sibling),x=s(V,I.props),x.ref=io(b,V,I),x.return=b,b=x;break e}n(b,V);break}else e(b,V);V=V.sibling}I.type===Ks?(x=ms(I.props.children,b.mode,j,I.key),x.return=b,b=x):(j=xl(I.type,I.key,I.props,null,b.mode,j),j.ref=io(b,x,I),j.return=b,b=j)}return o(b);case Gs:e:{for(V=I.key;x!==null;){if(x.key===V)if(x.tag===4&&x.stateNode.containerInfo===I.containerInfo&&x.stateNode.implementation===I.implementation){n(b,x.sibling),x=s(x,I.children||[]),x.return=b,b=x;break e}else{n(b,x);break}else e(b,x);x=x.sibling}x=$c(I,b.mode,j),x.return=b,b=x}return o(b);case pr:return V=I._init,R(b,x,V(I._payload),j)}if(uo(I))return S(b,x,I,j);if(eo(I))return P(b,x,I,j);Ya(b,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,x!==null&&x.tag===6?(n(b,x.sibling),x=s(x,I),x.return=b,b=x):(n(b,x),x=Bc(I,b.mode,j),x.return=b,b=x),o(b)):n(b,x)}return R}var _i=cv(!0),dv=cv(!1),ca={},An=Zr(ca),$o=Zr(ca),qo=Zr(ca);function hs(t){if(t===ca)throw Error(W(174));return t}function Yh(t,e){switch(Ve(qo,e),Ve($o,t),Ve(An,ca),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:hd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=hd(e,t)}Be(An),Ve(An,e)}function wi(){Be(An),Be($o),Be(qo)}function hv(t){hs(qo.current);var e=hs(An.current),n=hd(e,t.type);e!==n&&(Ve($o,t),Ve(An,n))}function Jh(t){$o.current===t&&(Be(An),Be($o))}var He=Zr(0);function Wl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Lc=[];function Zh(){for(var t=0;t<Lc.length;t++)Lc[t]._workInProgressVersionPrimary=null;Lc.length=0}var pl=ir.ReactCurrentDispatcher,Vc=ir.ReactCurrentBatchConfig,ws=0,We=null,ot=null,dt=null,Gl=!1,Eo=!1,Ho=0,ib=0;function Tt(){throw Error(W(321))}function ef(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!bn(t[n],e[n]))return!1;return!0}function tf(t,e,n,r,s,i){if(ws=i,We=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,pl.current=t===null||t.memoizedState===null?ub:cb,t=n(r,s),Eo){i=0;do{if(Eo=!1,Ho=0,25<=i)throw Error(W(301));i+=1,dt=ot=null,e.updateQueue=null,pl.current=db,t=n(r,s)}while(Eo)}if(pl.current=Kl,e=ot!==null&&ot.next!==null,ws=0,dt=ot=We=null,Gl=!1,e)throw Error(W(300));return t}function nf(){var t=Ho!==0;return Ho=0,t}function Nn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dt===null?We.memoizedState=dt=t:dt=dt.next=t,dt}function hn(){if(ot===null){var t=We.alternate;t=t!==null?t.memoizedState:null}else t=ot.next;var e=dt===null?We.memoizedState:dt.next;if(e!==null)dt=e,ot=t;else{if(t===null)throw Error(W(310));ot=t,t={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},dt===null?We.memoizedState=dt=t:dt=dt.next=t}return dt}function Wo(t,e){return typeof e=="function"?e(t):e}function Mc(t){var e=hn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=ot,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var u=o=null,c=null,d=i;do{var f=d.lane;if((ws&f)===f)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var y={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(u=c=y,o=r):c=c.next=y,We.lanes|=f,Es|=f}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=u,bn(r,e.memoizedState)||(Ht=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,We.lanes|=i,Es|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Fc(t){var e=hn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);bn(i,e.memoizedState)||(Ht=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function fv(){}function pv(t,e){var n=We,r=hn(),s=e(),i=!bn(r.memoizedState,s);if(i&&(r.memoizedState=s,Ht=!0),r=r.queue,rf(yv.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||dt!==null&&dt.memoizedState.tag&1){if(n.flags|=2048,Go(9,gv.bind(null,n,r,s,e),void 0,null),ht===null)throw Error(W(349));ws&30||mv(n,e,s)}return s}function mv(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=We.updateQueue,e===null?(e={lastEffect:null,stores:null},We.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function gv(t,e,n,r){e.value=n,e.getSnapshot=r,vv(e)&&xv(t)}function yv(t,e,n){return n(function(){vv(e)&&xv(t)})}function vv(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!bn(t,n)}catch{return!0}}function xv(t){var e=Jn(t,1);e!==null&&wn(e,t,1,-1)}function Gm(t){var e=Nn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wo,lastRenderedState:t},e.queue=t,t=t.dispatch=lb.bind(null,We,t),[e.memoizedState,t]}function Go(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=We.updateQueue,e===null?(e={lastEffect:null,stores:null},We.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function _v(){return hn().memoizedState}function ml(t,e,n,r){var s=Nn();We.flags|=t,s.memoizedState=Go(1|e,n,void 0,r===void 0?null:r)}function Su(t,e,n,r){var s=hn();r=r===void 0?null:r;var i=void 0;if(ot!==null){var o=ot.memoizedState;if(i=o.destroy,r!==null&&ef(r,o.deps)){s.memoizedState=Go(e,n,i,r);return}}We.flags|=t,s.memoizedState=Go(1|e,n,i,r)}function Km(t,e){return ml(8390656,8,t,e)}function rf(t,e){return Su(2048,8,t,e)}function wv(t,e){return Su(4,2,t,e)}function Ev(t,e){return Su(4,4,t,e)}function bv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Tv(t,e,n){return n=n!=null?n.concat([t]):null,Su(4,4,bv.bind(null,e,t),n)}function sf(){}function Iv(t,e){var n=hn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ef(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Nv(t,e){var n=hn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ef(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Sv(t,e,n){return ws&21?(bn(n,e)||(n=A0(),We.lanes|=n,Es|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ht=!0),t.memoizedState=n)}function ob(t,e){var n=Re;Re=n!==0&&4>n?n:4,t(!0);var r=Vc.transition;Vc.transition={};try{t(!1),e()}finally{Re=n,Vc.transition=r}}function Cv(){return hn().memoizedState}function ab(t,e,n){var r=Pr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},kv(t))Av(e,n);else if(n=ov(t,e,n,r),n!==null){var s=Lt();wn(n,t,r,s),Pv(n,e,r)}}function lb(t,e,n){var r=Pr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(kv(t))Av(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,u=i(o,n);if(s.hasEagerState=!0,s.eagerState=u,bn(u,o)){var c=e.interleaved;c===null?(s.next=s,Qh(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=ov(t,e,s,r),n!==null&&(s=Lt(),wn(n,t,r,s),Pv(n,e,r))}}function kv(t){var e=t.alternate;return t===We||e!==null&&e===We}function Av(t,e){Eo=Gl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Pv(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Oh(t,n)}}var Kl={readContext:dn,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useInsertionEffect:Tt,useLayoutEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useMutableSource:Tt,useSyncExternalStore:Tt,useId:Tt,unstable_isNewReconciler:!1},ub={readContext:dn,useCallback:function(t,e){return Nn().memoizedState=[t,e===void 0?null:e],t},useContext:dn,useEffect:Km,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ml(4194308,4,bv.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ml(4194308,4,t,e)},useInsertionEffect:function(t,e){return ml(4,2,t,e)},useMemo:function(t,e){var n=Nn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Nn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=ab.bind(null,We,t),[r.memoizedState,t]},useRef:function(t){var e=Nn();return t={current:t},e.memoizedState=t},useState:Gm,useDebugValue:sf,useDeferredValue:function(t){return Nn().memoizedState=t},useTransition:function(){var t=Gm(!1),e=t[0];return t=ob.bind(null,t[1]),Nn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=We,s=Nn();if($e){if(n===void 0)throw Error(W(407));n=n()}else{if(n=e(),ht===null)throw Error(W(349));ws&30||mv(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Km(yv.bind(null,r,i,t),[t]),r.flags|=2048,Go(9,gv.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Nn(),e=ht.identifierPrefix;if($e){var n=Wn,r=Hn;n=(r&~(1<<32-_n(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ho++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=ib++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},cb={readContext:dn,useCallback:Iv,useContext:dn,useEffect:rf,useImperativeHandle:Tv,useInsertionEffect:wv,useLayoutEffect:Ev,useMemo:Nv,useReducer:Mc,useRef:_v,useState:function(){return Mc(Wo)},useDebugValue:sf,useDeferredValue:function(t){var e=hn();return Sv(e,ot.memoizedState,t)},useTransition:function(){var t=Mc(Wo)[0],e=hn().memoizedState;return[t,e]},useMutableSource:fv,useSyncExternalStore:pv,useId:Cv,unstable_isNewReconciler:!1},db={readContext:dn,useCallback:Iv,useContext:dn,useEffect:rf,useImperativeHandle:Tv,useInsertionEffect:wv,useLayoutEffect:Ev,useMemo:Nv,useReducer:Fc,useRef:_v,useState:function(){return Fc(Wo)},useDebugValue:sf,useDeferredValue:function(t){var e=hn();return ot===null?e.memoizedState=t:Sv(e,ot.memoizedState,t)},useTransition:function(){var t=Fc(Wo)[0],e=hn().memoizedState;return[t,e]},useMutableSource:fv,useSyncExternalStore:pv,useId:Cv,unstable_isNewReconciler:!1};function Ei(t,e){try{var n="",r=e;do n+=F1(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Uc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Od(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var hb=typeof WeakMap=="function"?WeakMap:Map;function Rv(t,e,n){n=Qn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Xl||(Xl=!0,Hd=r),Od(t,e)},n}function jv(t,e,n){n=Qn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Od(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Od(t,e),typeof r!="function"&&(Ar===null?Ar=new Set([this]):Ar.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Qm(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new hb;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=Nb.bind(null,t,e,n),e.then(t,t))}function Xm(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Ym(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Qn(-1,1),e.tag=2,kr(n,e,1))),n.lanes|=1),t)}var fb=ir.ReactCurrentOwner,Ht=!1;function Ot(t,e,n,r){e.child=t===null?dv(e,null,n,r):_i(e,t.child,n,r)}function Jm(t,e,n,r,s){n=n.render;var i=e.ref;return ci(e,s),r=tf(t,e,n,r,i,s),n=nf(),t!==null&&!Ht?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Zn(t,e,s)):($e&&n&&$h(e),e.flags|=1,Ot(t,e,r,s),e.child)}function Zm(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!ff(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Dv(t,e,i,r,s)):(t=xl(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Fo,n(o,r)&&t.ref===e.ref)return Zn(t,e,s)}return e.flags|=1,t=Rr(i,r),t.ref=e.ref,t.return=e,e.child=t}function Dv(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Fo(i,r)&&t.ref===e.ref)if(Ht=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Ht=!0);else return e.lanes=t.lanes,Zn(t,e,s)}return Ld(t,e,n,r,s)}function Ov(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ve(si,Yt),Yt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ve(si,Yt),Yt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ve(si,Yt),Yt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ve(si,Yt),Yt|=r;return Ot(t,e,s,n),e.child}function Lv(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ld(t,e,n,r,s){var i=Gt(n)?xs:At.current;return i=vi(e,i),ci(e,s),n=tf(t,e,n,r,i,s),r=nf(),t!==null&&!Ht?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Zn(t,e,s)):($e&&r&&$h(e),e.flags|=1,Ot(t,e,n,s),e.child)}function eg(t,e,n,r,s){if(Gt(n)){var i=!0;Ul(e)}else i=!1;if(ci(e,s),e.stateNode===null)gl(t,e),uv(e,n,r),Dd(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,u=e.memoizedProps;o.props=u;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=dn(d):(d=Gt(n)?xs:At.current,d=vi(e,d));var f=n.getDerivedStateFromProps,y=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";y||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==r||c!==d)&&Hm(e,o,r,d),mr=!1;var g=e.memoizedState;o.state=g,Hl(e,r,o,s),c=e.memoizedState,u!==r||g!==c||Wt.current||mr?(typeof f=="function"&&(jd(e,n,f,r),c=e.memoizedState),(u=mr||qm(e,n,u,r,g,c,d))?(y||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=u):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,av(t,e),u=e.memoizedProps,d=e.type===e.elementType?u:mn(e.type,u),o.props=d,y=e.pendingProps,g=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=dn(c):(c=Gt(n)?xs:At.current,c=vi(e,c));var w=n.getDerivedStateFromProps;(f=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==y||g!==c)&&Hm(e,o,r,c),mr=!1,g=e.memoizedState,o.state=g,Hl(e,r,o,s);var S=e.memoizedState;u!==y||g!==S||Wt.current||mr?(typeof w=="function"&&(jd(e,n,w,r),S=e.memoizedState),(d=mr||qm(e,n,d,r,g,S,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,S,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,S,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||u===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=S),o.props=r,o.state=S,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||u===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return Vd(t,e,n,r,i,s)}function Vd(t,e,n,r,s,i){Lv(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Fm(e,n,!1),Zn(t,e,i);r=e.stateNode,fb.current=e;var u=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=_i(e,t.child,null,i),e.child=_i(e,null,u,i)):Ot(t,e,u,i),e.memoizedState=r.state,s&&Fm(e,n,!0),e.child}function Vv(t){var e=t.stateNode;e.pendingContext?Mm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Mm(t,e.context,!1),Yh(t,e.containerInfo)}function tg(t,e,n,r,s){return xi(),Hh(s),e.flags|=256,Ot(t,e,n,r),e.child}var Md={dehydrated:null,treeContext:null,retryLane:0};function Fd(t){return{baseLanes:t,cachePool:null,transitions:null}}function Mv(t,e,n){var r=e.pendingProps,s=He.current,i=!1,o=(e.flags&128)!==0,u;if((u=o)||(u=t!==null&&t.memoizedState===null?!1:(s&2)!==0),u?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ve(He,s&1),t===null)return Pd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Au(o,r,0,null),t=ms(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Fd(n),e.memoizedState=Md,t):of(e,o));if(s=t.memoizedState,s!==null&&(u=s.dehydrated,u!==null))return pb(t,e,o,r,u,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,u=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Rr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),u!==null?i=Rr(u,i):(i=ms(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Fd(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Md,r}return i=t.child,t=i.sibling,r=Rr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function of(t,e){return e=Au({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ja(t,e,n,r){return r!==null&&Hh(r),_i(e,t.child,null,n),t=of(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function pb(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Uc(Error(W(422))),Ja(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Au({mode:"visible",children:r.children},s,0,null),i=ms(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&_i(e,t.child,null,o),e.child.memoizedState=Fd(o),e.memoizedState=Md,i);if(!(e.mode&1))return Ja(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var u=r.dgst;return r=u,i=Error(W(419)),r=Uc(i,r,void 0),Ja(t,e,o,r)}if(u=(o&t.childLanes)!==0,Ht||u){if(r=ht,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Jn(t,s),wn(r,t,s,-1))}return hf(),r=Uc(Error(W(421))),Ja(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Sb.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Jt=Cr(s.nextSibling),en=e,$e=!0,yn=null,t!==null&&(sn[on++]=Hn,sn[on++]=Wn,sn[on++]=_s,Hn=t.id,Wn=t.overflow,_s=e),e=of(e,r.children),e.flags|=4096,e)}function ng(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Rd(t.return,e,n)}function zc(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Fv(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Ot(t,e,r.children,n),r=He.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ng(t,n,e);else if(t.tag===19)ng(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ve(He,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Wl(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),zc(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Wl(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}zc(e,!0,n,null,i);break;case"together":zc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function gl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Zn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Es|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(W(153));if(e.child!==null){for(t=e.child,n=Rr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Rr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function mb(t,e,n){switch(e.tag){case 3:Vv(e),xi();break;case 5:hv(e);break;case 1:Gt(e.type)&&Ul(e);break;case 4:Yh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ve($l,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ve(He,He.current&1),e.flags|=128,null):n&e.child.childLanes?Mv(t,e,n):(Ve(He,He.current&1),t=Zn(t,e,n),t!==null?t.sibling:null);Ve(He,He.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Fv(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ve(He,He.current),r)break;return null;case 22:case 23:return e.lanes=0,Ov(t,e,n)}return Zn(t,e,n)}var Uv,Ud,zv,Bv;Uv=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ud=function(){};zv=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,hs(An.current);var i=null;switch(n){case"input":s=ld(t,s),r=ld(t,r),i=[];break;case"select":s=Ge({},s,{value:void 0}),r=Ge({},r,{value:void 0}),i=[];break;case"textarea":s=dd(t,s),r=dd(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ml)}fd(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var u=s[d];for(o in u)u.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ro.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(u=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==u&&(c!=null||u!=null))if(d==="style")if(u){for(o in u)!u.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&u[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,u=u?u.__html:void 0,c!=null&&u!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ro.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Fe("scroll",t),i||u===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};Bv=function(t,e,n,r){n!==r&&(e.flags|=4)};function oo(t,e){if(!$e)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function It(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function gb(t,e,n){var r=e.pendingProps;switch(qh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return It(e),null;case 1:return Gt(e.type)&&Fl(),It(e),null;case 3:return r=e.stateNode,wi(),Be(Wt),Be(At),Zh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Xa(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,yn!==null&&(Kd(yn),yn=null))),Ud(t,e),It(e),null;case 5:Jh(e);var s=hs(qo.current);if(n=e.type,t!==null&&e.stateNode!=null)zv(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(W(166));return It(e),null}if(t=hs(An.current),Xa(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Cn]=e,r[Bo]=i,t=(e.mode&1)!==0,n){case"dialog":Fe("cancel",r),Fe("close",r);break;case"iframe":case"object":case"embed":Fe("load",r);break;case"video":case"audio":for(s=0;s<ho.length;s++)Fe(ho[s],r);break;case"source":Fe("error",r);break;case"img":case"image":case"link":Fe("error",r),Fe("load",r);break;case"details":Fe("toggle",r);break;case"input":dm(r,i),Fe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Fe("invalid",r);break;case"textarea":fm(r,i),Fe("invalid",r)}fd(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var u=i[o];o==="children"?typeof u=="string"?r.textContent!==u&&(i.suppressHydrationWarning!==!0&&Qa(r.textContent,u,t),s=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(i.suppressHydrationWarning!==!0&&Qa(r.textContent,u,t),s=["children",""+u]):Ro.hasOwnProperty(o)&&u!=null&&o==="onScroll"&&Fe("scroll",r)}switch(n){case"input":za(r),hm(r,i,!0);break;case"textarea":za(r),pm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Ml)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=m0(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Cn]=e,t[Bo]=r,Uv(t,e,!1,!1),e.stateNode=t;e:{switch(o=pd(n,r),n){case"dialog":Fe("cancel",t),Fe("close",t),s=r;break;case"iframe":case"object":case"embed":Fe("load",t),s=r;break;case"video":case"audio":for(s=0;s<ho.length;s++)Fe(ho[s],t);s=r;break;case"source":Fe("error",t),s=r;break;case"img":case"image":case"link":Fe("error",t),Fe("load",t),s=r;break;case"details":Fe("toggle",t),s=r;break;case"input":dm(t,r),s=ld(t,r),Fe("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ge({},r,{value:void 0}),Fe("invalid",t);break;case"textarea":fm(t,r),s=dd(t,r),Fe("invalid",t);break;default:s=r}fd(n,s),u=s;for(i in u)if(u.hasOwnProperty(i)){var c=u[i];i==="style"?v0(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&g0(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&jo(t,c):typeof c=="number"&&jo(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ro.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Fe("scroll",t):c!=null&&kh(t,i,c,o))}switch(n){case"input":za(t),hm(t,r,!1);break;case"textarea":za(t),pm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+zr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?oi(t,!!r.multiple,i,!1):r.defaultValue!=null&&oi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Ml)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return It(e),null;case 6:if(t&&e.stateNode!=null)Bv(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(W(166));if(n=hs(qo.current),hs(An.current),Xa(e)){if(r=e.stateNode,n=e.memoizedProps,r[Cn]=e,(i=r.nodeValue!==n)&&(t=en,t!==null))switch(t.tag){case 3:Qa(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Qa(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Cn]=e,e.stateNode=r}return It(e),null;case 13:if(Be(He),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if($e&&Jt!==null&&e.mode&1&&!(e.flags&128))iv(),xi(),e.flags|=98560,i=!1;else if(i=Xa(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(W(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[Cn]=e}else xi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;It(e),i=!1}else yn!==null&&(Kd(yn),yn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||He.current&1?lt===0&&(lt=3):hf())),e.updateQueue!==null&&(e.flags|=4),It(e),null);case 4:return wi(),Ud(t,e),t===null&&Uo(e.stateNode.containerInfo),It(e),null;case 10:return Kh(e.type._context),It(e),null;case 17:return Gt(e.type)&&Fl(),It(e),null;case 19:if(Be(He),i=e.memoizedState,i===null)return It(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)oo(i,!1);else{if(lt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Wl(t),o!==null){for(e.flags|=128,oo(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ve(He,He.current&1|2),e.child}t=t.sibling}i.tail!==null&&Je()>bi&&(e.flags|=128,r=!0,oo(i,!1),e.lanes=4194304)}else{if(!r)if(t=Wl(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),oo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!$e)return It(e),null}else 2*Je()-i.renderingStartTime>bi&&n!==1073741824&&(e.flags|=128,r=!0,oo(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Je(),e.sibling=null,n=He.current,Ve(He,r?n&1|2:n&1),e):(It(e),null);case 22:case 23:return df(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Yt&1073741824&&(It(e),e.subtreeFlags&6&&(e.flags|=8192)):It(e),null;case 24:return null;case 25:return null}throw Error(W(156,e.tag))}function yb(t,e){switch(qh(e),e.tag){case 1:return Gt(e.type)&&Fl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return wi(),Be(Wt),Be(At),Zh(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Jh(e),null;case 13:if(Be(He),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(W(340));xi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Be(He),null;case 4:return wi(),null;case 10:return Kh(e.type._context),null;case 22:case 23:return df(),null;case 24:return null;default:return null}}var Za=!1,Ct=!1,vb=typeof WeakSet=="function"?WeakSet:Set,re=null;function ri(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Xe(t,e,r)}else n.current=null}function zd(t,e,n){try{n()}catch(r){Xe(t,e,r)}}var rg=!1;function xb(t,e){if(Td=Ol,t=W0(),Bh(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,u=-1,c=-1,d=0,f=0,y=t,g=null;t:for(;;){for(var w;y!==n||s!==0&&y.nodeType!==3||(u=o+s),y!==i||r!==0&&y.nodeType!==3||(c=o+r),y.nodeType===3&&(o+=y.nodeValue.length),(w=y.firstChild)!==null;)g=y,y=w;for(;;){if(y===t)break t;if(g===n&&++d===s&&(u=o),g===i&&++f===r&&(c=o),(w=y.nextSibling)!==null)break;y=g,g=y.parentNode}y=w}n=u===-1||c===-1?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Id={focusedElem:t,selectionRange:n},Ol=!1,re=e;re!==null;)if(e=re,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,re=t;else for(;re!==null;){e=re;try{var S=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var P=S.memoizedProps,R=S.memoizedState,b=e.stateNode,x=b.getSnapshotBeforeUpdate(e.elementType===e.type?P:mn(e.type,P),R);b.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(j){Xe(e,e.return,j)}if(t=e.sibling,t!==null){t.return=e.return,re=t;break}re=e.return}return S=rg,rg=!1,S}function bo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&zd(e,n,i)}s=s.next}while(s!==r)}}function Cu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Bd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function $v(t){var e=t.alternate;e!==null&&(t.alternate=null,$v(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Cn],delete e[Bo],delete e[Cd],delete e[tb],delete e[nb])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function qv(t){return t.tag===5||t.tag===3||t.tag===4}function sg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||qv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function $d(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ml));else if(r!==4&&(t=t.child,t!==null))for($d(t,e,n),t=t.sibling;t!==null;)$d(t,e,n),t=t.sibling}function qd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(qd(t,e,n),t=t.sibling;t!==null;)qd(t,e,n),t=t.sibling}var mt=null,gn=!1;function hr(t,e,n){for(n=n.child;n!==null;)Hv(t,e,n),n=n.sibling}function Hv(t,e,n){if(kn&&typeof kn.onCommitFiberUnmount=="function")try{kn.onCommitFiberUnmount(_u,n)}catch{}switch(n.tag){case 5:Ct||ri(n,e);case 6:var r=mt,s=gn;mt=null,hr(t,e,n),mt=r,gn=s,mt!==null&&(gn?(t=mt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):mt.removeChild(n.stateNode));break;case 18:mt!==null&&(gn?(t=mt,n=n.stateNode,t.nodeType===8?Dc(t.parentNode,n):t.nodeType===1&&Dc(t,n),Vo(t)):Dc(mt,n.stateNode));break;case 4:r=mt,s=gn,mt=n.stateNode.containerInfo,gn=!0,hr(t,e,n),mt=r,gn=s;break;case 0:case 11:case 14:case 15:if(!Ct&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&zd(n,e,o),s=s.next}while(s!==r)}hr(t,e,n);break;case 1:if(!Ct&&(ri(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){Xe(n,e,u)}hr(t,e,n);break;case 21:hr(t,e,n);break;case 22:n.mode&1?(Ct=(r=Ct)||n.memoizedState!==null,hr(t,e,n),Ct=r):hr(t,e,n);break;default:hr(t,e,n)}}function ig(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new vb),e.forEach(function(r){var s=Cb.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function pn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,u=o;e:for(;u!==null;){switch(u.tag){case 5:mt=u.stateNode,gn=!1;break e;case 3:mt=u.stateNode.containerInfo,gn=!0;break e;case 4:mt=u.stateNode.containerInfo,gn=!0;break e}u=u.return}if(mt===null)throw Error(W(160));Hv(i,o,s),mt=null,gn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){Xe(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Wv(e,t),e=e.sibling}function Wv(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(pn(e,t),In(t),r&4){try{bo(3,t,t.return),Cu(3,t)}catch(P){Xe(t,t.return,P)}try{bo(5,t,t.return)}catch(P){Xe(t,t.return,P)}}break;case 1:pn(e,t),In(t),r&512&&n!==null&&ri(n,n.return);break;case 5:if(pn(e,t),In(t),r&512&&n!==null&&ri(n,n.return),t.flags&32){var s=t.stateNode;try{jo(s,"")}catch(P){Xe(t,t.return,P)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,u=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{u==="input"&&i.type==="radio"&&i.name!=null&&f0(s,i),pd(u,o);var d=pd(u,i);for(o=0;o<c.length;o+=2){var f=c[o],y=c[o+1];f==="style"?v0(s,y):f==="dangerouslySetInnerHTML"?g0(s,y):f==="children"?jo(s,y):kh(s,f,y,d)}switch(u){case"input":ud(s,i);break;case"textarea":p0(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var w=i.value;w!=null?oi(s,!!i.multiple,w,!1):g!==!!i.multiple&&(i.defaultValue!=null?oi(s,!!i.multiple,i.defaultValue,!0):oi(s,!!i.multiple,i.multiple?[]:"",!1))}s[Bo]=i}catch(P){Xe(t,t.return,P)}}break;case 6:if(pn(e,t),In(t),r&4){if(t.stateNode===null)throw Error(W(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(P){Xe(t,t.return,P)}}break;case 3:if(pn(e,t),In(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Vo(e.containerInfo)}catch(P){Xe(t,t.return,P)}break;case 4:pn(e,t),In(t);break;case 13:pn(e,t),In(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(uf=Je())),r&4&&ig(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Ct=(d=Ct)||f,pn(e,t),Ct=d):pn(e,t),In(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(re=t,f=t.child;f!==null;){for(y=re=f;re!==null;){switch(g=re,w=g.child,g.tag){case 0:case 11:case 14:case 15:bo(4,g,g.return);break;case 1:ri(g,g.return);var S=g.stateNode;if(typeof S.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,S.props=e.memoizedProps,S.state=e.memoizedState,S.componentWillUnmount()}catch(P){Xe(r,n,P)}}break;case 5:ri(g,g.return);break;case 22:if(g.memoizedState!==null){ag(y);continue}}w!==null?(w.return=g,re=w):ag(y)}f=f.sibling}e:for(f=null,y=t;;){if(y.tag===5){if(f===null){f=y;try{s=y.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(u=y.stateNode,c=y.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,u.style.display=y0("display",o))}catch(P){Xe(t,t.return,P)}}}else if(y.tag===6){if(f===null)try{y.stateNode.nodeValue=d?"":y.memoizedProps}catch(P){Xe(t,t.return,P)}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===t)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;f===y&&(f=null),y=y.return}f===y&&(f=null),y.sibling.return=y.return,y=y.sibling}}break;case 19:pn(e,t),In(t),r&4&&ig(t);break;case 21:break;default:pn(e,t),In(t)}}function In(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(qv(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(jo(s,""),r.flags&=-33);var i=sg(t);qd(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,u=sg(t);$d(t,u,o);break;default:throw Error(W(161))}}catch(c){Xe(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function _b(t,e,n){re=t,Gv(t)}function Gv(t,e,n){for(var r=(t.mode&1)!==0;re!==null;){var s=re,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Za;if(!o){var u=s.alternate,c=u!==null&&u.memoizedState!==null||Ct;u=Za;var d=Ct;if(Za=o,(Ct=c)&&!d)for(re=s;re!==null;)o=re,c=o.child,o.tag===22&&o.memoizedState!==null?lg(s):c!==null?(c.return=o,re=c):lg(s);for(;i!==null;)re=i,Gv(i),i=i.sibling;re=s,Za=u,Ct=d}og(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,re=i):og(t)}}function og(t){for(;re!==null;){var e=re;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ct||Cu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ct)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:mn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&$m(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}$m(e,o,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var y=f.dehydrated;y!==null&&Vo(y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}Ct||e.flags&512&&Bd(e)}catch(g){Xe(e,e.return,g)}}if(e===t){re=null;break}if(n=e.sibling,n!==null){n.return=e.return,re=n;break}re=e.return}}function ag(t){for(;re!==null;){var e=re;if(e===t){re=null;break}var n=e.sibling;if(n!==null){n.return=e.return,re=n;break}re=e.return}}function lg(t){for(;re!==null;){var e=re;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Cu(4,e)}catch(c){Xe(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Xe(e,s,c)}}var i=e.return;try{Bd(e)}catch(c){Xe(e,i,c)}break;case 5:var o=e.return;try{Bd(e)}catch(c){Xe(e,o,c)}}}catch(c){Xe(e,e.return,c)}if(e===t){re=null;break}var u=e.sibling;if(u!==null){u.return=e.return,re=u;break}re=e.return}}var wb=Math.ceil,Ql=ir.ReactCurrentDispatcher,af=ir.ReactCurrentOwner,un=ir.ReactCurrentBatchConfig,Se=0,ht=null,tt=null,vt=0,Yt=0,si=Zr(0),lt=0,Ko=null,Es=0,ku=0,lf=0,To=null,$t=null,uf=0,bi=1/0,$n=null,Xl=!1,Hd=null,Ar=null,el=!1,br=null,Yl=0,Io=0,Wd=null,yl=-1,vl=0;function Lt(){return Se&6?Je():yl!==-1?yl:yl=Je()}function Pr(t){return t.mode&1?Se&2&&vt!==0?vt&-vt:sb.transition!==null?(vl===0&&(vl=A0()),vl):(t=Re,t!==0||(t=window.event,t=t===void 0?16:V0(t.type)),t):1}function wn(t,e,n,r){if(50<Io)throw Io=0,Wd=null,Error(W(185));aa(t,n,r),(!(Se&2)||t!==ht)&&(t===ht&&(!(Se&2)&&(ku|=n),lt===4&&yr(t,vt)),Kt(t,r),n===1&&Se===0&&!(e.mode&1)&&(bi=Je()+500,Iu&&es()))}function Kt(t,e){var n=t.callbackNode;sE(t,e);var r=Dl(t,t===ht?vt:0);if(r===0)n!==null&&ym(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&ym(n),e===1)t.tag===0?rb(ug.bind(null,t)):nv(ug.bind(null,t)),ZE(function(){!(Se&6)&&es()}),n=null;else{switch(P0(r)){case 1:n=Dh;break;case 4:n=C0;break;case 16:n=jl;break;case 536870912:n=k0;break;default:n=jl}n=tx(n,Kv.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Kv(t,e){if(yl=-1,vl=0,Se&6)throw Error(W(327));var n=t.callbackNode;if(di()&&t.callbackNode!==n)return null;var r=Dl(t,t===ht?vt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Jl(t,r);else{e=r;var s=Se;Se|=2;var i=Xv();(ht!==t||vt!==e)&&($n=null,bi=Je()+500,ps(t,e));do try{Tb();break}catch(u){Qv(t,u)}while(!0);Gh(),Ql.current=i,Se=s,tt!==null?e=0:(ht=null,vt=0,e=lt)}if(e!==0){if(e===2&&(s=xd(t),s!==0&&(r=s,e=Gd(t,s))),e===1)throw n=Ko,ps(t,0),yr(t,r),Kt(t,Je()),n;if(e===6)yr(t,r);else{if(s=t.current.alternate,!(r&30)&&!Eb(s)&&(e=Jl(t,r),e===2&&(i=xd(t),i!==0&&(r=i,e=Gd(t,i))),e===1))throw n=Ko,ps(t,0),yr(t,r),Kt(t,Je()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(W(345));case 2:ls(t,$t,$n);break;case 3:if(yr(t,r),(r&130023424)===r&&(e=uf+500-Je(),10<e)){if(Dl(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Lt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Sd(ls.bind(null,t,$t,$n),e);break}ls(t,$t,$n);break;case 4:if(yr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-_n(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Je()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*wb(r/1960))-r,10<r){t.timeoutHandle=Sd(ls.bind(null,t,$t,$n),r);break}ls(t,$t,$n);break;case 5:ls(t,$t,$n);break;default:throw Error(W(329))}}}return Kt(t,Je()),t.callbackNode===n?Kv.bind(null,t):null}function Gd(t,e){var n=To;return t.current.memoizedState.isDehydrated&&(ps(t,e).flags|=256),t=Jl(t,e),t!==2&&(e=$t,$t=n,e!==null&&Kd(e)),t}function Kd(t){$t===null?$t=t:$t.push.apply($t,t)}function Eb(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!bn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function yr(t,e){for(e&=~lf,e&=~ku,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-_n(e),r=1<<n;t[n]=-1,e&=~r}}function ug(t){if(Se&6)throw Error(W(327));di();var e=Dl(t,0);if(!(e&1))return Kt(t,Je()),null;var n=Jl(t,e);if(t.tag!==0&&n===2){var r=xd(t);r!==0&&(e=r,n=Gd(t,r))}if(n===1)throw n=Ko,ps(t,0),yr(t,e),Kt(t,Je()),n;if(n===6)throw Error(W(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ls(t,$t,$n),Kt(t,Je()),null}function cf(t,e){var n=Se;Se|=1;try{return t(e)}finally{Se=n,Se===0&&(bi=Je()+500,Iu&&es())}}function bs(t){br!==null&&br.tag===0&&!(Se&6)&&di();var e=Se;Se|=1;var n=un.transition,r=Re;try{if(un.transition=null,Re=1,t)return t()}finally{Re=r,un.transition=n,Se=e,!(Se&6)&&es()}}function df(){Yt=si.current,Be(si)}function ps(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,JE(n)),tt!==null)for(n=tt.return;n!==null;){var r=n;switch(qh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Fl();break;case 3:wi(),Be(Wt),Be(At),Zh();break;case 5:Jh(r);break;case 4:wi();break;case 13:Be(He);break;case 19:Be(He);break;case 10:Kh(r.type._context);break;case 22:case 23:df()}n=n.return}if(ht=t,tt=t=Rr(t.current,null),vt=Yt=e,lt=0,Ko=null,lf=ku=Es=0,$t=To=null,ds!==null){for(e=0;e<ds.length;e++)if(n=ds[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}ds=null}return t}function Qv(t,e){do{var n=tt;try{if(Gh(),pl.current=Kl,Gl){for(var r=We.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Gl=!1}if(ws=0,dt=ot=We=null,Eo=!1,Ho=0,af.current=null,n===null||n.return===null){lt=1,Ko=e,tt=null;break}e:{var i=t,o=n.return,u=n,c=e;if(e=vt,u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,f=u,y=f.tag;if(!(f.mode&1)&&(y===0||y===11||y===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var w=Xm(o);if(w!==null){w.flags&=-257,Ym(w,o,u,i,e),w.mode&1&&Qm(i,d,e),e=w,c=d;var S=e.updateQueue;if(S===null){var P=new Set;P.add(c),e.updateQueue=P}else S.add(c);break e}else{if(!(e&1)){Qm(i,d,e),hf();break e}c=Error(W(426))}}else if($e&&u.mode&1){var R=Xm(o);if(R!==null){!(R.flags&65536)&&(R.flags|=256),Ym(R,o,u,i,e),Hh(Ei(c,u));break e}}i=c=Ei(c,u),lt!==4&&(lt=2),To===null?To=[i]:To.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=Rv(i,c,e);Bm(i,b);break e;case 1:u=c;var x=i.type,I=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Ar===null||!Ar.has(I)))){i.flags|=65536,e&=-e,i.lanes|=e;var j=jv(i,u,e);Bm(i,j);break e}}i=i.return}while(i!==null)}Jv(n)}catch(M){e=M,tt===n&&n!==null&&(tt=n=n.return);continue}break}while(!0)}function Xv(){var t=Ql.current;return Ql.current=Kl,t===null?Kl:t}function hf(){(lt===0||lt===3||lt===2)&&(lt=4),ht===null||!(Es&268435455)&&!(ku&268435455)||yr(ht,vt)}function Jl(t,e){var n=Se;Se|=2;var r=Xv();(ht!==t||vt!==e)&&($n=null,ps(t,e));do try{bb();break}catch(s){Qv(t,s)}while(!0);if(Gh(),Se=n,Ql.current=r,tt!==null)throw Error(W(261));return ht=null,vt=0,lt}function bb(){for(;tt!==null;)Yv(tt)}function Tb(){for(;tt!==null&&!Q1();)Yv(tt)}function Yv(t){var e=ex(t.alternate,t,Yt);t.memoizedProps=t.pendingProps,e===null?Jv(t):tt=e,af.current=null}function Jv(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=yb(n,e),n!==null){n.flags&=32767,tt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{lt=6,tt=null;return}}else if(n=gb(n,e,Yt),n!==null){tt=n;return}if(e=e.sibling,e!==null){tt=e;return}tt=e=t}while(e!==null);lt===0&&(lt=5)}function ls(t,e,n){var r=Re,s=un.transition;try{un.transition=null,Re=1,Ib(t,e,n,r)}finally{un.transition=s,Re=r}return null}function Ib(t,e,n,r){do di();while(br!==null);if(Se&6)throw Error(W(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(W(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(iE(t,i),t===ht&&(tt=ht=null,vt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||el||(el=!0,tx(jl,function(){return di(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=un.transition,un.transition=null;var o=Re;Re=1;var u=Se;Se|=4,af.current=null,xb(t,n),Wv(n,t),HE(Id),Ol=!!Td,Id=Td=null,t.current=n,_b(n),X1(),Se=u,Re=o,un.transition=i}else t.current=n;if(el&&(el=!1,br=t,Yl=s),i=t.pendingLanes,i===0&&(Ar=null),Z1(n.stateNode),Kt(t,Je()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Xl)throw Xl=!1,t=Hd,Hd=null,t;return Yl&1&&t.tag!==0&&di(),i=t.pendingLanes,i&1?t===Wd?Io++:(Io=0,Wd=t):Io=0,es(),null}function di(){if(br!==null){var t=P0(Yl),e=un.transition,n=Re;try{if(un.transition=null,Re=16>t?16:t,br===null)var r=!1;else{if(t=br,br=null,Yl=0,Se&6)throw Error(W(331));var s=Se;for(Se|=4,re=t.current;re!==null;){var i=re,o=i.child;if(re.flags&16){var u=i.deletions;if(u!==null){for(var c=0;c<u.length;c++){var d=u[c];for(re=d;re!==null;){var f=re;switch(f.tag){case 0:case 11:case 15:bo(8,f,i)}var y=f.child;if(y!==null)y.return=f,re=y;else for(;re!==null;){f=re;var g=f.sibling,w=f.return;if($v(f),f===d){re=null;break}if(g!==null){g.return=w,re=g;break}re=w}}}var S=i.alternate;if(S!==null){var P=S.child;if(P!==null){S.child=null;do{var R=P.sibling;P.sibling=null,P=R}while(P!==null)}}re=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,re=o;else e:for(;re!==null;){if(i=re,i.flags&2048)switch(i.tag){case 0:case 11:case 15:bo(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,re=b;break e}re=i.return}}var x=t.current;for(re=x;re!==null;){o=re;var I=o.child;if(o.subtreeFlags&2064&&I!==null)I.return=o,re=I;else e:for(o=x;re!==null;){if(u=re,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Cu(9,u)}}catch(M){Xe(u,u.return,M)}if(u===o){re=null;break e}var j=u.sibling;if(j!==null){j.return=u.return,re=j;break e}re=u.return}}if(Se=s,es(),kn&&typeof kn.onPostCommitFiberRoot=="function")try{kn.onPostCommitFiberRoot(_u,t)}catch{}r=!0}return r}finally{Re=n,un.transition=e}}return!1}function cg(t,e,n){e=Ei(n,e),e=Rv(t,e,1),t=kr(t,e,1),e=Lt(),t!==null&&(aa(t,1,e),Kt(t,e))}function Xe(t,e,n){if(t.tag===3)cg(t,t,n);else for(;e!==null;){if(e.tag===3){cg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ar===null||!Ar.has(r))){t=Ei(n,t),t=jv(e,t,1),e=kr(e,t,1),t=Lt(),e!==null&&(aa(e,1,t),Kt(e,t));break}}e=e.return}}function Nb(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Lt(),t.pingedLanes|=t.suspendedLanes&n,ht===t&&(vt&n)===n&&(lt===4||lt===3&&(vt&130023424)===vt&&500>Je()-uf?ps(t,0):lf|=n),Kt(t,e)}function Zv(t,e){e===0&&(t.mode&1?(e=qa,qa<<=1,!(qa&130023424)&&(qa=4194304)):e=1);var n=Lt();t=Jn(t,e),t!==null&&(aa(t,e,n),Kt(t,n))}function Sb(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Zv(t,n)}function Cb(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(e),Zv(t,n)}var ex;ex=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Wt.current)Ht=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ht=!1,mb(t,e,n);Ht=!!(t.flags&131072)}else Ht=!1,$e&&e.flags&1048576&&rv(e,Bl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;gl(t,e),t=e.pendingProps;var s=vi(e,At.current);ci(e,n),s=tf(null,e,r,t,s,n);var i=nf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Gt(r)?(i=!0,Ul(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Xh(e),s.updater=Nu,e.stateNode=s,s._reactInternals=e,Dd(e,r,t,n),e=Vd(null,e,r,!0,i,n)):(e.tag=0,$e&&i&&$h(e),Ot(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(gl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=Ab(r),t=mn(r,t),s){case 0:e=Ld(null,e,r,t,n);break e;case 1:e=eg(null,e,r,t,n);break e;case 11:e=Jm(null,e,r,t,n);break e;case 14:e=Zm(null,e,r,mn(r.type,t),n);break e}throw Error(W(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mn(r,s),Ld(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mn(r,s),eg(t,e,r,s,n);case 3:e:{if(Vv(e),t===null)throw Error(W(387));r=e.pendingProps,i=e.memoizedState,s=i.element,av(t,e),Hl(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ei(Error(W(423)),e),e=tg(t,e,r,n,s);break e}else if(r!==s){s=Ei(Error(W(424)),e),e=tg(t,e,r,n,s);break e}else for(Jt=Cr(e.stateNode.containerInfo.firstChild),en=e,$e=!0,yn=null,n=dv(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(xi(),r===s){e=Zn(t,e,n);break e}Ot(t,e,r,n)}e=e.child}return e;case 5:return hv(e),t===null&&Pd(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Nd(r,s)?o=null:i!==null&&Nd(r,i)&&(e.flags|=32),Lv(t,e),Ot(t,e,o,n),e.child;case 6:return t===null&&Pd(e),null;case 13:return Mv(t,e,n);case 4:return Yh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=_i(e,null,r,n):Ot(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mn(r,s),Jm(t,e,r,s,n);case 7:return Ot(t,e,e.pendingProps,n),e.child;case 8:return Ot(t,e,e.pendingProps.children,n),e.child;case 12:return Ot(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Ve($l,r._currentValue),r._currentValue=o,i!==null)if(bn(i.value,o)){if(i.children===s.children&&!Wt.current){e=Zn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var u=i.dependencies;if(u!==null){o=i.child;for(var c=u.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Qn(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?c.next=c:(c.next=f.next,f.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Rd(i.return,n,e),u.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(W(341));o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),Rd(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ot(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ci(e,n),s=dn(s),r=r(s),e.flags|=1,Ot(t,e,r,n),e.child;case 14:return r=e.type,s=mn(r,e.pendingProps),s=mn(r.type,s),Zm(t,e,r,s,n);case 15:return Dv(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mn(r,s),gl(t,e),e.tag=1,Gt(r)?(t=!0,Ul(e)):t=!1,ci(e,n),uv(e,r,s),Dd(e,r,s,n),Vd(null,e,r,!0,t,n);case 19:return Fv(t,e,n);case 22:return Ov(t,e,n)}throw Error(W(156,e.tag))};function tx(t,e){return S0(t,e)}function kb(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ln(t,e,n,r){return new kb(t,e,n,r)}function ff(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ab(t){if(typeof t=="function")return ff(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ph)return 11;if(t===Rh)return 14}return 2}function Rr(t,e){var n=t.alternate;return n===null?(n=ln(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function xl(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")ff(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ks:return ms(n.children,s,i,e);case Ah:o=8,s|=8;break;case sd:return t=ln(12,n,e,s|2),t.elementType=sd,t.lanes=i,t;case id:return t=ln(13,n,e,s),t.elementType=id,t.lanes=i,t;case od:return t=ln(19,n,e,s),t.elementType=od,t.lanes=i,t;case c0:return Au(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case l0:o=10;break e;case u0:o=9;break e;case Ph:o=11;break e;case Rh:o=14;break e;case pr:o=16,r=null;break e}throw Error(W(130,t==null?t:typeof t,""))}return e=ln(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ms(t,e,n,r){return t=ln(7,t,r,e),t.lanes=n,t}function Au(t,e,n,r){return t=ln(22,t,r,e),t.elementType=c0,t.lanes=n,t.stateNode={isHidden:!1},t}function Bc(t,e,n){return t=ln(6,t,null,e),t.lanes=n,t}function $c(t,e,n){return e=ln(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Pb(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bc(0),this.expirationTimes=bc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function pf(t,e,n,r,s,i,o,u,c){return t=new Pb(t,e,n,u,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=ln(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xh(i),t}function Rb(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Gs,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function nx(t){if(!t)return Br;t=t._reactInternals;e:{if(Ps(t)!==t||t.tag!==1)throw Error(W(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Gt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(W(171))}if(t.tag===1){var n=t.type;if(Gt(n))return tv(t,n,e)}return e}function rx(t,e,n,r,s,i,o,u,c){return t=pf(n,r,!0,t,s,i,o,u,c),t.context=nx(null),n=t.current,r=Lt(),s=Pr(n),i=Qn(r,s),i.callback=e??null,kr(n,i,s),t.current.lanes=s,aa(t,s,r),Kt(t,r),t}function Pu(t,e,n,r){var s=e.current,i=Lt(),o=Pr(s);return n=nx(n),e.context===null?e.context=n:e.pendingContext=n,e=Qn(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=kr(s,e,o),t!==null&&(wn(t,s,o,i),fl(t,s,o)),o}function Zl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function dg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function mf(t,e){dg(t,e),(t=t.alternate)&&dg(t,e)}function jb(){return null}var sx=typeof reportError=="function"?reportError:function(t){console.error(t)};function gf(t){this._internalRoot=t}Ru.prototype.render=gf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(W(409));Pu(t,e,null,null)};Ru.prototype.unmount=gf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;bs(function(){Pu(null,t,null,null)}),e[Yn]=null}};function Ru(t){this._internalRoot=t}Ru.prototype.unstable_scheduleHydration=function(t){if(t){var e=D0();t={blockedOn:null,target:t,priority:e};for(var n=0;n<gr.length&&e!==0&&e<gr[n].priority;n++);gr.splice(n,0,t),n===0&&L0(t)}};function yf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ju(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function hg(){}function Db(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Zl(o);i.call(d)}}var o=rx(e,r,t,0,null,!1,!1,"",hg);return t._reactRootContainer=o,t[Yn]=o.current,Uo(t.nodeType===8?t.parentNode:t),bs(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var u=r;r=function(){var d=Zl(c);u.call(d)}}var c=pf(t,0,!1,null,null,!1,!1,"",hg);return t._reactRootContainer=c,t[Yn]=c.current,Uo(t.nodeType===8?t.parentNode:t),bs(function(){Pu(e,c,n,r)}),c}function Du(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var u=s;s=function(){var c=Zl(o);u.call(c)}}Pu(e,o,t,s)}else o=Db(n,e,t,s,r);return Zl(o)}R0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=co(e.pendingLanes);n!==0&&(Oh(e,n|1),Kt(e,Je()),!(Se&6)&&(bi=Je()+500,es()))}break;case 13:bs(function(){var r=Jn(t,1);if(r!==null){var s=Lt();wn(r,t,1,s)}}),mf(t,1)}};Lh=function(t){if(t.tag===13){var e=Jn(t,134217728);if(e!==null){var n=Lt();wn(e,t,134217728,n)}mf(t,134217728)}};j0=function(t){if(t.tag===13){var e=Pr(t),n=Jn(t,e);if(n!==null){var r=Lt();wn(n,t,e,r)}mf(t,e)}};D0=function(){return Re};O0=function(t,e){var n=Re;try{return Re=t,e()}finally{Re=n}};gd=function(t,e,n){switch(e){case"input":if(ud(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Tu(r);if(!s)throw Error(W(90));h0(r),ud(r,s)}}}break;case"textarea":p0(t,n);break;case"select":e=n.value,e!=null&&oi(t,!!n.multiple,e,!1)}};w0=cf;E0=bs;var Ob={usingClientEntryPoint:!1,Events:[ua,Js,Tu,x0,_0,cf]},ao={findFiberByHostInstance:cs,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Lb={bundleType:ao.bundleType,version:ao.version,rendererPackageName:ao.rendererPackageName,rendererConfig:ao.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ir.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=I0(t),t===null?null:t.stateNode},findFiberByHostInstance:ao.findFiberByHostInstance||jb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var tl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tl.isDisabled&&tl.supportsFiber)try{_u=tl.inject(Lb),kn=tl}catch{}}nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ob;nn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!yf(e))throw Error(W(200));return Rb(t,e,null,n)};nn.createRoot=function(t,e){if(!yf(t))throw Error(W(299));var n=!1,r="",s=sx;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=pf(t,1,!1,null,null,n,!1,r,s),t[Yn]=e.current,Uo(t.nodeType===8?t.parentNode:t),new gf(e)};nn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(W(188)):(t=Object.keys(t).join(","),Error(W(268,t)));return t=I0(e),t=t===null?null:t.stateNode,t};nn.flushSync=function(t){return bs(t)};nn.hydrate=function(t,e,n){if(!ju(e))throw Error(W(200));return Du(null,t,e,!0,n)};nn.hydrateRoot=function(t,e,n){if(!yf(t))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=sx;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=rx(e,null,t,1,n??null,s,!1,i,o),t[Yn]=e.current,Uo(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Ru(e)};nn.render=function(t,e,n){if(!ju(e))throw Error(W(200));return Du(null,t,e,!1,n)};nn.unmountComponentAtNode=function(t){if(!ju(t))throw Error(W(40));return t._reactRootContainer?(bs(function(){Du(null,null,t,!1,function(){t._reactRootContainer=null,t[Yn]=null})}),!0):!1};nn.unstable_batchedUpdates=cf;nn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ju(n))throw Error(W(200));if(t==null||t._reactInternals===void 0)throw Error(W(38));return Du(t,e,n,!1,r)};nn.version="18.2.0-next-9e3b772b8-20220608";function ix(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ix)}catch(t){console.error(t)}}ix(),r0.exports=nn;var Vb=r0.exports,ox,fg=Vb;ox=fg.createRoot,fg.hydrateRoot;/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mb=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Fb=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),pg=t=>{const e=Fb(t);return e.charAt(0).toUpperCase()+e.slice(1)},ax=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),Ub=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var zb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bb=B.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...u},c)=>B.createElement("svg",{ref:c,...zb,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:ax("lucide",s),...!i&&!Ub(u)&&{"aria-hidden":"true"},...u},[...o.map(([d,f])=>B.createElement(d,f)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=(t,e)=>{const n=B.forwardRef(({className:r,...s},i)=>B.createElement(Bb,{ref:i,iconNode:e,className:ax(`lucide-${Mb(pg(t))}`,`lucide-${t}`,r),...s}));return n.displayName=pg(t),n};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $b=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],qb=qe("box",$b);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hb=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Wb=qe("calendar",Hb);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gb=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Kb=qe("camera",Gb);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qb=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],Xb=qe("chart-pie",Qb);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yb=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],qc=qe("chevron-down",Yb);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jb=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Hc=qe("chevron-up",Jb);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zb=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],eT=qe("circle-alert",Zb);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tT=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],nT=qe("clipboard",tT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rT=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],sT=qe("crown",rT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iT=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],oT=qe("dollar-sign",iT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aT=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],lT=qe("image",aT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uT=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],hi=qe("package",uT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cT=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],lx=qe("pen",cT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dT=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],hT=qe("plus",dT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fT=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ux=qe("save",fT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pT=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],mT=qe("scissors",pT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gT=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],cx=qe("search",gT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yT=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],eu=qe("trash-2",yT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vT=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],xT=qe("trending-down",vT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _T=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Qd=qe("trending-up",_T);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wT=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],dx=qe("triangle-alert",wT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ET=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],bT=qe("truck",ET);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TT=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],hx=qe("users",TT);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IT=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],$r=qe("x",IT);function NT({inventoryItems:t=[],soldCounts:e={},onViewItem:n,onAddClick:r}){const[s,i]=B.useState(""),[o,u]=B.useState("all"),[c,d]=B.useState("name"),f=g=>g?Object.values(g).reduce((w,S)=>w+(parseInt(S)||0),0):0,y=B.useMemo(()=>{let g=[...t];if(s){const w=s.toLowerCase();g=g.filter(S=>S.name&&S.name.toLowerCase().includes(w)||S.websiteProductName&&S.websiteProductName.toLowerCase().includes(w)||S.location&&S.location.toLowerCase().includes(w))}return o==="fabrics"&&(g=g.filter(w=>w.type==="fabric")),o==="outfits"&&(g=g.filter(w=>w.type==="outfit")),o==="low"&&(g=g.filter(w=>w.type==="fabric"&&w.currentLength<5)),g.sort((w,S)=>{if(c==="name")return(w.name||"").localeCompare(S.name||"");if(c==="stock"){const P=w.type==="fabric"?w.currentLength:f(w.stockBreakdown);return(S.type==="fabric"?S.currentLength:f(S.stockBreakdown))-P}if(c==="potential"){const P=w.type==="fabric"&&w.potentialOutfits||0;return(S.type==="fabric"&&S.potentialOutfits||0)-P}return 0}),g},[t,s,o,c]);return l.jsxs("div",{className:"space-y-4 fade-in",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Inventory"}),r&&l.jsxs("button",{onClick:r,className:"text-sm bg-brand text-white px-4 py-2 rounded-full font-bold shadow-lg hover:bg-brand-dark flex items-center gap-1",children:[l.jsx(hT,{className:"w-4 h-4"})," Add Item"]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx("span",{className:"absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400",children:l.jsx(cx,{className:"w-5 h-5"})}),l.jsx("input",{className:"w-full pl-10 p-3 bg-white rounded-xl border-none shadow-sm text-sm",placeholder:"Search...",value:s,onChange:g=>i(g.target.value)})]}),l.jsxs("select",{className:"text-xs bg-white border border-gray-200 rounded-lg p-2 text-gray-600 outline-none shadow-sm",value:c,onChange:g=>d(g.target.value),children:[l.jsx("option",{value:"name",children:"Name (A-Z)"}),l.jsx("option",{value:"stock",children:"Stock Level (High)"}),l.jsx("option",{value:"potential",children:"Potential (High)"})]})]}),l.jsx("div",{className:"flex space-x-2 overflow-x-auto no-scrollbar pb-2",children:["all","fabrics","outfits","low"].map(g=>l.jsx("button",{onClick:()=>u(g),className:`px-4 py-2 rounded-xl text-xs font-bold whitespace-nowrap capitalize transition-colors ${o===g?"bg-gray-800 text-white shadow-md":"bg-white text-gray-500 border border-gray-100"}`,children:g},g))}),l.jsx("div",{className:"grid grid-cols-2 gap-4 p-2",children:y.map(g=>{if(g.type==="fabric"){const S=g.currentLength>0&&g.currentLength<5;return l.jsxs("div",{className:"relative aspect-[4/5] rounded-2xl overflow-hidden shadow-md bg-white cursor-pointer",onClick:()=>n&&n(g),children:[l.jsx("img",{src:g.imageUrl,className:"w-full h-full object-cover"}),l.jsxs("div",{className:"absolute bottom-0 w-full bg-gradient-to-t from-black/80 to-transparent p-3 pt-6",children:[l.jsx("h4",{className:"text-white font-bold text-sm truncate",children:g.name}),l.jsxs("p",{className:"text-xs text-gray-300",children:[(parseFloat(g.currentLength)||0).toFixed(1)," ",g.unit]})]}),S&&l.jsx("div",{className:"absolute top-2 right-2 bg-red-500 text-white text-[9px] font-bold px-2 py-0.5 rounded-full",children:"Low"})]},g.id)}else{const S=f(g.stockBreakdown),P=(e[g.name]||0)+(parseInt(g.manualSoldCount)||0);return l.jsxs("div",{className:"relative aspect-[4/5] rounded-2xl overflow-hidden shadow-md bg-white cursor-pointer",onClick:()=>n&&n(g),children:[l.jsx("img",{src:g.imageUrl,className:"w-full h-full object-cover"}),l.jsxs("div",{className:"absolute bottom-0 w-full bg-gradient-to-t from-black/80 to-transparent p-3 pt-6",children:[l.jsx("h4",{className:"text-white font-bold text-sm truncate",children:g.name}),l.jsxs("p",{className:"text-xs text-gray-300 font-bold",children:["Stock: ",S," ",l.jsxs("span",{className:"opacity-60 font-normal",children:["| Sold: ",P]})]})]})]},g.id)}})}),y.length===0&&l.jsx("div",{className:"text-center py-8 text-gray-500",children:s?`No items match "${s}"`:"No items in this category"})]})}const ST=()=>{};var mg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},CT=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],u=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},px={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,u=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,f=i>>2,y=(i&3)<<4|u>>4;let g=(u&15)<<2|d>>6,w=d&63;c||(w=64,o||(g=64)),r.push(n[f],n[y],n[g],n[w])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(fx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):CT(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],u=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const y=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||u==null||d==null||y==null)throw new kT;const g=i<<2|u>>4;if(r.push(g),d!==64){const w=u<<4&240|d>>2;if(r.push(w),y!==64){const S=d<<6&192|y;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class kT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const AT=function(t){const e=fx(t);return px.encodeByteArray(e,!0)},tu=function(t){return AT(t).replace(/\./g,"")},mx=function(t){try{return px.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RT=()=>PT().__FIREBASE_DEFAULTS__,jT=()=>{if(typeof process>"u"||typeof mg>"u")return;const t=mg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},DT=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&mx(t[1]);return e&&JSON.parse(e)},Ou=()=>{try{return ST()||RT()||jT()||DT()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},gx=t=>{var e,n;return(n=(e=Ou())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},OT=t=>{const e=gx(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},yx=()=>{var t;return(t=Ou())===null||t===void 0?void 0:t.config},vx=t=>{var e;return(e=Ou())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ji(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function xx(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[tu(JSON.stringify(n)),tu(JSON.stringify(o)),""].join(".")}const No={};function MT(){const t={prod:[],emulator:[]};for(const e of Object.keys(No))No[e]?t.emulator.push(e):t.prod.push(e);return t}function FT(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let gg=!1;function _x(t,e){if(typeof window>"u"||typeof document>"u"||!ji(window.location.host)||No[t]===e||No[t]||gg)return;No[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=MT().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function u(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,w){g.setAttribute("width","24"),g.setAttribute("id",w),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function d(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{gg=!0,o()},g}function f(g,w){g.setAttribute("id",w),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function y(){const g=FT(r),w=n("text"),S=document.getElementById(w)||document.createElement("span"),P=n("learnmore"),R=document.getElementById(P)||document.createElement("a"),b=n("preprendIcon"),x=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const I=g.element;u(I),f(R,P);const j=d();c(x,b),I.append(x,S,R,j),document.body.appendChild(I)}i?(S.innerText="Preview backend disconnected.",x.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(x.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function UT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Pt())}function zT(){var t;const e=(t=Ou())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function BT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function $T(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function qT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function HT(){const t=Pt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function WT(){return!zT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function GT(){try{return typeof indexedDB=="object"}catch{return!1}}function KT(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QT="FirebaseError";class or extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=QT,Object.setPrototypeOf(this,or.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,da.prototype.create)}}class da{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?XT(i,r):"Error",u=`${this.serviceName}: ${o} (${s}).`;return new or(s,u,r)}}function XT(t,e){return t.replace(YT,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const YT=/\{\$([^}]+)}/g;function JT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ts(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(yg(i)&&yg(o)){if(!Ts(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function yg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ha(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ZT(t,e){const n=new eI(t,e);return n.subscribe.bind(n)}class eI{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");tI(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Wc),s.error===void 0&&(s.error=Wc),s.complete===void 0&&(s.complete=Wc);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function tI(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Wc(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(t){return t&&t._delegate?t._delegate:t}class Is{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const us="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new LT;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(sI(e))try{this.getOrInitializeService({instanceIdentifier:us})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=us){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=us){return this.instances.has(e)}getOptions(e=us){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(i);r===u&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:rI(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=us){return this.component?this.component.multipleInstances?e:us:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function rI(t){return t===us?void 0:t}function sI(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new nI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var we;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(we||(we={}));const oI={debug:we.DEBUG,verbose:we.VERBOSE,info:we.INFO,warn:we.WARN,error:we.ERROR,silent:we.SILENT},aI=we.INFO,lI={[we.DEBUG]:"log",[we.VERBOSE]:"log",[we.INFO]:"info",[we.WARN]:"warn",[we.ERROR]:"error"},uI=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=lI[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class vf{constructor(e){this.name=e,this._logLevel=aI,this._logHandler=uI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in we))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?oI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,we.DEBUG,...e),this._logHandler(this,we.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,we.VERBOSE,...e),this._logHandler(this,we.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,we.INFO,...e),this._logHandler(this,we.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,we.WARN,...e),this._logHandler(this,we.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,we.ERROR,...e),this._logHandler(this,we.ERROR,...e)}}const cI=(t,e)=>e.some(n=>t instanceof n);let vg,xg;function dI(){return vg||(vg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function hI(){return xg||(xg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const wx=new WeakMap,Xd=new WeakMap,Ex=new WeakMap,Gc=new WeakMap,xf=new WeakMap;function fI(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(jr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&wx.set(n,t)}).catch(()=>{}),xf.set(e,t),e}function pI(t){if(Xd.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Xd.set(t,e)}let Yd={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Xd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Ex.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return jr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function mI(t){Yd=t(Yd)}function gI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Kc(this),e,...n);return Ex.set(r,e.sort?e.sort():[e]),jr(r)}:hI().includes(t)?function(...e){return t.apply(Kc(this),e),jr(wx.get(this))}:function(...e){return jr(t.apply(Kc(this),e))}}function yI(t){return typeof t=="function"?gI(t):(t instanceof IDBTransaction&&pI(t),cI(t,dI())?new Proxy(t,Yd):t)}function jr(t){if(t instanceof IDBRequest)return fI(t);if(Gc.has(t))return Gc.get(t);const e=yI(t);return e!==t&&(Gc.set(t,e),xf.set(e,t)),e}const Kc=t=>xf.get(t);function vI(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),u=jr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(jr(o.result),c.oldVersion,c.newVersion,jr(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),u.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const xI=["get","getKey","getAll","getAllKeys","count"],_I=["put","add","delete","clear"],Qc=new Map;function _g(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Qc.get(e))return Qc.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=_I.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||xI.includes(n)))return;const i=async function(o,...u){const c=this.transaction(o,s?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(u.shift())),(await Promise.all([d[n](...u),s&&c.done]))[0]};return Qc.set(e,i),i}mI(t=>({...t,get:(e,n,r)=>_g(e,n)||t.get(e,n,r),has:(e,n)=>!!_g(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(EI(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function EI(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Jd="@firebase/app",wg="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const er=new vf("@firebase/app"),bI="@firebase/app-compat",TI="@firebase/analytics-compat",II="@firebase/analytics",NI="@firebase/app-check-compat",SI="@firebase/app-check",CI="@firebase/auth",kI="@firebase/auth-compat",AI="@firebase/database",PI="@firebase/data-connect",RI="@firebase/database-compat",jI="@firebase/functions",DI="@firebase/functions-compat",OI="@firebase/installations",LI="@firebase/installations-compat",VI="@firebase/messaging",MI="@firebase/messaging-compat",FI="@firebase/performance",UI="@firebase/performance-compat",zI="@firebase/remote-config",BI="@firebase/remote-config-compat",$I="@firebase/storage",qI="@firebase/storage-compat",HI="@firebase/firestore",WI="@firebase/ai",GI="@firebase/firestore-compat",KI="firebase",QI="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zd="[DEFAULT]",XI={[Jd]:"fire-core",[bI]:"fire-core-compat",[II]:"fire-analytics",[TI]:"fire-analytics-compat",[SI]:"fire-app-check",[NI]:"fire-app-check-compat",[CI]:"fire-auth",[kI]:"fire-auth-compat",[AI]:"fire-rtdb",[PI]:"fire-data-connect",[RI]:"fire-rtdb-compat",[jI]:"fire-fn",[DI]:"fire-fn-compat",[OI]:"fire-iid",[LI]:"fire-iid-compat",[VI]:"fire-fcm",[MI]:"fire-fcm-compat",[FI]:"fire-perf",[UI]:"fire-perf-compat",[zI]:"fire-rc",[BI]:"fire-rc-compat",[$I]:"fire-gcs",[qI]:"fire-gcs-compat",[HI]:"fire-fst",[GI]:"fire-fst-compat",[WI]:"fire-vertex","fire-js":"fire-js",[KI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nu=new Map,YI=new Map,eh=new Map;function Eg(t,e){try{t.container.addComponent(e)}catch(n){er.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ti(t){const e=t.name;if(eh.has(e))return er.debug(`There were multiple attempts to register component ${e}.`),!1;eh.set(e,t);for(const n of nu.values())Eg(n,t);for(const n of YI.values())Eg(n,t);return!0}function _f(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function vn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Dr=new da("app","Firebase",JI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Is("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Dr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Di=QI;function bx(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Zd,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw Dr.create("bad-app-name",{appName:String(s)});if(n||(n=yx()),!n)throw Dr.create("no-options");const i=nu.get(s);if(i){if(Ts(n,i.options)&&Ts(r,i.config))return i;throw Dr.create("duplicate-app",{appName:s})}const o=new iI(s);for(const c of eh.values())o.addComponent(c);const u=new ZI(n,r,o);return nu.set(s,u),u}function Tx(t=Zd){const e=nu.get(t);if(!e&&t===Zd&&yx())return bx();if(!e)throw Dr.create("no-app",{appName:t});return e}function Or(t,e,n){var r;let s=(r=XI[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const u=[`Unable to register library "${s}" with version "${e}":`];i&&u.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&u.push("and"),o&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),er.warn(u.join(" "));return}Ti(new Is(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eN="firebase-heartbeat-database",tN=1,Qo="firebase-heartbeat-store";let Xc=null;function Ix(){return Xc||(Xc=vI(eN,tN,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Qo)}catch(n){console.warn(n)}}}}).catch(t=>{throw Dr.create("idb-open",{originalErrorMessage:t.message})})),Xc}async function nN(t){try{const n=(await Ix()).transaction(Qo),r=await n.objectStore(Qo).get(Nx(t));return await n.done,r}catch(e){if(e instanceof or)er.warn(e.message);else{const n=Dr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});er.warn(n.message)}}}async function bg(t,e){try{const r=(await Ix()).transaction(Qo,"readwrite");await r.objectStore(Qo).put(e,Nx(t)),await r.done}catch(n){if(n instanceof or)er.warn(n.message);else{const r=Dr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});er.warn(r.message)}}}function Nx(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rN=1024,sN=30;class iN{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new aN(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Tg();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>sN){const o=lN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){er.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Tg(),{heartbeatsToSend:r,unsentEntries:s}=oN(this._heartbeatsCache.heartbeats),i=tu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return er.warn(n),""}}}function Tg(){return new Date().toISOString().substring(0,10)}function oN(t,e=rN){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Ig(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ig(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class aN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return GT()?KT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await nN(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return bg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return bg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Ig(t){return tu(JSON.stringify({version:2,heartbeats:t})).length}function lN(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(t){Ti(new Is("platform-logger",e=>new wI(e),"PRIVATE")),Ti(new Is("heartbeat",e=>new iN(e),"PRIVATE")),Or(Jd,wg,t),Or(Jd,wg,"esm2017"),Or("fire-js","")}uN("");var cN="firebase",dN="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Or(cN,dN,"app");function wf(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Sx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const hN=Sx,Cx=new da("auth","Firebase",Sx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ru=new vf("@firebase/auth");function fN(t,...e){ru.logLevel<=we.WARN&&ru.warn(`Auth (${Di}): ${t}`,...e)}function _l(t,...e){ru.logLevel<=we.ERROR&&ru.error(`Auth (${Di}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(t,...e){throw Ef(t,...e)}function Pn(t,...e){return Ef(t,...e)}function kx(t,e,n){const r=Object.assign(Object.assign({},hN()),{[e]:n});return new da("auth","Firebase",r).create(e,{appName:t.name})}function Lr(t){return kx(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ef(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Cx.create(t,...e)}function de(t,e,...n){if(!t)throw Ef(e,...n)}function Gn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw _l(e),new Error(e)}function nr(t,e){t||Gn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function th(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function pN(){return Ng()==="http:"||Ng()==="https:"}function Ng(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(pN()||$T()||"connection"in navigator)?navigator.onLine:!0}function gN(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e,n){this.shortDelay=e,this.longDelay=n,nr(n>e,"Short delay should be less than long delay!"),this.isMobile=UT()||qT()}get(){return mN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bf(t,e){nr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],xN=new fa(3e4,6e4);function Lu(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Oi(t,e,n,r,s={}){return Px(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const u=ha(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:c},i);return BT()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&ji(t.emulatorConfig.host)&&(d.credentials="include"),Ax.fetch()(await jx(t,t.config.apiHost,n,u),d)})}async function Px(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},yN),e);try{const s=new _N(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw nl(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const u=i.ok?o.errorMessage:o.error.message,[c,d]=u.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw nl(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw nl(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw nl(t,"user-disabled",o);const f=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw kx(t,f,d);tr(t,f)}}catch(s){if(s instanceof or)throw s;tr(t,"network-request-failed",{message:String(s)})}}async function Rx(t,e,n,r,s={}){const i=await Oi(t,e,n,r,s);return"mfaPendingCredential"in i&&tr(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function jx(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?bf(t.config,s):`${t.config.apiScheme}://${s}`;return vN.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class _N{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Pn(this.auth,"network-request-failed")),xN.get())})}}function nl(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Pn(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wN(t,e){return Oi(t,"POST","/v1/accounts:delete",e)}async function su(t,e){return Oi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function So(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function EN(t,e=!1){const n=Rt(t),r=await n.getIdToken(e),s=Tf(r);de(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:So(Yc(s.auth_time)),issuedAtTime:So(Yc(s.iat)),expirationTime:So(Yc(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Yc(t){return Number(t)*1e3}function Tf(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return _l("JWT malformed, contained fewer than 3 sections"),null;try{const s=mx(n);return s?JSON.parse(s):(_l("Failed to decode base64 JWT payload"),null)}catch(s){return _l("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Sg(t){const e=Tf(t);return de(e,"internal-error"),de(typeof e.exp<"u","internal-error"),de(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xo(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof or&&bN(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function bN({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=So(this.lastLoginAt),this.creationTime=So(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iu(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Xo(t,su(n,{idToken:r}));de(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Dx(i.providerUserInfo):[],u=NN(t.providerData,o),c=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(u!=null&&u.length),f=c?d:!1,y={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:u,metadata:new nh(i.createdAt,i.lastLoginAt),isAnonymous:f};Object.assign(t,y)}async function IN(t){const e=Rt(t);await iu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function NN(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Dx(t){return t.map(e=>{var{providerId:n}=e,r=wf(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SN(t,e){const n=await Px(t,{},async()=>{const r=ha({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await jx(t,s,"/v1/token",`key=${i}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:u,body:r};return t.emulatorConfig&&ji(t.emulatorConfig.host)&&(c.credentials="include"),Ax.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function CN(t,e){return Oi(t,"POST","/v2/accounts:revokeToken",Lu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){de(e.idToken,"internal-error"),de(typeof e.idToken<"u","internal-error"),de(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Sg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){de(e.length!==0,"internal-error");const n=Sg(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(de(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await SN(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new fi;return r&&(de(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(de(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(de(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fi,this.toJSON())}_performRefresh(){return Gn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fr(t,e){de(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class xn{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=wf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new TN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new nh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Xo(this,this.stsTokenManager.getToken(this.auth,e));return de(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return EN(this,e)}reload(){return IN(this)}_assign(e){this!==e&&(de(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new xn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){de(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await iu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(vn(this.auth.app))return Promise.reject(Lr(this.auth));const e=await this.getIdToken();return await Xo(this,wN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,u,c,d,f;const y=(r=n.displayName)!==null&&r!==void 0?r:void 0,g=(s=n.email)!==null&&s!==void 0?s:void 0,w=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,S=(o=n.photoURL)!==null&&o!==void 0?o:void 0,P=(u=n.tenantId)!==null&&u!==void 0?u:void 0,R=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,b=(d=n.createdAt)!==null&&d!==void 0?d:void 0,x=(f=n.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:I,emailVerified:j,isAnonymous:M,providerData:V,stsTokenManager:T}=n;de(I&&T,e,"internal-error");const p=fi.fromJSON(this.name,T);de(typeof I=="string",e,"internal-error"),fr(y,e.name),fr(g,e.name),de(typeof j=="boolean",e,"internal-error"),de(typeof M=="boolean",e,"internal-error"),fr(w,e.name),fr(S,e.name),fr(P,e.name),fr(R,e.name),fr(b,e.name),fr(x,e.name);const v=new xn({uid:I,auth:e,email:g,emailVerified:j,displayName:y,isAnonymous:M,photoURL:S,phoneNumber:w,tenantId:P,stsTokenManager:p,createdAt:b,lastLoginAt:x});return V&&Array.isArray(V)&&(v.providerData=V.map(_=>Object.assign({},_))),R&&(v._redirectEventId=R),v}static async _fromIdTokenResponse(e,n,r=!1){const s=new fi;s.updateFromServerResponse(n);const i=new xn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await iu(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];de(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Dx(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),u=new fi;u.updateFromIdToken(r);const c=new xn({uid:s.localId,auth:e,stsTokenManager:u,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new nh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cg=new Map;function Kn(t){nr(t instanceof Function,"Expected a class definition");let e=Cg.get(t);return e?(nr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Cg.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Ox.type="NONE";const kg=Ox;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wl(t,e,n){return`firebase:${t}:${e}:${n}`}class pi{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=wl(this.userKey,s.apiKey,i),this.fullPersistenceKey=wl("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await su(this.auth,{idToken:e}).catch(()=>{});return n?xn._fromGetAccountInfoResponse(this.auth,n,e):null}return xn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new pi(Kn(kg),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Kn(kg);const o=wl(r,e.config.apiKey,e.name);let u=null;for(const d of n)try{const f=await d._get(o);if(f){let y;if(typeof f=="string"){const g=await su(e,{idToken:f}).catch(()=>{});if(!g)break;y=await xn._fromGetAccountInfoResponse(e,g,f)}else y=xn._fromJSON(e,f);d!==i&&(u=y),i=d;break}}catch{}const c=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new pi(i,e,r):(i=c[0],u&&await i._set(o,u.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new pi(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ag(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Fx(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Lx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(zx(e))return"Blackberry";if(Bx(e))return"Webos";if(Vx(e))return"Safari";if((e.includes("chrome/")||Mx(e))&&!e.includes("edge/"))return"Chrome";if(Ux(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Lx(t=Pt()){return/firefox\//i.test(t)}function Vx(t=Pt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Mx(t=Pt()){return/crios\//i.test(t)}function Fx(t=Pt()){return/iemobile/i.test(t)}function Ux(t=Pt()){return/android/i.test(t)}function zx(t=Pt()){return/blackberry/i.test(t)}function Bx(t=Pt()){return/webos/i.test(t)}function If(t=Pt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function kN(t=Pt()){var e;return If(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function AN(){return HT()&&document.documentMode===10}function $x(t=Pt()){return If(t)||Ux(t)||Bx(t)||zx(t)||/windows phone/i.test(t)||Fx(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qx(t,e=[]){let n;switch(t){case"Browser":n=Ag(Pt());break;case"Worker":n=`${Ag(Pt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Di}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,u)=>{try{const c=e(i);o(c)}catch(c){u(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RN(t,e={}){return Oi(t,"GET","/v2/passwordPolicy",Lu(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jN=6;class DN{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:jN,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,u;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(u=c.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Pg(this),this.idTokenSubscription=new Pg(this),this.beforeStateQueue=new PN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Cx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Kn(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await pi.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await su(this,{idToken:e}),r=await xn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(vn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(u,u))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,u=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===u)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return de(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await iu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=gN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(vn(this.app))return Promise.reject(Lr(this));const n=e?Rt(e):null;return n&&de(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&de(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return vn(this.app)?Promise.reject(Lr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return vn(this.app)?Promise.reject(Lr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Kn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await RN(this),n=new DN(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new da("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await CN(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Kn(e)||this._popupRedirectResolver;de(n,this,"argument-error"),this.redirectPersistenceManager=await pi.create(this,[Kn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(de(u,this,"internal-error"),u.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return de(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=qx(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;if(vn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&fN(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Vu(t){return Rt(t)}class Pg{constructor(e){this.auth=e,this.observer=null,this.addObserver=ZT(n=>this.observer=n)}get next(){return de(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function LN(t){Nf=t}function VN(t){return Nf.loadJS(t)}function MN(){return Nf.gapiScript}function FN(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UN(t,e){const n=_f(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Ts(i,e??{}))return s;tr(s,"already-initialized")}return n.initialize({options:e})}function zN(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Kn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function BN(t,e,n){const r=Vu(t);de(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Hx(e),{host:o,port:u}=$N(e),c=u===null?"":`:${u}`,d={url:`${i}//${o}${c}/`},f=Object.freeze({host:o,port:u,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){de(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),de(Ts(d,r.config.emulator)&&Ts(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,ji(o)?(xx(`${i}//${o}${c}`),_x("Auth",!0)):qN()}function Hx(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function $N(t){const e=Hx(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Rg(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Rg(o)}}}function Rg(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function qN(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Gn("not implemented")}_getIdTokenResponse(e){return Gn("not implemented")}_linkToIdToken(e,n){return Gn("not implemented")}_getReauthenticationResolver(e){return Gn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mi(t,e){return Rx(t,"POST","/v1/accounts:signInWithIdp",Lu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HN="http://localhost";class Ns extends Wx{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ns(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):tr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=wf(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Ns(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return mi(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,mi(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,mi(e,n)}buildRequest(){const e={requestUri:HN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ha(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa extends Gx{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr extends pa{constructor(){super("facebook.com")}static credential(e){return Ns._fromParams({providerId:vr.PROVIDER_ID,signInMethod:vr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vr.credentialFromTaggedObject(e)}static credentialFromError(e){return vr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vr.credential(e.oauthAccessToken)}catch{return null}}}vr.FACEBOOK_SIGN_IN_METHOD="facebook.com";vr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr extends pa{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ns._fromParams({providerId:xr.PROVIDER_ID,signInMethod:xr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return xr.credentialFromTaggedObject(e)}static credentialFromError(e){return xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return xr.credential(n,r)}catch{return null}}}xr.GOOGLE_SIGN_IN_METHOD="google.com";xr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r extends pa{constructor(){super("github.com")}static credential(e){return Ns._fromParams({providerId:_r.PROVIDER_ID,signInMethod:_r.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _r.credentialFromTaggedObject(e)}static credentialFromError(e){return _r.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _r.credential(e.oauthAccessToken)}catch{return null}}}_r.GITHUB_SIGN_IN_METHOD="github.com";_r.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr extends pa{constructor(){super("twitter.com")}static credential(e,n){return Ns._fromParams({providerId:wr.PROVIDER_ID,signInMethod:wr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return wr.credentialFromTaggedObject(e)}static credentialFromError(e){return wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return wr.credential(n,r)}catch{return null}}}wr.TWITTER_SIGN_IN_METHOD="twitter.com";wr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WN(t,e){return Rx(t,"POST","/v1/accounts:signUp",Lu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await xn._fromIdTokenResponse(e,r,s),o=jg(r);return new qr({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=jg(r);return new qr({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function jg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GN(t){var e;if(vn(t.app))return Promise.reject(Lr(t));const n=Vu(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new qr({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await WN(n,{returnSecureToken:!0}),s=await qr._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou extends or{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,ou.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new ou(e,n,r,s)}}function Kx(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?ou._fromErrorAndOperation(t,i,e,r):i})}async function KN(t,e,n=!1){const r=await Xo(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return qr._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QN(t,e,n=!1){const{auth:r}=t;if(vn(r.app))return Promise.reject(Lr(r));const s="reauthenticate";try{const i=await Xo(t,Kx(r,s,e,t),n);de(i.idToken,r,"internal-error");const o=Tf(i.idToken);de(o,r,"internal-error");const{sub:u}=o;return de(t.uid===u,r,"user-mismatch"),qr._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&tr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XN(t,e,n=!1){if(vn(t.app))return Promise.reject(Lr(t));const r="signIn",s=await Kx(t,r,e),i=await qr._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function YN(t,e,n,r){return Rt(t).onIdTokenChanged(e,n,r)}function JN(t,e,n){return Rt(t).beforeAuthStateChanged(e,n)}const au="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(au,"1"),this.storage.removeItem(au),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN=1e3,eS=10;class Xx extends Qx{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=$x(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,u,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);AN()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,eS):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},ZN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Xx.type="LOCAL";const tS=Xx;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yx extends Qx{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Yx.type="SESSION";const Jx=Yx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nS(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Mu(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const u=Array.from(o).map(async d=>d(n.origin,i)),c=await nS(u);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Mu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sf(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((u,c)=>{const d=Sf("",20);s.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(y){const g=y;if(g.data.eventId===d)switch(g.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),u(g.data.response);break;default:clearTimeout(f),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rn(){return window}function sS(t){Rn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zx(){return typeof Rn().WorkerGlobalScope<"u"&&typeof Rn().importScripts=="function"}async function iS(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function oS(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function aS(){return Zx()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_="firebaseLocalStorageDb",lS=1,lu="firebaseLocalStorage",t_="fbase_key";class ma{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Fu(t,e){return t.transaction([lu],e?"readwrite":"readonly").objectStore(lu)}function uS(){const t=indexedDB.deleteDatabase(e_);return new ma(t).toPromise()}function rh(){const t=indexedDB.open(e_,lS);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(lu,{keyPath:t_})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(lu)?e(r):(r.close(),await uS(),e(await rh()))})})}async function Dg(t,e,n){const r=Fu(t,!0).put({[t_]:e,value:n});return new ma(r).toPromise()}async function cS(t,e){const n=Fu(t,!1).get(e),r=await new ma(n).toPromise();return r===void 0?null:r.value}function Og(t,e){const n=Fu(t,!0).delete(e);return new ma(n).toPromise()}const dS=800,hS=3;class n_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await rh(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>hS)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Zx()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Mu._getInstance(aS()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await iS(),!this.activeServiceWorker)return;this.sender=new rS(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||oS()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await rh();return await Dg(e,au,"1"),await Og(e,au),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Dg(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>cS(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Og(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Fu(s,!1).getAll();return new ma(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),dS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}n_.type="LOCAL";const fS=n_;new fa(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pS(t,e){return e?Kn(e):(de(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf extends Wx{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return mi(e,this._buildIdpRequest())}_linkToIdToken(e,n){return mi(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return mi(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function mS(t){return XN(t.auth,new Cf(t),t.bypassAuthState)}function gS(t){const{auth:e,user:n}=t;return de(n,e,"internal-error"),QN(n,new Cf(t),t.bypassAuthState)}async function yS(t){const{auth:e,user:n}=t;return de(n,e,"internal-error"),KN(n,new Cf(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:u}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return mS;case"linkViaPopup":case"linkViaRedirect":return yS;case"reauthViaPopup":case"reauthViaRedirect":return gS;default:tr(this.auth,"internal-error")}}resolve(e){nr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){nr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vS=new fa(2e3,1e4);class ii extends r_{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ii.currentPopupAction&&ii.currentPopupAction.cancel(),ii.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return de(e,this.auth,"internal-error"),e}async onExecution(){nr(this.filter.length===1,"Popup operations only handle one event");const e=Sf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Pn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Pn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ii.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Pn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,vS.get())};e()}}ii.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xS="pendingRedirect",El=new Map;class _S extends r_{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=El.get(this.auth._key());if(!e){try{const r=await wS(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}El.set(this.auth._key(),e)}return this.bypassAuthState||El.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function wS(t,e){const n=TS(e),r=bS(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function ES(t,e){El.set(t._key(),e)}function bS(t){return Kn(t._redirectPersistence)}function TS(t){return wl(xS,t.config.apiKey,t.name)}async function IS(t,e,n=!1){if(vn(t.app))return Promise.reject(Lr(t));const r=Vu(t),s=pS(r,e),o=await new _S(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS=10*60*1e3;class SS{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!CS(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!s_(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Pn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=NS&&this.cachedEventUids.clear(),this.cachedEventUids.has(Lg(e))}saveEventToCache(e){this.cachedEventUids.add(Lg(e)),this.lastProcessedEventTime=Date.now()}}function Lg(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function s_({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function CS(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return s_(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kS(t,e={}){return Oi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,PS=/^https?/;async function RS(t){if(t.config.emulator)return;const{authorizedDomains:e}=await kS(t);for(const n of e)try{if(jS(n))return}catch{}tr(t,"unauthorized-domain")}function jS(t){const e=th(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!PS.test(n))return!1;if(AS.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DS=new fa(3e4,6e4);function Vg(){const t=Rn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function OS(t){return new Promise((e,n)=>{var r,s,i;function o(){Vg(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Vg(),n(Pn(t,"network-request-failed"))},timeout:DS.get()})}if(!((s=(r=Rn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Rn().gapi)===null||i===void 0)&&i.load)o();else{const u=FN("iframefcb");return Rn()[u]=()=>{gapi.load?o():n(Pn(t,"network-request-failed"))},VN(`${MN()}?onload=${u}`).catch(c=>n(c))}}).catch(e=>{throw bl=null,e})}let bl=null;function LS(t){return bl=bl||OS(t),bl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VS=new fa(5e3,15e3),MS="__/auth/iframe",FS="emulator/auth/iframe",US={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},zS=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function BS(t){const e=t.config;de(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?bf(e,FS):`https://${t.config.authDomain}/${MS}`,r={apiKey:e.apiKey,appName:t.name,v:Di},s=zS.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${ha(r).slice(1)}`}async function $S(t){const e=await LS(t),n=Rn().gapi;return de(n,t,"internal-error"),e.open({where:document.body,url:BS(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:US,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Pn(t,"network-request-failed"),u=Rn().setTimeout(()=>{i(o)},VS.get());function c(){Rn().clearTimeout(u),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},HS=500,WS=600,GS="_blank",KS="http://localhost";class Mg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function QS(t,e,n,r=HS,s=WS){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let u="";const c=Object.assign(Object.assign({},qS),{width:r.toString(),height:s.toString(),top:i,left:o}),d=Pt().toLowerCase();n&&(u=Mx(d)?GS:n),Lx(d)&&(e=e||KS,c.scrollbars="yes");const f=Object.entries(c).reduce((g,[w,S])=>`${g}${w}=${S},`,"");if(kN(d)&&u!=="_self")return XS(e||"",u),new Mg(null);const y=window.open(e||"",u,f);de(y,t,"popup-blocked");try{y.focus()}catch{}return new Mg(y)}function XS(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YS="__/auth/handler",JS="emulator/auth/handler",ZS=encodeURIComponent("fac");async function Fg(t,e,n,r,s,i){de(t.config.authDomain,t,"auth-domain-config-required"),de(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Di,eventId:s};if(e instanceof Gx){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",JT(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,y]of Object.entries({}))o[f]=y}if(e instanceof pa){const f=e.getScopes().filter(y=>y!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const u=o;for(const f of Object.keys(u))u[f]===void 0&&delete u[f];const c=await t._getAppCheckToken(),d=c?`#${ZS}=${encodeURIComponent(c)}`:"";return`${eC(t)}?${ha(u).slice(1)}${d}`}function eC({config:t}){return t.emulator?bf(t,JS):`https://${t.authDomain}/${YS}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jc="webStorageSupport";class tC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Jx,this._completeRedirectFn=IS,this._overrideRedirectResult=ES}async _openPopup(e,n,r,s){var i;nr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await Fg(e,n,r,th(),s);return QS(e,o,Sf())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Fg(e,n,r,th(),s);return sS(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(nr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await $S(e),r=new SS(e);return n.register("authEvent",s=>(de(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Jc,{type:Jc},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Jc];o!==void 0&&n(!!o),tr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=RS(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return $x()||Vx()||If()}}const nC=tC;var Ug="@firebase/auth",zg="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){de(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sC(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function iC(t){Ti(new Is("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:u}=r.options;de(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qx(t)},d=new ON(r,s,i,c);return zN(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ti(new Is("auth-internal",e=>{const n=Vu(e.getProvider("auth").getImmediate());return(r=>new rC(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Or(Ug,zg,sC(t)),Or(Ug,zg,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oC=5*60,aC=vx("authIdTokenMaxAge")||oC;let Bg=null;const lC=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>aC)return;const s=n==null?void 0:n.token;Bg!==s&&(Bg=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function uC(t=Tx()){const e=_f(t,"auth");if(e.isInitialized())return e.getImmediate();const n=UN(t,{popupRedirectResolver:nC,persistence:[fS,tS,Jx]}),r=vx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=lC(i.toString());JN(n,o,()=>o(n.currentUser)),YN(n,u=>o(u))}}const s=gx("auth");return s&&BN(n,`http://${s}`),n}function cC(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}LN({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Pn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",cC().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});iC("Browser");var $g=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vr,i_;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,p){function v(){}v.prototype=p.prototype,T.D=p.prototype,T.prototype=new v,T.prototype.constructor=T,T.C=function(_,C,A){for(var N=Array(arguments.length-2),me=2;me<arguments.length;me++)N[me-2]=arguments[me];return p.prototype[C].apply(_,N)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,p,v){v||(v=0);var _=Array(16);if(typeof p=="string")for(var C=0;16>C;++C)_[C]=p.charCodeAt(v++)|p.charCodeAt(v++)<<8|p.charCodeAt(v++)<<16|p.charCodeAt(v++)<<24;else for(C=0;16>C;++C)_[C]=p[v++]|p[v++]<<8|p[v++]<<16|p[v++]<<24;p=T.g[0],v=T.g[1],C=T.g[2];var A=T.g[3],N=p+(A^v&(C^A))+_[0]+3614090360&4294967295;p=v+(N<<7&4294967295|N>>>25),N=A+(C^p&(v^C))+_[1]+3905402710&4294967295,A=p+(N<<12&4294967295|N>>>20),N=C+(v^A&(p^v))+_[2]+606105819&4294967295,C=A+(N<<17&4294967295|N>>>15),N=v+(p^C&(A^p))+_[3]+3250441966&4294967295,v=C+(N<<22&4294967295|N>>>10),N=p+(A^v&(C^A))+_[4]+4118548399&4294967295,p=v+(N<<7&4294967295|N>>>25),N=A+(C^p&(v^C))+_[5]+1200080426&4294967295,A=p+(N<<12&4294967295|N>>>20),N=C+(v^A&(p^v))+_[6]+2821735955&4294967295,C=A+(N<<17&4294967295|N>>>15),N=v+(p^C&(A^p))+_[7]+4249261313&4294967295,v=C+(N<<22&4294967295|N>>>10),N=p+(A^v&(C^A))+_[8]+1770035416&4294967295,p=v+(N<<7&4294967295|N>>>25),N=A+(C^p&(v^C))+_[9]+2336552879&4294967295,A=p+(N<<12&4294967295|N>>>20),N=C+(v^A&(p^v))+_[10]+4294925233&4294967295,C=A+(N<<17&4294967295|N>>>15),N=v+(p^C&(A^p))+_[11]+2304563134&4294967295,v=C+(N<<22&4294967295|N>>>10),N=p+(A^v&(C^A))+_[12]+1804603682&4294967295,p=v+(N<<7&4294967295|N>>>25),N=A+(C^p&(v^C))+_[13]+4254626195&4294967295,A=p+(N<<12&4294967295|N>>>20),N=C+(v^A&(p^v))+_[14]+2792965006&4294967295,C=A+(N<<17&4294967295|N>>>15),N=v+(p^C&(A^p))+_[15]+1236535329&4294967295,v=C+(N<<22&4294967295|N>>>10),N=p+(C^A&(v^C))+_[1]+4129170786&4294967295,p=v+(N<<5&4294967295|N>>>27),N=A+(v^C&(p^v))+_[6]+3225465664&4294967295,A=p+(N<<9&4294967295|N>>>23),N=C+(p^v&(A^p))+_[11]+643717713&4294967295,C=A+(N<<14&4294967295|N>>>18),N=v+(A^p&(C^A))+_[0]+3921069994&4294967295,v=C+(N<<20&4294967295|N>>>12),N=p+(C^A&(v^C))+_[5]+3593408605&4294967295,p=v+(N<<5&4294967295|N>>>27),N=A+(v^C&(p^v))+_[10]+38016083&4294967295,A=p+(N<<9&4294967295|N>>>23),N=C+(p^v&(A^p))+_[15]+3634488961&4294967295,C=A+(N<<14&4294967295|N>>>18),N=v+(A^p&(C^A))+_[4]+3889429448&4294967295,v=C+(N<<20&4294967295|N>>>12),N=p+(C^A&(v^C))+_[9]+568446438&4294967295,p=v+(N<<5&4294967295|N>>>27),N=A+(v^C&(p^v))+_[14]+3275163606&4294967295,A=p+(N<<9&4294967295|N>>>23),N=C+(p^v&(A^p))+_[3]+4107603335&4294967295,C=A+(N<<14&4294967295|N>>>18),N=v+(A^p&(C^A))+_[8]+1163531501&4294967295,v=C+(N<<20&4294967295|N>>>12),N=p+(C^A&(v^C))+_[13]+2850285829&4294967295,p=v+(N<<5&4294967295|N>>>27),N=A+(v^C&(p^v))+_[2]+4243563512&4294967295,A=p+(N<<9&4294967295|N>>>23),N=C+(p^v&(A^p))+_[7]+1735328473&4294967295,C=A+(N<<14&4294967295|N>>>18),N=v+(A^p&(C^A))+_[12]+2368359562&4294967295,v=C+(N<<20&4294967295|N>>>12),N=p+(v^C^A)+_[5]+4294588738&4294967295,p=v+(N<<4&4294967295|N>>>28),N=A+(p^v^C)+_[8]+2272392833&4294967295,A=p+(N<<11&4294967295|N>>>21),N=C+(A^p^v)+_[11]+1839030562&4294967295,C=A+(N<<16&4294967295|N>>>16),N=v+(C^A^p)+_[14]+4259657740&4294967295,v=C+(N<<23&4294967295|N>>>9),N=p+(v^C^A)+_[1]+2763975236&4294967295,p=v+(N<<4&4294967295|N>>>28),N=A+(p^v^C)+_[4]+1272893353&4294967295,A=p+(N<<11&4294967295|N>>>21),N=C+(A^p^v)+_[7]+4139469664&4294967295,C=A+(N<<16&4294967295|N>>>16),N=v+(C^A^p)+_[10]+3200236656&4294967295,v=C+(N<<23&4294967295|N>>>9),N=p+(v^C^A)+_[13]+681279174&4294967295,p=v+(N<<4&4294967295|N>>>28),N=A+(p^v^C)+_[0]+3936430074&4294967295,A=p+(N<<11&4294967295|N>>>21),N=C+(A^p^v)+_[3]+3572445317&4294967295,C=A+(N<<16&4294967295|N>>>16),N=v+(C^A^p)+_[6]+76029189&4294967295,v=C+(N<<23&4294967295|N>>>9),N=p+(v^C^A)+_[9]+3654602809&4294967295,p=v+(N<<4&4294967295|N>>>28),N=A+(p^v^C)+_[12]+3873151461&4294967295,A=p+(N<<11&4294967295|N>>>21),N=C+(A^p^v)+_[15]+530742520&4294967295,C=A+(N<<16&4294967295|N>>>16),N=v+(C^A^p)+_[2]+3299628645&4294967295,v=C+(N<<23&4294967295|N>>>9),N=p+(C^(v|~A))+_[0]+4096336452&4294967295,p=v+(N<<6&4294967295|N>>>26),N=A+(v^(p|~C))+_[7]+1126891415&4294967295,A=p+(N<<10&4294967295|N>>>22),N=C+(p^(A|~v))+_[14]+2878612391&4294967295,C=A+(N<<15&4294967295|N>>>17),N=v+(A^(C|~p))+_[5]+4237533241&4294967295,v=C+(N<<21&4294967295|N>>>11),N=p+(C^(v|~A))+_[12]+1700485571&4294967295,p=v+(N<<6&4294967295|N>>>26),N=A+(v^(p|~C))+_[3]+2399980690&4294967295,A=p+(N<<10&4294967295|N>>>22),N=C+(p^(A|~v))+_[10]+4293915773&4294967295,C=A+(N<<15&4294967295|N>>>17),N=v+(A^(C|~p))+_[1]+2240044497&4294967295,v=C+(N<<21&4294967295|N>>>11),N=p+(C^(v|~A))+_[8]+1873313359&4294967295,p=v+(N<<6&4294967295|N>>>26),N=A+(v^(p|~C))+_[15]+4264355552&4294967295,A=p+(N<<10&4294967295|N>>>22),N=C+(p^(A|~v))+_[6]+2734768916&4294967295,C=A+(N<<15&4294967295|N>>>17),N=v+(A^(C|~p))+_[13]+1309151649&4294967295,v=C+(N<<21&4294967295|N>>>11),N=p+(C^(v|~A))+_[4]+4149444226&4294967295,p=v+(N<<6&4294967295|N>>>26),N=A+(v^(p|~C))+_[11]+3174756917&4294967295,A=p+(N<<10&4294967295|N>>>22),N=C+(p^(A|~v))+_[2]+718787259&4294967295,C=A+(N<<15&4294967295|N>>>17),N=v+(A^(C|~p))+_[9]+3951481745&4294967295,T.g[0]=T.g[0]+p&4294967295,T.g[1]=T.g[1]+(C+(N<<21&4294967295|N>>>11))&4294967295,T.g[2]=T.g[2]+C&4294967295,T.g[3]=T.g[3]+A&4294967295}r.prototype.u=function(T,p){p===void 0&&(p=T.length);for(var v=p-this.blockSize,_=this.B,C=this.h,A=0;A<p;){if(C==0)for(;A<=v;)s(this,T,A),A+=this.blockSize;if(typeof T=="string"){for(;A<p;)if(_[C++]=T.charCodeAt(A++),C==this.blockSize){s(this,_),C=0;break}}else for(;A<p;)if(_[C++]=T[A++],C==this.blockSize){s(this,_),C=0;break}}this.h=C,this.o+=p},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var p=1;p<T.length-8;++p)T[p]=0;var v=8*this.o;for(p=T.length-8;p<T.length;++p)T[p]=v&255,v/=256;for(this.u(T),T=Array(16),p=v=0;4>p;++p)for(var _=0;32>_;_+=8)T[v++]=this.g[p]>>>_&255;return T};function i(T,p){var v=u;return Object.prototype.hasOwnProperty.call(v,T)?v[T]:v[T]=p(T)}function o(T,p){this.h=p;for(var v=[],_=!0,C=T.length-1;0<=C;C--){var A=T[C]|0;_&&A==p||(v[C]=A,_=!1)}this.g=v}var u={};function c(T){return-128<=T&&128>T?i(T,function(p){return new o([p|0],0>p?-1:0)}):new o([T|0],0>T?-1:0)}function d(T){if(isNaN(T)||!isFinite(T))return y;if(0>T)return R(d(-T));for(var p=[],v=1,_=0;T>=v;_++)p[_]=T/v|0,v*=4294967296;return new o(p,0)}function f(T,p){if(T.length==0)throw Error("number format error: empty string");if(p=p||10,2>p||36<p)throw Error("radix out of range: "+p);if(T.charAt(0)=="-")return R(f(T.substring(1),p));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=d(Math.pow(p,8)),_=y,C=0;C<T.length;C+=8){var A=Math.min(8,T.length-C),N=parseInt(T.substring(C,C+A),p);8>A?(A=d(Math.pow(p,A)),_=_.j(A).add(d(N))):(_=_.j(v),_=_.add(d(N)))}return _}var y=c(0),g=c(1),w=c(16777216);t=o.prototype,t.m=function(){if(P(this))return-R(this).m();for(var T=0,p=1,v=0;v<this.g.length;v++){var _=this.i(v);T+=(0<=_?_:4294967296+_)*p,p*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(S(this))return"0";if(P(this))return"-"+R(this).toString(T);for(var p=d(Math.pow(T,6)),v=this,_="";;){var C=j(v,p).g;v=b(v,C.j(p));var A=((0<v.g.length?v.g[0]:v.h)>>>0).toString(T);if(v=C,S(v))return A+_;for(;6>A.length;)A="0"+A;_=A+_}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function S(T){if(T.h!=0)return!1;for(var p=0;p<T.g.length;p++)if(T.g[p]!=0)return!1;return!0}function P(T){return T.h==-1}t.l=function(T){return T=b(this,T),P(T)?-1:S(T)?0:1};function R(T){for(var p=T.g.length,v=[],_=0;_<p;_++)v[_]=~T.g[_];return new o(v,~T.h).add(g)}t.abs=function(){return P(this)?R(this):this},t.add=function(T){for(var p=Math.max(this.g.length,T.g.length),v=[],_=0,C=0;C<=p;C++){var A=_+(this.i(C)&65535)+(T.i(C)&65535),N=(A>>>16)+(this.i(C)>>>16)+(T.i(C)>>>16);_=N>>>16,A&=65535,N&=65535,v[C]=N<<16|A}return new o(v,v[v.length-1]&-2147483648?-1:0)};function b(T,p){return T.add(R(p))}t.j=function(T){if(S(this)||S(T))return y;if(P(this))return P(T)?R(this).j(R(T)):R(R(this).j(T));if(P(T))return R(this.j(R(T)));if(0>this.l(w)&&0>T.l(w))return d(this.m()*T.m());for(var p=this.g.length+T.g.length,v=[],_=0;_<2*p;_++)v[_]=0;for(_=0;_<this.g.length;_++)for(var C=0;C<T.g.length;C++){var A=this.i(_)>>>16,N=this.i(_)&65535,me=T.i(C)>>>16,ie=T.i(C)&65535;v[2*_+2*C]+=N*ie,x(v,2*_+2*C),v[2*_+2*C+1]+=A*ie,x(v,2*_+2*C+1),v[2*_+2*C+1]+=N*me,x(v,2*_+2*C+1),v[2*_+2*C+2]+=A*me,x(v,2*_+2*C+2)}for(_=0;_<p;_++)v[_]=v[2*_+1]<<16|v[2*_];for(_=p;_<2*p;_++)v[_]=0;return new o(v,0)};function x(T,p){for(;(T[p]&65535)!=T[p];)T[p+1]+=T[p]>>>16,T[p]&=65535,p++}function I(T,p){this.g=T,this.h=p}function j(T,p){if(S(p))throw Error("division by zero");if(S(T))return new I(y,y);if(P(T))return p=j(R(T),p),new I(R(p.g),R(p.h));if(P(p))return p=j(T,R(p)),new I(R(p.g),p.h);if(30<T.g.length){if(P(T)||P(p))throw Error("slowDivide_ only works with positive integers.");for(var v=g,_=p;0>=_.l(T);)v=M(v),_=M(_);var C=V(v,1),A=V(_,1);for(_=V(_,2),v=V(v,2);!S(_);){var N=A.add(_);0>=N.l(T)&&(C=C.add(v),A=N),_=V(_,1),v=V(v,1)}return p=b(T,C.j(p)),new I(C,p)}for(C=y;0<=T.l(p);){for(v=Math.max(1,Math.floor(T.m()/p.m())),_=Math.ceil(Math.log(v)/Math.LN2),_=48>=_?1:Math.pow(2,_-48),A=d(v),N=A.j(p);P(N)||0<N.l(T);)v-=_,A=d(v),N=A.j(p);S(A)&&(A=g),C=C.add(A),T=b(T,N)}return new I(C,T)}t.A=function(T){return j(this,T).h},t.and=function(T){for(var p=Math.max(this.g.length,T.g.length),v=[],_=0;_<p;_++)v[_]=this.i(_)&T.i(_);return new o(v,this.h&T.h)},t.or=function(T){for(var p=Math.max(this.g.length,T.g.length),v=[],_=0;_<p;_++)v[_]=this.i(_)|T.i(_);return new o(v,this.h|T.h)},t.xor=function(T){for(var p=Math.max(this.g.length,T.g.length),v=[],_=0;_<p;_++)v[_]=this.i(_)^T.i(_);return new o(v,this.h^T.h)};function M(T){for(var p=T.g.length+1,v=[],_=0;_<p;_++)v[_]=T.i(_)<<1|T.i(_-1)>>>31;return new o(v,T.h)}function V(T,p){var v=p>>5;p%=32;for(var _=T.g.length-v,C=[],A=0;A<_;A++)C[A]=0<p?T.i(A+v)>>>p|T.i(A+v+1)<<32-p:T.i(A+v);return new o(C,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,i_=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=f,Vr=o}).apply(typeof $g<"u"?$g:typeof self<"u"?self:typeof window<"u"?window:{});var rl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var o_,fo,a_,Tl,sh,l_,u_,c_;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,m){return a==Array.prototype||a==Object.prototype||(a[h]=m.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof rl=="object"&&rl];for(var h=0;h<a.length;++h){var m=a[h];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=n(this);function s(a,h){if(h)e:{var m=r;a=a.split(".");for(var E=0;E<a.length-1;E++){var D=a[E];if(!(D in m))break e;m=m[D]}a=a[a.length-1],E=m[a],h=h(E),h!=E&&h!=null&&e(m,a,{configurable:!0,writable:!0,value:h})}}function i(a,h){a instanceof String&&(a+="");var m=0,E=!1,D={next:function(){if(!E&&m<a.length){var L=m++;return{value:h(L,a[L]),done:!1}}return E=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}s("Array.prototype.values",function(a){return a||function(){return i(this,function(h,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},u=this||self;function c(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function d(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function f(a,h,m){return a.call.apply(a.bind,arguments)}function y(a,h,m){if(!a)throw Error();if(2<arguments.length){var E=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,E),a.apply(h,D)}}return function(){return a.apply(h,arguments)}}function g(a,h,m){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:y,g.apply(null,arguments)}function w(a,h){var m=Array.prototype.slice.call(arguments,1);return function(){var E=m.slice();return E.push.apply(E,arguments),a.apply(this,E)}}function S(a,h){function m(){}m.prototype=h.prototype,a.aa=h.prototype,a.prototype=new m,a.prototype.constructor=a,a.Qb=function(E,D,L){for(var Q=Array(arguments.length-2),Oe=2;Oe<arguments.length;Oe++)Q[Oe-2]=arguments[Oe];return h.prototype[D].apply(E,Q)}}function P(a){const h=a.length;if(0<h){const m=Array(h);for(let E=0;E<h;E++)m[E]=a[E];return m}return[]}function R(a,h){for(let m=1;m<arguments.length;m++){const E=arguments[m];if(c(E)){const D=a.length||0,L=E.length||0;a.length=D+L;for(let Q=0;Q<L;Q++)a[D+Q]=E[Q]}else a.push(E)}}class b{constructor(h,m){this.i=h,this.j=m,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function x(a){return/^[\s\xa0]*$/.test(a)}function I(){var a=u.navigator;return a&&(a=a.userAgent)?a:""}function j(a){return j[" "](a),a}j[" "]=function(){};var M=I().indexOf("Gecko")!=-1&&!(I().toLowerCase().indexOf("webkit")!=-1&&I().indexOf("Edge")==-1)&&!(I().indexOf("Trident")!=-1||I().indexOf("MSIE")!=-1)&&I().indexOf("Edge")==-1;function V(a,h,m){for(const E in a)h.call(m,a[E],E,a)}function T(a,h){for(const m in a)h.call(void 0,a[m],m,a)}function p(a){const h={};for(const m in a)h[m]=a[m];return h}const v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _(a,h){let m,E;for(let D=1;D<arguments.length;D++){E=arguments[D];for(m in E)a[m]=E[m];for(let L=0;L<v.length;L++)m=v[L],Object.prototype.hasOwnProperty.call(E,m)&&(a[m]=E[m])}}function C(a){var h=1;a=a.split(":");const m=[];for(;0<h&&a.length;)m.push(a.shift()),h--;return a.length&&m.push(a.join(":")),m}function A(a){u.setTimeout(()=>{throw a},0)}function N(){var a=q;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class me{constructor(){this.h=this.g=null}add(h,m){const E=ie.get();E.set(h,m),this.h?this.h.next=E:this.g=E,this.h=E}}var ie=new b(()=>new Ie,a=>a.reset());class Ie{constructor(){this.next=this.g=this.h=null}set(h,m){this.h=h,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let te,z=!1,q=new me,X=()=>{const a=u.Promise.resolve(void 0);te=()=>{a.then(G)}};var G=()=>{for(var a;a=N();){try{a.h.call(a.g)}catch(m){A(m)}var h=ie;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}z=!1};function k(){this.s=this.s,this.C=this.C}k.prototype.s=!1,k.prototype.ma=function(){this.s||(this.s=!0,this.N())},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var K=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const m=()=>{};u.addEventListener("test",m,h),u.removeEventListener("test",m,h)}catch{}return a}();function se(a,h){if(O.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var m=this.type=a.type,E=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(M){e:{try{j(h.nodeName);var D=!0;break e}catch{}D=!1}D||(h=null)}}else m=="mouseover"?h=a.fromElement:m=="mouseout"&&(h=a.toElement);this.relatedTarget=h,E?(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:F[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&se.aa.h.call(this)}}S(se,O);var F={2:"touch",3:"pen",4:"mouse"};se.prototype.h=function(){se.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var H="closure_listenable_"+(1e6*Math.random()|0),Y=0;function ue(a,h,m,E,D){this.listener=a,this.proxy=null,this.src=h,this.type=m,this.capture=!!E,this.ha=D,this.key=++Y,this.da=this.fa=!1}function oe(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function ne(a){this.src=a,this.g={},this.h=0}ne.prototype.add=function(a,h,m,E,D){var L=a.toString();a=this.g[L],a||(a=this.g[L]=[],this.h++);var Q=Ce(a,h,E,D);return-1<Q?(h=a[Q],m||(h.fa=!1)):(h=new ue(h,this.src,L,!!E,D),h.fa=m,a.push(h)),h};function xe(a,h){var m=h.type;if(m in a.g){var E=a.g[m],D=Array.prototype.indexOf.call(E,h,void 0),L;(L=0<=D)&&Array.prototype.splice.call(E,D,1),L&&(oe(h),a.g[m].length==0&&(delete a.g[m],a.h--))}}function Ce(a,h,m,E){for(var D=0;D<a.length;++D){var L=a[D];if(!L.da&&L.listener==h&&L.capture==!!m&&L.ha==E)return D}return-1}var ge="closure_lm_"+(1e6*Math.random()|0),ye={};function ve(a,h,m,E,D){if(Array.isArray(h)){for(var L=0;L<h.length;L++)ve(a,h[L],m,E,D);return null}return m=Qt(m),a&&a[H]?a.K(h,m,d(E)?!!E.capture:!1,D):jt(a,h,m,!1,E,D)}function jt(a,h,m,E,D,L){if(!h)throw Error("Invalid event type");var Q=d(D)?!!D.capture:!!D,Oe=De(a);if(Oe||(a[ge]=Oe=new ne(a)),m=Oe.add(h,m,E,Q,L),m.proxy)return m;if(E=fe(),m.proxy=E,E.src=a,E.listener=m,a.addEventListener)K||(D=Q),D===void 0&&(D=!1),a.addEventListener(h.toString(),E,D);else if(a.attachEvent)a.attachEvent(J(h.toString()),E);else if(a.addListener&&a.removeListener)a.addListener(E);else throw Error("addEventListener and attachEvent are unavailable.");return m}function fe(){function a(m){return h.call(a.src,a.listener,m)}const h=le;return a}function je(a,h,m,E,D){if(Array.isArray(h))for(var L=0;L<h.length;L++)je(a,h[L],m,E,D);else E=d(E)?!!E.capture:!!E,m=Qt(m),a&&a[H]?(a=a.i,h=String(h).toString(),h in a.g&&(L=a.g[h],m=Ce(L,m,E,D),-1<m&&(oe(L[m]),Array.prototype.splice.call(L,m,1),L.length==0&&(delete a.g[h],a.h--)))):a&&(a=De(a))&&(h=a.g[h.toString()],a=-1,h&&(a=Ce(h,m,E,D)),(m=-1<a?h[a]:null)&&Ut(m))}function Ut(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[H])xe(h.i,a);else{var m=a.type,E=a.proxy;h.removeEventListener?h.removeEventListener(m,E,a.capture):h.detachEvent?h.detachEvent(J(m),E):h.addListener&&h.removeListener&&h.removeListener(E),(m=De(h))?(xe(m,a),m.h==0&&(m.src=null,h[ge]=null)):oe(a)}}}function J(a){return a in ye?ye[a]:ye[a]="on"+a}function le(a,h){if(a.da)a=!0;else{h=new se(h,this);var m=a.listener,E=a.ha||a.src;a.fa&&Ut(a),a=m.call(E,h)}return a}function De(a){return a=a[ge],a instanceof ne?a:null}var Ze="__closure_events_fn_"+(1e9*Math.random()>>>0);function Qt(a){return typeof a=="function"?a:(a[Ze]||(a[Ze]=function(h){return a.handleEvent(h)}),a[Ze])}function Te(){k.call(this),this.i=new ne(this),this.M=this,this.F=null}S(Te,k),Te.prototype[H]=!0,Te.prototype.removeEventListener=function(a,h,m,E){je(this,a,h,m,E)};function Ae(a,h){var m,E=a.F;if(E)for(m=[];E;E=E.F)m.push(E);if(a=a.M,E=h.type||h,typeof h=="string")h=new O(h,a);else if(h instanceof O)h.target=h.target||a;else{var D=h;h=new O(E,a),_(h,D)}if(D=!0,m)for(var L=m.length-1;0<=L;L--){var Q=h.g=m[L];D=zt(Q,E,!0,h)&&D}if(Q=h.g=a,D=zt(Q,E,!0,h)&&D,D=zt(Q,E,!1,h)&&D,m)for(L=0;L<m.length;L++)Q=h.g=m[L],D=zt(Q,E,!1,h)&&D}Te.prototype.N=function(){if(Te.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var m=a.g[h],E=0;E<m.length;E++)oe(m[E]);delete a.g[h],a.h--}}this.F=null},Te.prototype.K=function(a,h,m,E){return this.i.add(String(a),h,!1,m,E)},Te.prototype.L=function(a,h,m,E){return this.i.add(String(a),h,!0,m,E)};function zt(a,h,m,E){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var D=!0,L=0;L<h.length;++L){var Q=h[L];if(Q&&!Q.da&&Q.capture==m){var Oe=Q.listener,pt=Q.ha||Q.src;Q.fa&&xe(a.i,Q),D=Oe.call(pt,E)!==!1&&D}}return D&&!E.defaultPrevented}function Os(a,h,m){if(typeof a=="function")m&&(a=g(a,m));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:u.setTimeout(a,h||0)}function Ui(a){a.g=Os(()=>{a.g=null,a.i&&(a.i=!1,Ui(a))},a.l);const h=a.h;a.h=null,a.m.apply(null,h)}class ar extends k{constructor(h,m){super(),this.m=h,this.l=m,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Ui(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function wt(a){k.call(this),this.h=a,this.g={}}S(wt,k);var lr=[];function zi(a){V(a.g,function(h,m){this.g.hasOwnProperty(m)&&Ut(h)},a),a.g={}}wt.prototype.N=function(){wt.aa.N.call(this),zi(this)},wt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var nc=u.JSON.stringify,zw=u.JSON.parse,Bw=class{stringify(a){return u.JSON.stringify(a,void 0)}parse(a){return u.JSON.parse(a,void 0)}};function rc(){}rc.prototype.h=null;function pp(a){return a.h||(a.h=a.i())}function mp(){}var Bi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function sc(){O.call(this,"d")}S(sc,O);function ic(){O.call(this,"c")}S(ic,O);var rs={},gp=null;function Ta(){return gp=gp||new Te}rs.La="serverreachability";function yp(a){O.call(this,rs.La,a)}S(yp,O);function $i(a){const h=Ta();Ae(h,new yp(h))}rs.STAT_EVENT="statevent";function vp(a,h){O.call(this,rs.STAT_EVENT,a),this.stat=h}S(vp,O);function Dt(a){const h=Ta();Ae(h,new vp(h,a))}rs.Ma="timingevent";function xp(a,h){O.call(this,rs.Ma,a),this.size=h}S(xp,O);function qi(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){a()},h)}function Hi(){this.g=!0}Hi.prototype.xa=function(){this.g=!1};function $w(a,h,m,E,D,L){a.info(function(){if(a.g)if(L)for(var Q="",Oe=L.split("&"),pt=0;pt<Oe.length;pt++){var ke=Oe[pt].split("=");if(1<ke.length){var Et=ke[0];ke=ke[1];var bt=Et.split("_");Q=2<=bt.length&&bt[1]=="type"?Q+(Et+"="+ke+"&"):Q+(Et+"=redacted&")}}else Q=null;else Q=L;return"XMLHTTP REQ ("+E+") [attempt "+D+"]: "+h+`
`+m+`
`+Q})}function qw(a,h,m,E,D,L,Q){a.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+D+"]: "+h+`
`+m+`
`+L+" "+Q})}function Ls(a,h,m,E){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+Ww(a,m)+(E?" "+E:"")})}function Hw(a,h){a.info(function(){return"TIMEOUT: "+h})}Hi.prototype.info=function(){};function Ww(a,h){if(!a.g)return h;if(!h)return null;try{var m=JSON.parse(h);if(m){for(a=0;a<m.length;a++)if(Array.isArray(m[a])){var E=m[a];if(!(2>E.length)){var D=E[1];if(Array.isArray(D)&&!(1>D.length)){var L=D[0];if(L!="noop"&&L!="stop"&&L!="close")for(var Q=1;Q<D.length;Q++)D[Q]=""}}}}return nc(m)}catch{return h}}var Ia={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},_p={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},oc;function Na(){}S(Na,rc),Na.prototype.g=function(){return new XMLHttpRequest},Na.prototype.i=function(){return{}},oc=new Na;function ur(a,h,m,E){this.j=a,this.i=h,this.l=m,this.R=E||1,this.U=new wt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new wp}function wp(){this.i=null,this.g="",this.h=!1}var Ep={},ac={};function lc(a,h,m){a.L=1,a.v=Aa(Un(h)),a.m=m,a.P=!0,bp(a,null)}function bp(a,h){a.F=Date.now(),Sa(a),a.A=Un(a.v);var m=a.A,E=a.R;Array.isArray(E)||(E=[String(E)]),Vp(m.i,"t",E),a.C=0,m=a.j.J,a.h=new wp,a.g=tm(a.j,m?h:null,!a.m),0<a.O&&(a.M=new ar(g(a.Y,a,a.g),a.O)),h=a.U,m=a.g,E=a.ca;var D="readystatechange";Array.isArray(D)||(D&&(lr[0]=D.toString()),D=lr);for(var L=0;L<D.length;L++){var Q=ve(m,D[L],E||h.handleEvent,!1,h.h||h);if(!Q)break;h.g[Q.key]=Q}h=a.H?p(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),$i(),$w(a.i,a.u,a.A,a.l,a.R,a.m)}ur.prototype.ca=function(a){a=a.target;const h=this.M;h&&zn(a)==3?h.j():this.Y(a)},ur.prototype.Y=function(a){try{if(a==this.g)e:{const bt=zn(this.g);var h=this.g.Ba();const Fs=this.g.Z();if(!(3>bt)&&(bt!=3||this.g&&(this.h.h||this.g.oa()||qp(this.g)))){this.J||bt!=4||h==7||(h==8||0>=Fs?$i(3):$i(2)),uc(this);var m=this.g.Z();this.X=m;t:if(Tp(this)){var E=qp(this.g);a="";var D=E.length,L=zn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ss(this),Wi(this);var Q="";break t}this.h.i=new u.TextDecoder}for(h=0;h<D;h++)this.h.h=!0,a+=this.h.i.decode(E[h],{stream:!(L&&h==D-1)});E.length=0,this.h.g+=a,this.C=0,Q=this.h.g}else Q=this.g.oa();if(this.o=m==200,qw(this.i,this.u,this.A,this.l,this.R,bt,m),this.o){if(this.T&&!this.K){t:{if(this.g){var Oe,pt=this.g;if((Oe=pt.g?pt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(Oe)){var ke=Oe;break t}}ke=null}if(m=ke)Ls(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,cc(this,m);else{this.o=!1,this.s=3,Dt(12),ss(this),Wi(this);break e}}if(this.P){m=!0;let fn;for(;!this.J&&this.C<Q.length;)if(fn=Gw(this,Q),fn==ac){bt==4&&(this.s=4,Dt(14),m=!1),Ls(this.i,this.l,null,"[Incomplete Response]");break}else if(fn==Ep){this.s=4,Dt(15),Ls(this.i,this.l,Q,"[Invalid Chunk]"),m=!1;break}else Ls(this.i,this.l,fn,null),cc(this,fn);if(Tp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),bt!=4||Q.length!=0||this.h.h||(this.s=1,Dt(16),m=!1),this.o=this.o&&m,!m)Ls(this.i,this.l,Q,"[Invalid Chunked Response]"),ss(this),Wi(this);else if(0<Q.length&&!this.W){this.W=!0;var Et=this.j;Et.g==this&&Et.ba&&!Et.M&&(Et.j.info("Great, no buffering proxy detected. Bytes received: "+Q.length),gc(Et),Et.M=!0,Dt(11))}}else Ls(this.i,this.l,Q,null),cc(this,Q);bt==4&&ss(this),this.o&&!this.J&&(bt==4?Yp(this.j,this):(this.o=!1,Sa(this)))}else c1(this.g),m==400&&0<Q.indexOf("Unknown SID")?(this.s=3,Dt(12)):(this.s=0,Dt(13)),ss(this),Wi(this)}}}catch{}finally{}};function Tp(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function Gw(a,h){var m=a.C,E=h.indexOf(`
`,m);return E==-1?ac:(m=Number(h.substring(m,E)),isNaN(m)?Ep:(E+=1,E+m>h.length?ac:(h=h.slice(E,E+m),a.C=E+m,h)))}ur.prototype.cancel=function(){this.J=!0,ss(this)};function Sa(a){a.S=Date.now()+a.I,Ip(a,a.I)}function Ip(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=qi(g(a.ba,a),h)}function uc(a){a.B&&(u.clearTimeout(a.B),a.B=null)}ur.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(Hw(this.i,this.A),this.L!=2&&($i(),Dt(17)),ss(this),this.s=2,Wi(this)):Ip(this,this.S-a)};function Wi(a){a.j.G==0||a.J||Yp(a.j,a)}function ss(a){uc(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,zi(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function cc(a,h){try{var m=a.j;if(m.G!=0&&(m.g==a||dc(m.h,a))){if(!a.K&&dc(m.h,a)&&m.G==3){try{var E=m.Da.g.parse(h)}catch{E=null}if(Array.isArray(E)&&E.length==3){var D=E;if(D[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<a.F)La(m),Da(m);else break e;mc(m),Dt(18)}}else m.za=D[1],0<m.za-m.T&&37500>D[2]&&m.F&&m.v==0&&!m.C&&(m.C=qi(g(m.Za,m),6e3));if(1>=Cp(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else os(m,11)}else if((a.K||m.g==a)&&La(m),!x(h))for(D=m.Da.g.parse(h),h=0;h<D.length;h++){let ke=D[h];if(m.T=ke[0],ke=ke[1],m.G==2)if(ke[0]=="c"){m.K=ke[1],m.ia=ke[2];const Et=ke[3];Et!=null&&(m.la=Et,m.j.info("VER="+m.la));const bt=ke[4];bt!=null&&(m.Aa=bt,m.j.info("SVER="+m.Aa));const Fs=ke[5];Fs!=null&&typeof Fs=="number"&&0<Fs&&(E=1.5*Fs,m.L=E,m.j.info("backChannelRequestTimeoutMs_="+E)),E=m;const fn=a.g;if(fn){const Ma=fn.g?fn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ma){var L=E.h;L.g||Ma.indexOf("spdy")==-1&&Ma.indexOf("quic")==-1&&Ma.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(hc(L,L.h),L.h=null))}if(E.D){const yc=fn.g?fn.g.getResponseHeader("X-HTTP-Session-Id"):null;yc&&(E.ya=yc,Me(E.I,E.D,yc))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-a.F,m.j.info("Handshake RTT: "+m.R+"ms")),E=m;var Q=a;if(E.qa=em(E,E.J?E.ia:null,E.W),Q.K){kp(E.h,Q);var Oe=Q,pt=E.L;pt&&(Oe.I=pt),Oe.B&&(uc(Oe),Sa(Oe)),E.g=Q}else Qp(E);0<m.i.length&&Oa(m)}else ke[0]!="stop"&&ke[0]!="close"||os(m,7);else m.G==3&&(ke[0]=="stop"||ke[0]=="close"?ke[0]=="stop"?os(m,7):pc(m):ke[0]!="noop"&&m.l&&m.l.ta(ke),m.v=0)}}$i(4)}catch{}}var Kw=class{constructor(a,h){this.g=a,this.map=h}};function Np(a){this.l=a||10,u.PerformanceNavigationTiming?(a=u.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Sp(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Cp(a){return a.h?1:a.g?a.g.size:0}function dc(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function hc(a,h){a.g?a.g.add(h):a.h=h}function kp(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}Np.prototype.cancel=function(){if(this.i=Ap(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Ap(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(const m of a.g.values())h=h.concat(m.D);return h}return P(a.i)}function Qw(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var h=[],m=a.length,E=0;E<m;E++)h.push(a[E]);return h}h=[],m=0;for(E in a)h[m++]=a[E];return h}function Xw(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var h=[];a=a.length;for(var m=0;m<a;m++)h.push(m);return h}h=[],m=0;for(const E in a)h[m++]=E;return h}}}function Pp(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var m=Xw(a),E=Qw(a),D=E.length,L=0;L<D;L++)h.call(void 0,E[L],m&&m[L],a)}var Rp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Yw(a,h){if(a){a=a.split("&");for(var m=0;m<a.length;m++){var E=a[m].indexOf("="),D=null;if(0<=E){var L=a[m].substring(0,E);D=a[m].substring(E+1)}else L=a[m];h(L,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function is(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof is){this.h=a.h,Ca(this,a.j),this.o=a.o,this.g=a.g,ka(this,a.s),this.l=a.l;var h=a.i,m=new Qi;m.i=h.i,h.g&&(m.g=new Map(h.g),m.h=h.h),jp(this,m),this.m=a.m}else a&&(h=String(a).match(Rp))?(this.h=!1,Ca(this,h[1]||"",!0),this.o=Gi(h[2]||""),this.g=Gi(h[3]||"",!0),ka(this,h[4]),this.l=Gi(h[5]||"",!0),jp(this,h[6]||"",!0),this.m=Gi(h[7]||"")):(this.h=!1,this.i=new Qi(null,this.h))}is.prototype.toString=function(){var a=[],h=this.j;h&&a.push(Ki(h,Dp,!0),":");var m=this.g;return(m||h=="file")&&(a.push("//"),(h=this.o)&&a.push(Ki(h,Dp,!0),"@"),a.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&a.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&a.push("/"),a.push(Ki(m,m.charAt(0)=="/"?e1:Zw,!0))),(m=this.i.toString())&&a.push("?",m),(m=this.m)&&a.push("#",Ki(m,n1)),a.join("")};function Un(a){return new is(a)}function Ca(a,h,m){a.j=m?Gi(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function ka(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function jp(a,h,m){h instanceof Qi?(a.i=h,r1(a.i,a.h)):(m||(h=Ki(h,t1)),a.i=new Qi(h,a.h))}function Me(a,h,m){a.i.set(h,m)}function Aa(a){return Me(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Gi(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Ki(a,h,m){return typeof a=="string"?(a=encodeURI(a).replace(h,Jw),m&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Jw(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Dp=/[#\/\?@]/g,Zw=/[#\?:]/g,e1=/[#\?]/g,t1=/[#\?@]/g,n1=/#/g;function Qi(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function cr(a){a.g||(a.g=new Map,a.h=0,a.i&&Yw(a.i,function(h,m){a.add(decodeURIComponent(h.replace(/\+/g," ")),m)}))}t=Qi.prototype,t.add=function(a,h){cr(this),this.i=null,a=Vs(this,a);var m=this.g.get(a);return m||this.g.set(a,m=[]),m.push(h),this.h+=1,this};function Op(a,h){cr(a),h=Vs(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function Lp(a,h){return cr(a),h=Vs(a,h),a.g.has(h)}t.forEach=function(a,h){cr(this),this.g.forEach(function(m,E){m.forEach(function(D){a.call(h,D,E,this)},this)},this)},t.na=function(){cr(this);const a=Array.from(this.g.values()),h=Array.from(this.g.keys()),m=[];for(let E=0;E<h.length;E++){const D=a[E];for(let L=0;L<D.length;L++)m.push(h[E])}return m},t.V=function(a){cr(this);let h=[];if(typeof a=="string")Lp(this,a)&&(h=h.concat(this.g.get(Vs(this,a))));else{a=Array.from(this.g.values());for(let m=0;m<a.length;m++)h=h.concat(a[m])}return h},t.set=function(a,h){return cr(this),this.i=null,a=Vs(this,a),Lp(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},t.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function Vp(a,h,m){Op(a,h),0<m.length&&(a.i=null,a.g.set(Vs(a,h),P(m)),a.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],h=Array.from(this.g.keys());for(var m=0;m<h.length;m++){var E=h[m];const L=encodeURIComponent(String(E)),Q=this.V(E);for(E=0;E<Q.length;E++){var D=L;Q[E]!==""&&(D+="="+encodeURIComponent(String(Q[E]))),a.push(D)}}return this.i=a.join("&")};function Vs(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function r1(a,h){h&&!a.j&&(cr(a),a.i=null,a.g.forEach(function(m,E){var D=E.toLowerCase();E!=D&&(Op(this,E),Vp(this,D,m))},a)),a.j=h}function s1(a,h){const m=new Hi;if(u.Image){const E=new Image;E.onload=w(dr,m,"TestLoadImage: loaded",!0,h,E),E.onerror=w(dr,m,"TestLoadImage: error",!1,h,E),E.onabort=w(dr,m,"TestLoadImage: abort",!1,h,E),E.ontimeout=w(dr,m,"TestLoadImage: timeout",!1,h,E),u.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=a}else h(!1)}function i1(a,h){const m=new Hi,E=new AbortController,D=setTimeout(()=>{E.abort(),dr(m,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:E.signal}).then(L=>{clearTimeout(D),L.ok?dr(m,"TestPingServer: ok",!0,h):dr(m,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(D),dr(m,"TestPingServer: error",!1,h)})}function dr(a,h,m,E,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),E(m)}catch{}}function o1(){this.g=new Bw}function a1(a,h,m){const E=m||"";try{Pp(a,function(D,L){let Q=D;d(D)&&(Q=nc(D)),h.push(E+L+"="+encodeURIComponent(Q))})}catch(D){throw h.push(E+"type="+encodeURIComponent("_badmap")),D}}function Pa(a){this.l=a.Ub||null,this.j=a.eb||!1}S(Pa,rc),Pa.prototype.g=function(){return new Ra(this.l,this.j)},Pa.prototype.i=function(a){return function(){return a}}({});function Ra(a,h){Te.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(Ra,Te),t=Ra.prototype,t.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,Yi(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||u).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Xi(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Yi(this)),this.g&&(this.readyState=3,Yi(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Mp(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Mp(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?Xi(this):Yi(this),this.readyState==3&&Mp(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,Xi(this))},t.Qa=function(a){this.g&&(this.response=a,Xi(this))},t.ga=function(){this.g&&Xi(this)};function Xi(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Yi(a)}t.setRequestHeader=function(a,h){this.u.append(a,h)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],h=this.h.entries();for(var m=h.next();!m.done;)m=m.value,a.push(m[0]+": "+m[1]),m=h.next();return a.join(`\r
`)};function Yi(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Ra.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Fp(a){let h="";return V(a,function(m,E){h+=E,h+=":",h+=m,h+=`\r
`}),h}function fc(a,h,m){e:{for(E in m){var E=!1;break e}E=!0}E||(m=Fp(m),typeof a=="string"?m!=null&&encodeURIComponent(String(m)):Me(a,h,m))}function Qe(a){Te.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(Qe,Te);var l1=/^https?$/i,u1=["POST","PUT"];t=Qe.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,h,m,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():oc.g(),this.v=this.o?pp(this.o):pp(oc),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(L){Up(this,L);return}if(a=m||"",m=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var D in E)m.set(D,E[D]);else if(typeof E.keys=="function"&&typeof E.get=="function")for(const L of E.keys())m.set(L,E.get(L));else throw Error("Unknown input type for opt_headers: "+String(E));E=Array.from(m.keys()).find(L=>L.toLowerCase()=="content-type"),D=u.FormData&&a instanceof u.FormData,!(0<=Array.prototype.indexOf.call(u1,h,void 0))||E||D||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,Q]of m)this.g.setRequestHeader(L,Q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$p(this),this.u=!0,this.g.send(a),this.u=!1}catch(L){Up(this,L)}};function Up(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,zp(a),ja(a)}function zp(a){a.A||(a.A=!0,Ae(a,"complete"),Ae(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,Ae(this,"complete"),Ae(this,"abort"),ja(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ja(this,!0)),Qe.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Bp(this):this.bb())},t.bb=function(){Bp(this)};function Bp(a){if(a.h&&typeof o<"u"&&(!a.v[1]||zn(a)!=4||a.Z()!=2)){if(a.u&&zn(a)==4)Os(a.Ea,0,a);else if(Ae(a,"readystatechange"),zn(a)==4){a.h=!1;try{const Q=a.Z();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var m;if(!(m=h)){var E;if(E=Q===0){var D=String(a.D).match(Rp)[1]||null;!D&&u.self&&u.self.location&&(D=u.self.location.protocol.slice(0,-1)),E=!l1.test(D?D.toLowerCase():"")}m=E}if(m)Ae(a,"complete"),Ae(a,"success");else{a.m=6;try{var L=2<zn(a)?a.g.statusText:""}catch{L=""}a.l=L+" ["+a.Z()+"]",zp(a)}}finally{ja(a)}}}}function ja(a,h){if(a.g){$p(a);const m=a.g,E=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||Ae(a,"ready");try{m.onreadystatechange=E}catch{}}}function $p(a){a.I&&(u.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function zn(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<zn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),zw(h)}};function qp(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function c1(a){const h={};a=(a.g&&2<=zn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let E=0;E<a.length;E++){if(x(a[E]))continue;var m=C(a[E]);const D=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const L=h[D]||[];h[D]=L,L.push(m)}T(h,function(E){return E.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ji(a,h,m){return m&&m.internalChannelParams&&m.internalChannelParams[a]||h}function Hp(a){this.Aa=0,this.i=[],this.j=new Hi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ji("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ji("baseRetryDelayMs",5e3,a),this.cb=Ji("retryDelaySeedMs",1e4,a),this.Wa=Ji("forwardChannelMaxRetries",2,a),this.wa=Ji("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Np(a&&a.concurrentRequestLimit),this.Da=new o1,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Hp.prototype,t.la=8,t.G=1,t.connect=function(a,h,m,E){Dt(0),this.W=a,this.H=h||{},m&&E!==void 0&&(this.H.OSID=m,this.H.OAID=E),this.F=this.X,this.I=em(this,null,this.W),Oa(this)};function pc(a){if(Wp(a),a.G==3){var h=a.U++,m=Un(a.I);if(Me(m,"SID",a.K),Me(m,"RID",h),Me(m,"TYPE","terminate"),Zi(a,m),h=new ur(a,a.j,h),h.L=2,h.v=Aa(Un(m)),m=!1,u.navigator&&u.navigator.sendBeacon)try{m=u.navigator.sendBeacon(h.v.toString(),"")}catch{}!m&&u.Image&&(new Image().src=h.v,m=!0),m||(h.g=tm(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Sa(h)}Zp(a)}function Da(a){a.g&&(gc(a),a.g.cancel(),a.g=null)}function Wp(a){Da(a),a.u&&(u.clearTimeout(a.u),a.u=null),La(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&u.clearTimeout(a.s),a.s=null)}function Oa(a){if(!Sp(a.h)&&!a.s){a.s=!0;var h=a.Ga;te||X(),z||(te(),z=!0),q.add(h,a),a.B=0}}function d1(a,h){return Cp(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=qi(g(a.Ga,a,h),Jp(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const D=new ur(this,this.j,a);let L=this.o;if(this.S&&(L?(L=p(L),_(L,this.S)):L=this.S),this.m!==null||this.O||(D.H=L,L=null),this.P)e:{for(var h=0,m=0;m<this.i.length;m++){t:{var E=this.i[m];if("__data__"in E.map&&(E=E.map.__data__,typeof E=="string")){E=E.length;break t}E=void 0}if(E===void 0)break;if(h+=E,4096<h){h=m;break e}if(h===4096||m===this.i.length-1){h=m+1;break e}}h=1e3}else h=1e3;h=Kp(this,D,h),m=Un(this.I),Me(m,"RID",a),Me(m,"CVER",22),this.D&&Me(m,"X-HTTP-Session-Id",this.D),Zi(this,m),L&&(this.O?h="headers="+encodeURIComponent(String(Fp(L)))+"&"+h:this.m&&fc(m,this.m,L)),hc(this.h,D),this.Ua&&Me(m,"TYPE","init"),this.P?(Me(m,"$req",h),Me(m,"SID","null"),D.T=!0,lc(D,m,null)):lc(D,m,h),this.G=2}}else this.G==3&&(a?Gp(this,a):this.i.length==0||Sp(this.h)||Gp(this))};function Gp(a,h){var m;h?m=h.l:m=a.U++;const E=Un(a.I);Me(E,"SID",a.K),Me(E,"RID",m),Me(E,"AID",a.T),Zi(a,E),a.m&&a.o&&fc(E,a.m,a.o),m=new ur(a,a.j,m,a.B+1),a.m===null&&(m.H=a.o),h&&(a.i=h.D.concat(a.i)),h=Kp(a,m,1e3),m.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),hc(a.h,m),lc(m,E,h)}function Zi(a,h){a.H&&V(a.H,function(m,E){Me(h,E,m)}),a.l&&Pp({},function(m,E){Me(h,E,m)})}function Kp(a,h,m){m=Math.min(a.i.length,m);var E=a.l?g(a.l.Na,a.l,a):null;e:{var D=a.i;let L=-1;for(;;){const Q=["count="+m];L==-1?0<m?(L=D[0].g,Q.push("ofs="+L)):L=0:Q.push("ofs="+L);let Oe=!0;for(let pt=0;pt<m;pt++){let ke=D[pt].g;const Et=D[pt].map;if(ke-=L,0>ke)L=Math.max(0,D[pt].g-100),Oe=!1;else try{a1(Et,Q,"req"+ke+"_")}catch{E&&E(Et)}}if(Oe){E=Q.join("&");break e}}}return a=a.i.splice(0,m),h.D=a,E}function Qp(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;te||X(),z||(te(),z=!0),q.add(h,a),a.v=0}}function mc(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=qi(g(a.Fa,a),Jp(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,Xp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=qi(g(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Dt(10),Da(this),Xp(this))};function gc(a){a.A!=null&&(u.clearTimeout(a.A),a.A=null)}function Xp(a){a.g=new ur(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=Un(a.qa);Me(h,"RID","rpc"),Me(h,"SID",a.K),Me(h,"AID",a.T),Me(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&Me(h,"TO",a.ja),Me(h,"TYPE","xmlhttp"),Zi(a,h),a.m&&a.o&&fc(h,a.m,a.o),a.L&&(a.g.I=a.L);var m=a.g;a=a.ia,m.L=1,m.v=Aa(Un(h)),m.m=null,m.P=!0,bp(m,a)}t.Za=function(){this.C!=null&&(this.C=null,Da(this),mc(this),Dt(19))};function La(a){a.C!=null&&(u.clearTimeout(a.C),a.C=null)}function Yp(a,h){var m=null;if(a.g==h){La(a),gc(a),a.g=null;var E=2}else if(dc(a.h,h))m=h.D,kp(a.h,h),E=1;else return;if(a.G!=0){if(h.o)if(E==1){m=h.m?h.m.length:0,h=Date.now()-h.F;var D=a.B;E=Ta(),Ae(E,new xp(E,m)),Oa(a)}else Qp(a);else if(D=h.s,D==3||D==0&&0<h.X||!(E==1&&d1(a,h)||E==2&&mc(a)))switch(m&&0<m.length&&(h=a.h,h.i=h.i.concat(m)),D){case 1:os(a,5);break;case 4:os(a,10);break;case 3:os(a,6);break;default:os(a,2)}}}function Jp(a,h){let m=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(m*=2),m*h}function os(a,h){if(a.j.info("Error code "+h),h==2){var m=g(a.fb,a),E=a.Xa;const D=!E;E=new is(E||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Ca(E,"https"),Aa(E),D?s1(E.toString(),m):i1(E.toString(),m)}else Dt(2);a.G=0,a.l&&a.l.sa(h),Zp(a),Wp(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),Dt(2)):(this.j.info("Failed to ping google.com"),Dt(1))};function Zp(a){if(a.G=0,a.ka=[],a.l){const h=Ap(a.h);(h.length!=0||a.i.length!=0)&&(R(a.ka,h),R(a.ka,a.i),a.h.i.length=0,P(a.i),a.i.length=0),a.l.ra()}}function em(a,h,m){var E=m instanceof is?Un(m):new is(m);if(E.g!="")h&&(E.g=h+"."+E.g),ka(E,E.s);else{var D=u.location;E=D.protocol,h=h?h+"."+D.hostname:D.hostname,D=+D.port;var L=new is(null);E&&Ca(L,E),h&&(L.g=h),D&&ka(L,D),m&&(L.l=m),E=L}return m=a.D,h=a.ya,m&&h&&Me(E,m,h),Me(E,"VER",a.la),Zi(a,E),E}function tm(a,h,m){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new Qe(new Pa({eb:m})):new Qe(a.pa),h.Ha(a.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function nm(){}t=nm.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Va(){}Va.prototype.g=function(a,h){return new Xt(a,h)};function Xt(a,h){Te.call(this),this.g=new Hp(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!x(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!x(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new Ms(this)}S(Xt,Te),Xt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Xt.prototype.close=function(){pc(this.g)},Xt.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var m={};m.__data__=a,a=m}else this.u&&(m={},m.__data__=nc(a),a=m);h.i.push(new Kw(h.Ya++,a)),h.G==3&&Oa(h)},Xt.prototype.N=function(){this.g.l=null,delete this.j,pc(this.g),delete this.g,Xt.aa.N.call(this)};function rm(a){sc.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(const m in h){a=m;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}S(rm,sc);function sm(){ic.call(this),this.status=1}S(sm,ic);function Ms(a){this.g=a}S(Ms,nm),Ms.prototype.ua=function(){Ae(this.g,"a")},Ms.prototype.ta=function(a){Ae(this.g,new rm(a))},Ms.prototype.sa=function(a){Ae(this.g,new sm)},Ms.prototype.ra=function(){Ae(this.g,"b")},Va.prototype.createWebChannel=Va.prototype.g,Xt.prototype.send=Xt.prototype.o,Xt.prototype.open=Xt.prototype.m,Xt.prototype.close=Xt.prototype.close,c_=function(){return new Va},u_=function(){return Ta()},l_=rs,sh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ia.NO_ERROR=0,Ia.TIMEOUT=8,Ia.HTTP_ERROR=6,Tl=Ia,_p.COMPLETE="complete",a_=_p,mp.EventType=Bi,Bi.OPEN="a",Bi.CLOSE="b",Bi.ERROR="c",Bi.MESSAGE="d",Te.prototype.listen=Te.prototype.K,fo=mp,Qe.prototype.listenOnce=Qe.prototype.L,Qe.prototype.getLastError=Qe.prototype.Ka,Qe.prototype.getLastErrorCode=Qe.prototype.Ba,Qe.prototype.getStatus=Qe.prototype.Z,Qe.prototype.getResponseJson=Qe.prototype.Oa,Qe.prototype.getResponseText=Qe.prototype.oa,Qe.prototype.send=Qe.prototype.ea,Qe.prototype.setWithCredentials=Qe.prototype.Ha,o_=Qe}).apply(typeof rl<"u"?rl:typeof self<"u"?self:typeof window<"u"?window:{});const qg="@firebase/firestore",Hg="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}St.UNAUTHENTICATED=new St(null),St.GOOGLE_CREDENTIALS=new St("google-credentials-uid"),St.FIRST_PARTY=new St("first-party-uid"),St.MOCK_USER=new St("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Li="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss=new vf("@firebase/firestore");function Bs(){return Ss.logLevel}function Z(t,...e){if(Ss.logLevel<=we.DEBUG){const n=e.map(kf);Ss.debug(`Firestore (${Li}): ${t}`,...n)}}function rr(t,...e){if(Ss.logLevel<=we.ERROR){const n=e.map(kf);Ss.error(`Firestore (${Li}): ${t}`,...n)}}function Hr(t,...e){if(Ss.logLevel<=we.WARN){const n=e.map(kf);Ss.warn(`Firestore (${Li}): ${t}`,...n)}}function kf(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ce(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,d_(t,r,n)}function d_(t,e,n){let r=`FIRESTORE (${Li}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw rr(r),new Error(r)}function Pe(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||d_(e,s,r)}function pe(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ee extends or{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class dC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(St.UNAUTHENTICATED))}shutdown(){}}class hC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class fC{constructor(e){this.t=e,this.currentUser=St.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Pe(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new Mr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Mr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},u=c=>{Z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?u(c):(Z("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Mr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Pe(typeof r.accessToken=="string",31837,{l:r}),new h_(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Pe(e===null||typeof e=="string",2055,{h:e}),new St(e)}}class pC{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=St.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class mC{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new pC(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(St.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Wg{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class gC{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,vn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Pe(this.o===void 0,3512);const r=i=>{i.error!=null&&Z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Wg(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Pe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Wg(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yC(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f_(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=yC(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function _e(t,e){return t<e?-1:t>e?1:0}function ih(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),s=e.codePointAt(n);if(r!==s){if(r<128&&s<128)return _e(r,s);{const i=f_(),o=vC(i.encode(Gg(t,n)),i.encode(Gg(e,n)));return o!==0?o:_e(r,s)}}n+=r>65535?2:1}return _e(t.length,e.length)}function Gg(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function vC(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return _e(t[n],e[n]);return _e(t.length,e.length)}function Ii(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kg="__name__";class Sn{constructor(e,n,r){n===void 0?n=0:n>e.length&&ce(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ce(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Sn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Sn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Sn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return _e(e.length,n.length)}static compareSegments(e,n){const r=Sn.isNumericId(e),s=Sn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Sn.extractNumericId(e).compare(Sn.extractNumericId(n)):ih(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Vr.fromString(e.substring(4,e.length-2))}}class Le extends Sn{construct(e,n,r){return new Le(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ee(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Le(n)}static emptyPath(){return new Le([])}}const xC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class yt extends Sn{construct(e,n,r){return new yt(e,n,r)}static isValidIdentifier(e){return xC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),yt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Kg}static keyField(){return new yt([Kg])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new ee(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const u=e[s];if(u==="\\"){if(s+1===e.length)throw new ee(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ee(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else u==="`"?(o=!o,s++):u!=="."||o?(r+=u,s++):(i(),s++)}if(i(),o)throw new ee(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new yt(n)}static emptyPath(){return new yt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.path=e}static fromPath(e){return new ae(Le.fromString(e))}static fromName(e){return new ae(Le.fromString(e).popFirst(5))}static empty(){return new ae(Le.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Le.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Le.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ae(new Le(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p_(t,e,n){if(!n)throw new ee(U.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function _C(t,e,n,r){if(e===!0&&r===!0)throw new ee(U.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Qg(t){if(!ae.isDocumentKey(t))throw new ee(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Xg(t){if(ae.isDocumentKey(t))throw new ee(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function m_(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Uu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ce(12329,{type:typeof t})}function jn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ee(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Uu(t);throw new ee(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rt(t,e){const n={typeString:t};return e&&(n.value=e),n}function ga(t,e){if(!m_(t))throw new ee(U.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new ee(U.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yg=-62135596800,Jg=1e6;class Ue{static now(){return Ue.fromMillis(Date.now())}static fromDate(e){return Ue.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*Jg);return new Ue(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ee(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ee(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Yg)throw new ee(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ee(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Jg}_compareTo(e){return this.seconds===e.seconds?_e(this.nanoseconds,e.nanoseconds):_e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ue._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ga(e,Ue._jsonSchema))return new Ue(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Yg;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ue._jsonSchemaVersion="firestore/timestamp/1.0",Ue._jsonSchema={type:rt("string",Ue._jsonSchemaVersion),seconds:rt("number"),nanoseconds:rt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{static fromTimestamp(e){return new he(e)}static min(){return new he(new Ue(0,0))}static max(){return new he(new Ue(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo=-1;function wC(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=he.fromTimestamp(r===1e9?new Ue(n+1,0):new Ue(n,r));return new Wr(s,ae.empty(),e)}function EC(t){return new Wr(t.readTime,t.key,Yo)}class Wr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Wr(he.min(),ae.empty(),Yo)}static max(){return new Wr(he.max(),ae.empty(),Yo)}}function bC(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ae.comparator(t.documentKey,e.documentKey),n!==0?n:_e(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class IC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vi(t){if(t.code!==U.FAILED_PRECONDITION||t.message!==TC)throw t;Z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ce(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new $((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof $?n:$.resolve(n)}catch(n){return $.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):$.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):$.reject(n)}static resolve(e){return new $((n,r)=>{n(e)})}static reject(e){return new $((n,r)=>{r(e)})}static waitFor(e){return new $((n,r)=>{let s=0,i=0,o=!1;e.forEach(u=>{++s,u.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=$.resolve(!1);for(const r of e)n=n.next(s=>s?$.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new $((r,s)=>{const i=e.length,o=new Array(i);let u=0;for(let c=0;c<i;c++){const d=c;n(e[d]).next(f=>{o[d]=f,++u,u===i&&r(o)},f=>s(f))}})}static doWhile(e,n){return new $((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function NC(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Mi(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}zu.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pf=-1;function Bu(t){return t==null}function uu(t){return t===0&&1/t==-1/0}function SC(t){return typeof t=="number"&&Number.isInteger(t)&&!uu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g_="";function CC(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Zg(e)),e=kC(t.get(n),e);return Zg(e)}function kC(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case g_:n+="";break;default:n+=i}}return n}function Zg(t){return t+g_+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ey(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ts(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function y_(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e,n){this.comparator=e,this.root=n||gt.EMPTY}insert(e,n){return new Ke(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,gt.BLACK,null,null))}remove(e){return new Ke(this.comparator,this.root.remove(e,this.comparator).copy(null,null,gt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sl(this.root,e,this.comparator,!1)}getReverseIterator(){return new sl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sl(this.root,e,this.comparator,!0)}}class sl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class gt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??gt.RED,this.left=s??gt.EMPTY,this.right=i??gt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new gt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return gt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return gt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,gt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,gt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ce(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ce(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ce(27949);return e+(this.isRed()?0:1)}}gt.EMPTY=null,gt.RED=!0,gt.BLACK=!1;gt.EMPTY=new class{constructor(){this.size=0}get key(){throw ce(57766)}get value(){throw ce(16141)}get color(){throw ce(16727)}get left(){throw ce(29726)}get right(){throw ce(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new gt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e){this.comparator=e,this.data=new Ke(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new ty(this.data.getIterator())}getIteratorFrom(e){return new ty(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof ut)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ut(this.comparator);return n.data=e,n}}class ty{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.fields=e,e.sort(yt.comparator)}static empty(){return new Zt([])}unionWith(e){let n=new ut(yt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Zt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ii(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new v_("Invalid base64 string: "+i):i}}(e);return new _t(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new _t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return _e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_t.EMPTY_BYTE_STRING=new _t("");const AC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gr(t){if(Pe(!!t,39018),typeof t=="string"){let e=0;const n=AC.exec(t);if(Pe(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ye(t.seconds),nanos:Ye(t.nanos)}}function Ye(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Kr(t){return typeof t=="string"?_t.fromBase64String(t):_t.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x_="server_timestamp",__="__type__",w_="__previous_value__",E_="__local_write_time__";function Rf(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[__])===null||n===void 0?void 0:n.stringValue)===x_}function $u(t){const e=t.mapValue.fields[w_];return Rf(e)?$u(e):e}function Jo(t){const e=Gr(t.mapValue.fields[E_].timestampValue);return new Ue(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e,n,r,s,i,o,u,c,d,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=f}}const cu="(default)";class Zo{constructor(e,n){this.projectId=e,this.database=n||cu}static empty(){return new Zo("","")}get isDefaultDatabase(){return this.database===cu}isEqual(e){return e instanceof Zo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b_="__type__",RC="__max__",il={mapValue:{}},T_="__vector__",du="value";function Qr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Rf(t)?4:DC(t)?9007199254740991:jC(t)?10:11:ce(28295,{value:t})}function Mn(t,e){if(t===e)return!0;const n=Qr(t);if(n!==Qr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Jo(t).isEqual(Jo(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Gr(s.timestampValue),u=Gr(i.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Kr(s.bytesValue).isEqual(Kr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Ye(s.geoPointValue.latitude)===Ye(i.geoPointValue.latitude)&&Ye(s.geoPointValue.longitude)===Ye(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ye(s.integerValue)===Ye(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Ye(s.doubleValue),u=Ye(i.doubleValue);return o===u?uu(o)===uu(u):isNaN(o)&&isNaN(u)}return!1}(t,e);case 9:return Ii(t.arrayValue.values||[],e.arrayValue.values||[],Mn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},u=i.mapValue.fields||{};if(ey(o)!==ey(u))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(u[c]===void 0||!Mn(o[c],u[c])))return!1;return!0}(t,e);default:return ce(52216,{left:t})}}function ea(t,e){return(t.values||[]).find(n=>Mn(n,e))!==void 0}function Ni(t,e){if(t===e)return 0;const n=Qr(t),r=Qr(e);if(n!==r)return _e(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return _e(t.booleanValue,e.booleanValue);case 2:return function(i,o){const u=Ye(i.integerValue||i.doubleValue),c=Ye(o.integerValue||o.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(t,e);case 3:return ny(t.timestampValue,e.timestampValue);case 4:return ny(Jo(t),Jo(e));case 5:return ih(t.stringValue,e.stringValue);case 6:return function(i,o){const u=Kr(i),c=Kr(o);return u.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const u=i.split("/"),c=o.split("/");for(let d=0;d<u.length&&d<c.length;d++){const f=_e(u[d],c[d]);if(f!==0)return f}return _e(u.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const u=_e(Ye(i.latitude),Ye(o.latitude));return u!==0?u:_e(Ye(i.longitude),Ye(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return ry(t.arrayValue,e.arrayValue);case 10:return function(i,o){var u,c,d,f;const y=i.fields||{},g=o.fields||{},w=(u=y[du])===null||u===void 0?void 0:u.arrayValue,S=(c=g[du])===null||c===void 0?void 0:c.arrayValue,P=_e(((d=w==null?void 0:w.values)===null||d===void 0?void 0:d.length)||0,((f=S==null?void 0:S.values)===null||f===void 0?void 0:f.length)||0);return P!==0?P:ry(w,S)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===il.mapValue&&o===il.mapValue)return 0;if(i===il.mapValue)return 1;if(o===il.mapValue)return-1;const u=i.fields||{},c=Object.keys(u),d=o.fields||{},f=Object.keys(d);c.sort(),f.sort();for(let y=0;y<c.length&&y<f.length;++y){const g=ih(c[y],f[y]);if(g!==0)return g;const w=Ni(u[c[y]],d[f[y]]);if(w!==0)return w}return _e(c.length,f.length)}(t.mapValue,e.mapValue);default:throw ce(23264,{le:n})}}function ny(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return _e(t,e);const n=Gr(t),r=Gr(e),s=_e(n.seconds,r.seconds);return s!==0?s:_e(n.nanos,r.nanos)}function ry(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ni(n[s],r[s]);if(i)return i}return _e(n.length,r.length)}function Si(t){return oh(t)}function oh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Gr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Kr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ae.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=oh(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${oh(n.fields[o])}`;return s+"}"}(t.mapValue):ce(61005,{value:t})}function Il(t){switch(Qr(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$u(t);return e?16+Il(e):16;case 5:return 2*t.stringValue.length;case 6:return Kr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Il(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return ts(r.fields,(i,o)=>{s+=i.length+Il(o)}),s}(t.mapValue);default:throw ce(13486,{value:t})}}function sy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ah(t){return!!t&&"integerValue"in t}function jf(t){return!!t&&"arrayValue"in t}function iy(t){return!!t&&"nullValue"in t}function oy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Nl(t){return!!t&&"mapValue"in t}function jC(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[b_])===null||n===void 0?void 0:n.stringValue)===T_}function Co(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ts(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Co(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Co(t.arrayValue.values[n]);return e}return Object.assign({},t)}function DC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===RC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e){this.value=e}static empty(){return new qt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Nl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Co(n)}setAll(e){let n=yt.emptyPath(),r={},s=[];e.forEach((o,u)=>{if(!n.isImmediateParentOf(u)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=u.popLast()}o?r[u.lastSegment()]=Co(o):s.push(u.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Nl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Mn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Nl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ts(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new qt(Co(this.value))}}function I_(t){const e=[];return ts(t.fields,(n,r)=>{const s=new yt([n]);if(Nl(r)){const i=I_(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Zt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e,n,r,s,i,o,u){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=u}static newInvalidDocument(e){return new kt(e,0,he.min(),he.min(),he.min(),qt.empty(),0)}static newFoundDocument(e,n,r,s){return new kt(e,1,n,he.min(),r,s,0)}static newNoDocument(e,n){return new kt(e,2,n,he.min(),he.min(),qt.empty(),0)}static newUnknownDocument(e,n){return new kt(e,3,n,he.min(),he.min(),qt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(he.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=he.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof kt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new kt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e,n){this.position=e,this.inclusive=n}}function ay(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ae.comparator(ae.fromName(o.referenceValue),n.key):r=Ni(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function ly(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Mn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(e,n="asc"){this.field=e,this.dir=n}}function OC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{}class nt extends N_{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new VC(e,n,r):n==="array-contains"?new UC(e,r):n==="in"?new zC(e,r):n==="not-in"?new BC(e,r):n==="array-contains-any"?new $C(e,r):new nt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new MC(e,r):new FC(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ni(n,this.value)):n!==null&&Qr(this.value)===Qr(n)&&this.matchesComparison(Ni(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ce(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Tn extends N_{constructor(e,n){super(),this.filters=e,this.op=n,this.he=null}static create(e,n){return new Tn(e,n)}matches(e){return S_(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function S_(t){return t.op==="and"}function C_(t){return LC(t)&&S_(t)}function LC(t){for(const e of t.filters)if(e instanceof Tn)return!1;return!0}function lh(t){if(t instanceof nt)return t.field.canonicalString()+t.op.toString()+Si(t.value);if(C_(t))return t.filters.map(e=>lh(e)).join(",");{const e=t.filters.map(n=>lh(n)).join(",");return`${t.op}(${e})`}}function k_(t,e){return t instanceof nt?function(r,s){return s instanceof nt&&r.op===s.op&&r.field.isEqual(s.field)&&Mn(r.value,s.value)}(t,e):t instanceof Tn?function(r,s){return s instanceof Tn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,u)=>i&&k_(o,s.filters[u]),!0):!1}(t,e):void ce(19439)}function A_(t){return t instanceof nt?function(n){return`${n.field.canonicalString()} ${n.op} ${Si(n.value)}`}(t):t instanceof Tn?function(n){return n.op.toString()+" {"+n.getFilters().map(A_).join(" ,")+"}"}(t):"Filter"}class VC extends nt{constructor(e,n,r){super(e,n,r),this.key=ae.fromName(r.referenceValue)}matches(e){const n=ae.comparator(e.key,this.key);return this.matchesComparison(n)}}class MC extends nt{constructor(e,n){super(e,"in",n),this.keys=P_("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class FC extends nt{constructor(e,n){super(e,"not-in",n),this.keys=P_("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function P_(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ae.fromName(r.referenceValue))}class UC extends nt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return jf(n)&&ea(n.arrayValue,this.value)}}class zC extends nt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ea(this.value.arrayValue,n)}}class BC extends nt{constructor(e,n){super(e,"not-in",n)}matches(e){if(ea(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!ea(this.value.arrayValue,n)}}class $C extends nt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!jf(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ea(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e,n=null,r=[],s=[],i=null,o=null,u=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=u,this.Pe=null}}function uy(t,e=null,n=[],r=[],s=null,i=null,o=null){return new qC(t,e,n,r,s,i,o)}function Df(t){const e=pe(t);if(e.Pe===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>lh(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Bu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Si(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Si(r)).join(",")),e.Pe=n}return e.Pe}function Of(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!OC(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!k_(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ly(t.startAt,e.startAt)&&ly(t.endAt,e.endAt)}function uh(t){return ae.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e,n=null,r=[],s=[],i=null,o="F",u=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=u,this.endAt=c,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function HC(t,e,n,r,s,i,o,u){return new ya(t,e,n,r,s,i,o,u)}function Lf(t){return new ya(t)}function cy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function R_(t){return t.collectionGroup!==null}function ko(t){const e=pe(t);if(e.Te===null){e.Te=[];const n=new Set;for(const i of e.explicitOrderBy)e.Te.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new ut(yt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Te.push(new fu(i,r))}),n.has(yt.keyField().canonicalString())||e.Te.push(new fu(yt.keyField(),r))}return e.Te}function Dn(t){const e=pe(t);return e.Ie||(e.Ie=WC(e,ko(t))),e.Ie}function WC(t,e){if(t.limitType==="F")return uy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new fu(s.field,i)});const n=t.endAt?new hu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new hu(t.startAt.position,t.startAt.inclusive):null;return uy(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function ch(t,e){const n=t.filters.concat([e]);return new ya(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function dh(t,e,n){return new ya(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function qu(t,e){return Of(Dn(t),Dn(e))&&t.limitType===e.limitType}function j_(t){return`${Df(Dn(t))}|lt:${t.limitType}`}function $s(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>A_(s)).join(", ")}]`),Bu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Si(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Si(s)).join(",")),`Target(${r})`}(Dn(t))}; limitType=${t.limitType})`}function Hu(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ae.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of ko(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,u,c){const d=ay(o,u,c);return o.inclusive?d<=0:d<0}(r.startAt,ko(r),s)||r.endAt&&!function(o,u,c){const d=ay(o,u,c);return o.inclusive?d>=0:d>0}(r.endAt,ko(r),s))}(t,e)}function GC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function D_(t){return(e,n)=>{let r=!1;for(const s of ko(t)){const i=KC(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function KC(t,e,n){const r=t.field.isKeyField()?ae.comparator(e.key,n.key):function(i,o,u){const c=o.data.field(i),d=u.data.field(i);return c!==null&&d!==null?Ni(c,d):ce(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ce(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ts(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return y_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC=new Ke(ae.comparator);function sr(){return QC}const O_=new Ke(ae.comparator);function po(...t){let e=O_;for(const n of t)e=e.insert(n.key,n);return e}function L_(t){let e=O_;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function fs(){return Ao()}function V_(){return Ao()}function Ao(){return new Rs(t=>t.toString(),(t,e)=>t.isEqual(e))}const XC=new Ke(ae.comparator),YC=new ut(ae.comparator);function Ee(...t){let e=YC;for(const n of t)e=e.add(n);return e}const JC=new ut(_e);function ZC(){return JC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vf(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:uu(e)?"-0":e}}function M_(t){return{integerValue:""+t}}function F_(t,e){return SC(e)?M_(e):Vf(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(){this._=void 0}}function ek(t,e,n){return t instanceof ta?function(s,i){const o={fields:{[__]:{stringValue:x_},[E_]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Rf(i)&&(i=$u(i)),i&&(o.fields[w_]=i),{mapValue:o}}(n,e):t instanceof na?z_(t,e):t instanceof ra?B_(t,e):function(s,i){const o=U_(s,i),u=dy(o)+dy(s.Ee);return ah(o)&&ah(s.Ee)?M_(u):Vf(s.serializer,u)}(t,e)}function tk(t,e,n){return t instanceof na?z_(t,e):t instanceof ra?B_(t,e):n}function U_(t,e){return t instanceof sa?function(r){return ah(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ta extends Wu{}class na extends Wu{constructor(e){super(),this.elements=e}}function z_(t,e){const n=$_(e);for(const r of t.elements)n.some(s=>Mn(s,r))||n.push(r);return{arrayValue:{values:n}}}class ra extends Wu{constructor(e){super(),this.elements=e}}function B_(t,e){let n=$_(e);for(const r of t.elements)n=n.filter(s=>!Mn(s,r));return{arrayValue:{values:n}}}class sa extends Wu{constructor(e,n){super(),this.serializer=e,this.Ee=n}}function dy(t){return Ye(t.integerValue||t.doubleValue)}function $_(t){return jf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_{constructor(e,n){this.field=e,this.transform=n}}function nk(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof na&&s instanceof na||r instanceof ra&&s instanceof ra?Ii(r.elements,s.elements,Mn):r instanceof sa&&s instanceof sa?Mn(r.Ee,s.Ee):r instanceof ta&&s instanceof ta}(t.transform,e.transform)}class rk{constructor(e,n){this.version=e,this.transformResults=n}}class En{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new En}static exists(e){return new En(void 0,e)}static updateTime(e){return new En(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Sl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Gu{}function H_(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Mf(t.key,En.none()):new va(t.key,t.data,En.none());{const n=t.data,r=qt.empty();let s=new ut(yt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new ns(t.key,r,new Zt(s.toArray()),En.none())}}function sk(t,e,n){t instanceof va?function(s,i,o){const u=s.value.clone(),c=fy(s.fieldTransforms,i,o.transformResults);u.setAll(c),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):t instanceof ns?function(s,i,o){if(!Sl(s.precondition,i))return void i.convertToUnknownDocument(o.version);const u=fy(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(W_(s)),c.setAll(u),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Po(t,e,n,r){return t instanceof va?function(i,o,u,c){if(!Sl(i.precondition,o))return u;const d=i.value.clone(),f=py(i.fieldTransforms,c,o);return d.setAll(f),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof ns?function(i,o,u,c){if(!Sl(i.precondition,o))return u;const d=py(i.fieldTransforms,c,o),f=o.data;return f.setAll(W_(i)),f.setAll(d),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),u===null?null:u.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(y=>y.field))}(t,e,n,r):function(i,o,u){return Sl(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u}(t,e,n)}function ik(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=U_(r.transform,s||null);i!=null&&(n===null&&(n=qt.empty()),n.set(r.field,i))}return n||null}function hy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ii(r,s,(i,o)=>nk(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class va extends Gu{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ns extends Gu{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function W_(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function fy(t,e,n){const r=new Map;Pe(t.length===n.length,32656,{Ae:n.length,Re:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,u=e.data.field(i.field);r.set(i.field,tk(o,u,n[s]))}return r}function py(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,ek(i,o,e))}return r}class Mf extends Gu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ok extends Gu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&sk(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Po(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Po(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=V_();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let u=this.applyToLocalView(o,i.mutatedFields);u=n.has(s.key)?null:u;const c=H_(o,u);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(he.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ee())}isEqual(e){return this.batchId===e.batchId&&Ii(this.mutations,e.mutations,(n,r)=>hy(n,r))&&Ii(this.baseMutations,e.baseMutations,(n,r)=>hy(n,r))}}class Ff{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Pe(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let s=function(){return XC}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Ff(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var et,Ne;function ck(t){switch(t){case U.OK:return ce(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return ce(15467,{code:t})}}function G_(t){if(t===void 0)return rr("GRPC error has no .code"),U.UNKNOWN;switch(t){case et.OK:return U.OK;case et.CANCELLED:return U.CANCELLED;case et.UNKNOWN:return U.UNKNOWN;case et.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case et.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case et.INTERNAL:return U.INTERNAL;case et.UNAVAILABLE:return U.UNAVAILABLE;case et.UNAUTHENTICATED:return U.UNAUTHENTICATED;case et.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case et.NOT_FOUND:return U.NOT_FOUND;case et.ALREADY_EXISTS:return U.ALREADY_EXISTS;case et.PERMISSION_DENIED:return U.PERMISSION_DENIED;case et.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case et.ABORTED:return U.ABORTED;case et.OUT_OF_RANGE:return U.OUT_OF_RANGE;case et.UNIMPLEMENTED:return U.UNIMPLEMENTED;case et.DATA_LOSS:return U.DATA_LOSS;default:return ce(39323,{code:t})}}(Ne=et||(et={}))[Ne.OK=0]="OK",Ne[Ne.CANCELLED=1]="CANCELLED",Ne[Ne.UNKNOWN=2]="UNKNOWN",Ne[Ne.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ne[Ne.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ne[Ne.NOT_FOUND=5]="NOT_FOUND",Ne[Ne.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ne[Ne.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ne[Ne.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ne[Ne.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ne[Ne.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ne[Ne.ABORTED=10]="ABORTED",Ne[Ne.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ne[Ne.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ne[Ne.INTERNAL=13]="INTERNAL",Ne[Ne.UNAVAILABLE=14]="UNAVAILABLE",Ne[Ne.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dk=new Vr([4294967295,4294967295],0);function my(t){const e=f_().encode(t),n=new i_;return n.update(e),new Uint8Array(n.digest())}function gy(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Vr([n,r],0),new Vr([s,i],0)]}class Uf{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new mo(`Invalid padding: ${n}`);if(r<0)throw new mo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new mo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new mo(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*e.length-n,this.ge=Vr.fromNumber(this.fe)}pe(e,n,r){let s=e.add(n.multiply(Vr.fromNumber(r)));return s.compare(dk)===1&&(s=new Vr([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const n=my(e),[r,s]=gy(n);for(let i=0;i<this.hashCount;i++){const o=this.pe(r,s,i);if(!this.ye(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Uf(i,s,n);return r.forEach(u=>o.insert(u)),o}insert(e){if(this.fe===0)return;const n=my(e),[r,s]=gy(n);for(let i=0;i<this.hashCount;i++){const o=this.pe(r,s,i);this.we(o)}}we(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class mo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,xa.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Ku(he.min(),s,new Ke(_e),sr(),Ee())}}class xa{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new xa(r,n,Ee(),Ee(),Ee())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(e,n,r,s){this.Se=e,this.removedTargetIds=n,this.key=r,this.be=s}}class K_{constructor(e,n){this.targetId=e,this.De=n}}class Q_{constructor(e,n,r=_t.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class yy{constructor(){this.ve=0,this.Ce=vy(),this.Fe=_t.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Ee(),n=Ee(),r=Ee();return this.Ce.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ce(38017,{changeType:i})}}),new xa(this.Fe,this.Me,e,n,r)}ke(){this.xe=!1,this.Ce=vy()}qe(e,n){this.xe=!0,this.Ce=this.Ce.insert(e,n)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Pe(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class hk{constructor(e){this.We=e,this.Ge=new Map,this.ze=sr(),this.je=ol(),this.Je=ol(),this.He=new Ke(_e)}Ye(e){for(const n of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(n,e.be):this.Xe(n,e.key,e.be);for(const n of e.removedTargetIds)this.Xe(n,e.key,e.be)}et(e){this.forEachTarget(e,n=>{const r=this.tt(n);switch(e.state){case 0:this.nt(n)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(e.resumeToken));break;default:ce(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ge.forEach((r,s)=>{this.nt(s)&&n(s)})}it(e){const n=e.targetId,r=e.De.count,s=this.st(n);if(s){const i=s.target;if(uh(i))if(r===0){const o=new ae(i.path);this.Xe(n,o,kt.newNoDocument(o,he.min()))}else Pe(r===1,20013,{expectedCount:r});else{const o=this.ot(n);if(o!==r){const u=this._t(e),c=u?this.ut(u,e,o):1;if(c!==0){this.rt(n);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,d)}}}}}_t(e){const n=e.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,u;try{o=Kr(r).toUint8Array()}catch(c){if(c instanceof v_)return Hr("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new Uf(o,s,i)}catch(c){return Hr(c instanceof mo?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.fe===0?null:u}ut(e,n,r){return n.De.count===r-this.ht(e,n.targetId)?0:2}ht(e,n){const r=this.We.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.We.lt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(u)||(this.Xe(n,i,null),s++)}),s}Pt(e){const n=new Map;this.Ge.forEach((i,o)=>{const u=this.st(o);if(u){if(i.current&&uh(u.target)){const c=new ae(u.target.path);this.Tt(c).has(o)||this.It(o,c)||this.Xe(o,c,kt.newNoDocument(c,e))}i.Ne&&(n.set(o,i.Le()),i.ke())}});let r=Ee();this.Je.forEach((i,o)=>{let u=!0;o.forEachWhile(c=>{const d=this.st(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(i))}),this.ze.forEach((i,o)=>o.setReadTime(e));const s=new Ku(e,n,this.He,this.ze,r);return this.ze=sr(),this.je=ol(),this.Je=ol(),this.He=new Ke(_e),s}Ze(e,n){if(!this.nt(e))return;const r=this.It(e,n.key)?2:0;this.tt(e).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(e)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(e))}Xe(e,n,r){if(!this.nt(e))return;const s=this.tt(e);this.It(e,n)?s.qe(n,1):s.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(e)),this.Je=this.Je.insert(n,this.dt(n).add(e)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const n=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let n=this.Ge.get(e);return n||(n=new yy,this.Ge.set(e,n)),n}dt(e){let n=this.Je.get(e);return n||(n=new ut(_e),this.Je=this.Je.insert(e,n)),n}Tt(e){let n=this.je.get(e);return n||(n=new ut(_e),this.je=this.je.insert(e,n)),n}nt(e){const n=this.st(e)!==null;return n||Z("WatchChangeAggregator","Detected inactive target",e),n}st(e){const n=this.Ge.get(e);return n&&n.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new yy),this.We.getRemoteKeysForTarget(e).forEach(n=>{this.Xe(e,n,null)})}It(e,n){return this.We.getRemoteKeysForTarget(e).has(n)}}function ol(){return new Ke(ae.comparator)}function vy(){return new Ke(ae.comparator)}const fk={asc:"ASCENDING",desc:"DESCENDING"},pk={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mk={and:"AND",or:"OR"};class gk{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function hh(t,e){return t.useProto3Json||Bu(e)?e:{value:e}}function pu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function X_(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function yk(t,e){return pu(t,e.toTimestamp())}function On(t){return Pe(!!t,49232),he.fromTimestamp(function(n){const r=Gr(n);return new Ue(r.seconds,r.nanos)}(t))}function zf(t,e){return fh(t,e).canonicalString()}function fh(t,e){const n=function(s){return new Le(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Y_(t){const e=Le.fromString(t);return Pe(nw(e),10190,{key:e.toString()}),e}function ph(t,e){return zf(t.databaseId,e.path)}function Zc(t,e){const n=Y_(e);if(n.get(1)!==t.databaseId.projectId)throw new ee(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ee(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ae(Z_(n))}function J_(t,e){return zf(t.databaseId,e)}function vk(t){const e=Y_(t);return e.length===4?Le.emptyPath():Z_(e)}function mh(t){return new Le(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Z_(t){return Pe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function xy(t,e,n){return{name:ph(t,e),fields:n.value.mapValue.fields}}function xk(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ce(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(Pe(f===void 0||typeof f=="string",58123),_t.fromBase64String(f||"")):(Pe(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),_t.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&function(d){const f=d.code===void 0?U.UNKNOWN:G_(d.code);return new ee(f,d.message||"")}(o);n=new Q_(r,s,i,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Zc(t,r.document.name),i=On(r.document.updateTime),o=r.document.createTime?On(r.document.createTime):he.min(),u=new qt({mapValue:{fields:r.document.fields}}),c=kt.newFoundDocument(s,i,o,u),d=r.targetIds||[],f=r.removedTargetIds||[];n=new Cl(d,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Zc(t,r.document),i=r.readTime?On(r.readTime):he.min(),o=kt.newNoDocument(s,i),u=r.removedTargetIds||[];n=new Cl([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Zc(t,r.document),i=r.removedTargetIds||[];n=new Cl([],i,s,null)}else{if(!("filter"in e))return ce(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new uk(s,i),u=r.targetId;n=new K_(u,o)}}return n}function _k(t,e){let n;if(e instanceof va)n={update:xy(t,e.key,e.value)};else if(e instanceof Mf)n={delete:ph(t,e.key)};else if(e instanceof ns)n={update:xy(t,e.key,e.data),updateMask:kk(e.fieldMask)};else{if(!(e instanceof ok))return ce(16599,{Rt:e.type});n={verify:ph(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const u=o.transform;if(u instanceof ta)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof na)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof ra)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof sa)return{fieldPath:o.field.canonicalString(),increment:u.Ee};throw ce(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:yk(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ce(27497)}(t,e.precondition)),n}function wk(t,e){return t&&t.length>0?(Pe(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?On(s.updateTime):On(i);return o.isEqual(he.min())&&(o=On(i)),new rk(o,s.transformResults||[])}(n,e))):[]}function Ek(t,e){return{documents:[J_(t,e.path)]}}function bk(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=J_(t,s);const i=function(d){if(d.length!==0)return tw(Tn.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(f=>function(g){return{field:qs(g.field),direction:Nk(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const u=hh(t,e.limit);return u!==null&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{Vt:n,parent:s}}function Tk(t){let e=vk(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Pe(r===1,65062);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(y){const g=ew(y);return g instanceof Tn&&C_(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(y){return y.map(g=>function(S){return new fu(Hs(S.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(g))}(n.orderBy));let u=null;n.limit&&(u=function(y){let g;return g=typeof y=="object"?y.value:y,Bu(g)?null:g}(n.limit));let c=null;n.startAt&&(c=function(y){const g=!!y.before,w=y.values||[];return new hu(w,g)}(n.startAt));let d=null;return n.endAt&&(d=function(y){const g=!y.before,w=y.values||[];return new hu(w,g)}(n.endAt)),HC(e,s,o,i,u,"F",c,d)}function Ik(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ce(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function ew(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Hs(n.unaryFilter.field);return nt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Hs(n.unaryFilter.field);return nt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Hs(n.unaryFilter.field);return nt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Hs(n.unaryFilter.field);return nt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ce(61313);default:return ce(60726)}}(t):t.fieldFilter!==void 0?function(n){return nt.create(Hs(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ce(58110);default:return ce(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Tn.create(n.compositeFilter.filters.map(r=>ew(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ce(1026)}}(n.compositeFilter.op))}(t):ce(30097,{filter:t})}function Nk(t){return fk[t]}function Sk(t){return pk[t]}function Ck(t){return mk[t]}function qs(t){return{fieldPath:t.canonicalString()}}function Hs(t){return yt.fromServerFormat(t.fieldPath)}function tw(t){return t instanceof nt?function(n){if(n.op==="=="){if(oy(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NAN"}};if(iy(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(oy(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NOT_NAN"}};if(iy(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qs(n.field),op:Sk(n.op),value:n.value}}}(t):t instanceof Tn?function(n){const r=n.getFilters().map(s=>tw(s));return r.length===1?r[0]:{compositeFilter:{op:Ck(n.op),filters:r}}}(t):ce(54877,{filter:t})}function kk(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function nw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e,n,r,s,i=he.min(),o=he.min(),u=_t.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(e){return new Tr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{constructor(e){this.gt=e}}function Pk(t){const e=Tk({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?dh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk{constructor(){this.Dn=new jk}addToCollectionParentIndex(e,n){return this.Dn.add(n),$.resolve()}getCollectionParents(e,n){return $.resolve(this.Dn.getEntries(n))}addFieldIndex(e,n){return $.resolve()}deleteFieldIndex(e,n){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,n){return $.resolve()}getDocumentsMatchingTarget(e,n){return $.resolve(null)}getIndexType(e,n){return $.resolve(0)}getFieldIndexes(e,n){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,n){return $.resolve(Wr.min())}getMinOffsetFromCollectionGroup(e,n){return $.resolve(Wr.min())}updateCollectionGroup(e,n,r){return $.resolve()}updateIndexEntries(e,n){return $.resolve()}}class jk{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new ut(Le.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ut(Le.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _y={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},rw=41943040;class Bt{static withCacheSize(e){return new Bt(e,Bt.DEFAULT_COLLECTION_PERCENTILE,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Bt.DEFAULT_COLLECTION_PERCENTILE=10,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bt.DEFAULT=new Bt(rw,Bt.DEFAULT_COLLECTION_PERCENTILE,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bt.DISABLED=new Bt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new Ci(0)}static ur(){return new Ci(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wy="LruGarbageCollector",Dk=1048576;function Ey([t,e],[n,r]){const s=_e(t,n);return s===0?_e(e,r):s}class Ok{constructor(e){this.Tr=e,this.buffer=new ut(Ey),this.Ir=0}dr(){return++this.Ir}Er(e){const n=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Ey(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Lk{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Z(wy,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Mi(n)?Z(wy,"Ignoring IndexedDB error during garbage collection: ",n):await Vi(n)}await this.Rr(3e5)})}}class Vk{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.mr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return $.resolve(zu.ue);const r=new Ok(n);return this.Vr.forEachTarget(e,s=>r.Er(s.sequenceNumber)).next(()=>this.Vr.gr(e,s=>r.Er(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Z("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(_y)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Z("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),_y):this.pr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,n){let r,s,i,o,u,c,d;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(Z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),s=this.params.maximumSequenceNumbersToCollect):s=y,o=Date.now(),this.nthSequenceNumber(e,s))).next(y=>(r=y,u=Date.now(),this.removeTargets(e,r,n))).next(y=>(i=y,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(y=>(d=Date.now(),Bs()<=we.DEBUG&&Z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${s} in `+(u-o)+`ms
	Removed ${i} targets in `+(c-u)+`ms
	Removed ${y} documents in `+(d-c)+`ms
Total Duration: ${d-f}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:y})))}}function Mk(t,e){return new Vk(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fk{constructor(){this.changes=new Rs(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,kt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?$.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Po(r.mutation,s,Zt.empty(),Ue.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ee()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ee()){const s=fs();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=po();return i.forEach((u,c)=>{o=o.insert(u,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=fs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ee()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,u)=>{n.set(o,u)})})}computeViews(e,n,r,s){let i=sr();const o=Ao(),u=function(){return Ao()}();return n.forEach((c,d)=>{const f=r.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof ns)?i=i.insert(d.key,d):f!==void 0?(o.set(d.key,f.mutation.getFieldMask()),Po(f.mutation,d,f.mutation.getFieldMask(),Ue.now())):o.set(d.key,Zt.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((d,f)=>o.set(d,f)),n.forEach((d,f)=>{var y;return u.set(d,new Uk(f,(y=o.get(d))!==null&&y!==void 0?y:null))}),u))}recalculateAndSaveOverlays(e,n){const r=Ao();let s=new Ke((o,u)=>o-u),i=Ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const u of o)u.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let f=r.get(c)||Zt.empty();f=u.applyToLocalView(d,f),r.set(c,f);const y=(s.get(u.batchId)||Ee()).add(c);s=s.insert(u.batchId,y)})}).next(()=>{const o=[],u=s.getReverseIterator();for(;u.hasNext();){const c=u.getNext(),d=c.key,f=c.value,y=V_();f.forEach(g=>{if(!i.has(g)){const w=H_(n.get(g),r.get(g));w!==null&&y.set(g,w),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,y))}return $.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return ae.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):R_(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):$.resolve(fs());let u=Yo,c=i;return o.next(d=>$.forEach(d,(f,y)=>(u<y.largestBatchId&&(u=y.largestBatchId),i.get(f)?$.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{c=c.insert(f,g)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,c,d,Ee())).next(f=>({batchId:u,changes:L_(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ae(n)).next(r=>{let s=po();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=po();return this.indexManager.getCollectionParents(e,i).next(u=>$.forEach(u,c=>{const d=function(y,g){return new ya(g,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(f=>{f.forEach((y,g)=>{o=o.insert(y,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,d)=>{const f=d.getKey();o.get(f)===null&&(o=o.insert(f,kt.newInvalidDocument(f)))});let u=po();return o.forEach((c,d)=>{const f=i.get(c);f!==void 0&&Po(f.mutation,d,Zt.empty(),Ue.now()),Hu(n,d)&&(u=u.insert(c,d))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,n){return $.resolve(this.Br.get(n))}saveBundleMetadata(e,n){return this.Br.set(n.id,function(s){return{id:s.id,version:s.version,createTime:On(s.createTime)}}(n)),$.resolve()}getNamedQuery(e,n){return $.resolve(this.Lr.get(n))}saveNamedQuery(e,n){return this.Lr.set(n.name,function(s){return{name:s.name,query:Pk(s.bundledQuery),readTime:On(s.readTime)}}(n)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $k{constructor(){this.overlays=new Ke(ae.comparator),this.kr=new Map}getOverlay(e,n){return $.resolve(this.overlays.get(n))}getOverlays(e,n){const r=fs();return $.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.wt(e,n,i)}),$.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.kr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.kr.delete(r)),$.resolve()}getOverlaysForCollection(e,n,r){const s=fs(),i=n.length+1,o=new ae(n.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const c=u.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return $.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ke((d,f)=>d-f);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let f=i.get(d.largestBatchId);f===null&&(f=fs(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const u=fs(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,f)=>u.set(d,f)),!(u.size()>=s)););return $.resolve(u)}wt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.kr.get(s.largestBatchId).delete(r.key);this.kr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new lk(n,r));let i=this.kr.get(n);i===void 0&&(i=Ee(),this.kr.set(n,i)),this.kr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(){this.sessionToken=_t.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(){this.qr=new ut(ct.Qr),this.$r=new ut(ct.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,n){const r=new ct(e,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new ct(e,n))}Gr(e,n){e.forEach(r=>this.removeReference(r,n))}zr(e){const n=new ae(new Le([])),r=new ct(n,e),s=new ct(n,e+1),i=[];return this.$r.forEachInRange([r,s],o=>{this.Wr(o),i.push(o.key)}),i}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const n=new ae(new Le([])),r=new ct(n,e),s=new ct(n,e+1);let i=Ee();return this.$r.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new ct(e,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class ct{constructor(e,n){this.key=e,this.Hr=n}static Qr(e,n){return ae.comparator(e.key,n.key)||_e(e.Hr,n.Hr)}static Ur(e,n){return _e(e.Hr,n.Hr)||ae.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new ut(ct.Qr)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new ak(i,n,r,s);this.mutationQueue.push(o);for(const u of s)this.Yr=this.Yr.add(new ct(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return $.resolve(o)}lookupMutationBatch(e,n){return $.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Xr(r),i=s<0?0:s;return $.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?Pf:this.er-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new ct(n,0),s=new ct(n,Number.POSITIVE_INFINITY),i=[];return this.Yr.forEachInRange([r,s],o=>{const u=this.Zr(o.Hr);i.push(u)}),$.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ut(_e);return n.forEach(s=>{const i=new ct(s,0),o=new ct(s,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([i,o],u=>{r=r.add(u.Hr)})}),$.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ae.isDocumentKey(i)||(i=i.child(""));const o=new ct(new ae(i),0);let u=new ut(_e);return this.Yr.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(u=u.add(c.Hr)),!0)},o),$.resolve(this.ei(u))}ei(e){const n=[];return e.forEach(r=>{const s=this.Zr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Pe(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return $.forEach(n.mutations,s=>{const i=new ct(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,n){const r=new ct(n,0),s=this.Yr.firstAfterOrEqual(r);return $.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}ti(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{constructor(e){this.ni=e,this.docs=function(){return new Ke(ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return $.resolve(r?r.document.mutableCopy():kt.newInvalidDocument(n))}getEntries(e,n){let r=sr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():kt.newInvalidDocument(s))}),$.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=sr();const o=n.path,u=new ae(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){const{key:d,value:{document:f}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||bC(EC(f),r)<=0||(s.has(f.key)||Hu(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return $.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ce(9500)}ri(e,n){return $.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Gk(this)}getSize(e){return $.resolve(this.size)}}class Gk extends Fk{constructor(e){super(),this.Or=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Or.addEntry(e,s)):this.Or.removeEntry(r)}),$.waitFor(n)}getFromCache(e,n){return this.Or.getEntry(e,n)}getAllFromCache(e,n){return this.Or.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e){this.persistence=e,this.ii=new Rs(n=>Df(n),Of),this.lastRemoteSnapshotVersion=he.min(),this.highestTargetId=0,this.si=0,this.oi=new Bf,this.targetCount=0,this._i=Ci.ar()}forEachTarget(e,n){return this.ii.forEach((r,s)=>n(s)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),$.resolve()}hr(e){this.ii.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this._i=new Ci(n),this.highestTargetId=n),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,n){return this.hr(n),this.targetCount+=1,$.resolve()}updateTargetData(e,n){return this.hr(n),$.resolve()}removeTargetData(e,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.ii.forEach((o,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.ii.delete(o),i.push(this.removeMatchingKeysForTargetId(e,u.targetId)),s++)}),$.waitFor(i).next(()=>s)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,n){const r=this.ii.get(n)||null;return $.resolve(r)}addMatchingKeys(e,n,r){return this.oi.Kr(n,r),$.resolve()}removeMatchingKeys(e,n,r){this.oi.Gr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),$.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.oi.zr(n),$.resolve()}getMatchingKeysForTargetId(e,n){const r=this.oi.Jr(n);return $.resolve(r)}containsKey(e,n){return $.resolve(this.oi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(e,n){this.ai={},this.overlays={},this.ui=new zu(0),this.ci=!1,this.ci=!0,this.li=new qk,this.referenceDelegate=e(this),this.hi=new Kk(this),this.indexManager=new Rk,this.remoteDocumentCache=function(s){return new Wk(s)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new Ak(n),this.Ti=new Bk(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new $k,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ai[e.toKey()];return r||(r=new Hk(n,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,n,r){Z("MemoryPersistence","Starting transaction:",e);const s=new Qk(this.ui.next());return this.referenceDelegate.Ii(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ei(e,n){return $.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,n)))}}class Qk extends IC{constructor(e){super(),this.currentSequenceNumber=e}}class $f{constructor(e){this.persistence=e,this.Ai=new Bf,this.Ri=null}static Vi(e){return new $f(e)}get mi(){if(this.Ri)return this.Ri;throw ce(60996)}addReference(e,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),$.resolve()}removeReference(e,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),$.resolve()}markPotentiallyOrphaned(e,n){return this.mi.add(n.toString()),$.resolve()}removeTarget(e,n){this.Ai.zr(n.targetId).forEach(s=>this.mi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.mi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ii(){this.Ri=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.mi,r=>{const s=ae.fromPath(r);return this.fi(e,s).next(i=>{i||n.removeEntry(s,he.min())})}).next(()=>(this.Ri=null,n.apply(e)))}updateLimboDocument(e,n){return this.fi(e,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(e){return 0}fi(e,n){return $.or([()=>$.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class mu{constructor(e,n){this.persistence=e,this.gi=new Rs(r=>CC(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=Mk(this,n)}static Vi(e,n){return new mu(e,n)}Ii(){}di(e){return $.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}mr(e){const n=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}yr(e){let n=0;return this.gr(e,r=>{n++}).next(()=>n)}gr(e,n){return $.forEach(this.gi,(r,s)=>this.Sr(e,r,s).next(i=>i?$.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ri(e,o=>this.Sr(e,o,n).next(u=>{u||(r++,i.removeEntry(o,he.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.gi.set(n,e.currentSequenceNumber),$.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),$.resolve()}removeReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),$.resolve()}updateLimboDocument(e,n){return this.gi.set(n,e.currentSequenceNumber),$.resolve()}Pi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Il(e.data.value)),n}Sr(e,n,r){return $.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.gi.get(n);return $.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Is=r,this.ds=s}static Es(e,n){let r=Ee(),s=Ee();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new qf(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yk{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return WT()?8:NC(Pt())>0?6:4}()}initialize(e,n){this.gs=e,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ps(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ys(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new Xk;return this.ws(e,n,o).next(u=>{if(i.result=u,this.Rs)return this.Ss(e,n,o,u.size)})}).next(()=>i.result)}Ss(e,n,r,s){return r.documentReadCount<this.Vs?(Bs()<=we.DEBUG&&Z("QueryEngine","SDK will not create cache indexes for query:",$s(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),$.resolve()):(Bs()<=we.DEBUG&&Z("QueryEngine","Query:",$s(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.fs*s?(Bs()<=we.DEBUG&&Z("QueryEngine","The SDK decides to create cache indexes for query:",$s(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Dn(n))):$.resolve())}ps(e,n){if(cy(n))return $.resolve(null);let r=Dn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=dh(n,null,"F"),r=Dn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ee(...i);return this.gs.getDocuments(e,o).next(u=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.bs(n,u);return this.Ds(n,d,o,c.readTime)?this.ps(e,dh(n,null,"F")):this.vs(e,d,n,c)}))})))}ys(e,n,r,s){return cy(n)||s.isEqual(he.min())?$.resolve(null):this.gs.getDocuments(e,r).next(i=>{const o=this.bs(n,i);return this.Ds(n,o,r,s)?$.resolve(null):(Bs()<=we.DEBUG&&Z("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),$s(n)),this.vs(e,o,n,wC(s,Yo)).next(u=>u))})}bs(e,n){let r=new ut(D_(e));return n.forEach((s,i)=>{Hu(e,i)&&(r=r.add(i))}),r}Ds(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ws(e,n,r){return Bs()<=we.DEBUG&&Z("QueryEngine","Using full collection scan to execute query:",$s(n)),this.gs.getDocumentsMatchingQuery(e,n,Wr.min(),r)}vs(e,n,r,s){return this.gs.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf="LocalStore",Jk=3e8;class Zk{constructor(e,n,r,s){this.persistence=e,this.Cs=n,this.serializer=s,this.Fs=new Ke(_e),this.Ms=new Rs(i=>Df(i),Of),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new zk(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Fs))}}function eA(t,e,n,r){return new Zk(t,e,n,r)}async function iw(t,e){const n=pe(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Ns(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],u=[];let c=Ee();for(const d of s){o.push(d.batchId);for(const f of d.mutations)c=c.add(f.key)}for(const d of i){u.push(d.batchId);for(const f of d.mutations)c=c.add(f.key)}return n.localDocuments.getDocuments(r,c).next(d=>({Bs:d,removedBatchIds:o,addedBatchIds:u}))})})}function tA(t,e){const n=pe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Os.newChangeBuffer({trackRemovals:!0});return function(u,c,d,f){const y=d.batch,g=y.keys();let w=$.resolve();return g.forEach(S=>{w=w.next(()=>f.getEntry(c,S)).next(P=>{const R=d.docVersions.get(S);Pe(R!==null,48541),P.version.compareTo(R)<0&&(y.applyToRemoteDocument(P,d),P.isValidDocument()&&(P.setReadTime(d.commitVersion),f.addEntry(P)))})}),w.next(()=>u.mutationQueue.removeMutationBatch(c,y))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let c=Ee();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(c=c.add(u.batch.mutations[d].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function ow(t){const e=pe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.hi.getLastRemoteSnapshotVersion(n))}function nA(t,e){const n=pe(t),r=e.snapshotVersion;let s=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Os.newChangeBuffer({trackRemovals:!0});s=n.Fs;const u=[];e.targetChanges.forEach((f,y)=>{const g=s.get(y);if(!g)return;u.push(n.hi.removeMatchingKeys(i,f.removedDocuments,y).next(()=>n.hi.addMatchingKeys(i,f.addedDocuments,y)));let w=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(y)!==null?w=w.withResumeToken(_t.EMPTY_BYTE_STRING,he.min()).withLastLimboFreeSnapshotVersion(he.min()):f.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(f.resumeToken,r)),s=s.insert(y,w),function(P,R,b){return P.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=Jk?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(g,w,f)&&u.push(n.hi.updateTargetData(i,w))});let c=sr(),d=Ee();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),u.push(rA(i,o,e.documentUpdates).next(f=>{c=f.Ls,d=f.ks})),!r.isEqual(he.min())){const f=n.hi.getLastRemoteSnapshotVersion(i).next(y=>n.hi.setTargetsMetadata(i,i.currentSequenceNumber,r));u.push(f)}return $.waitFor(u).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,d)).next(()=>c)}).then(i=>(n.Fs=s,i))}function rA(t,e,n){let r=Ee(),s=Ee();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=sr();return n.forEach((u,c)=>{const d=i.get(u);c.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(u)),c.isNoDocument()&&c.version.isEqual(he.min())?(e.removeEntry(u,c.readTime),o=o.insert(u,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(u,c)):Z(Hf,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",c.version)}),{Ls:o,ks:s}})}function sA(t,e){const n=pe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Pf),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function iA(t,e){const n=pe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.hi.getTargetData(r,e).next(i=>i?(s=i,$.resolve(s)):n.hi.allocateTargetId(r).next(o=>(s=new Tr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Fs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(e,r.targetId)),r})}async function gh(t,e,n){const r=pe(t),s=r.Fs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Mi(o))throw o;Z(Hf,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(s.target)}function by(t,e,n){const r=pe(t);let s=he.min(),i=Ee();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,f){const y=pe(c),g=y.Ms.get(f);return g!==void 0?$.resolve(y.Fs.get(g)):y.hi.getTargetData(d,f)}(r,o,Dn(e)).next(u=>{if(u)return s=u.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,u.targetId).next(c=>{i=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?s:he.min(),n?i:Ee())).next(u=>(oA(r,GC(e),u),{documents:u,qs:i})))}function oA(t,e,n){let r=t.xs.get(e)||he.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.xs.set(e,r)}class Ty{constructor(){this.activeTargetIds=ZC()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class aA{constructor(){this.Fo=new Ty,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,n,r){this.Mo[e]=n}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Ty,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iy="ConnectivityMonitor";class Ny{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Z(Iy,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Z(Iy,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let al=null;function yh(){return al===null?al=function(){return 268435456+Math.round(2147483648*Math.random())}():al++,"0x"+al.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ed="RestConnection",uA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class cA{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.Ko=this.databaseId.database===cu?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,n,r,s,i){const o=yh(),u=this.Go(e,n.toUriEncodedString());Z(ed,`Sending RPC '${e}' ${o}:`,u,r);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(c,s,i);const{host:d}=new URL(u),f=ji(d);return this.jo(e,u,c,r,f).then(y=>(Z(ed,`Received RPC '${e}' ${o}: `,y),y),y=>{throw Hr(ed,`RPC '${e}' ${o} failed with error: `,y,"url: ",u,"request:",r),y})}Jo(e,n,r,s,i,o){return this.Wo(e,n,r,s,i)}zo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Li}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}Go(e,n){const r=uA[e];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dA{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nt="WebChannelConnection";class hA extends cA{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,n,r,s,i){const o=yh();return new Promise((u,c)=>{const d=new o_;d.setWithCredentials(!0),d.listenOnce(a_.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Tl.NO_ERROR:const y=d.getResponseJson();Z(Nt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(y)),u(y);break;case Tl.TIMEOUT:Z(Nt,`RPC '${e}' ${o} timed out`),c(new ee(U.DEADLINE_EXCEEDED,"Request time out"));break;case Tl.HTTP_ERROR:const g=d.getStatus();if(Z(Nt,`RPC '${e}' ${o} failed with status:`,g,"response text:",d.getResponseText()),g>0){let w=d.getResponseJson();Array.isArray(w)&&(w=w[0]);const S=w==null?void 0:w.error;if(S&&S.status&&S.message){const P=function(b){const x=b.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(x)>=0?x:U.UNKNOWN}(S.status);c(new ee(P,S.message))}else c(new ee(U.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new ee(U.UNAVAILABLE,"Connection failed."));break;default:ce(9055,{c_:e,streamId:o,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{Z(Nt,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(s);Z(Nt,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",f,r,15)})}P_(e,n,r){const s=yh(),i=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=c_(),u=u_(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.zo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const f=i.join("");Z(Nt,`Creating RPC '${e}' stream ${s}: ${f}`,c);const y=o.createWebChannel(f,c);this.T_(y);let g=!1,w=!1;const S=new dA({Ho:R=>{w?Z(Nt,`Not sending because RPC '${e}' stream ${s} is closed:`,R):(g||(Z(Nt,`Opening RPC '${e}' stream ${s} transport.`),y.open(),g=!0),Z(Nt,`RPC '${e}' stream ${s} sending:`,R),y.send(R))},Yo:()=>y.close()}),P=(R,b,x)=>{R.listen(b,I=>{try{x(I)}catch(j){setTimeout(()=>{throw j},0)}})};return P(y,fo.EventType.OPEN,()=>{w||(Z(Nt,`RPC '${e}' stream ${s} transport opened.`),S.s_())}),P(y,fo.EventType.CLOSE,()=>{w||(w=!0,Z(Nt,`RPC '${e}' stream ${s} transport closed`),S.__(),this.I_(y))}),P(y,fo.EventType.ERROR,R=>{w||(w=!0,Hr(Nt,`RPC '${e}' stream ${s} transport errored. Name:`,R.name,"Message:",R.message),S.__(new ee(U.UNAVAILABLE,"The operation could not be completed")))}),P(y,fo.EventType.MESSAGE,R=>{var b;if(!w){const x=R.data[0];Pe(!!x,16349);const I=x,j=(I==null?void 0:I.error)||((b=I[0])===null||b===void 0?void 0:b.error);if(j){Z(Nt,`RPC '${e}' stream ${s} received error:`,j);const M=j.status;let V=function(v){const _=et[v];if(_!==void 0)return G_(_)}(M),T=j.message;V===void 0&&(V=U.INTERNAL,T="Unknown error status: "+M+" with message "+j.message),w=!0,S.__(new ee(V,T)),y.close()}else Z(Nt,`RPC '${e}' stream ${s} received:`,x),S.a_(x)}}),P(u,l_.STAT_EVENT,R=>{R.stat===sh.PROXY?Z(Nt,`RPC '${e}' stream ${s} detected buffering proxy`):R.stat===sh.NOPROXY&&Z(Nt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{S.o_()},0),S}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(n=>n===e)}}function td(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qu(t){return new gk(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Fi=e,this.timerId=n,this.d_=r,this.E_=s,this.A_=i,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),s=Math.max(0,n-r);s>0&&Z("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,s,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sy="PersistentStream";class lw{constructor(e,n,r,s,i,o,u,c){this.Fi=e,this.w_=r,this.S_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new aw(e,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():n&&n.code===U.RESOURCE_EXHAUSTED?(rr(n.toString()),rr("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(n)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.b_===n&&this.W_(r,s)},r=>{e(()=>{const s=new ee(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(s)})})}W_(e,n){const r=this.K_(this.b_);this.stream=this.z_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(s=>{r(()=>this.G_(s))}),this.stream.onMessage(s=>{r(()=>++this.C_==1?this.j_(s):this.onNext(s))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return Z(Sy,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return n=>{this.Fi.enqueueAndForget(()=>this.b_===e?n():(Z(Sy,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class fA extends lw{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}z_(e,n){return this.connection.P_("Listen",e,n)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const n=xk(this.serializer,e),r=function(i){if(!("targetChange"in i))return he.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?he.min():o.readTime?On(o.readTime):he.min()}(e);return this.listener.J_(n,r)}H_(e){const n={};n.database=mh(this.serializer),n.addTarget=function(i,o){let u;const c=o.target;if(u=uh(c)?{documents:Ek(i,c)}:{query:bk(i,c).Vt},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=X_(i,o.resumeToken);const d=hh(i,o.expectedCount);d!==null&&(u.expectedCount=d)}else if(o.snapshotVersion.compareTo(he.min())>0){u.readTime=pu(i,o.snapshotVersion.toTimestamp());const d=hh(i,o.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);const r=Ik(this.serializer,e);r&&(n.labels=r),this.k_(n)}Y_(e){const n={};n.database=mh(this.serializer),n.removeTarget=e,this.k_(n)}}class pA extends lw{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,n){return this.connection.P_("Write",e,n)}j_(e){return Pe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Pe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Pe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const n=wk(e.writeResults,e.commitTime),r=On(e.commitTime);return this.listener.ta(r,n)}na(){const e={};e.database=mh(this.serializer),this.k_(e)}X_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>_k(this.serializer,r))};this.k_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{}class gA extends mA{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ra=!1}ia(){if(this.ra)throw new ee(U.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Wo(e,fh(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ee(U.UNKNOWN,i.toString())})}Jo(e,n,r,s,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Jo(e,fh(n,r),s,o,u,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ee(U.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class yA{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(rr(n),this._a=!1):Z("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs="RemoteStore";class vA{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=i,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{js(this)&&(Z(Cs,"Restarting streams for network reachability change."),await async function(c){const d=pe(c);d.Ia.add(4),await _a(d),d.Aa.set("Unknown"),d.Ia.delete(4),await Xu(d)}(this))})}),this.Aa=new yA(r,s)}}async function Xu(t){if(js(t))for(const e of t.da)await e(!0)}async function _a(t){for(const e of t.da)await e(!1)}function uw(t,e){const n=pe(t);n.Ta.has(e.targetId)||(n.Ta.set(e.targetId,e),Qf(n)?Kf(n):Fi(n).x_()&&Gf(n,e))}function Wf(t,e){const n=pe(t),r=Fi(n);n.Ta.delete(e),r.x_()&&cw(n,e),n.Ta.size===0&&(r.x_()?r.B_():js(n)&&n.Aa.set("Unknown"))}function Gf(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(he.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Fi(t).H_(e)}function cw(t,e){t.Ra.$e(e),Fi(t).Y_(e)}function Kf(t){t.Ra=new hk({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),Fi(t).start(),t.Aa.aa()}function Qf(t){return js(t)&&!Fi(t).M_()&&t.Ta.size>0}function js(t){return pe(t).Ia.size===0}function dw(t){t.Ra=void 0}async function xA(t){t.Aa.set("Online")}async function _A(t){t.Ta.forEach((e,n)=>{Gf(t,e)})}async function wA(t,e){dw(t),Qf(t)?(t.Aa.la(e),Kf(t)):t.Aa.set("Unknown")}async function EA(t,e,n){if(t.Aa.set("Online"),e instanceof Q_&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const u of i.targetIds)s.Ta.has(u)&&(await s.remoteSyncer.rejectListen(u,o),s.Ta.delete(u),s.Ra.removeTarget(u))}(t,e)}catch(r){Z(Cs,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await gu(t,r)}else if(e instanceof Cl?t.Ra.Ye(e):e instanceof K_?t.Ra.it(e):t.Ra.et(e),!n.isEqual(he.min()))try{const r=await ow(t.localStore);n.compareTo(r)>=0&&await function(i,o){const u=i.Ra.Pt(o);return u.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const f=i.Ta.get(d);f&&i.Ta.set(d,f.withResumeToken(c.resumeToken,o))}}),u.targetMismatches.forEach((c,d)=>{const f=i.Ta.get(c);if(!f)return;i.Ta.set(c,f.withResumeToken(_t.EMPTY_BYTE_STRING,f.snapshotVersion)),cw(i,c);const y=new Tr(f.target,c,d,f.sequenceNumber);Gf(i,y)}),i.remoteSyncer.applyRemoteEvent(u)}(t,n)}catch(r){Z(Cs,"Failed to raise snapshot:",r),await gu(t,r)}}async function gu(t,e,n){if(!Mi(e))throw e;t.Ia.add(1),await _a(t),t.Aa.set("Offline"),n||(n=()=>ow(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Z(Cs,"Retrying IndexedDB access"),await n(),t.Ia.delete(1),await Xu(t)})}function hw(t,e){return e().catch(n=>gu(t,n,e))}async function Yu(t){const e=pe(t),n=Xr(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Pf;for(;bA(e);)try{const s=await sA(e.localStore,r);if(s===null){e.Pa.length===0&&n.B_();break}r=s.batchId,TA(e,s)}catch(s){await gu(e,s)}fw(e)&&pw(e)}function bA(t){return js(t)&&t.Pa.length<10}function TA(t,e){t.Pa.push(e);const n=Xr(t);n.x_()&&n.Z_&&n.X_(e.mutations)}function fw(t){return js(t)&&!Xr(t).M_()&&t.Pa.length>0}function pw(t){Xr(t).start()}async function IA(t){Xr(t).na()}async function NA(t){const e=Xr(t);for(const n of t.Pa)e.X_(n.mutations)}async function SA(t,e,n){const r=t.Pa.shift(),s=Ff.from(r,e,n);await hw(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Yu(t)}async function CA(t,e){e&&Xr(t).Z_&&await async function(r,s){if(function(o){return ck(o)&&o!==U.ABORTED}(s.code)){const i=r.Pa.shift();Xr(r).N_(),await hw(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Yu(r)}}(t,e),fw(t)&&pw(t)}async function Cy(t,e){const n=pe(t);n.asyncQueue.verifyOperationInProgress(),Z(Cs,"RemoteStore received new credentials");const r=js(n);n.Ia.add(3),await _a(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ia.delete(3),await Xu(n)}async function kA(t,e){const n=pe(t);e?(n.Ia.delete(2),await Xu(n)):e||(n.Ia.add(2),await _a(n),n.Aa.set("Unknown"))}function Fi(t){return t.Va||(t.Va=function(n,r,s){const i=pe(n);return i.ia(),new fA(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:xA.bind(null,t),e_:_A.bind(null,t),n_:wA.bind(null,t),J_:EA.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),Qf(t)?Kf(t):t.Aa.set("Unknown")):(await t.Va.stop(),dw(t))})),t.Va}function Xr(t){return t.ma||(t.ma=function(n,r,s){const i=pe(n);return i.ia(),new pA(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:IA.bind(null,t),n_:CA.bind(null,t),ea:NA.bind(null,t),ta:SA.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await Yu(t)):(await t.ma.stop(),t.Pa.length>0&&(Z(Cs,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Mr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,u=new Xf(e,n,o,s,i);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ee(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Yf(t,e){if(rr("AsyncQueue",`${e}: ${t}`),Mi(t))return new ee(U.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{static emptySet(e){return new gi(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ae.comparator(n.key,r.key):(n,r)=>ae.comparator(n.key,r.key),this.keyedMap=po(),this.sortedSet=new Ke(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof gi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new gi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{constructor(){this.fa=new Ke(ae.comparator)}track(e){const n=e.doc.key,r=this.fa.get(n);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(n,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(n):e.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):ce(63341,{At:e,ga:r}):this.fa=this.fa.insert(n,e)}pa(){const e=[];return this.fa.inorderTraversal((n,r)=>{e.push(r)}),e}}class ki{constructor(e,n,r,s,i,o,u,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(u=>{o.push({type:0,doc:u})}),new ki(e,n,gi.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class PA{constructor(){this.queries=Ay(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const s=pe(n),i=s.queries;s.queries=Ay(),i.forEach((o,u)=>{for(const c of u.wa)c.onError(r)})})(this,new ee(U.ABORTED,"Firestore shutting down"))}}function Ay(){return new Rs(t=>j_(t),qu)}async function mw(t,e){const n=pe(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.Sa()&&e.ba()&&(r=2):(i=new AA,r=e.ba()?0:1);try{switch(r){case 0:i.ya=await n.onListen(s,!0);break;case 1:i.ya=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const u=Yf(o,`Initialization of query '${$s(e.query)}' failed`);return void e.onError(u)}n.queries.set(s,i),i.wa.push(e),e.va(n.onlineState),i.ya&&e.Ca(i.ya)&&Jf(n)}async function gw(t,e){const n=pe(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.wa.indexOf(e);o>=0&&(i.wa.splice(o,1),i.wa.length===0?s=e.ba()?0:1:!i.Sa()&&e.ba()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function RA(t,e){const n=pe(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const u of o.wa)u.Ca(s)&&(r=!0);o.ya=s}}r&&Jf(n)}function jA(t,e,n){const r=pe(t),s=r.queries.get(e);if(s)for(const i of s.wa)i.onError(n);r.queries.delete(e)}function Jf(t){t.Da.forEach(e=>{e.next()})}var vh,Py;(Py=vh||(vh={})).Fa="default",Py.Cache="cache";class yw{constructor(e,n,r){this.query=e,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new ki(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),n=!0):this.Ba(e,this.onlineState)&&(this.La(e),n=!0),this.Oa=e,n}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),n=!0),n}Ba(e,n){if(!e.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(e){e=ki.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==vh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(e){this.key=e}}class xw{constructor(e){this.key=e}}class DA{constructor(e,n){this.query=e,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Ee(),this.mutatedKeys=Ee(),this.Xa=D_(e),this.eu=new gi(this.Xa)}get tu(){return this.Ha}nu(e,n){const r=n?n.ru:new ky,s=n?n.eu:this.eu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,u=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,y)=>{const g=s.get(f),w=Hu(this.query,y)?y:null,S=!!g&&this.mutatedKeys.has(g.key),P=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let R=!1;g&&w?g.data.isEqual(w.data)?S!==P&&(r.track({type:3,doc:w}),R=!0):this.iu(g,w)||(r.track({type:2,doc:w}),R=!0,(c&&this.Xa(w,c)>0||d&&this.Xa(w,d)<0)&&(u=!0)):!g&&w?(r.track({type:0,doc:w}),R=!0):g&&!w&&(r.track({type:1,doc:g}),R=!0,(c||d)&&(u=!0)),R&&(w?(o=o.add(w),i=P?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{eu:o,ru:r,Ds:u,mutatedKeys:i}}iu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const o=e.ru.pa();o.sort((f,y)=>function(w,S){const P=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ce(20277,{At:R})}};return P(w)-P(S)}(f.type,y.type)||this.Xa(f.doc,y.doc)),this.su(r),s=s!=null&&s;const u=n&&!s?this.ou():[],c=this.Za.size===0&&this.current&&!s?1:0,d=c!==this.Ya;return this.Ya=c,o.length!==0||d?{snapshot:new ki(this.query,e.eu,i,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new ky,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=Ee(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return e.forEach(r=>{this.Za.has(r)||n.push(new xw(r))}),this.Za.forEach(r=>{e.has(r)||n.push(new vw(r))}),n}uu(e){this.Ha=e.qs,this.Za=Ee();const n=this.nu(e.documents);return this.applyChanges(n,!0)}cu(){return ki.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Zf="SyncEngine";class OA{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class LA{constructor(e){this.key=e,this.lu=!1}}class VA{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new Rs(u=>j_(u),qu),this.Tu=new Map,this.Iu=new Set,this.du=new Ke(ae.comparator),this.Eu=new Map,this.Au=new Bf,this.Ru={},this.Vu=new Map,this.mu=Ci.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function MA(t,e,n=!0){const r=Iw(t);let s;const i=r.Pu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.cu()):s=await _w(r,e,n,!0),s}async function FA(t,e){const n=Iw(t);await _w(n,e,!0,!1)}async function _w(t,e,n,r){const s=await iA(t.localStore,Dn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let u;return r&&(u=await UA(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&uw(t.remoteStore,s),u}async function UA(t,e,n,r,s){t.gu=(y,g,w)=>async function(P,R,b,x){let I=R.view.nu(b);I.Ds&&(I=await by(P.localStore,R.query,!1).then(({documents:T})=>R.view.nu(T,I)));const j=x&&x.targetChanges.get(R.targetId),M=x&&x.targetMismatches.get(R.targetId)!=null,V=R.view.applyChanges(I,P.isPrimaryClient,j,M);return jy(P,R.targetId,V._u),V.snapshot}(t,y,g,w);const i=await by(t.localStore,e,!0),o=new DA(e,i.qs),u=o.nu(i.documents),c=xa.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(u,t.isPrimaryClient,c);jy(t,n,d._u);const f=new OA(e,n,o);return t.Pu.set(e,f),t.Tu.has(n)?t.Tu.get(n).push(e):t.Tu.set(n,[e]),d.snapshot}async function zA(t,e,n){const r=pe(t),s=r.Pu.get(e),i=r.Tu.get(s.targetId);if(i.length>1)return r.Tu.set(s.targetId,i.filter(o=>!qu(o,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await gh(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Wf(r.remoteStore,s.targetId),xh(r,s.targetId)}).catch(Vi)):(xh(r,s.targetId),await gh(r.localStore,s.targetId,!0))}async function BA(t,e){const n=pe(t),r=n.Pu.get(e),s=n.Tu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Wf(n.remoteStore,r.targetId))}async function $A(t,e,n){const r=XA(t);try{const s=await function(o,u){const c=pe(o),d=Ue.now(),f=u.reduce((w,S)=>w.add(S.key),Ee());let y,g;return c.persistence.runTransaction("Locally write mutations","readwrite",w=>{let S=sr(),P=Ee();return c.Os.getEntries(w,f).next(R=>{S=R,S.forEach((b,x)=>{x.isValidDocument()||(P=P.add(b))})}).next(()=>c.localDocuments.getOverlayedDocuments(w,S)).next(R=>{y=R;const b=[];for(const x of u){const I=ik(x,y.get(x.key).overlayedDocument);I!=null&&b.push(new ns(x.key,I,I_(I.value.mapValue),En.exists(!0)))}return c.mutationQueue.addMutationBatch(w,d,b,u)}).next(R=>{g=R;const b=R.applyToLocalDocumentSet(y,P);return c.documentOverlayCache.saveOverlays(w,R.batchId,b)})}).then(()=>({batchId:g.batchId,changes:L_(y)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,u,c){let d=o.Ru[o.currentUser.toKey()];d||(d=new Ke(_e)),d=d.insert(u,c),o.Ru[o.currentUser.toKey()]=d}(r,s.batchId,n),await wa(r,s.changes),await Yu(r.remoteStore)}catch(s){const i=Yf(s,"Failed to persist write");n.reject(i)}}async function ww(t,e){const n=pe(t);try{const r=await nA(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Eu.get(i);o&&(Pe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.lu=!0:s.modifiedDocuments.size>0?Pe(o.lu,14607):s.removedDocuments.size>0&&(Pe(o.lu,42227),o.lu=!1))}),await wa(n,r,e)}catch(r){await Vi(r)}}function Ry(t,e,n){const r=pe(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Pu.forEach((i,o)=>{const u=o.view.va(e);u.snapshot&&s.push(u.snapshot)}),function(o,u){const c=pe(o);c.onlineState=u;let d=!1;c.queries.forEach((f,y)=>{for(const g of y.wa)g.va(u)&&(d=!0)}),d&&Jf(c)}(r.eventManager,e),s.length&&r.hu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function qA(t,e,n){const r=pe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Eu.get(e),i=s&&s.key;if(i){let o=new Ke(ae.comparator);o=o.insert(i,kt.newNoDocument(i,he.min()));const u=Ee().add(i),c=new Ku(he.min(),new Map,new Ke(_e),o,u);await ww(r,c),r.du=r.du.remove(i),r.Eu.delete(e),ep(r)}else await gh(r.localStore,e,!1).then(()=>xh(r,e,n)).catch(Vi)}async function HA(t,e){const n=pe(t),r=e.batch.batchId;try{const s=await tA(n.localStore,e);bw(n,r,null),Ew(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await wa(n,s)}catch(s){await Vi(s)}}async function WA(t,e,n){const r=pe(t);try{const s=await function(o,u){const c=pe(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return c.mutationQueue.lookupMutationBatch(d,u).next(y=>(Pe(y!==null,37113),f=y.keys(),c.mutationQueue.removeMutationBatch(d,y))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,f,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>c.localDocuments.getDocuments(d,f))})}(r.localStore,e);bw(r,e,n),Ew(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await wa(r,s)}catch(s){await Vi(s)}}function Ew(t,e){(t.Vu.get(e)||[]).forEach(n=>{n.resolve()}),t.Vu.delete(e)}function bw(t,e,n){const r=pe(t);let s=r.Ru[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ru[r.currentUser.toKey()]=s}}function xh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Tu.get(e))t.Pu.delete(r),n&&t.hu.pu(r,n);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(r=>{t.Au.containsKey(r)||Tw(t,r)})}function Tw(t,e){t.Iu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Wf(t.remoteStore,n),t.du=t.du.remove(e),t.Eu.delete(n),ep(t))}function jy(t,e,n){for(const r of n)r instanceof vw?(t.Au.addReference(r.key,e),GA(t,r)):r instanceof xw?(Z(Zf,"Document no longer in limbo: "+r.key),t.Au.removeReference(r.key,e),t.Au.containsKey(r.key)||Tw(t,r.key)):ce(19791,{yu:r})}function GA(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Iu.has(r)||(Z(Zf,"New document in limbo: "+n),t.Iu.add(r),ep(t))}function ep(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const n=new ae(Le.fromString(e)),r=t.mu.next();t.Eu.set(r,new LA(n)),t.du=t.du.insert(n,r),uw(t.remoteStore,new Tr(Dn(Lf(n.path)),r,"TargetPurposeLimboResolution",zu.ue))}}async function wa(t,e,n){const r=pe(t),s=[],i=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((u,c)=>{o.push(r.gu(c,e,n).then(d=>{var f;if((d||n)&&r.isPrimaryClient){const y=d?!d.fromCache:(f=n==null?void 0:n.targetChanges.get(c.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(c.targetId,y?"current":"not-current")}if(d){s.push(d);const y=qf.Es(c.targetId,d);i.push(y)}}))}),await Promise.all(o),r.hu.J_(s),await async function(c,d){const f=pe(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>$.forEach(d,g=>$.forEach(g.Is,w=>f.persistence.referenceDelegate.addReference(y,g.targetId,w)).next(()=>$.forEach(g.ds,w=>f.persistence.referenceDelegate.removeReference(y,g.targetId,w)))))}catch(y){if(!Mi(y))throw y;Z(Hf,"Failed to update sequence numbers: "+y)}for(const y of d){const g=y.targetId;if(!y.fromCache){const w=f.Fs.get(g),S=w.snapshotVersion,P=w.withLastLimboFreeSnapshotVersion(S);f.Fs=f.Fs.insert(g,P)}}}(r.localStore,i))}async function KA(t,e){const n=pe(t);if(!n.currentUser.isEqual(e)){Z(Zf,"User change. New user:",e.toKey());const r=await iw(n.localStore,e);n.currentUser=e,function(i,o){i.Vu.forEach(u=>{u.forEach(c=>{c.reject(new ee(U.CANCELLED,o))})}),i.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await wa(n,r.Bs)}}function QA(t,e){const n=pe(t),r=n.Eu.get(e);if(r&&r.lu)return Ee().add(r.key);{let s=Ee();const i=n.Tu.get(e);if(!i)return s;for(const o of i){const u=n.Pu.get(o);s=s.unionWith(u.view.tu)}return s}}function Iw(t){const e=pe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ww.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=QA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=qA.bind(null,e),e.hu.J_=RA.bind(null,e.eventManager),e.hu.pu=jA.bind(null,e.eventManager),e}function XA(t){const e=pe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=HA.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=WA.bind(null,e),e}class yu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Qu(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,n){return null}Fu(e,n){return null}vu(e){return eA(this.persistence,new Yk,e.initialUser,this.serializer)}Du(e){return new sw($f.Vi,this.serializer)}bu(e){return new aA}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}yu.provider={build:()=>new yu};class YA extends yu{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,n){Pe(this.persistence.referenceDelegate instanceof mu,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new Lk(r,e.asyncQueue,n)}Du(e){const n=this.cacheSizeBytes!==void 0?Bt.withCacheSize(this.cacheSizeBytes):Bt.DEFAULT;return new sw(r=>mu.Vi(r,n),this.serializer)}}class _h{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Ry(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=KA.bind(null,this.syncEngine),await kA(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new PA}()}createDatastore(e){const n=Qu(e.databaseInfo.databaseId),r=function(i){return new hA(i)}(e.databaseInfo);return function(i,o,u,c){return new gA(i,o,u,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,u){return new vA(r,s,i,o,u)}(this.localStore,this.datastore,e.asyncQueue,n=>Ry(this.syncEngine,n,0),function(){return Ny.C()?new Ny:new lA}())}createSyncEngine(e,n){return function(s,i,o,u,c,d,f){const y=new VA(s,i,o,u,c,d);return f&&(y.fu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=pe(s);Z(Cs,"RemoteStore shutting down."),i.Ia.add(5),await _a(i),i.Ea.shutdown(),i.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}_h.provider={build:()=>new _h};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):rr("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yr="FirestoreClient";class JA{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=St.UNAUTHENTICATED,this.clientId=Af.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{Z(Yr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Z(Yr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Mr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Yf(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function nd(t,e){t.asyncQueue.verifyOperationInProgress(),Z(Yr,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await iw(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>{Hr("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{Z("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(s=>{Hr("Terminating Firestore due to IndexedDb database deletion failed",s)})}),t._offlineComponents=e}async function Dy(t,e){t.asyncQueue.verifyOperationInProgress();const n=await ZA(t);Z(Yr,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Cy(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Cy(e.remoteStore,s)),t._onlineComponents=e}async function ZA(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Z(Yr,"Using user provided OfflineComponentProvider");try{await nd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===U.FAILED_PRECONDITION||s.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Hr("Error using user provided cache. Falling back to memory cache: "+n),await nd(t,new yu)}}else Z(Yr,"Using default OfflineComponentProvider"),await nd(t,new YA(void 0));return t._offlineComponents}async function Sw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Z(Yr,"Using user provided OnlineComponentProvider"),await Dy(t,t._uninitializedComponentsProvider._online)):(Z(Yr,"Using default OnlineComponentProvider"),await Dy(t,new _h))),t._onlineComponents}function e2(t){return Sw(t).then(e=>e.syncEngine)}async function wh(t){const e=await Sw(t),n=e.eventManager;return n.onListen=MA.bind(null,e.syncEngine),n.onUnlisten=zA.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=FA.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=BA.bind(null,e.syncEngine),n}function t2(t,e,n={}){const r=new Mr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,u,c,d){const f=new Nw({next:g=>{f.Ou(),o.enqueueAndForget(()=>gw(i,y)),g.fromCache&&c.source==="server"?d.reject(new ee(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(g)},error:g=>d.reject(g)}),y=new yw(u,f,{includeMetadataChanges:!0,ka:!0});return mw(i,y)}(await wh(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oy=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kw="firestore.googleapis.com",Ly=!0;class Vy{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ee(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=kw,this.ssl=Ly}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:Ly;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=rw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Dk)throw new ee(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_C("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Cw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ee(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ee(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ee(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ju{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Vy({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ee(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ee(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Vy(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new dC;switch(r.type){case"firstParty":return new mC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ee(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Oy.get(n);r&&(Z("ComponentProvider","Removing Datastore"),Oy.delete(n),r.terminate())}(this),Promise.resolve()}}function n2(t,e,n,r={}){var s;t=jn(t,Ju);const i=ji(e),o=t._getSettings(),u=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),c=`${e}:${n}`;i&&(xx(`https://${c}`),_x("Firestore",!0)),o.host!==kw&&o.host!==c&&Hr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},o),{host:c,ssl:i,emulatorOptions:r});if(!Ts(d,u)&&(t._setSettings(d),r.mockUserToken)){let f,y;if(typeof r.mockUserToken=="string")f=r.mockUserToken,y=St.MOCK_USER;else{f=VT(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new ee(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new St(g)}t._authCredentials=new hC(new h_(f,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ds(this.firestore,e,this._query)}}class st{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new st(this.firestore,e,this._key)}toJSON(){return{type:st._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(ga(n,st._jsonSchema))return new st(e,r||null,new ae(Le.fromString(n.referencePath)))}}st._jsonSchemaVersion="firestore/documentReference/1.0",st._jsonSchema={type:rt("string",st._jsonSchemaVersion),referencePath:rt("string")};class Fr extends Ds{constructor(e,n,r){super(e,n,Lf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new st(this.firestore,null,new ae(e))}withConverter(e){return new Fr(this.firestore,e,this._path)}}function at(t,e,...n){if(t=Rt(t),p_("collection","path",e),t instanceof Ju){const r=Le.fromString(e,...n);return Xg(r),new Fr(t,null,r)}{if(!(t instanceof st||t instanceof Fr))throw new ee(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Le.fromString(e,...n));return Xg(r),new Fr(t.firestore,null,r)}}function it(t,e,...n){if(t=Rt(t),arguments.length===1&&(e=Af.newId()),p_("doc","path",e),t instanceof Ju){const r=Le.fromString(e,...n);return Qg(r),new st(t,null,new ae(r))}{if(!(t instanceof st||t instanceof Fr))throw new ee(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Le.fromString(e,...n));return Qg(r),new st(t.firestore,t instanceof Fr?t.converter:null,new ae(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const My="AsyncQueue";class Fy{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new aw(this,"async_queue_retry"),this.oc=()=>{const r=td();r&&Z(My,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const n=td();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const n=td();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new Mr;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Mi(e))throw e;Z(My,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const n=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,rr("INTERNAL UNHANDLED ERROR: ",Uy(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(e,n,r){this.ac(),this.sc.indexOf(e)>-1&&(n=0);const s=Xf.createAndSchedule(this,e,n,r,i=>this.lc(i));return this.ec.push(s),s}ac(){this.tc&&ce(47125,{hc:Uy(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const n of this.ec)if(n.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const n=this.ec.indexOf(e);this.ec.splice(n,1)}}function Uy(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zy(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class ks extends Ju{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Fy,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Fy(e),this._firestoreClient=void 0,await e}}}function r2(t,e){const n=typeof t=="object"?t:Tx(),r=typeof t=="string"?t:cu,s=_f(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=OT("firestore");i&&n2(s,...i)}return s}function tp(t){if(t._terminated)throw new ee(U.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||s2(t),t._firestoreClient}function s2(t){var e,n,r;const s=t._freezeSettings(),i=function(u,c,d,f){return new PC(u,c,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,Cw(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new JA(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(u){const c=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this._byteString=e}static fromBase64String(e){try{return new an(_t.fromBase64String(e))}catch(n){throw new ee(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new an(_t.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:an._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ga(e,an._jsonSchema))return an.fromBase64String(e.bytes)}}an._jsonSchemaVersion="firestore/bytes/1.0",an._jsonSchema={type:rt("string",an._jsonSchemaVersion),bytes:rt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ee(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new yt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ee(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ee(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return _e(this._lat,e._lat)||_e(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ln._jsonSchemaVersion}}static fromJSON(e){if(ga(e,Ln._jsonSchema))return new Ln(e.latitude,e.longitude)}}Ln._jsonSchemaVersion="firestore/geoPoint/1.0",Ln._jsonSchema={type:rt("string",Ln._jsonSchemaVersion),latitude:rt("number"),longitude:rt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Vn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ga(e,Vn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Vn(e.vectorValues);throw new ee(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Vn._jsonSchemaVersion="firestore/vectorValue/1.0",Vn._jsonSchema={type:rt("string",Vn._jsonSchemaVersion),vectorValues:rt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2=/^__.*__$/;class o2{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ns(e,this.data,this.fieldMask,n,this.fieldTransforms):new va(e,this.data,n,this.fieldTransforms)}}class Aw{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ns(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Pw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ce(40011,{Ec:t})}}class np{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Ac(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new np(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Rc({path:r,mc:!1});return s.fc(e),s}gc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Rc({path:r,mc:!1});return s.Ac(),s}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return vu(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(Pw(this.Ec)&&i2.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class a2{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Qu(e)}Dc(e,n,r,s=!1){return new np({Ec:e,methodName:n,bc:r,path:yt.emptyPath(),mc:!1,Sc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function rp(t){const e=t._freezeSettings(),n=Qu(t._databaseId);return new a2(t._databaseId,!!e.ignoreUndefinedProperties,n)}function l2(t,e,n,r,s,i={}){const o=t.Dc(i.merge||i.mergeFields?2:0,e,n,s);op("Data must be an object, but it was:",o,r);const u=Rw(r,o);let c,d;if(i.merge)c=new Zt(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const y of i.mergeFields){const g=Eh(e,y,n);if(!o.contains(g))throw new ee(U.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Dw(f,g)||f.push(g)}c=new Zt(f),d=o.fieldTransforms.filter(y=>c.covers(y.field))}else c=null,d=o.fieldTransforms;return new o2(new qt(u),c,d)}class ec extends Ea{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ec}}class sp extends Ea{_toFieldTransform(e){return new q_(e.path,new ta)}isEqual(e){return e instanceof sp}}class ip extends Ea{constructor(e,n){super(e),this.Cc=n}_toFieldTransform(e){const n=new sa(e.serializer,F_(e.serializer,this.Cc));return new q_(e.path,n)}isEqual(e){return e instanceof ip&&this.Cc===e.Cc}}function u2(t,e,n,r){const s=t.Dc(1,e,n);op("Data must be an object, but it was:",s,r);const i=[],o=qt.empty();ts(r,(c,d)=>{const f=ap(e,c,n);d=Rt(d);const y=s.gc(f);if(d instanceof ec)i.push(f);else{const g=ba(d,y);g!=null&&(i.push(f),o.set(f,g))}});const u=new Zt(i);return new Aw(o,u,s.fieldTransforms)}function c2(t,e,n,r,s,i){const o=t.Dc(1,e,n),u=[Eh(e,r,n)],c=[s];if(i.length%2!=0)throw new ee(U.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)u.push(Eh(e,i[g])),c.push(i[g+1]);const d=[],f=qt.empty();for(let g=u.length-1;g>=0;--g)if(!Dw(d,u[g])){const w=u[g];let S=c[g];S=Rt(S);const P=o.gc(w);if(S instanceof ec)d.push(w);else{const R=ba(S,P);R!=null&&(d.push(w),f.set(w,R))}}const y=new Zt(d);return new Aw(f,y,o.fieldTransforms)}function d2(t,e,n,r=!1){return ba(n,t.Dc(r?4:3,e))}function ba(t,e){if(jw(t=Rt(t)))return op("Unsupported field value:",e,t),Rw(t,e);if(t instanceof Ea)return function(r,s){if(!Pw(s.Ec))throw s.wc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.wc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const u of r){let c=ba(u,s.yc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Rt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return F_(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Ue.fromDate(r);return{timestampValue:pu(s.serializer,i)}}if(r instanceof Ue){const i=new Ue(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:pu(s.serializer,i)}}if(r instanceof Ln)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof an)return{bytesValue:X_(s.serializer,r._byteString)};if(r instanceof st){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:zf(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Vn)return function(o,u){return{mapValue:{fields:{[b_]:{stringValue:T_},[du]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw u.wc("VectorValues must only contain numeric values.");return Vf(u.serializer,d)})}}}}}}(r,s);throw s.wc(`Unsupported field value: ${Uu(r)}`)}(t,e)}function Rw(t,e){const n={};return y_(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ts(t,(r,s)=>{const i=ba(s,e.Vc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function jw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ue||t instanceof Ln||t instanceof an||t instanceof st||t instanceof Ea||t instanceof Vn)}function op(t,e,n){if(!jw(n)||!m_(n)){const r=Uu(n);throw r==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+r)}}function Eh(t,e,n){if((e=Rt(e))instanceof Zu)return e._internalPath;if(typeof e=="string")return ap(t,e);throw vu("Field path arguments must be of type string or ",t,!1,void 0,n)}const h2=new RegExp("[~\\*/\\[\\]]");function ap(t,e,n){if(e.search(h2)>=0)throw vu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Zu(...e.split("."))._internalPath}catch{throw vu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function vu(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let u=`Function ${e}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new ee(U.INVALID_ARGUMENT,u+t+c)}function Dw(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ow{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new st(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new f2(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Lw("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class f2 extends Ow{data(){return super.data()}}function Lw(t,e){return typeof e=="string"?ap(t,e):e instanceof Zu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vw(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ee(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class lp{}class p2 extends lp{}function m2(t,e,...n){let r=[];e instanceof lp&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof cp).length,u=i.filter(c=>c instanceof up).length;if(o>1||o>0&&u>0)throw new ee(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class up extends p2{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new up(e,n,r)}_apply(e){const n=this._parse(e);return Mw(e._query,n),new Ds(e.firestore,e.converter,ch(e._query,n))}_parse(e){const n=rp(e.firestore);return function(i,o,u,c,d,f,y){let g;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new ee(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){$y(y,f);const S=[];for(const P of y)S.push(By(c,i,P));g={arrayValue:{values:S}}}else g=By(c,i,y)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||$y(y,f),g=d2(u,o,y,f==="in"||f==="not-in");return nt.create(d,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class cp extends lp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new cp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Tn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const u=i.getFlattenedFilters();for(const c of u)Mw(o,c),o=ch(o,c)}(e._query,n),new Ds(e.firestore,e.converter,ch(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function By(t,e,n){if(typeof(n=Rt(n))=="string"){if(n==="")throw new ee(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!R_(e)&&n.indexOf("/")!==-1)throw new ee(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Le.fromString(n));if(!ae.isDocumentKey(r))throw new ee(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return sy(t,new ae(r))}if(n instanceof st)return sy(t,n._key);throw new ee(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Uu(n)}.`)}function $y(t,e){if(!Array.isArray(t)||t.length===0)throw new ee(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Mw(t,e){const n=function(s,i){for(const o of s)for(const u of o.getFlattenedFilters())if(i.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ee(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ee(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class g2{convertValue(e,n="none"){switch(Qr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ye(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Kr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ce(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ts(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n[du].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Ye(o.doubleValue));return new Vn(i)}convertGeoPoint(e){return new Ln(Ye(e.latitude),Ye(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=$u(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Jo(e));default:return null}}convertTimestamp(e){const n=Gr(e);return new Ue(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Le.fromString(e);Pe(nw(r),9688,{name:e});const s=new Zo(r.get(1),r.get(3)),i=new ae(r.popFirst(5));return s.isEqual(n)||rr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y2(t,e,n){let r;return r=t?t.toFirestore(e):e,r}class go{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class gs extends Ow{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new kl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Lw("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ee(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=gs._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}gs._jsonSchemaVersion="firestore/documentSnapshot/1.0",gs._jsonSchema={type:rt("string",gs._jsonSchemaVersion),bundleSource:rt("string","DocumentSnapshot"),bundleName:rt("string"),bundle:rt("string")};class kl extends gs{data(e={}){return super.data(e)}}class ys{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new go(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new kl(this._firestore,this._userDataWriter,r.key,r,new go(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ee(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(u=>{const c=new kl(s._firestore,s._userDataWriter,u.doc.key,u.doc,new go(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(u=>i||u.type!==3).map(u=>{const c=new kl(s._firestore,s._userDataWriter,u.doc.key,u.doc,new go(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return u.type!==0&&(d=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),f=o.indexOf(u.doc.key)),{type:v2(u.type),doc:c,oldIndex:d,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ee(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ys._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Af.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function v2(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ce(61501,{type:t})}}ys._jsonSchemaVersion="firestore/querySnapshot/1.0",ys._jsonSchema={type:rt("string",ys._jsonSchemaVersion),bundleSource:rt("string","QuerySnapshot"),bundleName:rt("string"),bundle:rt("string")};class dp extends g2{constructor(e){super(),this.firestore=e}convertBytes(e){return new an(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new st(this.firestore,null,n)}}function zs(t){t=jn(t,Ds);const e=jn(t.firestore,ks),n=tp(e),r=new dp(e);return Vw(t._query),t2(n,t._query).then(s=>new ys(e,r,t,s))}function Vt(t,e,n,...r){t=jn(t,st);const s=jn(t.firestore,ks),i=rp(s);let o;return o=typeof(e=Rt(e))=="string"||e instanceof Zu?c2(i,"updateDoc",t._key,e,n,r):u2(i,"updateDoc",t._key,e),hp(s,[o.toMutation(t._key,En.exists(!0))])}function tc(t){return hp(jn(t.firestore,ks),[new Mf(t._key,En.none())])}function cn(t,e){const n=jn(t.firestore,ks),r=it(t),s=y2(t.converter,e);return hp(n,[l2(rp(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,En.exists(!1))]).then(()=>r)}function x2(t,...e){var n,r,s;t=Rt(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||zy(e[o])||(i=e[o++]);const u={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(zy(e[o])){const y=e[o];e[o]=(n=y.next)===null||n===void 0?void 0:n.bind(y),e[o+1]=(r=y.error)===null||r===void 0?void 0:r.bind(y),e[o+2]=(s=y.complete)===null||s===void 0?void 0:s.bind(y)}let c,d,f;if(t instanceof st)d=jn(t.firestore,ks),f=Lf(t._key.path),c={next:y=>{e[o]&&e[o](_2(d,t,y))},error:e[o+1],complete:e[o+2]};else{const y=jn(t,Ds);d=jn(y.firestore,ks),f=y._query;const g=new dp(d);c={next:w=>{e[o]&&e[o](new ys(d,g,y,w))},error:e[o+1],complete:e[o+2]},Vw(t._query)}return function(g,w,S,P){const R=new Nw(P),b=new yw(w,R,S);return g.asyncQueue.enqueueAndForget(async()=>mw(await wh(g),b)),()=>{R.Ou(),g.asyncQueue.enqueueAndForget(async()=>gw(await wh(g),b))}}(tp(d),f,u,c)}function hp(t,e){return function(r,s){const i=new Mr;return r.asyncQueue.enqueueAndForget(async()=>$A(await e2(r),s,i)),i.promise}(tp(t),e)}function _2(t,e,n){const r=n.docs.get(e._key),s=new dp(t);return new gs(t,s,e._key,r,new go(n.hasPendingWrites,n.fromCache),e.converter)}function ze(){return new sp("serverTimestamp")}function ia(t){return new ip("increment",t)}(function(e,n=!0){(function(s){Li=s})(Di),Ti(new Is("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),u=new ks(new fC(r.getProvider("auth-internal")),new gC(o,r.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new ee(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zo(d.options.projectId,f)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),u._setSettings(i),u},"PUBLIC").setMultipleInstances(!0)),Or(qg,Hg,e),Or(qg,Hg,"esm2017")})();const w2={VITE_FIREBASE_API_KEY:"AIzaSyDUK-H7scDD-9t_yVASmG34ypw7AlKwNTY",VITE_FIREBASE_APP_ID:"1:97524547700:web:08f8d39ed9be7ec75a9121",VITE_FIREBASE_AUTH_DOMAIN:"poshakh-stock.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"97524547700",VITE_FIREBASE_PROJECT_ID:"poshakh-stock",VITE_FIREBASE_STORAGE_BUCKET:"poshakh-stock.firebasestorage.app"},qy={apiKey:"AIzaSyDUK-H7scDD-9t_yVASmG34ypw7AlKwNTY",authDomain:"poshakh-stock.firebaseapp.com",projectId:"poshakh-stock",storageBucket:"poshakh-stock.firebasestorage.app",messagingSenderId:"97524547700",appId:"1:97524547700:web:08f8d39ed9be7ec75a9121"};let vs;function fp(t){const e=typeof import.meta<"u"?w2:{},n={apiKey:e.VITE_FIREBASE_API_KEY,authDomain:e.VITE_FIREBASE_AUTH_DOMAIN,projectId:e.VITE_FIREBASE_PROJECT_ID,storageBucket:e.VITE_FIREBASE_STORAGE_BUCKET,messagingSenderId:e.VITE_FIREBASE_MESSAGING_SENDER_ID,appId:e.VITE_FIREBASE_APP_ID},r=Object.values(n).some(s=>s)?{...qy,...Object.fromEntries(Object.entries(n).filter(([,s])=>s))}:qy;return vs||(vs=bx(r)),vs}function E2(){vs||fp();const t=uC(vs);return GN(t)}function ft(){return vs||fp(),r2(vs)}const Fn="fabrics",Ur="production_orders";function b2({allOrders:t=[],inventoryItems:e=[],productionBatches:n=[],userProfile:r,onViewOrder:s,onShowLegacyModal:i,onCancelOrder:o,onDeleteOrder:u,onOpenShipping:c,onCreateProductionBatch:d,onDataChanged:f}){const[y,g]=B.useState({orderNumber:"",fabricId:"",lengthToCut:"",outfitName:"",customerName:"",size:"M",stitchingCost:"",acquisitionCost:""}),[w,S]=B.useState({orderNumber:"",outfitId:"",size:"M",quantity:"1",customerName:"",phone:"",address:""}),[P,R]=B.useState([]),[b,x]=B.useState("active"),[I,j]=B.useState("date_desc"),[M,V]=B.useState(!1),[T,p]=B.useState({batches:!1,stock:!1,production:!1}),v=B.useMemo(()=>e.filter(k=>k.type==="fabric"&&k.currentLength>0),[e]),_=B.useMemo(()=>e.filter(k=>k.type==="outfit"),[e]),C=B.useMemo(()=>e.filter(k=>k.type!=="outfit"?!1:Object.values(k.stockBreakdown||{}).reduce((K,se)=>K+(parseInt(se)||0),0)>0).map(k=>({...k,totalStock:Object.values(k.stockBreakdown||{}).reduce((O,K)=>O+(parseInt(K)||0),0)})),[e]),A=C.find(k=>k.id===w.outfitId),N=B.useMemo(()=>{let k=[...t];return k=k.filter(O=>O.status!=="Imported"),b==="active"?k=k.filter(O=>O.status!=="Cancelled"&&O.status!=="Order Shipped (Completed)"):b==="completed"&&(k=k.filter(O=>O.status==="Order Shipped (Completed)"||O.status==="Cancelled")),k.sort((O,K)=>{var H,Y;const se=(H=O.createdAt)!=null&&H.toMillis?O.createdAt.toMillis():0,F=(Y=K.createdAt)!=null&&Y.toMillis?K.createdAt.toMillis():0;return I==="date_desc"?F-se:I==="date_asc"?se-F:0}),k},[t,b,I]),me=k=>{k.preventDefault();const{orderNumber:O,fabricId:K,lengthToCut:se,outfitName:F,size:H,stitchingCost:Y,acquisitionCost:ue}=y;if(!O||!K)return;const oe=e.find(Ce=>Ce.id===K),ne=parseFloat(se)||0,xe={...y,fabricName:(oe==null?void 0:oe.name)||"Unknown",unit:(oe==null?void 0:oe.unit)||"m",cutAmount:ne,stitchingCost:parseFloat(Y)||0,acquisitionCost:parseFloat(ue)||0,imageUrl:(oe==null?void 0:oe.imageUrl)||""};R([...P,xe]),g({...y,lengthToCut:"",outfitName:"",customerName:"",stitchingCost:"",acquisitionCost:""})},ie=k=>R(P.filter((O,K)=>K!==k)),Ie=async()=>{V(!0);try{const k=ft(),O=P.map(async K=>{if(K.fabricId){const se=it(k,Fn,K.fabricId);K.cutAmount>0&&(await Vt(se,{currentLength:ia(-K.cutAmount),updatedAt:ze()}),await cn(at(se,"history"),{amountUsed:K.cutAmount,orderNumber:K.orderNumber,productName:K.outfitName,status:"Sent to Tailor",type:"CUT",usedByEmail:r==null?void 0:r.name,usedAt:ze()}))}await cn(at(k,Ur),{fabricId:K.fabricId||"",fabricName:K.fabricName,outfitName:K.outfitName,orderNumber:K.orderNumber,customerName:K.customerName,cutAmount:K.cutAmount,unit:K.unit,size:K.size,stitchingCost:K.stitchingCost,acquisitionCost:K.acquisitionCost,imageUrl:K.imageUrl,status:"Sent to Tailor",usedByEmail:r==null?void 0:r.name,createdAt:ze()})});await Promise.all(O),R([]),f&&await f()}catch(k){console.error("Batch submit error:",k)}V(!1)},te=async k=>{const O=ft();await Vt(it(O,Ur,k),{status:"Received from Tailor",updatedAt:ze()}),f&&await f()},z=async k=>{var Ce;k.preventDefault();const{orderNumber:O,outfitId:K,size:se,quantity:F,customerName:H,phone:Y,address:ue}=w;if(!O||!K||!se||!F){alert("Please fill all required fields");return}const oe=e.find(ge=>ge.id===K);if(!oe){alert("Outfit not found");return}const ne=parseInt(F),xe=parseInt((Ce=oe.stockBreakdown)==null?void 0:Ce[se])||0;if(ne>xe){alert(`Not enough stock! Only ${xe} pieces available in size ${se}`);return}V(!0);try{const ge=ft();await cn(at(ge,Ur),{orderNumber:O,outfitId:K,outfitName:oe.name,imageUrl:oe.imageUrl||"",size:se,quantity:ne,customerName:H,phone:Y,address:ue,productionCostPerPiece:oe.productionCostPerPiece||0,status:"Ready to Ship",orderType:"stock",usedByEmail:r==null?void 0:r.name,createdAt:ze()});const ye=oe.stockBreakdown||{};await Vt(it(ge,Fn,K),{stockBreakdown:{...ye,[se]:xe-ne},updatedAt:ze()}),alert(` Order #${O} created!
${ne} x ${oe.name} (${se})
Stock deducted: ${xe}  ${xe-ne}`),S({orderNumber:"",outfitId:"",size:"M",quantity:"1",customerName:"",phone:"",address:""}),f&&await f()}catch(ge){console.error("Stock order error:",ge),alert("Error creating order: "+ge.message)}finally{V(!1)}},q=B.useMemo(()=>e.filter(k=>k.type==="outfit").map(k=>{const O=Object.values(k.stockBreakdown||{}).reduce((K,se)=>K+(parseInt(se)||0),0);return{...k,totalStock:O}}).filter(k=>k.totalStock<5).sort((k,O)=>k.totalStock-O.totalStock),[e]),X=B.useMemo(()=>[...n].sort((k,O)=>{var F,H;const K=(F=k.receivedDate)!=null&&F.toDate?k.receivedDate.toDate():new Date(k.receivedDate);return((H=O.receivedDate)!=null&&H.toDate?O.receivedDate.toDate():new Date(O.receivedDate))-K}).slice(0,3),[n]),G=k=>k?(k.toDate?k.toDate():new Date(k)).toLocaleDateString("en-IN",{day:"numeric",month:"short"}):"N/A";return l.jsxs("div",{className:"space-y-6 fade-in",children:[d&&l.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 p-5 rounded-3xl shadow-card text-white",children:[l.jsxs("div",{className:"flex justify-between items-start mb-3",children:[l.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>p(k=>({...k,batches:!k.batches})),children:[l.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[l.jsx(hi,{className:"w-5 h-5"}),"Production Batches",T.batches?l.jsx(Hc,{className:"w-4 h-4"}):l.jsx(qc,{className:"w-4 h-4"})]}),l.jsx("p",{className:"text-xs opacity-80 mt-1",children:"Convert fabric to outfits"})]}),T.batches&&l.jsx("button",{onClick:d,className:"bg-white text-purple-600 px-4 py-2 rounded-xl font-bold text-sm hover:bg-purple-50",children:"+ New Batch"})]}),T.batches&&l.jsxs(l.Fragment,{children:[q.length>0&&l.jsxs("div",{className:"bg-white/20 backdrop-blur-sm p-3 rounded-xl mb-3",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(eT,{className:"w-4 h-4"}),l.jsx("span",{className:"text-xs font-bold",children:"Low Stock Alert"})]}),l.jsx("div",{className:"space-y-1",children:q.slice(0,3).map((k,O)=>l.jsxs("div",{className:"flex justify-between text-xs",children:[l.jsx("span",{children:k.name}),l.jsxs("span",{className:"font-bold",children:[k.totalStock," left"]})]},O))})]}),X.length>0?l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"text-xs opacity-80 mb-2",children:"Recent Batches:"}),X.map((k,O)=>l.jsx("div",{className:"bg-white/10 backdrop-blur-sm p-3 rounded-xl",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("p",{className:"font-bold text-sm",children:k.outfitName}),l.jsxs("p",{className:"text-xs opacity-80",children:[k.totalPieces," pcs from ",k.fabricName]})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("p",{className:"text-xs font-bold",children:["",(k.totalCostPerPiece||0).toFixed(0),"/pc"]}),l.jsx("p",{className:"text-xs opacity-70",children:G(k.receivedDate)})]})]})},O))]}):l.jsxs("div",{className:"text-center py-6 bg-white/10 backdrop-blur-sm rounded-xl",children:[l.jsx(hi,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),l.jsx("p",{className:"text-sm opacity-80",children:"No production batches yet"}),l.jsx("button",{onClick:d,className:"mt-3 bg-white text-purple-600 px-4 py-2 rounded-xl font-bold text-xs",children:"Create First Batch"})]})]})]}),l.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 p-5 rounded-3xl shadow-card text-white",children:[l.jsxs("div",{className:"cursor-pointer mb-3",onClick:()=>p(k=>({...k,stock:!k.stock})),children:[l.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[l.jsx(hi,{className:"w-5 h-5"}),"Ready Stock Orders",T.stock?l.jsx(Hc,{className:"w-4 h-4"}):l.jsx(qc,{className:"w-4 h-4"})]}),l.jsx("p",{className:"text-xs opacity-80 mt-1",children:"Fulfill customer orders from produced inventory"})]}),T.stock&&l.jsxs("form",{onSubmit:z,className:"space-y-3",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold opacity-90",children:"Order Number *"}),l.jsx("input",{className:"w-full p-2.5 rounded-xl mt-1 text-gray-900 text-sm",value:w.orderNumber,onChange:k=>S({...w,orderNumber:k.target.value}),placeholder:"e.g., 1001",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold opacity-90",children:"Select Outfit *"}),l.jsxs("select",{className:"w-full p-2.5 rounded-xl mt-1 text-gray-900 text-sm",value:w.outfitId,onChange:k=>S({...w,outfitId:k.target.value}),required:!0,children:[l.jsx("option",{value:"",children:"Choose outfit..."}),C.map(k=>l.jsxs("option",{value:k.id,children:[k.name," (",k.totalStock," pcs)"]},k.id))]})]})]}),A&&l.jsxs("div",{className:"bg-white/20 backdrop-blur-sm p-3 rounded-xl",children:[l.jsx("p",{className:"text-xs font-bold mb-2",children:"Available Stock:"}),l.jsx("div",{className:"flex gap-2 flex-wrap",children:["S","M","L","XL","XXL"].map(k=>{var K;const O=parseInt((K=A.stockBreakdown)==null?void 0:K[k])||0;return O===0?null:l.jsxs("div",{className:"bg-white/30 px-2 py-1 rounded-lg text-xs",children:[l.jsxs("span",{className:"font-bold",children:[k,":"]})," ",O]},k)})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold opacity-90",children:"Size *"}),l.jsx("select",{className:"w-full p-2.5 rounded-xl mt-1 text-gray-900 text-sm",value:w.size,onChange:k=>S({...w,size:k.target.value}),required:!0,children:["S","M","L","XL","XXL"].map(k=>{var O;return l.jsxs("option",{value:k,children:[k," ",A&&`(${parseInt((O=A.stockBreakdown)==null?void 0:O[k])||0} available)`]},k)})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold opacity-90",children:"Quantity *"}),l.jsx("input",{type:"number",min:"1",className:"w-full p-2.5 rounded-xl mt-1 text-gray-900 text-sm",value:w.quantity,onChange:k=>S({...w,quantity:k.target.value}),placeholder:"1",required:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold opacity-90",children:"Customer Name"}),l.jsx("input",{className:"w-full p-2.5 rounded-xl mt-1 text-gray-900 text-sm",value:w.customerName,onChange:k=>S({...w,customerName:k.target.value}),placeholder:"Customer name"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold opacity-90",children:"Phone"}),l.jsx("input",{className:"w-full p-2.5 rounded-xl mt-1 text-gray-900 text-sm",value:w.phone,onChange:k=>S({...w,phone:k.target.value}),placeholder:"Phone number"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold opacity-90",children:"Address"}),l.jsx("input",{className:"w-full p-2.5 rounded-xl mt-1 text-gray-900 text-sm",value:w.address,onChange:k=>S({...w,address:k.target.value}),placeholder:"Delivery address"})]})]}),l.jsx("button",{type:"submit",disabled:M||!w.outfitId,className:"w-full bg-white text-green-600 font-bold py-3 rounded-xl hover:bg-green-50 disabled:opacity-50 disabled:cursor-not-allowed",children:M?"Creating Order...":"Create Order"}),C.length===0&&l.jsx("div",{className:"text-center py-4 bg-white/10 backdrop-blur-sm rounded-xl",children:l.jsx("p",{className:"text-xs opacity-80",children:"No outfits in stock. Create production batches first!"})})]})]}),l.jsxs("div",{className:"bg-white p-5 rounded-3xl shadow-soft border-l-4 border-brand",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("div",{className:"flex-1 cursor-pointer",onClick:()=>p(k=>({...k,production:!k.production})),children:l.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[l.jsx(mT,{className:"w-5 h-5 text-brand"})," Production Queue",T.production?l.jsx(Hc,{className:"w-5 h-5 text-gray-400"}):l.jsx(qc,{className:"w-5 h-5 text-gray-400"})]})}),T.production&&i&&l.jsx("button",{onClick:i,className:"text-xs bg-gray-100 text-gray-600 px-3 py-1.5 rounded-full font-bold hover:bg-gray-200 flex items-center gap-1",children:"+ Log Past Order"})]}),T.production&&l.jsxs(l.Fragment,{children:[l.jsxs("form",{onSubmit:me,className:"space-y-3",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Order #"}),l.jsx("input",{className:"w-full p-2 bg-gray-50 rounded-xl mt-1 border-none text-sm",value:y.orderNumber,onChange:k=>g({...y,orderNumber:k.target.value}),placeholder:"101"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Select Fabric"}),l.jsxs("select",{className:"w-full p-2 bg-gray-50 rounded-xl mt-1 border-none text-sm",value:y.fabricId,onChange:k=>g({...y,fabricId:k.target.value}),children:[l.jsx("option",{value:"",children:"-- Choose --"}),v.map(k=>l.jsx("option",{value:k.id,children:k.name},k.id))]})]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Cut Amt"}),l.jsx("input",{type:"number",step:"0.1",className:"w-full p-2 bg-gray-50 rounded-xl mt-1 border-none text-sm",value:y.lengthToCut,onChange:k=>g({...y,lengthToCut:k.target.value}),placeholder:"0.0"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Stitching "}),l.jsx("input",{type:"number",className:"w-full p-2 bg-gray-50 rounded-xl mt-1 border-none text-sm",value:y.stitchingCost,onChange:k=>g({...y,stitchingCost:k.target.value}),placeholder:"0.00"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Acq. Cost "}),l.jsx("input",{type:"number",className:"w-full p-2 bg-gray-50 rounded-xl mt-1 border-none text-sm",value:y.acquisitionCost,onChange:k=>g({...y,acquisitionCost:k.target.value}),placeholder:"0.00"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Target Outfit"}),l.jsx("input",{list:"outfit-suggestions",className:"w-full p-2 bg-gray-50 rounded-xl mt-1 border-none text-sm",value:y.outfitName,onChange:k=>g({...y,outfitName:k.target.value}),placeholder:"e.g. Mirae"}),l.jsx("datalist",{id:"outfit-suggestions",children:_.map(k=>l.jsx("option",{value:k.name},k.id))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-1",children:"Target Size"}),l.jsx("div",{className:"flex bg-gray-50 p-1 rounded-xl gap-1 overflow-x-auto no-scrollbar",children:["S","M","L","XL","XXL","Custom"].map(k=>l.jsx("button",{type:"button",onClick:()=>g({...y,size:k}),className:`px-3 py-2 rounded-lg text-xs font-bold transition-all ${y.size===k?"bg-brand text-white shadow":"text-gray-500 hover:bg-gray-200"}`,children:k},k))})]}),l.jsx("button",{type:"submit",className:"w-full bg-gray-800 text-white py-2 rounded-xl font-bold text-sm hover:bg-gray-700",children:"+ Add to Queue"})]}),P.length>0&&l.jsxs("div",{className:"mt-4 border-t pt-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsxs("h4",{className:"text-xs font-bold text-gray-500 uppercase",children:["Pending Batch (",P.length,")"]}),l.jsx("button",{onClick:()=>R([]),className:"text-[10px] text-red-500 hover:underline",children:"Clear All"})]}),l.jsx("div",{className:"space-y-2 mb-4",children:P.map((k,O)=>l.jsxs("div",{className:"flex justify-between items-center text-sm bg-gray-50 p-2 rounded-lg",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-bold text-brand",children:k.fabricName}),k.cutAmount>0&&l.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["Cut: ",k.cutAmount," ",k.unit]}),l.jsxs("p",{className:"text-[10px] text-gray-400",children:["#",k.orderNumber,"  ",k.outfitName," (",k.size,")"]})]}),l.jsx("button",{onClick:()=>ie(O),className:"text-red-400 hover:text-red-600",children:l.jsx($r,{className:"w-4 h-4"})})]},O))}),l.jsx("button",{onClick:Ie,disabled:M,className:"w-full bg-brand text-white py-3 rounded-xl font-bold text-sm shadow-md",children:M?"Processing...":"Submit Batch to Production"})]})]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-end mb-3",children:[l.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[l.jsx(nT,{className:"w-5 h-5 text-accent"})," Order History"]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("select",{className:"text-xs bg-white border border-gray-200 rounded-lg p-1 text-gray-600",value:I,onChange:k=>j(k.target.value),children:[l.jsx("option",{value:"date_desc",children:"Newest"}),l.jsx("option",{value:"date_asc",children:"Oldest"})]}),l.jsxs("select",{className:"text-xs bg-white border border-gray-200 rounded-lg p-1 text-gray-600",value:b,onChange:k=>x(k.target.value),children:[l.jsx("option",{value:"active",children:"Active Only"}),l.jsx("option",{value:"completed",children:"Completed/Cancelled"})]})]})]}),l.jsx("div",{className:"space-y-3",children:N.map(k=>l.jsxs("div",{onClick:()=>s&&s(k),className:`bg-white p-4 rounded-2xl shadow-card flex flex-col gap-3 relative cursor-pointer active:scale-95 transition-transform ${k.status==="Cancelled"?"opacity-60 grayscale":""}`,children:[k.status!=="Cancelled"&&k.status!=="Order Shipped (Completed)"&&l.jsx("button",{onClick:O=>{O.stopPropagation(),o&&o(k)},className:"absolute top-3 right-3 text-gray-300 hover:text-red-500",children:l.jsx($r,{className:"w-5 h-5"})}),(k.status==="Cancelled"||k.status==="Order Shipped (Completed)")&&l.jsx("button",{onClick:O=>{O.stopPropagation(),u&&u(k.id)},className:"absolute bottom-3 right-3 text-gray-300 hover:text-red-500 z-10",children:l.jsx(eu,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("img",{src:k.imageUrl,className:"w-14 h-14 rounded-xl bg-gray-100 object-cover"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[l.jsxs("span",{className:"font-mono text-brand font-bold text-sm",children:["#",k.orderNumber]}),k.orderType==="stock"&&l.jsx("span",{className:"text-[10px] font-bold px-2 py-0.5 rounded bg-green-100 text-green-700",children:"STOCK"}),l.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded ${k.status==="Sent to Tailor"?"bg-yellow-100 text-yellow-700":k.status==="Ready to Ship"?"bg-blue-100 text-blue-700":k.status.includes("Shipped")?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:k.status})]}),l.jsxs("h4",{className:"font-bold text-gray-800 text-sm",children:[k.outfitName||"Unspecified",l.jsxs("span",{className:"text-xs bg-gray-100 px-1 rounded ml-1 text-gray-600",children:[k.quantity?`${k.quantity}x `:"","Size ",k.size]})]}),k.orderType==="stock"?l.jsxs("p",{className:"text-xs text-gray-500",children:["Cost: ",(k.productionCostPerPiece||0).toFixed(2),"/pc"]}):l.jsxs("p",{className:"text-xs text-gray-500",children:["Stitch Cost: ",k.stitchingCost||0]})]})]}),k.status!=="Cancelled"&&l.jsx("div",{className:"bg-gray-50 p-2 rounded-xl flex justify-between items-center mt-1",children:k.status==="Sent to Tailor"?l.jsx("button",{onClick:O=>{O.stopPropagation(),te(k.id)},className:"text-xs font-bold text-brand hover:underline",children:"Mark Received"}):k.status==="Received from Tailor"||k.status==="Ready to Ship"?l.jsxs("button",{onClick:O=>{O.stopPropagation(),c&&c(k.id)},className:"text-xs font-bold text-blue-600 hover:underline flex items-center gap-1",children:[l.jsx(bT,{className:"w-3 h-3"})," Ship It"]}):l.jsx("span",{className:"text-[10px] text-green-600 font-bold",children:"Done"})}),(k.customerName||k.phone||k.address)&&l.jsxs("div",{className:"text-[10px] text-gray-400 mt-1 border-t pt-1",children:[k.customerName," ",k.phone&&` ${k.phone}`," ",k.address&&` ${k.address}`]})]},k.id))})]})]})}function T2({onSuccess:t,onDataChanged:e}){const[n,r]=B.useState("fabric"),[s,i]=B.useState({name:"",websiteProductName:"",totalLength:"",unit:"meters",lengthRequiredPerOutfit:"",costPerMeter:"",parentFabricId:"",stockBreakdown:{S:0,M:0,L:0,XL:0,XXL:0},location:"",stitchingCost:"",sellingPrice:""}),[o,u]=B.useState(null),[c,d]=B.useState(!1),[f,y]=B.useState(""),g=S=>new Promise((P,R)=>{const b=new FileReader;b.readAsDataURL(S),b.onload=()=>P(b.result),b.onerror=x=>R(x)}),w=async S=>{S.preventDefault(),d(!0),y("");try{let P=`https://placehold.co/150x150/${n==="fabric"?"2e7d32":"7c3aed"}/ffffff?text=${s.name.substring(0,2).toUpperCase()}`;o&&(P=await g(o));const R={...s,type:n,imageUrl:P,updatedAt:ze(),createdAt:ze()};n==="fabric"&&(R.currentLength=parseFloat(s.totalLength),R.lengthRequiredPerOutfit=parseFloat(s.lengthRequiredPerOutfit),R.costPerMeter=parseFloat(s.costPerMeter),R.totalLength=parseFloat(s.totalLength),R.currentOrderStatus="None"),n==="outfit"&&(R.stitchingCost=parseFloat(s.stitchingCost)||0,R.sellingPrice=parseFloat(s.sellingPrice)||0,R.lengthRequiredPerOutfit=parseFloat(s.lengthRequiredPerOutfit)||0);const b=ft();await cn(at(b,Fn),R),i({name:"",websiteProductName:"",totalLength:"",unit:"meters",lengthRequiredPerOutfit:"",costPerMeter:"",parentFabricId:"",stockBreakdown:{S:0,M:0,L:0,XL:0,XXL:0},location:"",stitchingCost:"",sellingPrice:""}),u(null),e&&await e(),t&&t()}catch(P){y(P.message)}d(!1)};return l.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Add New Item"}),l.jsxs("div",{className:"bg-gray-100 rounded-2xl p-1 flex gap-1 mb-6",children:[l.jsx("button",{onClick:()=>r("fabric"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${n==="fabric"?"bg-white shadow text-brand":"text-gray-500"}`,children:"Fabric"}),l.jsx("button",{onClick:()=>r("outfit"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${n==="outfit"?"bg-white shadow text-outfit-600":"text-gray-500"}`,children:"Ready Outfit"})]}),l.jsxs("form",{onSubmit:w,className:"space-y-4",children:[f&&l.jsx("div",{className:"p-3 bg-red-50 text-red-600 text-sm rounded-xl",children:f}),l.jsxs("div",{className:"flex gap-3 items-center",children:[l.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-xl flex items-center justify-center overflow-hidden",children:o?l.jsx("img",{src:URL.createObjectURL(o),alt:"Preview",className:"w-full h-full object-cover"}):l.jsx("span",{className:"text-4xl text-gray-300",children:s.name?s.name.substring(0,2).toUpperCase():"+"})}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("label",{className:"px-4 py-2 bg-gray-100 text-gray-600 rounded-xl text-sm font-bold cursor-pointer hover:bg-gray-200",children:[" Camera",l.jsx("input",{type:"file",hidden:!0,capture:"environment",accept:"image/*",onChange:S=>u(S.target.files[0])})]}),l.jsxs("label",{className:"px-4 py-2 bg-gray-100 text-gray-600 rounded-xl text-sm font-bold cursor-pointer hover:bg-gray-200",children:[" Gallery",l.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:S=>u(S.target.files[0])})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Item Name"}),l.jsx("input",{required:!0,className:"w-full p-3 bg-white rounded-xl border border-gray-200 mt-1",placeholder:n==="fabric"?"e.g. Green Silk":"e.g. Mirae Suit",value:s.name,onChange:S=>i({...s,name:S.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Website Product Name (Optional)"}),l.jsx("input",{className:"w-full p-3 bg-white rounded-xl border border-gray-200 mt-1",placeholder:"Display name for e-commerce",value:s.websiteProductName,onChange:S=>i({...s,websiteProductName:S.target.value})})]}),n==="fabric"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Total Length"}),l.jsx("input",{type:"number",step:"0.1",required:!0,className:"w-full p-3 bg-white rounded-xl border border-gray-200 mt-1",placeholder:"e.g. 10.5",value:s.totalLength,onChange:S=>i({...s,totalLength:S.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Unit"}),l.jsxs("select",{className:"w-full p-3 bg-white rounded-xl border border-gray-200 mt-1",value:s.unit,onChange:S=>i({...s,unit:S.target.value}),children:[l.jsx("option",{value:"meters",children:"Meters"}),l.jsx("option",{value:"yards",children:"Yards"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Length per Outfit"}),l.jsx("input",{type:"number",step:"0.1",required:!0,className:"w-full p-3 bg-white rounded-xl border border-gray-200 mt-1",placeholder:"e.g. 2.5",value:s.lengthRequiredPerOutfit,onChange:S=>i({...s,lengthRequiredPerOutfit:S.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Cost per Meter ()"}),l.jsx("input",{type:"number",step:"0.01",required:!0,className:"w-full p-3 bg-white rounded-xl border border-gray-200 mt-1",placeholder:"e.g. 450",value:s.costPerMeter,onChange:S=>i({...s,costPerMeter:S.target.value})})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Location"}),l.jsx("input",{className:"w-full p-3 bg-white rounded-xl border border-gray-200 mt-1",placeholder:"e.g. Shelf A3",value:s.location,onChange:S=>i({...s,location:S.target.value})})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Selling Price ()"}),l.jsx("input",{type:"number",required:!0,className:"w-full p-3 bg-white rounded-xl border border-gray-200 mt-1",placeholder:"e.g. 2999",value:s.sellingPrice,onChange:S=>i({...s,sellingPrice:S.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Stitching Cost ()"}),l.jsx("input",{type:"number",className:"w-full p-3 bg-white rounded-xl border border-gray-200 mt-1",placeholder:"e.g. 500",value:s.stitchingCost,onChange:S=>i({...s,stitchingCost:S.target.value})})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Fabric Length Required"}),l.jsx("input",{type:"number",step:"0.1",className:"w-full p-3 bg-white rounded-xl border border-gray-200 mt-1",placeholder:"e.g. 2.5",value:s.lengthRequiredPerOutfit,onChange:S=>i({...s,lengthRequiredPerOutfit:S.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Location"}),l.jsx("input",{className:"w-full p-3 bg-white rounded-xl border border-gray-200 mt-1",placeholder:"e.g. Rack B2",value:s.location,onChange:S=>i({...s,location:S.target.value})})]})]}),l.jsx("button",{type:"submit",disabled:c,className:"w-full py-4 rounded-xl font-bold text-white shadow-lg mt-4 bg-brand hover:bg-brand-dark active:bg-brand-dark disabled:opacity-50",children:c?"Saving...":"Add Item"})]})]})}var Fw={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){((n,r)=>{t.exports=r()})(h1,function n(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},s,i=!r.document&&!!r.postMessage,o=r.IS_PAPA_WORKER||!1,u={},c=0,d={};function f(p){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(v){var _=M(v);_.chunkSize=parseInt(_.chunkSize),v.step||v.chunk||(_.chunkSize=null),this._handle=new P(_),(this._handle.streamer=this)._config=_}).call(this,p),this.parseChunk=function(v,_){var C=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<C){let N=this._config.newline;N||(A=this._config.quoteChar||'"',N=this._handle.guessLineEndings(v,A)),v=[...v.split(N).slice(C)].join(N)}this.isFirstChunk&&T(this._config.beforeFirstChunk)&&(A=this._config.beforeFirstChunk(v))!==void 0&&(v=A),this.isFirstChunk=!1,this._halted=!1;var C=this._partialLine+v,A=(this._partialLine="",this._handle.parse(C,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(v=A.meta.cursor,C=(this._finished||(this._partialLine=C.substring(v-this._baseIndex),this._baseIndex=v),A&&A.data&&(this._rowCount+=A.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)r.postMessage({results:A,workerId:d.WORKER_ID,finished:C});else if(T(this._config.chunk)&&!_){if(this._config.chunk(A,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=A=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(A.data),this._completeResults.errors=this._completeResults.errors.concat(A.errors),this._completeResults.meta=A.meta),this._completed||!C||!T(this._config.complete)||A&&A.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),C||A&&A.meta.paused||this._nextChunk(),A}this._halted=!0},this._sendError=function(v){T(this._config.error)?this._config.error(v):o&&this._config.error&&r.postMessage({workerId:d.WORKER_ID,error:v,finished:!1})}}function y(p){var v;(p=p||{}).chunkSize||(p.chunkSize=d.RemoteChunkSize),f.call(this,p),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(_){this._input=_,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(v=new XMLHttpRequest,this._config.withCredentials&&(v.withCredentials=this._config.withCredentials),i||(v.onload=V(this._chunkLoaded,this),v.onerror=V(this._chunkError,this)),v.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var _,C=this._config.downloadRequestHeaders;for(_ in C)v.setRequestHeader(_,C[_])}var A;this._config.chunkSize&&(A=this._start+this._config.chunkSize-1,v.setRequestHeader("Range","bytes="+this._start+"-"+A));try{v.send(this._config.downloadRequestBody)}catch(N){this._chunkError(N.message)}i&&v.status===0&&this._chunkError()}},this._chunkLoaded=function(){v.readyState===4&&(v.status<200||400<=v.status?this._chunkError():(this._start+=this._config.chunkSize||v.responseText.length,this._finished=!this._config.chunkSize||this._start>=(_=>(_=_.getResponseHeader("Content-Range"))!==null?parseInt(_.substring(_.lastIndexOf("/")+1)):-1)(v),this.parseChunk(v.responseText)))},this._chunkError=function(_){_=v.statusText||_,this._sendError(new Error(_))}}function g(p){(p=p||{}).chunkSize||(p.chunkSize=d.LocalChunkSize),f.call(this,p);var v,_,C=typeof FileReader<"u";this.stream=function(A){this._input=A,_=A.slice||A.webkitSlice||A.mozSlice,C?((v=new FileReader).onload=V(this._chunkLoaded,this),v.onerror=V(this._chunkError,this)):v=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var A=this._input,N=(this._config.chunkSize&&(N=Math.min(this._start+this._config.chunkSize,this._input.size),A=_.call(A,this._start,N)),v.readAsText(A,this._config.encoding));C||this._chunkLoaded({target:{result:N}})},this._chunkLoaded=function(A){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(A.target.result)},this._chunkError=function(){this._sendError(v.error)}}function w(p){var v;f.call(this,p=p||{}),this.stream=function(_){return v=_,this._nextChunk()},this._nextChunk=function(){var _,C;if(!this._finished)return _=this._config.chunkSize,v=_?(C=v.substring(0,_),v.substring(_)):(C=v,""),this._finished=!v,this.parseChunk(C)}}function S(p){f.call(this,p=p||{});var v=[],_=!0,C=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(A){this._input=A,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){C&&v.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),v.length?this.parseChunk(v.shift()):_=!0},this._streamData=V(function(A){try{v.push(typeof A=="string"?A:A.toString(this._config.encoding)),_&&(_=!1,this._checkIsFinished(),this.parseChunk(v.shift()))}catch(N){this._streamError(N)}},this),this._streamError=V(function(A){this._streamCleanUp(),this._sendError(A)},this),this._streamEnd=V(function(){this._streamCleanUp(),C=!0,this._streamData("")},this),this._streamCleanUp=V(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function P(p){var v,_,C,A,N=Math.pow(2,53),me=-N,ie=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Ie=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,te=this,z=0,q=0,X=!1,G=!1,k=[],O={data:[],errors:[],meta:{}};function K(Y){return p.skipEmptyLines==="greedy"?Y.join("").trim()==="":Y.length===1&&Y[0].length===0}function se(){if(O&&C&&(H("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),C=!1),p.skipEmptyLines&&(O.data=O.data.filter(function(ne){return!K(ne)})),F()){let ne=function(xe,Ce){T(p.transformHeader)&&(xe=p.transformHeader(xe,Ce)),k.push(xe)};if(O)if(Array.isArray(O.data[0])){for(var Y=0;F()&&Y<O.data.length;Y++)O.data[Y].forEach(ne);O.data.splice(0,1)}else O.data.forEach(ne)}function ue(ne,xe){for(var Ce=p.header?{}:[],ge=0;ge<ne.length;ge++){var ye=ge,ve=ne[ge],ve=((jt,fe)=>(je=>(p.dynamicTypingFunction&&p.dynamicTyping[je]===void 0&&(p.dynamicTyping[je]=p.dynamicTypingFunction(je)),(p.dynamicTyping[je]||p.dynamicTyping)===!0))(jt)?fe==="true"||fe==="TRUE"||fe!=="false"&&fe!=="FALSE"&&((je=>{if(ie.test(je)&&(je=parseFloat(je),me<je&&je<N))return 1})(fe)?parseFloat(fe):Ie.test(fe)?new Date(fe):fe===""?null:fe):fe)(ye=p.header?ge>=k.length?"__parsed_extra":k[ge]:ye,ve=p.transform?p.transform(ve,ye):ve);ye==="__parsed_extra"?(Ce[ye]=Ce[ye]||[],Ce[ye].push(ve)):Ce[ye]=ve}return p.header&&(ge>k.length?H("FieldMismatch","TooManyFields","Too many fields: expected "+k.length+" fields but parsed "+ge,q+xe):ge<k.length&&H("FieldMismatch","TooFewFields","Too few fields: expected "+k.length+" fields but parsed "+ge,q+xe)),Ce}var oe;O&&(p.header||p.dynamicTyping||p.transform)&&(oe=1,!O.data.length||Array.isArray(O.data[0])?(O.data=O.data.map(ue),oe=O.data.length):O.data=ue(O.data,0),p.header&&O.meta&&(O.meta.fields=k),q+=oe)}function F(){return p.header&&k.length===0}function H(Y,ue,oe,ne){Y={type:Y,code:ue,message:oe},ne!==void 0&&(Y.row=ne),O.errors.push(Y)}T(p.step)&&(A=p.step,p.step=function(Y){O=Y,F()?se():(se(),O.data.length!==0&&(z+=Y.data.length,p.preview&&z>p.preview?_.abort():(O.data=O.data[0],A(O,te))))}),this.parse=function(Y,ue,oe){var ne=p.quoteChar||'"',ne=(p.newline||(p.newline=this.guessLineEndings(Y,ne)),C=!1,p.delimiter?T(p.delimiter)&&(p.delimiter=p.delimiter(Y),O.meta.delimiter=p.delimiter):((ne=((xe,Ce,ge,ye,ve)=>{var jt,fe,je,Ut;ve=ve||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var J=0;J<ve.length;J++){for(var le,De=ve[J],Ze=0,Qt=0,Te=0,Ae=(je=void 0,new b({comments:ye,delimiter:De,newline:Ce,preview:10}).parse(xe)),zt=0;zt<Ae.data.length;zt++)ge&&K(Ae.data[zt])?Te++:(le=Ae.data[zt].length,Qt+=le,je===void 0?je=le:0<le&&(Ze+=Math.abs(le-je),je=le));0<Ae.data.length&&(Qt/=Ae.data.length-Te),(fe===void 0||Ze<=fe)&&(Ut===void 0||Ut<Qt)&&1.99<Qt&&(fe=Ze,jt=De,Ut=Qt)}return{successful:!!(p.delimiter=jt),bestDelimiter:jt}})(Y,p.newline,p.skipEmptyLines,p.comments,p.delimitersToGuess)).successful?p.delimiter=ne.bestDelimiter:(C=!0,p.delimiter=d.DefaultDelimiter),O.meta.delimiter=p.delimiter),M(p));return p.preview&&p.header&&ne.preview++,v=Y,_=new b(ne),O=_.parse(v,ue,oe),se(),X?{meta:{paused:!0}}:O||{meta:{paused:!1}}},this.paused=function(){return X},this.pause=function(){X=!0,_.abort(),v=T(p.chunk)?"":v.substring(_.getCharIndex())},this.resume=function(){te.streamer._halted?(X=!1,te.streamer.parseChunk(v,!0)):setTimeout(te.resume,3)},this.aborted=function(){return G},this.abort=function(){G=!0,_.abort(),O.meta.aborted=!0,T(p.complete)&&p.complete(O),v=""},this.guessLineEndings=function(xe,ne){xe=xe.substring(0,1048576);var ne=new RegExp(R(ne)+"([^]*?)"+R(ne),"gm"),oe=(xe=xe.replace(ne,"")).split("\r"),ne=xe.split(`
`),xe=1<ne.length&&ne[0].length<oe[0].length;if(oe.length===1||xe)return`
`;for(var Ce=0,ge=0;ge<oe.length;ge++)oe[ge][0]===`
`&&Ce++;return Ce>=oe.length/2?`\r
`:"\r"}}function R(p){return p.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function b(p){var v=(p=p||{}).delimiter,_=p.newline,C=p.comments,A=p.step,N=p.preview,me=p.fastMode,ie=null,Ie=!1,te=p.quoteChar==null?'"':p.quoteChar,z=te;if(p.escapeChar!==void 0&&(z=p.escapeChar),(typeof v!="string"||-1<d.BAD_DELIMITERS.indexOf(v))&&(v=","),C===v)throw new Error("Comment character same as delimiter");C===!0?C="#":(typeof C!="string"||-1<d.BAD_DELIMITERS.indexOf(C))&&(C=!1),_!==`
`&&_!=="\r"&&_!==`\r
`&&(_=`
`);var q=0,X=!1;this.parse=function(G,k,O){if(typeof G!="string")throw new Error("Input must be a string");var K=G.length,se=v.length,F=_.length,H=C.length,Y=T(A),ue=[],oe=[],ne=[],xe=q=0;if(!G)return Ze();if(me||me!==!1&&G.indexOf(te)===-1){for(var Ce=G.split(_),ge=0;ge<Ce.length;ge++){if(ne=Ce[ge],q+=ne.length,ge!==Ce.length-1)q+=_.length;else if(O)return Ze();if(!C||ne.substring(0,H)!==C){if(Y){if(ue=[],Ut(ne.split(v)),Qt(),X)return Ze()}else Ut(ne.split(v));if(N&&N<=ge)return ue=ue.slice(0,N),Ze(!0)}}return Ze()}for(var ye=G.indexOf(v,q),ve=G.indexOf(_,q),jt=new RegExp(R(z)+R(te),"g"),fe=G.indexOf(te,q);;)if(G[q]===te)for(fe=q,q++;;){if((fe=G.indexOf(te,fe+1))===-1)return O||oe.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ue.length,index:q}),le();if(fe===K-1)return le(G.substring(q,fe).replace(jt,te));if(te===z&&G[fe+1]===z)fe++;else if(te===z||fe===0||G[fe-1]!==z){ye!==-1&&ye<fe+1&&(ye=G.indexOf(v,fe+1));var je=J((ve=ve!==-1&&ve<fe+1?G.indexOf(_,fe+1):ve)===-1?ye:Math.min(ye,ve));if(G.substr(fe+1+je,se)===v){ne.push(G.substring(q,fe).replace(jt,te)),G[q=fe+1+je+se]!==te&&(fe=G.indexOf(te,q)),ye=G.indexOf(v,q),ve=G.indexOf(_,q);break}if(je=J(ve),G.substring(fe+1+je,fe+1+je+F)===_){if(ne.push(G.substring(q,fe).replace(jt,te)),De(fe+1+je+F),ye=G.indexOf(v,q),fe=G.indexOf(te,q),Y&&(Qt(),X))return Ze();if(N&&ue.length>=N)return Ze(!0);break}oe.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ue.length,index:q}),fe++}}else if(C&&ne.length===0&&G.substring(q,q+H)===C){if(ve===-1)return Ze();q=ve+F,ve=G.indexOf(_,q),ye=G.indexOf(v,q)}else if(ye!==-1&&(ye<ve||ve===-1))ne.push(G.substring(q,ye)),q=ye+se,ye=G.indexOf(v,q);else{if(ve===-1)break;if(ne.push(G.substring(q,ve)),De(ve+F),Y&&(Qt(),X))return Ze();if(N&&ue.length>=N)return Ze(!0)}return le();function Ut(Te){ue.push(Te),xe=q}function J(Te){var Ae=0;return Ae=Te!==-1&&(Te=G.substring(fe+1,Te))&&Te.trim()===""?Te.length:Ae}function le(Te){return O||(Te===void 0&&(Te=G.substring(q)),ne.push(Te),q=K,Ut(ne),Y&&Qt()),Ze()}function De(Te){q=Te,Ut(ne),ne=[],ve=G.indexOf(_,q)}function Ze(Te){if(p.header&&!k&&ue.length&&!Ie){var Ae=ue[0],zt=Object.create(null),Os=new Set(Ae);let Ui=!1;for(let ar=0;ar<Ae.length;ar++){let wt=Ae[ar];if(zt[wt=T(p.transformHeader)?p.transformHeader(wt,ar):wt]){let lr,zi=zt[wt];for(;lr=wt+"_"+zi,zi++,Os.has(lr););Os.add(lr),Ae[ar]=lr,zt[wt]++,Ui=!0,(ie=ie===null?{}:ie)[lr]=wt}else zt[wt]=1,Ae[ar]=wt;Os.add(wt)}Ui&&console.warn("Duplicate headers found and renamed."),Ie=!0}return{data:ue,errors:oe,meta:{delimiter:v,linebreak:_,aborted:X,truncated:!!Te,cursor:xe+(k||0),renamedHeaders:ie}}}function Qt(){A(Ze()),ue=[],oe=[]}},this.abort=function(){X=!0},this.getCharIndex=function(){return q}}function x(p){var v=p.data,_=u[v.workerId],C=!1;if(v.error)_.userError(v.error,v.file);else if(v.results&&v.results.data){var A={abort:function(){C=!0,I(v.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:j,resume:j};if(T(_.userStep)){for(var N=0;N<v.results.data.length&&(_.userStep({data:v.results.data[N],errors:v.results.errors,meta:v.results.meta},A),!C);N++);delete v.results}else T(_.userChunk)&&(_.userChunk(v.results,A,v.file),delete v.results)}v.finished&&!C&&I(v.workerId,v.results)}function I(p,v){var _=u[p];T(_.userComplete)&&_.userComplete(v),_.terminate(),delete u[p]}function j(){throw new Error("Not implemented.")}function M(p){if(typeof p!="object"||p===null)return p;var v,_=Array.isArray(p)?[]:{};for(v in p)_[v]=M(p[v]);return _}function V(p,v){return function(){p.apply(v,arguments)}}function T(p){return typeof p=="function"}return d.parse=function(p,v){var _=(v=v||{}).dynamicTyping||!1;if(T(_)&&(v.dynamicTypingFunction=_,_={}),v.dynamicTyping=_,v.transform=!!T(v.transform)&&v.transform,!v.worker||!d.WORKERS_SUPPORTED)return _=null,d.NODE_STREAM_INPUT,typeof p=="string"?(p=(C=>C.charCodeAt(0)!==65279?C:C.slice(1))(p),_=new(v.download?y:w)(v)):p.readable===!0&&T(p.read)&&T(p.on)?_=new S(v):(r.File&&p instanceof File||p instanceof Object)&&(_=new g(v)),_.stream(p);(_=(()=>{var C;return!!d.WORKERS_SUPPORTED&&(C=(()=>{var A=r.URL||r.webkitURL||null,N=n.toString();return d.BLOB_URL||(d.BLOB_URL=A.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",N,")();"],{type:"text/javascript"})))})(),(C=new r.Worker(C)).onmessage=x,C.id=c++,u[C.id]=C)})()).userStep=v.step,_.userChunk=v.chunk,_.userComplete=v.complete,_.userError=v.error,v.step=T(v.step),v.chunk=T(v.chunk),v.complete=T(v.complete),v.error=T(v.error),delete v.worker,_.postMessage({input:p,config:v,workerId:_.id})},d.unparse=function(p,v){var _=!1,C=!0,A=",",N=`\r
`,me='"',ie=me+me,Ie=!1,te=null,z=!1,q=((()=>{if(typeof v=="object"){if(typeof v.delimiter!="string"||d.BAD_DELIMITERS.filter(function(k){return v.delimiter.indexOf(k)!==-1}).length||(A=v.delimiter),typeof v.quotes!="boolean"&&typeof v.quotes!="function"&&!Array.isArray(v.quotes)||(_=v.quotes),typeof v.skipEmptyLines!="boolean"&&typeof v.skipEmptyLines!="string"||(Ie=v.skipEmptyLines),typeof v.newline=="string"&&(N=v.newline),typeof v.quoteChar=="string"&&(me=v.quoteChar),typeof v.header=="boolean"&&(C=v.header),Array.isArray(v.columns)){if(v.columns.length===0)throw new Error("Option columns is empty");te=v.columns}v.escapeChar!==void 0&&(ie=v.escapeChar+me),v.escapeFormulae instanceof RegExp?z=v.escapeFormulae:typeof v.escapeFormulae=="boolean"&&v.escapeFormulae&&(z=/^[=+\-@\t\r].*$/)}})(),new RegExp(R(me),"g"));if(typeof p=="string"&&(p=JSON.parse(p)),Array.isArray(p)){if(!p.length||Array.isArray(p[0]))return X(null,p,Ie);if(typeof p[0]=="object")return X(te||Object.keys(p[0]),p,Ie)}else if(typeof p=="object")return typeof p.data=="string"&&(p.data=JSON.parse(p.data)),Array.isArray(p.data)&&(p.fields||(p.fields=p.meta&&p.meta.fields||te),p.fields||(p.fields=Array.isArray(p.data[0])?p.fields:typeof p.data[0]=="object"?Object.keys(p.data[0]):[]),Array.isArray(p.data[0])||typeof p.data[0]=="object"||(p.data=[p.data])),X(p.fields||[],p.data||[],Ie);throw new Error("Unable to serialize unrecognized input");function X(k,O,K){var se="",F=(typeof k=="string"&&(k=JSON.parse(k)),typeof O=="string"&&(O=JSON.parse(O)),Array.isArray(k)&&0<k.length),H=!Array.isArray(O[0]);if(F&&C){for(var Y=0;Y<k.length;Y++)0<Y&&(se+=A),se+=G(k[Y],Y);0<O.length&&(se+=N)}for(var ue=0;ue<O.length;ue++){var oe=(F?k:O[ue]).length,ne=!1,xe=F?Object.keys(O[ue]).length===0:O[ue].length===0;if(K&&!F&&(ne=K==="greedy"?O[ue].join("").trim()==="":O[ue].length===1&&O[ue][0].length===0),K==="greedy"&&F){for(var Ce=[],ge=0;ge<oe;ge++){var ye=H?k[ge]:ge;Ce.push(O[ue][ye])}ne=Ce.join("").trim()===""}if(!ne){for(var ve=0;ve<oe;ve++){0<ve&&!xe&&(se+=A);var jt=F&&H?k[ve]:ve;se+=G(O[ue][jt],ve)}ue<O.length-1&&(!K||0<oe&&!xe)&&(se+=N)}}return se}function G(k,O){var K,se;return k==null?"":k.constructor===Date?JSON.stringify(k).slice(1,25):(se=!1,z&&typeof k=="string"&&z.test(k)&&(k="'"+k,se=!0),K=k.toString().replace(q,ie),(se=se||_===!0||typeof _=="function"&&_(k,O)||Array.isArray(_)&&_[O]||((F,H)=>{for(var Y=0;Y<H.length;Y++)if(-1<F.indexOf(H[Y]))return!0;return!1})(K,d.BAD_DELIMITERS)||-1<K.indexOf(A)||K.charAt(0)===" "||K.charAt(K.length-1)===" ")?me+K+me:K)}},d.RECORD_SEP="",d.UNIT_SEP="",d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!i&&!!r.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=b,d.ParserHandle=P,d.NetworkStreamer=y,d.FileStreamer=g,d.StringStreamer=w,d.ReadableStreamStreamer=S,r.jQuery&&((s=r.jQuery).fn.parse=function(p){var v=p.config||{},_=[];return this.each(function(N){if(!(s(this).prop("tagName").toUpperCase()==="INPUT"&&s(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var me=0;me<this.files.length;me++)_.push({file:this.files[me],inputElem:this,instanceConfig:s.extend({},v)})}),C(),this;function C(){if(_.length===0)T(p.complete)&&p.complete();else{var N,me,ie,Ie,te=_[0];if(T(p.before)){var z=p.before(te.file,te.inputElem);if(typeof z=="object"){if(z.action==="abort")return N="AbortError",me=te.file,ie=te.inputElem,Ie=z.reason,void(T(p.error)&&p.error({name:N},me,ie,Ie));if(z.action==="skip")return void A();typeof z.config=="object"&&(te.instanceConfig=s.extend(te.instanceConfig,z.config))}else if(z==="skip")return void A()}var q=te.instanceConfig.complete;te.instanceConfig.complete=function(X){T(q)&&q(X,te.file,te.inputElem),A()},d.parse(te.file,te.instanceConfig)}}function A(){_.splice(0,1),C()}}),o&&(r.onmessage=function(p){p=p.data,d.WORKER_ID===void 0&&p&&(d.WORKER_ID=p.workerId),typeof p.input=="string"?r.postMessage({workerId:d.WORKER_ID,results:d.parse(p.input,p.config),finished:!0}):(r.File&&p.input instanceof File||p.input instanceof Object)&&(p=d.parse(p.input,p.config))&&r.postMessage({workerId:d.WORKER_ID,results:p,finished:!0})}),(y.prototype=Object.create(f.prototype)).constructor=y,(g.prototype=Object.create(f.prototype)).constructor=g,(w.prototype=Object.create(w.prototype)).constructor=w,(S.prototype=Object.create(f.prototype)).constructor=S,d})})(Fw);var I2=Fw.exports;const Hy=Wy(I2);function N2(){const[t,e]=B.useState(""),[n,r]=B.useState(!1),[s,i]=B.useState(!1),[o,u]=B.useState(""),[c,d]=B.useState([]),[f,y]=B.useState(""),g=()=>{if(!t)return u("Provide sheet id");r(!0);const P=`https://docs.google.com/spreadsheets/d/${t}/export?format=csv`;Hy.parse(P,{download:!0,header:!0,complete:R=>{const b=(R.data||[]).filter(x=>Object.values(x).some(I=>I!=null&&I!==""));d(b),u(`Fetched ${b.length} rows  preview below. Tap Import to save.`),r(!1)},error:R=>{u("Fetch failed: "+R.message),r(!1)}})},w=()=>{if(!f)return u("Paste CSV content or fetch a sheet");try{const R=(Hy.parse(f,{header:!0}).data||[]).filter(b=>Object.values(b).some(x=>x!=null&&x!==""));d(R),u(`Parsed ${R.length} rows from pasted CSV.`)}catch(P){u("Parse failed: "+P.message)}},S=async()=>{if(!c||!c.length)return u("No data to import");i(!0);try{const P=ft();let R=0;for(const b of c)await cn(at(P,Ur),{importedData:b,createdAt:ze()}),R++;u(`Imported ${R} rows`),d([]),y("")}catch(P){u("Import failed: "+P.message)}i(!1)};return l.jsxs("div",{className:"p-4 max-w-3xl mx-auto",children:[l.jsx("h3",{className:"font-bold mb-3 text-lg",children:"Import Google Sheet / CSV"}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-3",children:[l.jsx("input",{value:t,onChange:P=>e(P.target.value),placeholder:"Google Sheet ID (or leave blank)",className:"flex-1 p-3 rounded border bg-white text-sm"}),l.jsx("button",{onClick:g,className:"w-full sm:w-auto px-4 py-3 bg-green-600 text-white rounded shadow",disabled:n,children:n?"Fetching":"Fetch Sheet"})]}),l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Or paste raw CSV data"}),l.jsx("textarea",{rows:6,value:f,onChange:P=>y(P.target.value),placeholder:"Paste CSV here",className:"w-full mt-2 p-3 rounded border bg-white text-sm font-mono"}),l.jsxs("div",{className:"flex gap-2 mt-2",children:[l.jsx("button",{onClick:w,className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded",children:"Parse Pasted CSV"}),l.jsx("button",{onClick:()=>{y(""),d([]),u("Cleared")},className:"px-4 py-3 bg-gray-100 rounded",children:"Clear"})]})]}),l.jsxs("div",{className:"mb-3",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h4",{className:"text-sm font-bold",children:"Preview"}),l.jsxs("div",{className:"text-xs text-gray-500",children:["Rows: ",c.length]})]}),c.length>0?l.jsxs("div",{className:"overflow-x-auto border rounded-lg bg-white",children:[l.jsxs("table",{className:"w-full text-xs table-auto",children:[l.jsx("thead",{className:"bg-gray-50 text-gray-600",children:l.jsx("tr",{children:Object.keys(c[0]).slice(0,10).map(P=>l.jsx("th",{className:"p-2 border-b",children:P},P))})}),l.jsx("tbody",{children:c.slice(0,5).map((P,R)=>l.jsx("tr",{className:"border-b hover:bg-gray-50",children:Object.values(P).slice(0,10).map((b,x)=>l.jsx("td",{className:"p-2 align-top whitespace-nowrap overflow-hidden text-ellipsis max-w-[10rem]",children:b},x))},R))})]}),l.jsx("div",{className:"text-[11px] text-gray-500 p-2",children:"Showing first 5 rows"})]}):l.jsx("div",{className:"text-center py-6 text-gray-400 bg-white border rounded-lg",children:"No data loaded."})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:S,disabled:s||c.length===0,className:"flex-1 px-4 py-3 bg-green-600 text-white rounded shadow",children:s?"Importing":"Import Parsed Data"}),l.jsx("button",{onClick:()=>{d([]),u("Cleared parsed data")},className:"px-4 py-3 bg-gray-100 rounded",children:"Reset"})]}),o&&l.jsx("p",{className:"text-sm text-gray-600 mt-3",children:o})]})}function S2({allOrders:t=[],inventoryItems:e=[],userRole:n="admin"}){const[r,s]=B.useState("all"),i=f=>{const y=parseFloat(f);return isNaN(y)?0:y},o=f=>f?Object.values(f).reduce((y,g)=>y+(parseInt(g)||0),0):0,u=(f,y)=>{if(!f.parentFabricId)return 0;const g=y.find(P=>P.id===f.parentFabricId);if(!g)return 0;const w=(parseFloat(g.costPerMeter)||0)*(parseFloat(f.lengthRequiredPerOutfit)||0),S=parseFloat(f.stitchingCost)||0;return w+S},c=B.useMemo(()=>{let f=0,y=0,g=0,w=0;e.forEach(b=>{if(b.type==="outfit"){const x=o(b.stockBreakdown);y+=x,f+=x*(b.sellingPrice||0);const I=u(b,e);w+=x*I}else if(b.type==="fabric"){const x=parseFloat(b.currentLength)||0,I=parseFloat(b.costPerMeter)||0,j=parseFloat(b.lengthRequiredPerOutfit)||1,M=parseFloat(b.sellingPrice)>0?parseFloat(b.sellingPrice):1500;g+=x*I;const V=Math.floor(x/(j>0?j:1));f+=V*M}});const S=g+w,P=f-S,R=S>0?P/S*100:0;return{potentialRevenue:f,totalStockCount:y,totalFabricCostValuation:g,totalOutfitCostValuation:w,totalStockValuation:S,percentageIncrease:R}},[e]),d=B.useMemo(()=>{const f=new Date().getMonth(),y=new Date().getFullYear(),g=t.filter(ie=>{var Ie;if(ie.status==="Cancelled")return!1;if(r==="month"){let te=null;return(Ie=ie.createdAt)!=null&&Ie.toDate?te=ie.createdAt.toDate():ie.dateString&&(te=new Date(ie.dateString)),!te||isNaN(te.getTime())?!1:te.getMonth()===f&&te.getFullYear()===y}return!0});let w=0,S=0,P=0,R=0,b=0,x=0,I=0,j=0,M=0,V=0,T=0;const p={},v=new Date;v.setHours(0,0,0,0),g.forEach(ie=>{const Ie=e.find(K=>K.id===ie.fabricId)||{costPerMeter:0},te=parseFloat(ie.cutAmount)||0,z=te*(parseFloat(Ie.costPerMeter)||0),q=i(ie.stitchingCost),X=i(ie.acquisitionCost)||i(ie.codCharge),G=i(ie.shippingCost),k=i(ie.otherExpenses),O=i(ie.finalSellingPrice)||i(ie.orderTotal);if(O>0||ie.status==="Order Shipped (Completed)"){w+=O,S++,b+=te,x+=z,I+=q,j+=G,M+=X+k;const K=O-z-q-X-G-k;P+=K,ie.createdAt&&typeof ie.createdAt.toDate=="function"&&ie.createdAt.toDate()>=v&&(R+=K);const se=(ie.paymentMethod||"").toLowerCase();if(se.includes("cod")||se.includes("cash")?V++:T++,ie.customerName){const F=ie.customerName.toLowerCase().trim();p[F]||(p[F]={name:ie.customerName,revenue:0,orders:0}),p[F].revenue+=O,p[F].orders++}}});const _=w>0?P/w*100:0,C=b>0?w/b:0,A=Object.values(p).sort((ie,Ie)=>Ie.revenue-ie.revenue).slice(0,5),N=Object.keys(p).length,me=N>0?w/N:0;return{totalRevenue:w.toFixed(0),totalProfit:P.toFixed(0),totalSold:S,dailyProfit:R,revPerMeter:C.toFixed(0),profitMargin:_.toFixed(1),breakdown:{fabric:x,stitch:I,ship:j,cod:M,ops:M+j},paymentSplit:{cod:V,prepaid:T},customerMetrics:{totalCustomers:N,avgRevenue:me,topCustomers:A}}},[e,t,r]);return l.jsxs(l.Fragment,{children:[n==="admin"&&l.jsx("div",{className:"flex justify-end mb-4",children:l.jsxs("div",{className:"bg-gray-100 p-1 rounded-lg flex text-xs font-bold",children:[l.jsx("button",{onClick:()=>s("all"),className:`px-3 py-1 rounded-md ${r==="all"?"bg-white shadow text-gray-900":"text-gray-500"}`,children:"All Time"}),l.jsx("button",{onClick:()=>s("month"),className:`px-3 py-1 rounded-md ${r==="month"?"bg-white shadow text-gray-900":"text-gray-500"}`,children:"This Month"})]})}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-brand text-white p-5 rounded-3xl shadow-soft flex flex-col justify-between h-40 relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-20",children:l.jsx(Qd,{className:"w-12 h-12"})}),l.jsxs("div",{children:[n==="admin"?l.jsxs(l.Fragment,{children:[l.jsxs("h3",{className:"text-2xl font-bold",children:["",parseInt(d.totalRevenue).toLocaleString()]}),l.jsx("p",{className:"text-brand-100 text-xs font-medium mt-1",children:"Total Revenue"})]}):l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-2xl font-bold",children:d.totalSold}),l.jsx("p",{className:"text-brand-100 text-xs font-medium mt-1",children:"Total Orders"})]}),l.jsxs("p",{className:"text-[10px] text-brand-200 mt-1",children:[d.totalSold," Orders"]})]})]}),l.jsx("div",{className:"bg-white p-5 rounded-3xl shadow-soft flex flex-col justify-between h-40",children:l.jsx("div",{children:n==="admin"?l.jsxs(l.Fragment,{children:[l.jsxs("h3",{className:"text-2xl font-bold text-gray-900",children:["",parseInt(d.totalProfit).toLocaleString()]}),l.jsx("p",{className:"text-gray-400 text-xs font-medium",children:"Net Profit"}),l.jsx("div",{className:"mt-2 text-[10px] text-gray-500 space-y-1",children:l.jsxs("p",{className:"text-green-600 font-bold",children:[d.profitMargin,"% Margin"]})})]}):l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:d.customerMetrics.totalCustomers}),l.jsx("p",{className:"text-gray-400 text-xs font-medium",children:"Total Customers"})]})})})]}),n==="admin"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-white p-4 rounded-3xl shadow-soft flex flex-col justify-center",children:[l.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase mb-1",children:"Daily Profit"}),l.jsxs("p",{className:"text-xl font-bold text-gray-800",children:["",d.dailyProfit.toLocaleString()]})]}),l.jsxs("div",{className:"bg-white p-4 rounded-3xl shadow-soft flex flex-col justify-center",children:[l.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase mb-1",children:"Rev / Meter"}),l.jsxs("p",{className:"text-xl font-bold text-gray-800",children:["",d.revPerMeter]})]}),l.jsxs("div",{className:"bg-white p-4 rounded-3xl shadow-soft flex flex-col justify-center",children:[l.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase mb-1",children:"Potential Rev"}),l.jsxs("p",{className:"text-xl font-bold text-gray-800",children:["",c.potentialRevenue.toLocaleString()]}),l.jsxs("p",{className:"text-[10px] font-bold text-green-600 mt-1",children:["+",c.percentageIncrease.toFixed(0),"% Potential ROI"]})]}),l.jsxs("div",{className:"bg-white p-4 rounded-3xl shadow-soft flex flex-col justify-center",children:[l.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase mb-1",children:"Stock Value"}),l.jsxs("p",{className:"text-xl font-bold text-gray-800",children:["",c.totalStockValuation.toLocaleString()]}),l.jsxs("div",{className:"flex gap-2 text-[9px] mt-1 text-gray-500",children:[l.jsxs("span",{children:["Fab: ",(c.totalFabricCostValuation/1e3).toFixed(1),"k"]}),l.jsx("span",{children:"|"}),l.jsxs("span",{children:["Out: ",(c.totalOutfitCostValuation/1e3).toFixed(1),"k"]})]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-white p-4 rounded-3xl shadow-soft",children:[l.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase mb-1",children:"Expenses"}),l.jsxs("div",{className:"text-[10px] space-y-1",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Fabric:"})," ",l.jsxs("span",{className:"font-bold",children:["",(d.breakdown.fabric/1e3).toFixed(1),"k"]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Stitch:"})," ",l.jsxs("span",{className:"font-bold",children:["",(d.breakdown.stitch/1e3).toFixed(1),"k"]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Ship:"})," ",l.jsxs("span",{className:"font-bold",children:["",(d.breakdown.ship/1e3).toFixed(1),"k"]})]}),l.jsxs("div",{className:"flex justify-between text-orange-600",children:[l.jsx("span",{children:"COD/Acq:"})," ",l.jsxs("span",{className:"font-bold",children:["",(d.breakdown.cod/1e3).toFixed(1),"k"]})]})]})]}),l.jsxs("div",{className:"bg-white p-4 rounded-3xl shadow-soft",children:[l.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase mb-1",children:"Payment Split"}),l.jsx("div",{className:"flex items-center justify-center h-20",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("p",{className:"text-xl font-bold text-gray-800",children:[d.paymentSplit.cod," ",l.jsx("span",{className:"text-xs font-normal text-gray-400",children:"COD"})]}),l.jsxs("p",{className:"text-xl font-bold text-gray-800",children:[d.paymentSplit.prepaid," ",l.jsx("span",{className:"text-xs font-normal text-gray-400",children:"Prepaid"})]})]})})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-white p-4 rounded-3xl shadow-soft",children:[l.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase mb-1",children:"Customer Metrics"}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-800",children:d.customerMetrics.totalCustomers}),l.jsx("p",{className:"text-[10px] text-gray-500",children:"Total Customers"})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("p",{className:"text-lg font-bold text-green-600",children:["",(d.customerMetrics.avgRevenue/1e3).toFixed(1),"k"]}),l.jsx("p",{className:"text-[10px] text-gray-500",children:"Avg Revenue"})]})]})]}),l.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 p-4 rounded-3xl shadow-soft",children:[l.jsx("p",{className:"text-xs text-purple-700 font-bold uppercase mb-2",children:"Top Customer"}),d.customerMetrics.topCustomers.length>0?l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-bold text-gray-900 truncate",children:d.customerMetrics.topCustomers[0].name}),l.jsxs("p",{className:"text-xl font-bold text-purple-600",children:["",(d.customerMetrics.topCustomers[0].revenue/1e3).toFixed(1),"k"]}),l.jsxs("p",{className:"text-[10px] text-gray-600",children:[d.customerMetrics.topCustomers[0].orders," orders"]})]}):l.jsx("p",{className:"text-xs text-gray-400",children:"No customers yet"})]})]})]})]})}function C2({allOrders:t=[],inventoryItems:e=[]}){const n=u=>{if(typeof u=="number")return u;if(!u)return 0;const c=String(u).replace(/[^0-9.-]/g,"");return parseFloat(c)||0},r=u=>u?Object.values(u).reduce((c,d)=>c+(parseFloat(d)||0),0):0,s=B.useMemo(()=>e.filter(u=>u.type==="outfit").map(u=>({name:u.name,imageUrl:u.imageUrl||`https://placehold.co/150x150/e2e8f0/64748b?text=${u.name.substring(0,3)}`,stock:r(u.stockBreakdown),revenue:0,qty:0,inInventory:!0})),[e]),i=B.useMemo(()=>{const u={};return s.forEach(c=>{u[c.name.toLowerCase()]={...c}}),t.forEach(c=>{if(c.status==="Cancelled")return;const f=(c.outfitName||c.productName||"Unknown").trim().toLowerCase(),y=n(c.finalSellingPrice)||n(c.orderTotal)||0;u[f]&&(u[f].revenue+=y,u[f].qty+=parseInt(c.quantity)||1)}),Object.values(u).sort((c,d)=>d.revenue-c.revenue)},[t,s]),o=B.useMemo(()=>{const u=new Set(e.filter(d=>d.type==="outfit").map(d=>d.name.toLowerCase())),c=[];return t.forEach(d=>{if(d.status==="Cancelled")return;const f=(d.outfitName||d.productName||"").trim();if(!(!f||f==="Unknown")&&!u.has(f.toLowerCase())){const y=c.find(g=>g.name.toLowerCase()===f.toLowerCase());y?(y.count+=1,y.orderIds.push(d.orderNumber||d.id)):c.push({name:f,count:1,orderIds:[d.orderNumber||d.id],imageUrl:d.imageUrl||`https://placehold.co/150x150/fef3c7/f59e0b?text=${f.substring(0,3)}`})}}),c},[t,e]);return l.jsxs("div",{className:"space-y-6 fade-in",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Outfits Performance"}),l.jsxs("div",{className:"text-xs bg-white px-3 py-1 rounded-full shadow font-bold text-gray-500",children:[i.length," Items"]})]}),o.length>0&&l.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-xl",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(dx,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("h3",{className:"font-bold text-yellow-900 text-sm mb-2",children:[" Outfits Not in Inventory (",o.length,")"]}),l.jsx("p",{className:"text-xs text-yellow-800 mb-3",children:"These outfit names appear in orders but don't exist in your inventory. Add them to inventory or update order history to match existing outfit names."}),l.jsx("div",{className:"space-y-2",children:o.map((u,c)=>l.jsxs("div",{className:"bg-white p-3 rounded-lg border border-yellow-200 flex gap-3 items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-lg overflow-hidden flex-shrink-0",children:l.jsx("img",{src:u.imageUrl,className:"w-full h-full object-cover"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h4",{className:"font-bold text-gray-900 text-sm truncate",children:u.name}),l.jsxs("p",{className:"text-xs text-gray-500",children:["Found in ",u.count," order",u.count>1?"s":"",": ",u.orderIds.slice(0,3).join(", "),u.orderIds.length>3&&` +${u.orderIds.length-3} more`]})]}),l.jsx("div",{className:"text-right",children:l.jsx("span",{className:"text-xs font-bold text-yellow-700 bg-yellow-100 px-2 py-1 rounded",children:"FIX"})})]},c))}),l.jsx("p",{className:"text-xs text-yellow-700 mt-3 font-bold",children:" Tip: Go to Inventory  Add Item to create these outfits, or edit orders to use existing outfit names."})]})]})}),l.jsx("div",{className:"grid grid-cols-1 gap-4",children:i.length>0?i.map((u,c)=>l.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-card flex gap-4 items-center",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-xl overflow-hidden flex-shrink-0",children:l.jsx("img",{src:u.imageUrl,className:"w-full h-full object-cover"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h4",{className:"font-bold text-gray-900 text-sm truncate",children:u.name}),l.jsxs("p",{className:"text-xs text-gray-500",children:["Stock: ",u.stock]})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("p",{className:"font-bold text-green-600",children:["",(u.revenue/1e3).toFixed(1),"k"]}),l.jsxs("p",{className:"text-[10px] text-gray-400 font-bold",children:[u.qty," SOLD"]})]})]},c)):l.jsxs("div",{className:"text-center py-10 text-gray-400",children:[l.jsx("p",{children:"No outfits in inventory yet."}),l.jsx("p",{className:"text-xs mt-2",children:"Add outfits in the Inventory tab"})]})})]})}function k2({allOrders:t=[],onViewCustomer:e=()=>{},searchTerm:n="",setSearchTerm:r=()=>{}}){const s=u=>{if(typeof u=="number")return u;if(!u)return 0;const c=String(u).replace(/[^0-9.-]/g,"");return parseFloat(c)||0},i=u=>{if(!u)return null;const c=u.toLowerCase().trim(),d=t.filter(g=>g.customerName&&g.customerName.toLowerCase().trim()===c),f=d.reduce((g,w)=>{var P;const S=s(w.orderTotal)||s(w.finalSellingPrice)||s((P=w.importedData)==null?void 0:P["Product Price"])||0;return g+S},0),y=d.length;return{history:d,totalSpent:f,totalItems:y}},o=B.useMemo(()=>{const u=new Map;t.forEach(d=>{var f;if(d.customerName){const y=d.customerName.toLowerCase().trim(),g=u.get(y)||{name:d.customerName,phone:d.phone||"",address:d.address||"",email:d.email||"",city:d.city||"",state:d.state||"",source:"Order History",customFields:d.importedData||{}};d.phone&&(g.phone=d.phone),d.address&&(g.address=d.address),d.city&&(g.city=d.city),d.state&&(g.state=d.state),(f=d.importedData)!=null&&f["Customer Email"]&&(g.email=d.importedData["Customer Email"]),u.set(y,g)}});let c=Array.from(u.values());if(n){const d=n.toLowerCase();c=c.filter(f=>f.name.toLowerCase().includes(d)||f.phone&&f.phone.includes(d))}return c.sort((d,f)=>d.name.localeCompare(f.name))},[t,n]);return l.jsxs("div",{className:"space-y-6 fade-in",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Customers"}),l.jsxs("div",{className:"text-xs text-gray-500 font-medium bg-white px-3 py-1 rounded-full shadow-sm",children:[o.length," Total"]})]}),l.jsxs("div",{className:"relative mb-4",children:[l.jsx("span",{className:"absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400",children:l.jsx(cx,{className:"w-5 h-5"})}),l.jsx("input",{className:"w-full pl-10 p-3 bg-white rounded-xl border-none shadow-sm text-sm",placeholder:"Search customers...",value:n,onChange:u=>r(u.target.value)})]}),l.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[o.map((u,c)=>{const d=i(u.name);return l.jsxs("div",{onClick:()=>e(u),className:"bg-white p-4 rounded-2xl shadow-card flex items-center justify-between cursor-pointer hover:bg-gray-50",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold text-sm",children:u.name.substring(0,2).toUpperCase()}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-bold text-gray-900 text-sm",children:u.name}),l.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-gray-500",children:[u.phone&&l.jsxs("span",{children:[" ",u.phone]}),u.source==="Saved"&&l.jsx("span",{className:"bg-green-50 text-green-600 px-1 rounded",children:"Imported"})]})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-lg font-bold text-gray-900",children:d.totalItems}),l.jsx("p",{className:"text-[10px] text-gray-400 uppercase",children:"Orders"})]})]},c)}),o.length===0&&l.jsxs("div",{className:"text-center py-10 text-gray-400",children:[l.jsx(hx,{className:"w-12 h-12 mx-auto mb-2 opacity-20"}),l.jsx("p",{children:"No customers found."})]})]})]})}function A2({inventoryItems:t=[],allOrders:e=[]}){const n=u=>{if(typeof u=="number")return u;if(!u)return 0;const c=String(u).replace(/[^0-9.-]/g,"");return parseFloat(c)||0},r=B.useMemo(()=>{var K,se;const u=new Date,c=u.getMonth(),d=u.getFullYear(),f=e.filter(F=>F.status!=="Cancelled"),y=f.reduce((F,H)=>F+(n(H.finalSellingPrice)||n(H.orderTotal)||0),0),g=f.filter(F=>{var Y;const H=(Y=F.orderDate)!=null&&Y.toDate?F.orderDate.toDate():new Date(F.orderDate);return H.getMonth()===c&&H.getFullYear()===d}).reduce((F,H)=>F+(n(H.finalSellingPrice)||n(H.orderTotal)||0),0),w=f.length>0?y/f.length:0,S=f.filter(F=>F.type==="fabric").reduce((F,H)=>F+(n(H.finalSellingPrice)||n(H.orderTotal)||0),0),P=f.filter(F=>F.type==="outfit"||F.outfitName).reduce((F,H)=>F+(n(H.finalSellingPrice)||n(H.orderTotal)||0),0),R=f.reduce((F,H)=>{const Y=n(H.fabricCost)||0,ue=n(H.stitchingCost)||0,oe=n(H.shippingCost)||0,ne=H.paymentMode==="COD"&&n(H.codCharge)||0;return F+Y+ue+oe+ne},0),b=y-R,x=y>0?b/y*100:0,I=e.filter(F=>F.paymentMode==="COD"&&F.status==="Shipped").reduce((F,H)=>F+(n(H.finalSellingPrice)||n(H.orderTotal)||0),0),j=f.filter(F=>F.paymentMode==="Prepaid").reduce((F,H)=>F+(n(H.finalSellingPrice)||n(H.orderTotal)||0),0),M=f.filter(F=>F.paymentMode==="COD").reduce((F,H)=>F+(n(H.finalSellingPrice)||n(H.orderTotal)||0),0),V=t.reduce((F,H)=>{if(H.type==="fabric"){const Y=parseFloat(H.currentLength)||0,ue=n(H.costPerMeter)||0;return F+Y*ue}else{const Y=Object.values(H.stockBreakdown||{}).reduce((oe,ne)=>oe+(parseFloat(ne)||0),0),ue=n(H.costPerMeter)||0;return F+Y*ue}},0),T=f.reduce((F,H)=>F+(n(H.fabricCost)||0),0),p=f.reduce((F,H)=>F+(n(H.stitchingCost)||0),0),v=f.reduce((F,H)=>F+(n(H.shippingCost)||0),0),_=f.reduce((F,H)=>H.paymentMode==="COD"?F+(n(H.codCharge)||0):F,0),C=new Set(f.map(F=>{var H;return(H=F.customerName)==null?void 0:H.toLowerCase().trim()}).filter(Boolean)),A=C.size>0?y/C.size:0,N={};f.forEach(F=>{if(F.customerName){const H=F.customerName,Y=n(F.finalSellingPrice)||n(F.orderTotal)||0;N[H]=(N[H]||0)+Y}});const me=Object.entries(N).sort((F,H)=>H[1]-F[1]).slice(0,10),ie={};f.forEach(F=>{const H=F.outfitName||F.productName||F.fabricName||"Unknown",Y=n(F.finalSellingPrice)||n(F.orderTotal)||0;ie[H]=(ie[H]||0)+Y});const Ie=Object.entries(ie).sort((F,H)=>H[1]-F[1]).slice(0,10),te=[];for(let F=5;F>=0;F--){const H=new Date(d,c-F,1),Y=f.filter(ue=>{var ne;const oe=(ne=ue.orderDate)!=null&&ne.toDate?ue.orderDate.toDate():new Date(ue.orderDate);return oe.getMonth()===H.getMonth()&&oe.getFullYear()===H.getFullYear()}).reduce((ue,oe)=>ue+(n(oe.finalSellingPrice)||n(oe.orderTotal)||0),0);te.push({month:H.toLocaleDateString("en-US",{month:"short"}),revenue:Y})}const z=((K=te[4])==null?void 0:K.revenue)||0,q=((se=te[5])==null?void 0:se.revenue)||0,X=z>0?(q-z)/z*100:0,G=Object.entries(N).sort((F,H)=>H[1]-F[1]).map(([F,H])=>{const Y=f.filter(ue=>ue.customerName===F);return{name:F,revenue:H,orderCount:Y.length,avgOrderValue:Y.length>0?H/Y.length:0}}),k=G.reduce((F,H)=>F+H.revenue,0),O=G.map(F=>({...F,percentage:k>0?F.revenue/k*100:0}));return{totalRevenue:y,monthlyRevenue:g,avgOrderValue:w,fabricRevenue:S,outfitRevenue:P,grossProfit:b,profitMargin:x,codPending:I,prepaidRevenue:j,codRevenue:M,totalInventoryValue:V,fabricCosts:T,stitchingCosts:p,shippingCosts:v,codCharges:_,totalCosts:R,uniqueCustomers:C.size,avgCustomerValue:A,topCustomers:me,topProducts:Ie,monthlyData:te,growthRate:X,customerRevenueData:O}},[t,e]),s=u=>`${(u/1e3).toFixed(1)}k`,[i,o]=B.useState(!1);return l.jsxs("div",{className:"space-y-6 fade-in pb-20",children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Financial Insights"})}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 p-4 rounded-2xl shadow-card text-white",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(oT,{className:"w-5 h-5"}),l.jsx("p",{className:"text-xs opacity-90",children:"Total Revenue"})]}),l.jsx("p",{className:"text-2xl font-bold",children:s(r.totalRevenue)}),l.jsx("p",{className:"text-xs opacity-80 mt-1",children:"All time"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 p-4 rounded-2xl shadow-card text-white",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(Wb,{className:"w-5 h-5"}),l.jsx("p",{className:"text-xs opacity-90",children:"This Month"})]}),l.jsx("p",{className:"text-2xl font-bold",children:s(r.monthlyRevenue)}),l.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[r.growthRate>=0?l.jsx(Qd,{className:"w-3 h-3"}):l.jsx(xT,{className:"w-3 h-3"}),l.jsxs("p",{className:"text-xs",children:[Math.abs(r.growthRate).toFixed(1),"% vs last month"]})]})]}),l.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 p-4 rounded-2xl shadow-card text-white",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(Qd,{className:"w-5 h-5"}),l.jsx("p",{className:"text-xs opacity-90",children:"Gross Profit"})]}),l.jsx("p",{className:"text-2xl font-bold",children:s(r.grossProfit)}),l.jsxs("p",{className:"text-xs opacity-80 mt-1",children:["Margin: ",r.profitMargin.toFixed(1),"%"]})]}),l.jsxs("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 p-4 rounded-2xl shadow-card text-white",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(hi,{className:"w-5 h-5"}),l.jsx("p",{className:"text-xs opacity-90",children:"Avg Order Value"})]}),l.jsx("p",{className:"text-2xl font-bold",children:s(r.avgOrderValue)}),l.jsx("p",{className:"text-xs opacity-80 mt-1",children:"Per transaction"})]})]}),l.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-card",children:[l.jsxs("h3",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:[l.jsx(Xb,{className:"w-5 h-5 text-brand"}),"Revenue by Category"]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between mb-1",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Outfits"}),l.jsx("span",{className:"text-sm font-bold text-gray-900",children:s(r.outfitRevenue)})]}),l.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-purple-600 rounded-full",style:{width:`${r.outfitRevenue/r.totalRevenue*100}%`}})})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between mb-1",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Fabrics"}),l.jsx("span",{className:"text-sm font-bold text-gray-900",children:s(r.fabricRevenue)})]}),l.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 to-green-600 rounded-full",style:{width:`${r.fabricRevenue/r.totalRevenue*100}%`}})})]})]})]}),l.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-card",children:[l.jsx("h3",{className:"font-bold text-gray-900 mb-4",children:"Revenue Trend (Last 6 Months)"}),l.jsx("div",{className:"flex items-end justify-between gap-2 h-32",children:r.monthlyData.map((u,c)=>{const d=Math.max(...r.monthlyData.map(y=>y.revenue)),f=d>0?u.revenue/d*100:0;return l.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[l.jsx("span",{className:"text-xs font-bold text-gray-900",children:s(u.revenue)}),l.jsx("div",{className:"w-full bg-gradient-to-t from-brand to-green-400 rounded-t-lg",style:{height:`${f}%`,minHeight:"4px"}}),l.jsx("span",{className:"text-xs text-gray-500",children:u.month})]},c)})})]}),l.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-card",children:[l.jsx("h3",{className:"font-bold text-gray-900 mb-4",children:"Expense Breakdown"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Fabric Costs"}),l.jsx("span",{className:"text-sm font-bold text-gray-900",children:s(r.fabricCosts)})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Stitching Costs"}),l.jsx("span",{className:"text-sm font-bold text-gray-900",children:s(r.stitchingCosts)})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Shipping Costs"}),l.jsx("span",{className:"text-sm font-bold text-gray-900",children:s(r.shippingCosts)})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"COD Charges"}),l.jsx("span",{className:"text-sm font-bold text-gray-900",children:s(r.codCharges)})]}),l.jsxs("div",{className:"border-t pt-2 flex justify-between items-center",children:[l.jsx("span",{className:"text-sm font-bold text-gray-900",children:"Total Expenses"}),l.jsx("span",{className:"text-sm font-bold text-red-600",children:s(r.totalCosts)})]})]})]}),l.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-card",children:[l.jsx("h3",{className:"font-bold text-gray-900 mb-4",children:"Cash Flow Overview"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex justify-between items-center p-3 bg-green-50 rounded-xl",children:[l.jsx("span",{className:"text-sm text-green-800",children:"Prepaid Revenue"}),l.jsx("span",{className:"text-sm font-bold text-green-900",children:s(r.prepaidRevenue)})]}),l.jsxs("div",{className:"flex justify-between items-center p-3 bg-blue-50 rounded-xl",children:[l.jsx("span",{className:"text-sm text-blue-800",children:"COD Revenue"}),l.jsx("span",{className:"text-sm font-bold text-blue-900",children:s(r.codRevenue)})]}),l.jsxs("div",{className:"flex justify-between items-center p-3 bg-orange-50 rounded-xl",children:[l.jsx("span",{className:"text-sm text-orange-800",children:"Pending COD Collections"}),l.jsx("span",{className:"text-sm font-bold text-orange-900",children:s(r.codPending)})]})]})]}),l.jsxs("div",{className:"bg-gradient-to-br from-indigo-500 to-indigo-600 p-5 rounded-2xl shadow-card text-white",children:[l.jsxs("h3",{className:"font-bold mb-2 flex items-center gap-2",children:[l.jsx(hi,{className:"w-5 h-5"}),"Total Inventory Value"]}),l.jsx("p",{className:"text-3xl font-bold",children:s(r.totalInventoryValue)}),l.jsx("p",{className:"text-xs opacity-80 mt-1",children:"Current stock valuation"})]}),l.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-card",children:[l.jsxs("h3",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:[l.jsx(hx,{className:"w-5 h-5 text-brand"}),"Customer Insights"]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Total Customers"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.uniqueCustomers})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Avg Customer Value"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s(r.avgCustomerValue)})]})]})]}),l.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-card",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h3",{className:"font-bold text-gray-900 flex items-center gap-2",children:[l.jsx(sT,{className:"w-5 h-5 text-yellow-500"}),"Customer Revenue Breakdown"]}),r.customerRevenueData.length>10&&l.jsx("button",{onClick:()=>o(!i),className:"text-xs text-brand hover:underline",children:i?"Show Top 10":`Show All ${r.customerRevenueData.length}`})]}),l.jsx("div",{className:"space-y-2",children:(i?r.customerRevenueData:r.customerRevenueData.slice(0,10)).map((u,c)=>l.jsxs("div",{className:"p-3 hover:bg-gray-50 rounded-lg transition-colors",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[l.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold ${c===0?"bg-yellow-100 text-yellow-700":c===1?"bg-gray-200 text-gray-700":c===2?"bg-orange-100 text-orange-700":"bg-blue-100 text-blue-600"}`,children:c+1}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"text-sm font-bold text-gray-900 truncate",children:u.name}),l.jsxs("p",{className:"text-xs text-gray-500",children:[u.orderCount," orders  Avg: ",(u.avgOrderValue/1e3).toFixed(1),"k"]})]})]}),l.jsxs("div",{className:"text-right ml-3",children:[l.jsx("p",{className:"text-sm font-bold text-brand",children:s(u.revenue)}),l.jsxs("p",{className:"text-xs text-gray-500",children:[u.percentage.toFixed(1),"%"]})]})]}),l.jsx("div",{className:"h-1.5 bg-gray-100 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-brand to-green-500 rounded-full transition-all",style:{width:`${u.percentage}%`}})})]},c))})]}),l.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-card",children:[l.jsx("h3",{className:"font-bold text-gray-900 mb-4",children:"Top 10 Products by Revenue"}),l.jsx("div",{className:"space-y-2",children:r.topProducts.map(([u,c],d)=>l.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-6 h-6 rounded-full bg-purple-100 flex items-center justify-center text-purple-600 text-xs font-bold",children:d+1}),l.jsx("span",{className:"text-sm text-gray-900 truncate",children:u})]}),l.jsx("span",{className:"text-sm font-bold text-brand",children:s(c)})]},d))})]})]})}function P2({visible:t,onClose:e,inventoryItems:n=[],onDataChanged:r}){const[s,i]=B.useState({fabricId:"",outfitId:"",fabricPerPiece:"",fabricUsed:"",estimatedPieces:0,sizeS:"",sizeM:"",sizeL:"",sizeXL:"",sizeXXL:"",stitchingCostTotal:"",tailorName:"",notes:"",status:"In Progress",sentDate:new Date().toISOString().split("T")[0],receivedDate:""}),[o,u]=B.useState(!1),c=B.useMemo(()=>n.filter(x=>x.type==="fabric"&&parseFloat(x.currentLength)>0),[n]),d=B.useMemo(()=>n.filter(x=>x.type==="outfit"),[n]),f=c.find(x=>x.id===s.fabricId),y=d.find(x=>x.id===s.outfitId),g=B.useMemo(()=>{if(!s.fabricUsed||!s.fabricPerPiece)return 0;const x=parseFloat(s.fabricUsed)||0,I=parseFloat(s.fabricPerPiece)||0;return I===0?0:Math.floor(x/I)},[s.fabricUsed,s.fabricPerPiece]);Ws.useEffect(()=>{if(g>0&&!s.sizeS&&!s.sizeM&&!s.sizeL){const x=Math.floor(g*.3),I=Math.floor(g*.4),j=g-x-I;i(M=>({...M,estimatedPieces:g,sizeS:x.toString(),sizeM:I.toString(),sizeL:j.toString(),sizeXL:"0",sizeXXL:"0"}))}},[g]);const w=[s.sizeS,s.sizeM,s.sizeL,s.sizeXL,s.sizeXXL].reduce((x,I)=>x+(parseInt(I)||0),0),S=B.useMemo(()=>{if(!f||!s.fabricUsed||w===0)return 0;const x=parseFloat(s.fabricUsed)||0,I=parseFloat(f.costPerMeter)||0;return x*I/w},[f,s.fabricUsed,w]),P=B.useMemo(()=>w===0?0:(parseFloat(s.stitchingCostTotal)||0)/w,[s.stitchingCostTotal,w]),R=S+P,b=async x=>{if(x.preventDefault(),!s.fabricId||!s.outfitId||!s.fabricUsed||!s.fabricPerPiece){alert("Please fill all required fields");return}if(w===0){alert("Please enter at least one piece in size breakdown");return}const I=parseFloat(s.fabricUsed);if(I>parseFloat(f.currentLength)){alert("Not enough fabric available!");return}u(!0);try{const j=ft(),M=parseFloat(s.fabricPerPiece)||0,V=w>0?I/w:0,T=V-M,p=M>0?T/M*100:0;if(await cn(at(j,"production_batches"),{fabricId:s.fabricId,fabricName:f.name,fabricUsed:I,fabricCostPerMeter:parseFloat(f.costPerMeter)||0,outfitId:s.outfitId,outfitName:y.name,outfitImageUrl:y.imageUrl||"",fabricPerPiece:M,estimatedPieces:g,actualFabricPerPiece:V,variance:T,variancePercent:p,sizeBreakdown:{S:parseInt(s.sizeS)||0,M:parseInt(s.sizeM)||0,L:parseInt(s.sizeL)||0,XL:parseInt(s.sizeXL)||0,XXL:parseInt(s.sizeXXL)||0},totalPieces:w,stitchingCostTotal:parseFloat(s.stitchingCostTotal)||0,stitchingCostPerPiece:P,fabricCostPerPiece:S,totalCostPerPiece:R,tailorName:s.tailorName||"Unknown",notes:s.notes||"",sentDate:new Date(s.sentDate),receivedDate:s.receivedDate?new Date(s.receivedDate):null,status:s.receivedDate?"Completed":"In Progress",createdAt:ze()}),await Vt(it(j,"fabrics",s.fabricId),{currentLength:ia(-I)}),s.receivedDate){const _=y.stockBreakdown||{};await Vt(it(j,"fabrics",s.outfitId),{stockBreakdown:{S:(parseInt(_.S)||0)+(parseInt(s.sizeS)||0),M:(parseInt(_.M)||0)+(parseInt(s.sizeM)||0),L:(parseInt(_.L)||0)+(parseInt(s.sizeL)||0),XL:(parseInt(_.XL)||0)+(parseInt(s.sizeXL)||0),XXL:(parseInt(_.XXL)||0)+(parseInt(s.sizeXXL)||0)},productionCostPerPiece:R})}const v=s.receivedDate?` Production batch completed!
${w} pieces added to inventory
${I}m deducted from fabric`:` Production batch created!
Estimated: ${g} pieces
Actual: ${w} pieces (update when received)
${I}m deducted from fabric`;alert(v),r&&await r(),e(),i({fabricId:"",outfitId:"",fabricPerPiece:"",fabricUsed:"",estimatedPieces:0,sizeS:"",sizeM:"",sizeL:"",sizeXL:"",sizeXXL:"",stitchingCostTotal:"",tailorName:"",notes:"",status:"In Progress",sentDate:new Date().toISOString().split("T")[0],receivedDate:""})}catch(j){console.error("Production batch error:",j),alert("Error creating production batch: "+j.message)}finally{u(!1)}};return t?l.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-end sm:items-center justify-center p-0 sm:p-4",children:l.jsxs("div",{className:"bg-white w-full sm:max-w-2xl rounded-t-3xl sm:rounded-2xl shadow-2xl max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center",children:[l.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Create Production Batch"}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full",children:l.jsx($r,{className:"w-5 h-5"})})]}),l.jsxs("form",{onSubmit:b,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Select Fabric *"}),l.jsxs("select",{value:s.fabricId,onChange:x=>i({...s,fabricId:x.target.value}),className:"w-full p-3 border border-gray-300 rounded-xl",required:!0,children:[l.jsx("option",{value:"",children:"Choose fabric..."}),c.map(x=>l.jsxs("option",{value:x.id,children:[x.name," - ",parseFloat(x.currentLength).toFixed(1),"m @ ",x.costPerMeter,"/m"]},x.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Outfit Design *"}),l.jsxs("select",{value:s.outfitId,onChange:x=>i({...s,outfitId:x.target.value}),className:"w-full p-3 border border-gray-300 rounded-xl",required:!0,children:[l.jsx("option",{value:"",children:"Choose outfit design..."}),d.map(x=>l.jsx("option",{value:x.id,children:x.name},x.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Fabric Per Piece (meters) *"}),l.jsx("input",{type:"number",step:"0.01",value:s.fabricPerPiece,onChange:x=>i({...s,fabricPerPiece:x.target.value}),className:"w-full p-3 border border-gray-300 rounded-xl",placeholder:"e.g., 1.5",required:!0}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"How many meters needed per outfit?"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Fabric Sent to Tailor (meters) *"}),l.jsx("input",{type:"number",step:"0.1",value:s.fabricUsed,onChange:x=>i({...s,fabricUsed:x.target.value}),className:"w-full p-3 border border-gray-300 rounded-xl",placeholder:"e.g., 50",required:!0})]}),g>0&&l.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-200",children:[l.jsx("h4",{className:"font-bold text-blue-900 mb-2",children:" Estimated Production"}),l.jsxs("p",{className:"text-sm text-blue-800",children:[s.fabricUsed,"m  ",s.fabricPerPiece,"m/piece = ",l.jsxs("span",{className:"font-bold text-lg",children:["~",g," pieces"]})]}),l.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Sizes auto-distributed below (you can adjust)"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:["Actual Size Breakdown *",g>0&&w!==g&&l.jsxs("span",{className:"ml-2 text-xs font-normal text-orange-600",children:["(Estimated: ",g,", Actual: ",w,")"]})]}),l.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs text-gray-600",children:"S"}),l.jsx("input",{type:"number",min:"0",value:s.sizeS,onChange:x=>i({...s,sizeS:x.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-center",placeholder:"0"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs text-gray-600",children:"M"}),l.jsx("input",{type:"number",min:"0",value:s.sizeM,onChange:x=>i({...s,sizeM:x.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-center",placeholder:"0"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs text-gray-600",children:"L"}),l.jsx("input",{type:"number",min:"0",value:s.sizeL,onChange:x=>i({...s,sizeL:x.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-center",placeholder:"0"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs text-gray-600",children:"XL"}),l.jsx("input",{type:"number",min:"0",value:s.sizeXL,onChange:x=>i({...s,sizeXL:x.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-center",placeholder:"0"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs text-gray-600",children:"XXL"}),l.jsx("input",{type:"number",min:"0",value:s.sizeXXL,onChange:x=>i({...s,sizeXXL:x.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg text-center",placeholder:"0"})]})]}),l.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Total Pieces: ",l.jsx("span",{className:"font-bold",children:w})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Total Stitching Cost *"}),l.jsx("input",{type:"number",step:"0.01",value:s.stitchingCostTotal,onChange:x=>i({...s,stitchingCostTotal:x.target.value}),className:"w-full p-3 border border-gray-300 rounded-xl",placeholder:"e.g., 5400",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Tailor Name"}),l.jsx("input",{type:"text",value:s.tailorName,onChange:x=>i({...s,tailorName:x.target.value}),className:"w-full p-3 border border-gray-300 rounded-xl",placeholder:"e.g., Ramesh Tailors"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Sent Date"}),l.jsx("input",{type:"date",value:s.sentDate,onChange:x=>i({...s,sentDate:x.target.value}),className:"w-full p-3 border border-gray-300 rounded-xl"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Received Date (Optional)"}),l.jsx("input",{type:"date",value:s.receivedDate,onChange:x=>i({...s,receivedDate:x.target.value}),className:"w-full p-3 border border-gray-300 rounded-xl"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty if not yet received"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Notes"}),l.jsx("textarea",{value:s.notes,onChange:x=>i({...s,notes:x.target.value}),className:"w-full p-3 border border-gray-300 rounded-xl",rows:"3",placeholder:"Any additional notes..."})]}),w>0&&l.jsxs("div",{className:"bg-green-50 p-4 rounded-xl border border-green-200",children:[l.jsx("h4",{className:"font-bold text-green-900 mb-2",children:"Cost Breakdown (Per Piece)"}),l.jsxs("div",{className:"space-y-1 text-sm",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-green-700",children:"Fabric Cost:"}),l.jsxs("span",{className:"font-bold text-green-900",children:["",S.toFixed(2)]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-green-700",children:"Stitching Cost:"}),l.jsxs("span",{className:"font-bold text-green-900",children:["",P.toFixed(2)]})]}),l.jsxs("div",{className:"flex justify-between border-t border-green-300 pt-1",children:[l.jsx("span",{className:"text-green-800 font-bold",children:"Total Cost/Piece:"}),l.jsxs("span",{className:"font-bold text-green-900",children:["",R.toFixed(2)]})]})]}),g>0&&w!==g&&l.jsxs("div",{className:"mt-3 pt-3 border-t border-green-300",children:[l.jsxs("p",{className:"text-xs text-green-800",children:[l.jsx("span",{className:"font-bold",children:"Variance:"})," ",w>g?"+":"",w-g," pieces (",((w-g)/g*100).toFixed(1),"%)"]}),l.jsx("p",{className:"text-xs text-green-600 mt-1",children:"This data will improve future predictions"})]})]}),l.jsx("button",{type:"submit",disabled:o,className:"w-full bg-brand hover:bg-brand-dark text-white font-bold py-4 rounded-xl disabled:opacity-50",children:o?"Creating...":s.receivedDate?"Complete Production Batch":"Create Production Batch (In Progress)"})]})]})}):null}const Uw=B.createContext(),R2={Adwait:{name:"Adwait",role:"admin"},Avani:{name:"Avani",role:"admin"},Binay:{name:"Binay",role:"staff"}};function j2(){return B.useContext(Uw)}function D2({children:t}){const[e,n]=B.useState(()=>{const c=localStorage.getItem("poshakh-user");return c?JSON.parse(c):null}),[r,s]=B.useState(!1),u={userProfile:e,loading:r,login:async c=>{const d=c.trim(),f=R2[d];return f?(n(f),localStorage.setItem("poshakh-user",JSON.stringify(f)),{ok:!0}):{ok:!1,message:"User not found. Please use: Adwait, Avani, or Binay"}},logout:async()=>{n(null),localStorage.removeItem("poshakh-user")}};return l.jsx(Uw.Provider,{value:u,children:t})}function O2({item:t,onClose:e,onOpenEdit:n,onOpenStock:r,onViewHistory:s,onDelete:i}){return t?l.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white w-full sm:max-w-md rounded-t-3xl sm:rounded-3xl h-[85vh] sm:h-auto overflow-hidden flex flex-col shadow-2xl",children:[l.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50 flex-shrink-0",children:[l.jsx("h3",{className:"font-bold text-lg",children:t.name}),l.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-white text-gray-400 hover:text-gray-600",children:l.jsx("span",{className:"text-2xl",children:""})})]}),l.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[l.jsx("div",{className:"relative h-48 rounded-2xl overflow-hidden mb-6 bg-gray-100",children:t.imageUrl&&l.jsx("img",{src:t.imageUrl,className:"w-full h-full object-cover",alt:t.name})}),l.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[l.jsx("button",{onClick:()=>{e(),n&&n(t)},className:"py-3 px-4 bg-white border-2 border-gray-200 rounded-xl font-semibold text-sm hover:border-brand active:bg-gray-50 transition",children:"Edit"}),l.jsx("button",{onClick:()=>{e(),r&&r(t,"ADD")},className:"py-3 px-4 bg-white border-2 border-gray-200 rounded-xl font-semibold text-sm hover:border-brand active:bg-gray-50 transition",children:"Adjust Stock"})]}),l.jsx("div",{className:"bg-gray-50 p-3 rounded-xl",children:t.type==="fabric"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{children:"Cost / m"}),l.jsxs("span",{children:["",t.costPerMeter||0]})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{children:"Total Length"}),l.jsxs("span",{children:[t.currentLength||0," ",t.unit||"m"]})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{children:"Selling"}),l.jsxs("span",{children:["",t.sellingPrice||0]})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{children:"Stitching"}),l.jsxs("span",{children:["",t.stitchingCost||0]})]})]})}),l.jsxs("div",{className:"mt-4",children:[l.jsx("button",{onClick:()=>{s&&s(t)},className:"w-full py-3 bg-white border rounded-xl",children:"View Transaction History"}),l.jsx("button",{onClick:()=>{i&&i(t)},className:"w-full py-3 mt-2 text-red-600",children:"Delete Item"})]})]})]})}):null}function L2({order:t,onClose:e,onEdit:n,onShip:r}){return t?l.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white w-full sm:max-w-md rounded-t-3xl sm:rounded-3xl h-[85vh] sm:h-auto overflow-hidden flex flex-col shadow-2xl",children:[l.jsxs("div",{className:"bg-gray-50 p-6 border-b border-gray-100 flex justify-between items-center flex-shrink-0",children:[l.jsxs("h3",{className:"font-bold text-lg",children:["Order #",t.orderNumber]}),l.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-white text-gray-400 hover:text-gray-600",children:l.jsx("span",{className:"text-2xl",children:""})})]}),l.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[l.jsxs("div",{className:"flex gap-4 mb-6",children:[l.jsx("div",{className:"w-20 h-20 rounded-xl overflow-hidden bg-gray-100 flex-shrink-0",children:t.imageUrl&&l.jsx("img",{src:t.imageUrl,className:"w-full h-full object-cover",alt:t.outfitName})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"font-bold text-base",children:t.customerName}),l.jsx("p",{className:"text-sm text-gray-500",children:t.outfitName}),l.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Size: ",t.size||"M"]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[l.jsx("button",{onClick:()=>{n&&n(t)},className:"py-3 px-4 bg-brand text-white rounded-xl font-semibold text-sm active:bg-brand-dark transition",children:"Edit Order"}),l.jsx("button",{onClick:()=>{r&&r(t)},className:"py-3 px-4 bg-white border-2 border-gray-200 rounded-xl font-semibold text-sm hover:border-brand active:bg-gray-50 transition",children:"Ship / Complete"})]}),l.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl space-y-2",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Price"}),l.jsxs("span",{className:"font-semibold",children:["",t.finalSellingPrice||t.orderTotal||0]})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Status"}),l.jsx("span",{className:"font-semibold",children:t.status})]})]})]})]})}):null}function V2({customer:t,onClose:e,allOrders:n=[],inventoryItems:r=[]}){const[s,i]=B.useState(!1),[o,u]=B.useState({name:(t==null?void 0:t.name)||"",phone:(t==null?void 0:t.phone)||"",address:(t==null?void 0:t.address)||"",email:(t==null?void 0:t.email)||"",city:(t==null?void 0:t.city)||"",state:(t==null?void 0:t.state)||""}),[c,d]=B.useState(!1),f=B.useMemo(()=>r.filter(b=>b.type==="outfit"),[r]),y=B.useMemo(()=>{if(!t)return[];const b=t.name.toLowerCase().trim();return n.filter(x=>x.customerName&&x.customerName.toLowerCase().trim()===b).map(x=>{const I=x.outfitName||x.productName||"",j=f.some(M=>M.name.toLowerCase()===I.toLowerCase());return{...x,matchesInventory:j,outfitName:I}}).sort((x,I)=>{var V,T;const j=(V=x.createdAt)!=null&&V.toMillis?x.createdAt.toMillis():0;return((T=I.createdAt)!=null&&T.toMillis?I.createdAt.toMillis():0)-j})},[t,n,f]),g=y.filter(b=>!b.matchesInventory&&b.outfitName),w=B.useMemo(()=>{const b=V=>{var T,p,v;if((T=V.importedData)!=null&&T["Order Total"]){const _=String(V.importedData["Order Total"]).replace(/[^0-9.-]/g,""),C=parseFloat(_);if(!isNaN(C)&&C>0)return C}if(V.orderTotal)return parseFloat(V.orderTotal);if(V.finalSellingPrice)return parseFloat(V.finalSellingPrice);if((p=V.importedData)!=null&&p["Product Price"]){const _=String(V.importedData["Product Price"]).replace(/[^0-9.-]/g,"");return parseFloat(_)||0}if((v=V.importedData)!=null&&v.Total){const _=String(V.importedData.Total).replace(/[^0-9.-]/g,"");return parseFloat(_)||0}return 0},x=y.reduce((V,T)=>V+b(T),0),I=y.length,j=I>0?x/I:0,M=y.filter(V=>V.status==="Order Shipped (Completed)").length;return{totalSpent:x,totalOrders:I,avgOrderValue:j,completedOrders:M}},[y]),S=async()=>{if(!o.name.trim()){alert("Customer name is required");return}d(!0);try{const b=ft(),x=y.map(I=>Vt(it(b,"production_orders",I.id),{customerName:o.name,phone:o.phone||I.phone,address:o.address||I.address,email:o.email||I.email,city:o.city||I.city,state:o.state||I.state}));await Promise.all(x),alert("Customer information updated!"),i(!1)}catch(b){console.error("Error updating customer:",b),alert("Error updating customer: "+b.message)}finally{d(!1)}},P=async(b,x,I)=>{if(!x)return;const j=r.find(M=>M.type==="outfit"&&M.name.toLowerCase()===x.toLowerCase());try{const M=ft(),V={outfitName:x,imageUrl:(j==null?void 0:j.imageUrl)||""};I&&(V.size=I),await Vt(it(M,"production_orders",b),V),alert(`Order updated!
Outfit: ${x}${I?`
Size: ${I}`:""}

Note: Original order total has been preserved.`)}catch(M){console.error("Error updating order:",M),alert("Error: "+M.message)}},R=async(b,x)=>{if(window.confirm(`Are you sure you want to delete order #${x}?

This action cannot be undone.`))try{const j=ft();await tc(it(j,"production_orders",b)),alert(`Order #${x} has been deleted successfully`)}catch(j){console.error("Error deleting order:",j),alert("Error deleting order: "+j.message)}};return t?l.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white w-full sm:max-w-2xl rounded-t-3xl sm:rounded-3xl max-h-[90vh] overflow-hidden flex flex-col shadow-2xl",children:[l.jsxs("div",{className:"bg-gray-50 p-6 border-b border-gray-100 flex justify-between items-center flex-shrink-0",children:[l.jsx("h3",{className:"font-bold text-lg",children:s?"Edit Customer":t.name}),l.jsxs("div",{className:"flex items-center gap-2",children:[!s&&l.jsx("button",{onClick:()=>i(!0),className:"p-2 rounded-full hover:bg-white text-blue-600",children:l.jsx(lx,{className:"w-5 h-5"})}),l.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-white text-gray-400 hover:text-gray-600",children:l.jsx($r,{className:"w-5 h-5"})})]})]}),l.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[s?l.jsxs("div",{className:"space-y-4 mb-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-700",children:"Customer Name *"}),l.jsx("input",{value:o.name,onChange:b=>u({...o,name:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-xl mt-1",placeholder:"Customer name"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-700",children:"Phone"}),l.jsx("input",{value:o.phone,onChange:b=>u({...o,phone:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-xl mt-1",placeholder:"Phone number"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-700",children:"Email"}),l.jsx("input",{value:o.email,onChange:b=>u({...o,email:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-xl mt-1",placeholder:"Email"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-700",children:"Address"}),l.jsx("input",{value:o.address,onChange:b=>u({...o,address:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-xl mt-1",placeholder:"Street address"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-700",children:"City"}),l.jsx("input",{value:o.city,onChange:b=>u({...o,city:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-xl mt-1",placeholder:"City"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-700",children:"State"}),l.jsx("input",{value:o.state,onChange:b=>u({...o,state:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-xl mt-1",placeholder:"State"})]})]}),l.jsxs("div",{className:"flex gap-2 pt-2",children:[l.jsxs("button",{onClick:S,disabled:c,className:"flex-1 bg-brand text-white py-3 rounded-xl font-bold flex items-center justify-center gap-2 disabled:opacity-50",children:[l.jsx(ux,{className:"w-4 h-4"}),c?"Saving...":"Save Changes"]}),l.jsx("button",{onClick:()=>{i(!1),u({name:t.name,phone:t.phone||"",address:t.address||"",email:t.email||"",city:t.city||"",state:t.state||""})},className:"px-6 py-3 border border-gray-300 rounded-xl font-bold text-gray-600",children:"Cancel"})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"bg-gradient-to-br from-brand to-green-600 p-5 rounded-2xl text-white mb-4 shadow-lg",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[l.jsx("div",{className:"w-16 h-16 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center font-bold text-xl border-2 border-white/30",children:t.name.substring(0,2).toUpperCase()}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-bold text-lg",children:t.name}),l.jsxs("div",{className:"flex flex-wrap gap-2 mt-1",children:[t.phone&&l.jsxs("span",{className:"text-xs bg-white/20 px-2 py-0.5 rounded-full",children:[" ",t.phone]}),t.email&&l.jsxs("span",{className:"text-xs bg-white/20 px-2 py-0.5 rounded-full",children:[" ",t.email]})]})]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[l.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-3 text-center",children:[l.jsxs("p",{className:"text-2xl font-bold",children:["",(w.totalSpent/1e3).toFixed(1),"k"]}),l.jsx("p",{className:"text-xs opacity-80 mt-1",children:"Total Spent"})]}),l.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-3 text-center",children:[l.jsx("p",{className:"text-2xl font-bold",children:w.totalOrders}),l.jsx("p",{className:"text-xs opacity-80 mt-1",children:"Total Orders"})]}),l.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-3 text-center",children:[l.jsxs("p",{className:"text-2xl font-bold",children:["",w.avgOrderValue.toFixed(0)]}),l.jsx("p",{className:"text-xs opacity-80 mt-1",children:"Avg Order"})]})]})]}),t.address&&l.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl mb-4",children:[l.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase mb-1",children:"Address"}),l.jsxs("p",{className:"text-sm text-gray-900",children:[t.address,t.city&&`, ${t.city}`,t.state&&`, ${t.state}`]})]}),t.customFields&&Object.keys(t.customFields).length>0&&l.jsxs("div",{className:"mb-4",children:[l.jsxs("h4",{className:"text-xs font-bold text-gray-600 uppercase tracking-wide mb-2 flex items-center gap-2",children:[l.jsx("span",{className:"w-1 h-4 bg-blue-500 rounded"}),"Imported Data"]}),l.jsx("div",{className:"bg-blue-50 border border-blue-100 p-4 rounded-xl",children:l.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:Object.entries(t.customFields).map(([b,x])=>l.jsxs("div",{className:"",children:[l.jsx("p",{className:"text-xs text-blue-600 font-semibold",children:b}),l.jsx("p",{className:"text-sm text-gray-900",children:x})]},b))})})]})]}),!s&&g.length>0&&l.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-xl mb-4",children:l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx(dx,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("h4",{className:"font-bold text-yellow-900 text-sm mb-1",children:[g.length," Order",g.length>1?"s":""," Need Outfit Matching"]}),l.jsx("p",{className:"text-xs text-yellow-800",children:"Update outfit names below to match your inventory"})]})]})}),!s&&l.jsxs("div",{children:[l.jsxs("h4",{className:"text-sm font-bold text-gray-700 mb-3 flex items-center gap-2",children:[l.jsx(hi,{className:"w-4 h-4"}),"Order History (",y.length,")"]}),l.jsxs("div",{className:"space-y-3",children:[y.map((b,x)=>l.jsx(M2,{order:b,outfitOptions:f,onUpdateOutfit:P,onDeleteOrder:R},x)),y.length===0&&l.jsx("div",{className:"text-center py-6 text-gray-400 text-sm",children:"No orders yet"})]})]})]})]})}):null}function M2({order:t,outfitOptions:e,onUpdateOutfit:n,onDeleteOrder:r}){const[s,i]=B.useState(!1),[o,u]=B.useState(t.outfitName),[c,d]=B.useState(t.size||"M"),f=g=>g?(g.toDate?g.toDate():new Date(g)).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"N/A",y=()=>{var g,w,S;if((g=t.importedData)!=null&&g["Order Total"]){const P=String(t.importedData["Order Total"]).replace(/[^0-9.-]/g,""),R=parseFloat(P);if(!isNaN(R)&&R>0)return R}if(t.orderTotal)return t.orderTotal;if(t.finalSellingPrice)return t.finalSellingPrice;if((w=t.importedData)!=null&&w["Product Price"]){const P=String(t.importedData["Product Price"]).replace(/[^0-9.-]/g,"");return parseFloat(P)||0}if((S=t.importedData)!=null&&S.Total){const P=String(t.importedData.Total).replace(/[^0-9.-]/g,"");return parseFloat(P)||0}return 0};return l.jsxs("div",{className:`bg-gradient-to-r ${t.matchesInventory?"from-white to-gray-50 border-gray-200":"from-yellow-50 to-orange-50 border-yellow-300"} border-2 p-4 rounded-xl shadow-sm hover:shadow-md transition-shadow`,children:[l.jsxs("div",{className:"flex justify-between items-start gap-4",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[l.jsxs("span",{className:"font-mono text-sm font-bold text-brand",children:["#",t.orderNumber]}),l.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-semibold ${t.status==="Order Shipped (Completed)"?"bg-green-100 text-green-700":t.status==="Received from Tailor"?"bg-blue-100 text-blue-700":t.status==="Sent to Tailor"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-600"}`,children:t.status}),!t.matchesInventory&&t.outfitName&&l.jsx("span",{className:"text-xs bg-red-100 text-red-700 px-2 py-1 rounded-full font-bold animate-pulse",children:" NEEDS FIX"}),l.jsx("button",{onClick:()=>r(t.id,t.orderNumber),className:"ml-auto text-red-600 p-1.5 hover:bg-red-50 rounded-lg transition-colors",title:"Delete order",children:l.jsx(eu,{className:"w-4 h-4"})})]}),s?l.jsxs("div",{className:"space-y-2 mt-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("select",{value:o,onChange:g=>u(g.target.value),className:"flex-1 p-2 border-2 border-brand rounded-lg text-sm font-medium focus:ring-2 focus:ring-brand/20",children:[l.jsxs("option",{value:t.outfitName,children:[t.outfitName," (current)"]}),e.map(g=>l.jsx("option",{value:g.name,children:g.name},g.id))]}),l.jsxs("select",{value:c,onChange:g=>d(g.target.value),className:"p-2 border-2 border-brand rounded-lg text-sm font-medium focus:ring-2 focus:ring-brand/20 w-20",children:[l.jsx("option",{value:"XS",children:"XS"}),l.jsx("option",{value:"S",children:"S"}),l.jsx("option",{value:"M",children:"M"}),l.jsx("option",{value:"L",children:"L"}),l.jsx("option",{value:"XL",children:"XL"}),l.jsx("option",{value:"XXL",children:"XXL"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>{n(t.id,o,c),i(!1)},className:"bg-brand text-white px-4 py-2 rounded-lg text-xs font-bold hover:bg-green-700 shadow-sm flex-1",children:" Save"}),l.jsx("button",{onClick:()=>{u(t.outfitName),d(t.size||"M"),i(!1)},className:"text-gray-500 px-4 py-2 hover:bg-gray-100 rounded-lg",children:l.jsx($r,{className:"w-4 h-4"})})]})]}):l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("p",{className:"text-base font-bold text-gray-900",children:t.outfitName||"Unknown"}),t.outfitName&&l.jsx("button",{onClick:()=>i(!0),className:"text-blue-600 p-1.5 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit outfit name",children:l.jsx(lx,{className:"w-3.5 h-3.5"})})]}),l.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[l.jsxs("span",{children:[" ",f(t.createdAt)]}),t.size&&l.jsxs("span",{className:"bg-gray-100 px-2 py-0.5 rounded font-semibold",children:["Size ",t.size]})]})]}),l.jsx("div",{className:"text-right flex-shrink-0",children:l.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["",y()]})})]}),t.importedData&&Object.keys(t.importedData).length>0&&l.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[l.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase mb-2",children:" Order Details"}),l.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:Object.entries(t.importedData).slice(0,6).map(([g,w])=>l.jsxs("div",{className:"bg-white/60 px-2 py-1 rounded",children:[l.jsx("p",{className:"text-xs text-gray-500",children:g}),l.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:w})]},g))})]})]})}function F2({visible:t,inventoryItems:e=[],userProfile:n,onClose:r,onDataChanged:s}){const[i,o]=B.useState({orderNumber:"",customerName:"",outfitName:"",size:"M",fabricId:"",status:"Sent to Tailor",sellingPrice:"",deductStock:!1,cutAmount:"",notes:"",phone:"",address:"",discount:"",source:"",acquisitionCost:"",paymentMethod:"Prepaid",city:"",state:"",codCharge:"",shippingCost:"",codRemittanceDate:""}),[u,c]=B.useState(!1),[d,f]=B.useState("");if(!t)return null;const y=async()=>{c(!0),f("");try{const{orderNumber:w,customerName:S,outfitName:P,size:R,fabricId:b,status:x,sellingPrice:I,deductStock:j,cutAmount:M,notes:V,phone:T,address:p,discount:v,source:_,acquisitionCost:C,paymentMethod:A,city:N,state:me,codCharge:ie,shippingCost:Ie,codRemittanceDate:te}=i;if(!w||!S)throw new Error("Order # and Customer Name are required");let z=null;if(P&&(z=e.find(G=>G.name.toLowerCase()===P.toLowerCase()&&G.type==="outfit"),!z))throw new Error(`Outfit '${P}' must be an existing outfit in Inventory.`);const q=ft(),X={orderNumber:w,customerName:S,outfitName:z?z.name:P,size:R,status:x,notes:V,phone:T,address:p,discount:v,source:_,acquisitionCost:parseFloat(C)||0,paymentMethod:A||"Prepaid",city:N||"",state:me||"",codCharge:parseFloat(ie)||0,shippingCost:parseFloat(Ie)||0,codRemittanceDate:te||"",usedByEmail:n==null?void 0:n.name,createdAt:ze(),updatedAt:ze()};if(b){const G=e.find(k=>k.id===b);if(G){X.fabricId=b,X.fabricName=G.name,X.imageUrl=G.imageUrl;const k=parseFloat(M);if(j&&k>0){X.cutAmount=k;const O=it(q,Fn,b);await Vt(O,{currentLength:ia(-k),updatedAt:ze()}),await cn(at(O,"history"),{amountUsed:k,orderNumber:w,productName:P,status:"Manual Entry",type:"CUT",usedByEmail:n==null?void 0:n.name,usedAt:ze()})}}}else X.imageUrl=z?z.imageUrl:`https://placehold.co/150x150/e2e8f0/64748b?text=${w}`;if(x==="Order Shipped (Completed)"){const G=parseFloat(I);if(G>0&&(X.finalSellingPrice=G),z){const k=it(q,Fn,z.id),O=1;await Vt(k,{manualSoldCount:ia(O),updatedAt:ze()}),await cn(at(k,"history"),{type:"OUTFIT_SOLD_MANUAL",amountUsed:O,size:R,status:"Legacy Sold",orderNumber:w,usedByEmail:n==null?void 0:n.name,usedAt:ze()})}}!X.finalSellingPrice&&I&&(X.finalSellingPrice=parseFloat(I)),await cn(at(q,Ur),X),o({orderNumber:"",customerName:"",outfitName:"",size:"M",fabricId:"",status:"Sent to Tailor",sellingPrice:"",deductStock:!1,cutAmount:"",notes:"",phone:"",address:"",discount:"",source:"",acquisitionCost:"",paymentMethod:"Prepaid",city:"",state:"",codCharge:"",shippingCost:"",codRemittanceDate:""}),s&&await s(),r()}catch(w){console.error(w),f(w.message||"Failed to add order")}c(!1)},g=e.filter(w=>w.type==="fabric");return l.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white w-full sm:max-w-lg sm:rounded-3xl rounded-t-3xl shadow-2xl h-[92vh] sm:h-auto flex flex-col",children:[l.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between flex-shrink-0",children:[l.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Log Past Order"}),l.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 text-gray-400 hover:text-gray-600",children:l.jsx("span",{className:"text-2xl",children:""})})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto",children:[d&&l.jsx("div",{className:"m-4 mb-0 p-3 bg-red-50 text-red-600 text-sm rounded-xl",children:d}),l.jsxs("div",{className:"space-y-4 p-6 pt-4",children:[l.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl border border-gray-100",children:[l.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-2",children:"Customer Details"}),l.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-2",children:[l.jsx("input",{className:"w-full p-2 bg-white rounded-lg border-none text-sm",placeholder:"Order # (Required)",value:i.orderNumber,onChange:w=>o({...i,orderNumber:w.target.value})}),l.jsx("input",{className:"w-full p-2 bg-white rounded-lg border-none text-sm",placeholder:"Customer Name (Required)",value:i.customerName,onChange:w=>o({...i,customerName:w.target.value})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsx("input",{className:"w-full p-2 bg-white rounded-lg border-none text-sm",placeholder:"Phone",value:i.phone,onChange:w=>o({...i,phone:w.target.value})}),l.jsx("input",{className:"w-full p-2 bg-white rounded-lg border-none text-sm",placeholder:"Address",value:i.address,onChange:w=>o({...i,address:w.target.value})})]})]}),l.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl border border-gray-100",children:[l.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-2",children:"Product Info"}),l.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-2",children:[l.jsx("input",{className:"w-full p-2 bg-white rounded-lg border-none text-sm",placeholder:"Outfit Name",value:i.outfitName,onChange:w=>o({...i,outfitName:w.target.value})}),l.jsxs("select",{className:"w-full p-2 bg-white rounded-lg border-none text-sm",value:i.size,onChange:w=>o({...i,size:w.target.value}),children:[l.jsx("option",{children:"S"}),l.jsx("option",{children:"M"}),l.jsx("option",{children:"L"}),l.jsx("option",{children:"XL"}),l.jsx("option",{children:"XXL"})]})]}),l.jsxs("select",{className:"w-full p-2 bg-white rounded-lg border-none text-sm mb-2",value:i.fabricId,onChange:w=>o({...i,fabricId:w.target.value}),children:[l.jsx("option",{value:"",children:" Select Fabric (Optional) "}),g.map(w=>l.jsx("option",{value:w.id,children:w.name},w.id))]}),i.fabricId&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("label",{className:"flex items-center gap-2 text-xs cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:i.deductStock,onChange:w=>o({...i,deductStock:w.target.checked})}),"Deduct Stock"]}),i.deductStock&&l.jsx("input",{type:"number",step:"0.1",className:"w-full p-2 bg-white rounded-lg border-none text-sm",placeholder:"Cut Amount (m)",value:i.cutAmount,onChange:w=>o({...i,cutAmount:w.target.value})})]}),l.jsx("textarea",{className:"w-full p-2 bg-white rounded-lg border-none text-sm mt-2",rows:"2",placeholder:"Notes",value:i.notes,onChange:w=>o({...i,notes:w.target.value})})]}),l.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl border border-gray-100",children:[l.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-2",children:"Status & Pricing"}),l.jsxs("select",{className:"w-full p-2 bg-white rounded-lg border-none text-sm mb-2",value:i.status,onChange:w=>o({...i,status:w.target.value}),children:[l.jsx("option",{children:"Sent to Tailor"}),l.jsx("option",{children:"Received from Tailor"}),l.jsx("option",{children:"Order Shipped (Completed)"}),l.jsx("option",{children:"Cancelled"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsx("input",{type:"number",className:"w-full p-2 bg-white rounded-lg border-none text-sm",placeholder:"Selling Price ()",value:i.sellingPrice,onChange:w=>o({...i,sellingPrice:w.target.value})}),l.jsx("input",{type:"number",className:"w-full p-2 bg-white rounded-lg border-none text-sm",placeholder:"Discount ()",value:i.discount,onChange:w=>o({...i,discount:w.target.value})})]})]})]}),l.jsx("div",{className:"p-6 pt-4 border-t border-gray-100 flex gap-3 flex-shrink-0 bg-white",children:l.jsx("button",{onClick:y,disabled:u,className:"flex-1 bg-brand text-white py-3 rounded-xl font-bold shadow-lg",children:u?"Saving...":"Add Record"})})]})]})})}function U2({item:t,type:e,onClose:n,userProfile:r,onDataChanged:s}){const[i,o]=B.useState(""),[u,c]=B.useState("M"),[d,f]=B.useState(!1),[y,g]=B.useState("");if(!t)return null;t.type;const w=async S=>{var R;S.preventDefault();const P=parseFloat(i);if(!(!P||P<=0)){f(!0),g("");try{const b=ft(),x=it(b,Fn,t.id),I=e==="ADD";if(t.type==="fabric"){const j=I?t.currentLength+P:t.currentLength-P;if(!I&&j<0){g("Cannot deduct more than available."),f(!1);return}await Vt(x,{currentLength:j,updatedAt:ze()}),await cn(at(x,"history"),{type:I?"ADJUST_ADD":"ADJUST_DEDUCT",amountUsed:P,isAddition:I,status:"Manual Adjustment",orderNumber:"MANUAL",usedByEmail:r==null?void 0:r.name,usedAt:ze()})}else{const j=((R=t.stockBreakdown)==null?void 0:R[u])||0,M=I?j+P:j-P;if(!I&&M<0){g("Cannot deduct more than available."),f(!1);return}const V={...t.stockBreakdown,[u]:M};await Vt(x,{stockBreakdown:V,updatedAt:ze()}),await cn(at(x,"history"),{type:I?"OUTFIT_ADD":"OUTFIT_SOLD",amountUsed:P,isAddition:I,size:u,status:`Stock ${I?"In":"Out"}`,orderNumber:"MANUAL",usedByEmail:r==null?void 0:r.name,usedAt:ze()})}o(""),s&&await s(),n()}catch(b){console.error(b),g("Failed to adjust stock")}f(!1)}};return l.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white w-full sm:max-w-sm sm:rounded-2xl rounded-t-3xl p-6 pb-8 shadow-2xl",children:[l.jsx("h3",{className:"text-lg font-bold mb-4 text-center",children:e==="ADD"?"Add Stock":"Deduct Stock"}),t.type==="outfit"&&l.jsx("div",{className:"flex justify-center gap-2 mb-4",children:["S","M","L","XL","XXL"].map(S=>l.jsx("button",{onClick:()=>c(S),className:`w-10 h-10 rounded-full font-bold text-sm ${u===S?"bg-outfit-600 text-white":"bg-gray-100 text-gray-500"}`,children:S},S))}),y&&l.jsx("div",{className:"mb-4 text-center text-red-600 text-sm",children:y}),l.jsx("div",{className:"mb-4",children:l.jsx("input",{type:"number",step:"0.1",className:"w-full p-4 border-2 border-brand-100 rounded-2xl text-2xl text-center font-bold focus:border-brand outline-none",autoFocus:!0,value:i,onChange:S=>o(S.target.value),placeholder:"0.0",disabled:d})}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:w,className:"flex-1 bg-brand text-white py-3 rounded-xl font-bold shadow-lg shadow-brand/30",disabled:d||!i,children:"Confirm"}),l.jsx("button",{onClick:n,className:"flex-1 bg-gray-100 text-gray-600 py-3 rounded-xl font-bold",disabled:d,children:"Cancel"})]})]})})}function z2({item:t,inventoryItems:e,db:n,onClose:r,onDataChanged:s}){if(!t)return null;const[i,o]=B.useState(t),[u,c]=B.useState(null),[d,f]=B.useState(!1),y=B.useRef(null),g=B.useRef(null),w=(R,b)=>{if(!R.parentFabricId)return 0;const x=b.find(M=>M.id===R.parentFabricId);if(!x)return 0;const I=(parseFloat(x.costPerMeter)||0)*(parseFloat(R.lengthRequiredPerOutfit)||0),j=parseFloat(R.stitchingCost)||0;return I+j},S=R=>new Promise((b,x)=>{const I=new FileReader;I.readAsDataURL(R),I.onload=()=>b(I.result),I.onerror=j=>x(j)}),P=async()=>{if(!(!i||!n)){f(!0);try{const R=it(n,"fabrics",i.id),b={...i,updatedAt:ze()};if(u){const x=await S(u);b.imageUrl=x}i.type==="outfit"&&(b.stitchingCost=parseFloat(i.stitchingCost)||0,b.sellingPrice=parseFloat(i.sellingPrice)||0,b.lengthRequiredPerOutfit=parseFloat(i.lengthRequiredPerOutfit)||0,b.manualSoldCount=parseInt(i.manualSoldCount)||0),await Vt(R,b),s&&await s(),r()}catch(R){console.error("Update Failed:",R.message)}f(!1)}};return l.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm overflow-y-auto",children:l.jsxs("div",{className:"bg-white w-full sm:max-w-lg rounded-t-3xl sm:rounded-3xl h-[92vh] sm:h-auto overflow-hidden flex flex-col shadow-2xl my-0 sm:my-10",children:[l.jsxs("div",{className:"bg-gray-50 p-6 border-b border-gray-100 flex justify-between items-center flex-shrink-0",children:[l.jsx("h3",{className:"font-bold text-lg",children:"Edit Details"}),l.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-white text-gray-400 hover:text-gray-600",children:l.jsx($r,{className:"w-6 h-6"})})]}),l.jsxs("div",{className:"p-6 overflow-y-auto flex-1 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Internal Name"}),l.jsx("input",{className:"w-full p-3 bg-gray-50 rounded-xl mt-1 border border-transparent focus:bg-white focus:border-brand",value:i.name,onChange:R=>o({...i,name:R.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Location"}),l.jsx("input",{className:"w-full p-3 bg-gray-50 rounded-xl mt-1 border border-transparent focus:bg-white focus:border-brand",value:i.location,onChange:R=>o({...i,location:R.target.value})})]}),i.type==="outfit"?l.jsxs("div",{className:"bg-purple-50 p-4 rounded-xl border border-purple-100",children:[l.jsxs("div",{className:"mb-3",children:[l.jsx("label",{className:"text-xs font-bold text-purple-800 uppercase block mb-1",children:"Linked Fabric"}),l.jsxs("select",{className:"w-full p-3 bg-white rounded-lg border border-purple-200 text-sm",value:i.parentFabricId||"",onChange:R=>o({...i,parentFabricId:R.target.value}),children:[l.jsx("option",{value:"",children:"-- No Fabric Linked --"}),e.filter(R=>R.type==="fabric").map(R=>l.jsx("option",{value:R.id,children:R.name},R.id))]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-bold text-purple-800 uppercase block mb-1",children:"Fabric Req (m)"}),l.jsx("input",{type:"number",step:"0.1",className:"w-full p-2 bg-white rounded-lg border border-purple-200 text-sm",value:i.lengthRequiredPerOutfit,onChange:R=>o({...i,lengthRequiredPerOutfit:R.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-bold text-purple-800 uppercase block mb-1",children:"Stitching "}),l.jsx("input",{type:"number",className:"w-full p-2 bg-white rounded-lg border border-purple-200 text-sm",value:i.stitchingCost,onChange:R=>o({...i,stitchingCost:R.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-bold text-purple-800 uppercase block mb-1",children:"Sell Price "}),l.jsx("input",{type:"number",className:"w-full p-2 bg-white rounded-lg border border-purple-200 text-sm",value:i.sellingPrice,onChange:R=>o({...i,sellingPrice:R.target.value})})]})]}),l.jsxs("div",{className:"pt-3 border-t border-purple-200 text-xs flex justify-between text-purple-900 mb-3",children:[l.jsxs("span",{children:["Raw Cost: ",w({...i,stitchingCost:0},e).toFixed(0)]}),l.jsxs("span",{className:"font-bold",children:["Total Make: ",w(i,e).toFixed(0)]})]}),l.jsxs("div",{className:"pt-3 border-t border-purple-200 mb-3",children:[l.jsx("p",{className:"text-xs font-bold text-purple-800 uppercase mb-2",children:"Manual Sold Count (Legacy)"}),l.jsx("input",{type:"number",className:"w-full p-2 bg-white rounded-lg border border-purple-200 text-sm",value:i.manualSoldCount||0,onChange:R=>o({...i,manualSoldCount:R.target.value}),placeholder:"0"})]}),l.jsxs("div",{className:"pt-3 border-t border-purple-200",children:[l.jsx("p",{className:"text-xs font-bold text-purple-800 uppercase mb-2",children:"Stock Breakdown"}),l.jsx("div",{className:"grid grid-cols-5 gap-2",children:["S","M","L","XL","XXL"].map(R=>{var b;return l.jsxs("div",{children:[l.jsx("label",{className:"block text-[10px] font-bold text-gray-400 mb-1 text-center",children:R}),l.jsx("input",{type:"number",className:"w-full p-2 text-center bg-white rounded-lg border border-purple-200 text-xs",value:((b=i.stockBreakdown)==null?void 0:b[R])||0,onChange:x=>o({...i,stockBreakdown:{...i.stockBreakdown,[R]:parseInt(x.target.value)||0}})})]},R)})})]})]}):l.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-100",children:[l.jsxs("label",{className:"text-xs font-bold text-blue-800 uppercase flex items-center gap-1 mb-2",children:[l.jsx(qb,{className:"w-3 h-3"})," Stock Correction"]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"number",step:"0.1",className:"flex-1 p-3 bg-white rounded-lg border border-blue-200",value:i.currentLength,onChange:R=>o({...i,currentLength:R.target.value})}),l.jsx("span",{className:"p-3 text-blue-800 font-bold self-center",children:i.unit})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-2",children:"Update Image"}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{onClick:()=>{var R;return(R=y.current)==null?void 0:R.click()},className:"h-20 bg-gray-50 rounded-xl border-dashed border-2 border-gray-300 flex flex-col items-center justify-center text-gray-400 cursor-pointer hover:border-brand active:bg-gray-100",children:[l.jsx(Kb,{className:"w-6 h-6 mb-1"}),l.jsx("span",{className:"text-xs",children:"Camera"})]}),l.jsxs("div",{onClick:()=>{var R;return(R=g.current)==null?void 0:R.click()},className:"h-20 bg-gray-50 rounded-xl border-dashed border-2 border-gray-300 flex flex-col items-center justify-center text-gray-400 cursor-pointer hover:border-brand active:bg-gray-100",children:[l.jsx(lT,{className:"w-6 h-6 mb-1"}),l.jsx("span",{className:"text-xs",children:"Gallery"})]})]}),l.jsx("input",{type:"file",hidden:!0,ref:y,capture:"environment",accept:"image/*",onChange:R=>c(R.target.files[0])}),l.jsx("input",{type:"file",hidden:!0,ref:g,accept:"image/*",onChange:R=>c(R.target.files[0])}),u&&l.jsx("p",{className:"text-xs text-green-600 font-bold mt-2 text-center",children:"New Image Selected"})]})]}),l.jsx("div",{className:"p-6 border-t border-gray-100 flex-shrink-0",children:l.jsx("button",{onClick:P,disabled:d,className:"w-full bg-brand text-white py-4 rounded-xl font-bold shadow-lg flex justify-center items-center gap-2 active:bg-brand-dark disabled:opacity-50",children:d?"Saving...":l.jsxs(l.Fragment,{children:[l.jsx(ux,{className:"w-5 h-5"})," Save Changes"]})})})]})})}function B2({visible:t,orderId:e,onClose:n}){const[r,s]=B.useState(""),[i,o]=B.useState(""),[u,c]=B.useState(!1);if(!t||!e)return null;const d=async()=>{if(r!=="posh123"){o("Incorrect Password!");return}c(!0),o("");try{const f=ft();await tc(it(f,Ur,e)),s(""),n()}catch(f){console.error(f),o("Delete failed: "+f.message)}c(!1)};return l.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white w-full sm:max-w-sm sm:rounded-2xl rounded-t-3xl p-6 pb-8 shadow-2xl",children:[l.jsxs("h3",{className:"text-lg font-bold mb-4 text-red-600 flex items-center gap-2",children:[l.jsx("span",{children:""})," Delete Record?"]}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Enter admin password to permanently delete this order history."}),i&&l.jsx("div",{className:"mb-3 p-2 bg-red-50 text-red-600 text-sm rounded",children:i}),l.jsx("input",{type:"password",className:"w-full p-3 border rounded-xl mb-4",placeholder:"Password",value:r,onChange:f=>s(f.target.value),autoFocus:!0,disabled:u}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:d,disabled:u,className:"flex-1 bg-red-600 text-white py-3 rounded-xl font-bold",children:"Delete"}),l.jsx("button",{onClick:()=>{s(""),n()},disabled:u,className:"flex-1 bg-gray-100 text-gray-600 py-3 rounded-xl font-bold",children:"Cancel"})]})]})})}function $2({visible:t,orderId:e,onClose:n}){const[r,s]=B.useState({sellingPrice:"",shippingCost:"",otherExpenses:""}),[i,o]=B.useState(""),[u,c]=B.useState(!1);if(!t||!e)return null;const d=async()=>{const f=parseFloat(r.sellingPrice);if(isNaN(f)||f<=0){o("Valid selling price required.");return}c(!0),o("");try{const y=ft();await Vt(it(y,Ur,e),{status:"Order Shipped (Completed)",finalSellingPrice:f,shippingCost:parseFloat(r.shippingCost)||0,otherExpenses:parseFloat(r.otherExpenses)||0,updatedAt:ze()}),s({sellingPrice:"",shippingCost:"",otherExpenses:""}),n()}catch(y){console.error(y),o("Failed to ship order")}c(!1)};return l.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white w-full sm:max-w-sm sm:rounded-2xl rounded-t-3xl p-6 pb-8 shadow-2xl",children:[l.jsx("h3",{className:"text-lg font-bold mb-4",children:"Complete Shipping"}),i&&l.jsx("div",{className:"mb-3 p-2 bg-red-50 text-red-600 text-sm rounded",children:i}),l.jsxs("div",{className:"space-y-3 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500",children:"Final Selling Price ()"}),l.jsx("input",{type:"number",className:"w-full p-2 border rounded-xl mt-1",value:r.sellingPrice,onChange:f=>s({...r,sellingPrice:f.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500",children:"Shipping Cost ()"}),l.jsx("input",{type:"number",className:"w-full p-2 border rounded-xl mt-1",value:r.shippingCost,onChange:f=>s({...r,shippingCost:f.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500",children:"Other Expenses ()"}),l.jsx("input",{type:"number",className:"w-full p-2 border rounded-xl mt-1",value:r.otherExpenses,onChange:f=>s({...r,otherExpenses:f.target.value})})]})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:d,disabled:u,className:"flex-1 bg-brand text-white py-3 rounded-xl font-bold",children:"Confirm Ship"}),l.jsx("button",{onClick:n,disabled:u,className:"flex-1 bg-gray-100 text-gray-600 py-3 rounded-xl font-bold",children:"Cancel"})]})]})})}function q2({url:t,onClose:e}){return t?l.jsxs("div",{className:"fixed inset-0 bg-black/95 z-[60] flex items-center justify-center p-4 backdrop-blur-sm modal-enter",onClick:e,children:[l.jsx("img",{src:t,className:"max-w-full max-h-[85vh] rounded-2xl shadow-2xl",alt:"Full size",onClick:n=>n.stopPropagation()}),l.jsx("button",{className:"absolute top-6 right-6 text-white p-3 bg-white/20 rounded-full hover:bg-white/30 active:bg-white/40",onClick:e,children:l.jsx($r,{className:"w-6 h-6"})})]}):null}function H2({itemId:t,onClose:e}){const[n,r]=B.useState([]),[s,i]=B.useState(null);B.useEffect(()=>{if(!t){r([]);return}const c=ft(),d=x2(m2(at(it(c,Fn,t),"history")),f=>{const y=f.docs.map(g=>({id:g.id,...g.data()})).sort((g,w)=>{var S,P;return(((S=w.usedAt)==null?void 0:S.toMillis())||0)-(((P=g.usedAt)==null?void 0:P.toMillis())||0)});r(y)},f=>console.error("History fetch error:",f));return()=>d()},[t]);const o=async(c,d)=>{const f=ft();await tc(it(f,Fn,c,"history",d)),i(null)},u=c=>{if(!c||!c.toDate)return"N/A";const d=c.toDate();return d.toLocaleDateString()+" "+d.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};return t?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 bg-black/60 z-[70] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white w-full sm:max-w-2xl rounded-t-3xl sm:rounded-3xl h-[90vh] sm:h-[85vh] overflow-hidden flex flex-col shadow-2xl",children:[l.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50 flex-shrink-0",children:[l.jsx("h3",{className:"font-bold text-lg",children:"Transaction History"}),l.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-white text-gray-400 hover:text-gray-600",children:l.jsx($r,{className:"w-6 h-6"})})]}),l.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:n.length===0?l.jsx("div",{className:"text-center py-12 text-gray-400",children:l.jsx("p",{children:"No transaction history recorded"})}):l.jsx("div",{className:"space-y-3",children:n.map(c=>l.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-md transition",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold ${c.type==="CUT"?"bg-red-100 text-red-700":c.type==="ADJUST_ADD"||c.type==="OUTFIT_ADD"?"bg-green-100 text-green-700":c.type==="ADJUST_DEDUCT"||c.type==="OUTFIT_SOLD"?"bg-orange-100 text-orange-700":c.type==="CANCEL_RETURN"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:c.type}),c.size&&l.jsxs("span",{className:"text-xs font-bold text-gray-500",children:["Size: ",c.size]})]}),l.jsxs("div",{className:"text-sm space-y-1",children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsx("span",{className:"text-gray-500",children:"Amount:"}),l.jsxs("span",{className:"font-bold text-gray-900",children:[parseFloat(c.amountUsed||0).toFixed(2)," ",c.size?"pcs":"m"]})]}),c.orderNumber&&l.jsxs("div",{className:"flex gap-2",children:[l.jsx("span",{className:"text-gray-500",children:"Order:"}),l.jsxs("span",{className:"font-medium text-gray-700",children:["#",c.orderNumber]})]}),c.productName&&l.jsxs("div",{className:"flex gap-2",children:[l.jsx("span",{className:"text-gray-500",children:"Product:"}),l.jsx("span",{className:"font-medium text-gray-700",children:c.productName})]}),c.status&&l.jsxs("div",{className:"flex gap-2",children:[l.jsx("span",{className:"text-gray-500",children:"Status:"}),l.jsx("span",{className:"font-medium text-gray-700",children:c.status})]}),c.usedByEmail&&l.jsxs("div",{className:"flex gap-2",children:[l.jsx("span",{className:"text-gray-500",children:"By:"}),l.jsx("span",{className:"text-xs text-gray-600",children:c.usedByEmail})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("span",{className:"text-gray-500",children:"Date:"}),l.jsx("span",{className:"text-xs text-gray-600",children:u(c.usedAt)})]})]})]}),l.jsx("button",{onClick:()=>i(c.id),className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition",title:"Delete log",children:l.jsx(eu,{className:"w-4 h-4"})})]})},c.id))})})]})}),s&&l.jsx("div",{className:"fixed inset-0 bg-black/50 z-[80] flex items-center justify-center p-4 modal-enter",children:l.jsxs("div",{className:"bg-white p-6 rounded-2xl w-full max-w-sm shadow-2xl",children:[l.jsxs("h3",{className:"text-lg font-bold mb-4 text-red-600 flex items-center gap-2",children:[l.jsx(eu,{className:"w-5 h-5"})," Delete Log Entry?"]}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"This will permanently remove this transaction from the history."}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:()=>o(t,s),className:"flex-1 bg-red-600 text-white py-3 rounded-xl font-bold",children:"Delete"}),l.jsx("button",{onClick:()=>i(null),className:"flex-1 bg-gray-100 text-gray-600 py-3 rounded-xl font-bold",children:"Cancel"})]})]})})]}):null}const Bn={Home:()=>l.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"})}),Box:()=>l.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})}),Plus:()=>l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),Clipboard:()=>l.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{d:"M4 4a2 2 0 012-2h6a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V4z"})}),Table:()=>l.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"})}),LogOut:()=>l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),ShoppingBag:()=>l.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 10a4 4 0 0 1-8 0"})]}),Users:()=>l.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 21v-2a4 4 0 0 0-4-4H7a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"9",cy:"7",r:"4",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})]}),TrendingUp:()=>l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})};function W2({login:t}){const[e,n]=B.useState(""),[r,s]=B.useState(""),[i,o]=B.useState(!1),u=async c=>{c.preventDefault(),s(""),o(!0);try{const d=await t(e);d.ok||s(d.message)}catch(d){s(d.message)}finally{o(!1)}};return l.jsxs("form",{onSubmit:u,className:"space-y-4",children:[r&&l.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-3 text-sm text-red-700",children:r}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-2",children:"Your Name"}),l.jsx("input",{type:"text",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-green-600 focus:outline-none transition",value:e,onChange:c=>n(c.target.value),required:!0})]}),l.jsx("button",{type:"submit",disabled:i,className:"w-full bg-green-600 text-white font-bold py-3 rounded-xl hover:bg-green-700 transition shadow-lg disabled:bg-gray-400 disabled:cursor-not-allowed",children:i?"Please wait...":"Sign In"})]})}function G2(){const[t,e]=B.useState("home"),{userProfile:n,login:r,logout:s,loading:i}=j2(),[o,u]=B.useState(""),[c,d]=B.useState([]),[f,y]=B.useState([]),[g,w]=B.useState([]),[S,P]=B.useState(!1),[R,b]=B.useState(null),[x,I]=B.useState(null),[j,M]=B.useState(null),[V,T]=B.useState(!1),[p,v]=B.useState({orderNumber:"",customerName:"",outfitName:"",size:"M",fabricId:"",status:"Sent to Tailor",sellingPrice:"",deductStock:!1,cutAmount:"",notes:"",phone:"",address:"",discount:"",source:"",acquisitionCost:"",paymentMethod:"Prepaid",city:"",state:"",codCharge:"",shippingCost:"",codRemittanceDate:""}),[_,C]=B.useState(null),[A,N]=B.useState(null),[me,ie]=B.useState(null),[Ie,te]=B.useState(null),[z,q]=B.useState(""),[X,G]=B.useState(null),[k,O]=B.useState({sellingPrice:"",shippingCost:"",otherExpenses:""}),[K,se]=B.useState(null),[F,H]=B.useState(!1),[Y,ue]=B.useState(null),[oe,ne]=B.useState(null);Ws.useEffect(()=>{try{fp();const J=ft();ue(J),E2().then(()=>{console.log("Firebase authenticated anonymously"),zs(at(J,"fabrics")).then(le=>{console.log("Direct fabrics query result:",le.size,"documents"),le.empty||console.log("Sample fabric:",le.docs[0].data())}).catch(le=>console.error("Direct fabrics query error:",le)),zs(at(J,"production_orders")).then(le=>{console.log("Direct production_orders query result:",le.size,"documents"),le.empty||console.log("Sample order:",le.docs[0].data())}).catch(le=>console.error("Direct production_orders query error:",le)),zs(at(J,"customers")).then(le=>{console.log("Direct customers query result:",le.size,"documents"),le.empty||console.log("Sample customer:",le.docs[0].data())}).catch(le=>console.error("Direct customers query error:",le))}).catch(le=>{console.error("Auth error:",le)})}catch(J){console.error("Firebase init error:",J)}},[]),Ws.useEffect(()=>{Y&&xe()},[Y]);const xe=async()=>{try{const le=(await zs(at(Y,"fabrics"))).docs.map(De=>({id:De.id,...De.data()})).filter(De=>De&&De.name);d(le),console.log("Loaded",le.length,"inventory items")}catch(J){console.error("Error loading inventory:",J)}};Ws.useEffect(()=>{Y&&Ce()},[Y]);const Ce=async()=>{try{const le=(await zs(at(Y,"production_orders"))).docs.map(De=>({id:De.id,...De.data()})).filter(De=>De&&De.orderNumber);y(le),console.log("Loaded",le.length,"orders")}catch(J){console.error("Error loading orders:",J)}};Ws.useEffect(()=>{Y&&ge()},[Y]);const ge=async()=>{try{const le=(await zs(at(Y,"production_batches"))).docs.map(De=>({id:De.id,...De.data()}));w(le),console.log("Loaded",le.length,"production batches")}catch(J){console.error("Error loading production batches:",J)}},ye=async()=>{await Promise.all([xe(),Ce(),ge()])},ve=J=>{ie(J.id)},jt=(J,le)=>{C(J),N(le)},fe=async J=>{if(confirm("Cancel this order?"))try{const le=ft();if(await Vt(it(le,Ur,J.id),{status:"Cancelled",updatedAt:ze()}),J.fabricId&&J.cutAmount>0){const De=it(le,Fn,J.fabricId);await Vt(De,{currentLength:ia(Math.abs(parseFloat(J.cutAmount)||0)),updatedAt:ze()}),await cn(at(De,"history"),{amountUsed:J.cutAmount,orderNumber:`CANCEL-${J.orderNumber}`,type:"CANCEL_RETURN",status:"Cancelled",usedAt:ze()})}await Promise.all([Ce(),xe()])}catch(le){console.error(le)}},je=async J=>{if(confirm("Delete this item?"))try{const le=ft();await tc(it(le,Fn,J.id)),b(null),await xe()}catch(le){console.error(le)}};if(!n)return l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-green-50 to-blue-50 p-4",children:l.jsxs("div",{className:"w-full max-w-sm bg-white rounded-2xl shadow-lg p-8",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("h1",{className:"text-3xl font-extrabold text-green-600 mb-2",children:"Poshakh Manager"}),l.jsx("p",{className:"text-gray-500 text-sm",children:"Stock & Production Tracking"})]}),l.jsx(W2,{login:r})]})});const Ut=[{id:"home",label:"Home",icon:Bn.Home},{id:"inventory",label:"Inventory",icon:Bn.Box},{id:"orders",label:"Orders",icon:Bn.Clipboard},{id:"add",label:"Add",icon:Bn.Plus},{id:"outfits",label:"Outfits",icon:Bn.ShoppingBag},{id:"customers",label:"Customers",icon:Bn.Users},...(n==null?void 0:n.role)==="admin"?[{id:"financial",label:"Financial",icon:Bn.TrendingUp}]:[]];return l.jsxs("div",{className:"min-h-screen bg-gray-50 pb-24",children:[l.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-40 shadow-sm",children:l.jsxs("div",{className:"px-4 sm:px-6 py-3 sm:py-4 flex justify-between items-center",children:[l.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[l.jsx("div",{className:"w-2 h-2 sm:w-3 sm:h-3 rounded-full bg-green-500"}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-base sm:text-lg font-bold text-gray-900",children:"Poshakh Manager"}),l.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500",children:"Connected"})]})]}),l.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[l.jsx("button",{onClick:ye,className:"h-9 w-9 sm:h-10 sm:w-10 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center hover:bg-blue-200 active:bg-blue-200",title:"Refresh Data",children:l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),(n==null?void 0:n.role)==="admin"&&l.jsx("button",{onClick:()=>e("import"),className:"h-9 w-9 sm:h-10 sm:w-10 bg-green-100 text-green-700 rounded-full flex items-center justify-center hover:bg-green-200 active:bg-green-200",title:"Import",children:l.jsx(Bn.Table,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),l.jsxs("div",{className:"text-right hidden sm:block",children:[l.jsx("p",{className:"text-sm font-semibold text-gray-900",children:n.name}),l.jsx("p",{className:"text-xs text-gray-500 capitalize",children:n.role})]}),l.jsx("button",{onClick:s,className:"p-2 rounded-lg hover:bg-red-50 active:bg-red-100 text-red-600 transition",title:"Logout",children:l.jsx(Bn.LogOut,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]})}),l.jsxs("main",{className:"px-4 sm:px-6 py-4 sm:py-6 max-w-7xl mx-auto pb-24",children:[t==="home"&&l.jsx(S2,{allOrders:f,inventoryItems:c,userRole:n==null?void 0:n.role}),t==="inventory"&&l.jsx(NT,{onViewItem:J=>b(J),inventoryItems:c,soldCounts:{},onAddClick:()=>e("add"),userRole:n==null?void 0:n.role}),t==="orders"&&l.jsx(b2,{allOrders:f,inventoryItems:c,productionBatches:g,onViewOrder:J=>I(J),onShowLegacyModal:()=>T(!0),onCancelOrder:fe,onDeleteOrder:J=>te(J),onOpenShipping:J=>G(J),onCreateProductionBatch:()=>P(!0),userRole:n==null?void 0:n.role,onDataChanged:ye}),t==="outfits"&&l.jsx(C2,{allOrders:f,inventoryItems:c}),t==="customers"&&l.jsx(k2,{allOrders:f,onViewCustomer:J=>M(J),searchTerm:"",setSearchTerm:()=>{}}),t==="financial"&&l.jsx(A2,{inventoryItems:c,allOrders:f,userRole:n==null?void 0:n.role}),t==="add"&&l.jsx(T2,{onSuccess:()=>e("inventory"),onDataChanged:ye}),t==="import"&&(n==null?void 0:n.role)==="admin"&&l.jsx(N2,{}),l.jsx(O2,{item:R,onClose:()=>b(null),onOpenEdit:ve,onOpenStock:jt,onViewHistory:J=>{b(null),ne(J.id)},onDelete:je}),l.jsx(L2,{order:x,onClose:()=>I(null),onEdit:J=>{I(null),T(!0),v({orderNumber:J.orderNumber,customerName:J.customerName,outfitName:J.outfitName,size:J.size,fabricId:J.fabricId||""})},onShip:J=>{G(J.id)}}),l.jsx(V2,{customer:j,onClose:()=>M(null),allOrders:f,inventoryItems:c,userRole:n==null?void 0:n.role}),l.jsx(F2,{visible:V,onClose:()=>T(!1),inventoryItems:c,onDataChanged:ye}),l.jsx(U2,{item:_,type:A,onClose:()=>{C(null),N(null)},onDataChanged:ye,userProfile:n}),l.jsx(z2,{item:me?c.find(J=>J.id===me):null,inventoryItems:c,db:Y,onClose:()=>ie(null),onDataChanged:ye}),l.jsx(B2,{visible:!!Ie,orderId:Ie,onClose:()=>{te(null)}}),l.jsx($2,{visible:!!X,orderId:X,onClose:()=>G(null)}),l.jsx(q2,{url:K,onClose:()=>se(null)}),l.jsx(H2,{itemId:oe,onClose:()=>ne(null)}),l.jsx(P2,{visible:S,onClose:()=>P(!1),inventoryItems:c,onDataChanged:ye})]}),l.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-2 sm:px-4 py-2 sm:py-3 flex justify-around items-center shadow-lg safe-area-inset-bottom",children:Ut.map(J=>{const le=t===J.id;return J.id==="add"?l.jsx("button",{onClick:()=>e(J.id),className:"w-14 h-14 sm:w-16 sm:h-16 rounded-full bg-green-600 text-white flex items-center justify-center shadow-xl hover:bg-green-700 active:bg-green-700 transition -mt-8 border-4 border-gray-50",children:l.jsx(J.icon,{className:"w-6 h-6"})},J.id):l.jsxs("button",{onClick:()=>e(J.id),className:`flex flex-col items-center gap-1 py-2 px-2 sm:px-3 rounded-xl transition min-w-[60px] ${le?"text-green-600 bg-green-50":"text-gray-500 active:text-gray-700 active:bg-gray-50"}`,children:[l.jsx(J.icon,{className:"w-5 h-5"}),l.jsx("span",{className:"text-[10px] sm:text-xs font-medium",children:J.label})]},J.id)})})]})}function K2(){return l.jsx(D2,{children:l.jsx(G2,{})})}ox(document.getElementById("root")).render(l.jsx(Ws.StrictMode,{children:l.jsx(K2,{})}));
