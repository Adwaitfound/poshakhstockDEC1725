(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var gb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qy(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Xy={exports:{}},_c={},Yy={exports:{}},Te={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var da=Symbol.for("react.element"),yb=Symbol.for("react.portal"),vb=Symbol.for("react.fragment"),xb=Symbol.for("react.strict_mode"),wb=Symbol.for("react.profiler"),_b=Symbol.for("react.provider"),bb=Symbol.for("react.context"),Eb=Symbol.for("react.forward_ref"),Nb=Symbol.for("react.suspense"),Tb=Symbol.for("react.memo"),Sb=Symbol.for("react.lazy"),am=Symbol.iterator;function Ib(t){return t===null||typeof t!="object"?null:(t=am&&t[am]||t["@@iterator"],typeof t=="function"?t:null)}var Jy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Zy=Object.assign,e0={};function Di(t,e,n){this.props=t,this.context=e,this.refs=e0,this.updater=n||Jy}Di.prototype.isReactComponent={};Di.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Di.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function t0(){}t0.prototype=Di.prototype;function Nh(t,e,n){this.props=t,this.context=e,this.refs=e0,this.updater=n||Jy}var Th=Nh.prototype=new t0;Th.constructor=Nh;Zy(Th,Di.prototype);Th.isPureReactComponent=!0;var lm=Array.isArray,n0=Object.prototype.hasOwnProperty,Sh={current:null},r0={key:!0,ref:!0,__self:!0,__source:!0};function s0(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)n0.call(e,r)&&!r0.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:da,type:t,key:i,ref:a,props:s,_owner:Sh.current}}function Cb(t,e){return{$$typeof:da,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ih(t){return typeof t=="object"&&t!==null&&t.$$typeof===da}function kb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var cm=/\/+/g;function wu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?kb(""+t.key):e.toString(36)}function hl(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case da:case yb:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+wu(a,0):r,lm(s)?(n="",t!=null&&(n=t.replace(cm,"$&/")+"/"),hl(s,e,n,"",function(d){return d})):s!=null&&(Ih(s)&&(s=Cb(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(cm,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",lm(t))for(var c=0;c<t.length;c++){i=t[c];var u=r+wu(i,c);a+=hl(i,e,n,u,s)}else if(u=Ib(t),typeof u=="function")for(t=u.call(t),c=0;!(i=t.next()).done;)i=i.value,u=r+wu(i,c++),a+=hl(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function $a(t,e,n){if(t==null)return t;var r=[],s=0;return hl(t,r,"","",function(i){return e.call(n,i,s++)}),r}function Ab(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ut={current:null},fl={transition:null},jb={ReactCurrentDispatcher:Ut,ReactCurrentBatchConfig:fl,ReactCurrentOwner:Sh};Te.Children={map:$a,forEach:function(t,e,n){$a(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return $a(t,function(){e++}),e},toArray:function(t){return $a(t,function(e){return e})||[]},only:function(t){if(!Ih(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Te.Component=Di;Te.Fragment=vb;Te.Profiler=wb;Te.PureComponent=Nh;Te.StrictMode=xb;Te.Suspense=Nb;Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jb;Te.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Zy({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Sh.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)n0.call(e,u)&&!r0.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:da,type:t.type,key:s,ref:i,props:r,_owner:a}};Te.createContext=function(t){return t={$$typeof:bb,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:_b,_context:t},t.Consumer=t};Te.createElement=s0;Te.createFactory=function(t){var e=s0.bind(null,t);return e.type=t,e};Te.createRef=function(){return{current:null}};Te.forwardRef=function(t){return{$$typeof:Eb,render:t}};Te.isValidElement=Ih;Te.lazy=function(t){return{$$typeof:Sb,_payload:{_status:-1,_result:t},_init:Ab}};Te.memo=function(t,e){return{$$typeof:Tb,type:t,compare:e===void 0?null:e}};Te.startTransition=function(t){var e=fl.transition;fl.transition={};try{t()}finally{fl.transition=e}};Te.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Te.useCallback=function(t,e){return Ut.current.useCallback(t,e)};Te.useContext=function(t){return Ut.current.useContext(t)};Te.useDebugValue=function(){};Te.useDeferredValue=function(t){return Ut.current.useDeferredValue(t)};Te.useEffect=function(t,e){return Ut.current.useEffect(t,e)};Te.useId=function(){return Ut.current.useId()};Te.useImperativeHandle=function(t,e,n){return Ut.current.useImperativeHandle(t,e,n)};Te.useInsertionEffect=function(t,e){return Ut.current.useInsertionEffect(t,e)};Te.useLayoutEffect=function(t,e){return Ut.current.useLayoutEffect(t,e)};Te.useMemo=function(t,e){return Ut.current.useMemo(t,e)};Te.useReducer=function(t,e,n){return Ut.current.useReducer(t,e,n)};Te.useRef=function(t){return Ut.current.useRef(t)};Te.useState=function(t){return Ut.current.useState(t)};Te.useSyncExternalStore=function(t,e,n){return Ut.current.useSyncExternalStore(t,e,n)};Te.useTransition=function(){return Ut.current.useTransition()};Te.version="18.2.0";Yy.exports=Te;var F=Yy.exports;const ms=Qy(F);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pb=F,Rb=Symbol.for("react.element"),Db=Symbol.for("react.fragment"),Ob=Object.prototype.hasOwnProperty,Lb=Pb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Mb={key:!0,ref:!0,__self:!0,__source:!0};function i0(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)Ob.call(e,r)&&!Mb.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Rb,type:t,key:i,ref:a,props:s,_owner:Lb.current}}_c.Fragment=Db;_c.jsx=i0;_c.jsxs=i0;Xy.exports=_c;var o=Xy.exports,o0={exports:{}},sn={},a0={exports:{}},l0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(O,$){var ee=O.length;O.push($);e:for(;0<ee;){var X=ee-1>>>1,J=O[X];if(0<s(J,$))O[X]=$,O[ee]=J,ee=X;else break e}}function n(O){return O.length===0?null:O[0]}function r(O){if(O.length===0)return null;var $=O[0],ee=O.pop();if(ee!==$){O[0]=ee;e:for(var X=0,J=O.length,A=J>>>1;X<A;){var H=2*(X+1)-1,K=O[H],V=H+1,z=O[V];if(0>s(K,ee))V<J&&0>s(z,K)?(O[X]=z,O[V]=ee,X=V):(O[X]=K,O[H]=ee,X=H);else if(V<J&&0>s(z,ee))O[X]=z,O[V]=ee,X=V;else break e}}return $}function s(O,$){var ee=O.sortIndex-$.sortIndex;return ee!==0?ee:O.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var u=[],d=[],p=1,y=null,m=3,T=!1,w=!1,P=!1,I=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(O){for(var $=n(d);$!==null;){if($.callback===null)r(d);else if($.startTime<=O)r(d),$.sortIndex=$.expirationTime,e(u,$);else break;$=n(d)}}function R(O){if(P=!1,b(O),!w)if(n(u)!==null)w=!0,Se(L);else{var $=n(d);$!==null&&ne(R,$.startTime-O)}}function L(O,$){w=!1,P&&(P=!1,E(f),f=-1),T=!0;var ee=m;try{for(b($),y=n(u);y!==null&&(!(y.expirationTime>$)||O&&!k());){var X=y.callback;if(typeof X=="function"){y.callback=null,m=y.priorityLevel;var J=X(y.expirationTime<=$);$=t.unstable_now(),typeof J=="function"?y.callback=J:y===n(u)&&r(u),b($)}else r(u);y=n(u)}if(y!==null)var A=!0;else{var H=n(d);H!==null&&ne(R,H.startTime-$),A=!1}return A}finally{y=null,m=ee,T=!1}}var M=!1,N=null,f=-1,v=5,_=-1;function k(){return!(t.unstable_now()-_<v)}function j(){if(N!==null){var O=t.unstable_now();_=O;var $=!0;try{$=N(!0,O)}finally{$?C():(M=!1,N=null)}}else M=!1}var C;if(typeof x=="function")C=function(){x(j)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,ae=ge.port2;ge.port1.onmessage=j,C=function(){ae.postMessage(null)}}else C=function(){I(j,0)};function Se(O){N=O,M||(M=!0,C())}function ne(O,$){f=I(function(){O(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){w||T||(w=!0,Se(L))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):v=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(O){switch(m){case 1:case 2:case 3:var $=3;break;default:$=m}var ee=m;m=$;try{return O()}finally{m=ee}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,$){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var ee=m;m=O;try{return $()}finally{m=ee}},t.unstable_scheduleCallback=function(O,$,ee){var X=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?X+ee:X):ee=X,O){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=ee+J,O={id:p++,callback:$,priorityLevel:O,startTime:ee,expirationTime:J,sortIndex:-1},ee>X?(O.sortIndex=ee,e(d,O),n(u)===null&&O===n(d)&&(P?(E(f),f=-1):P=!0,ne(R,ee-X))):(O.sortIndex=J,e(u,O),w||T||(w=!0,Se(L))),O},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(O){var $=m;return function(){var ee=m;m=$;try{return O.apply(this,arguments)}finally{m=ee}}}})(l0);a0.exports=l0;var Vb=a0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c0=F,rn=Vb;function W(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u0=new Set,Lo={};function Ms(t,e){wi(t,e),wi(t+"Capture",e)}function wi(t,e){for(Lo[t]=e,t=0;t<e.length;t++)u0.add(e[t])}var er=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),id=Object.prototype.hasOwnProperty,Fb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,um={},dm={};function Ub(t){return id.call(dm,t)?!0:id.call(um,t)?!1:Fb.test(t)?dm[t]=!0:(um[t]=!0,!1)}function zb(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Bb(t,e,n,r){if(e===null||typeof e>"u"||zb(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function zt(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var bt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){bt[t]=new zt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];bt[e]=new zt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){bt[t]=new zt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){bt[t]=new zt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){bt[t]=new zt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){bt[t]=new zt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){bt[t]=new zt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){bt[t]=new zt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){bt[t]=new zt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ch=/[\-:]([a-z])/g;function kh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ch,kh);bt[e]=new zt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ch,kh);bt[e]=new zt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ch,kh);bt[e]=new zt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){bt[t]=new zt(t,1,!1,t.toLowerCase(),null,!1,!1)});bt.xlinkHref=new zt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){bt[t]=new zt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ah(t,e,n,r){var s=bt.hasOwnProperty(e)?bt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Bb(e,n,s,r)&&(n=null),r||s===null?Ub(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var cr=c0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qa=Symbol.for("react.element"),Xs=Symbol.for("react.portal"),Ys=Symbol.for("react.fragment"),jh=Symbol.for("react.strict_mode"),od=Symbol.for("react.profiler"),d0=Symbol.for("react.provider"),h0=Symbol.for("react.context"),Ph=Symbol.for("react.forward_ref"),ad=Symbol.for("react.suspense"),ld=Symbol.for("react.suspense_list"),Rh=Symbol.for("react.memo"),vr=Symbol.for("react.lazy"),f0=Symbol.for("react.offscreen"),hm=Symbol.iterator;function so(t){return t===null||typeof t!="object"?null:(t=hm&&t[hm]||t["@@iterator"],typeof t=="function"?t:null)}var Ze=Object.assign,_u;function fo(t){if(_u===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);_u=e&&e[1]||""}return`
`+_u+t}var bu=!1;function Eu(t,e){if(!t||bu)return"";bu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,c=i.length-1;1<=a&&0<=c&&s[a]!==i[c];)c--;for(;1<=a&&0<=c;a--,c--)if(s[a]!==i[c]){if(a!==1||c!==1)do if(a--,c--,0>c||s[a]!==i[c]){var u=`
`+s[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=c);break}}}finally{bu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?fo(t):""}function $b(t){switch(t.tag){case 5:return fo(t.type);case 16:return fo("Lazy");case 13:return fo("Suspense");case 19:return fo("SuspenseList");case 0:case 2:case 15:return t=Eu(t.type,!1),t;case 11:return t=Eu(t.type.render,!1),t;case 1:return t=Eu(t.type,!0),t;default:return""}}function cd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ys:return"Fragment";case Xs:return"Portal";case od:return"Profiler";case jh:return"StrictMode";case ad:return"Suspense";case ld:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case h0:return(t.displayName||"Context")+".Consumer";case d0:return(t._context.displayName||"Context")+".Provider";case Ph:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Rh:return e=t.displayName||null,e!==null?e:cd(t.type)||"Memo";case vr:e=t._payload,t=t._init;try{return cd(t(e))}catch{}}return null}function qb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cd(e);case 8:return e===jh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function qr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function p0(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Hb(t){var e=p0(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ha(t){t._valueTracker||(t._valueTracker=Hb(t))}function m0(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=p0(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Dl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ud(t,e){var n=e.checked;return Ze({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function fm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=qr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function g0(t,e){e=e.checked,e!=null&&Ah(t,"checked",e,!1)}function dd(t,e){g0(t,e);var n=qr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?hd(t,e.type,n):e.hasOwnProperty("defaultValue")&&hd(t,e.type,qr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function pm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function hd(t,e,n){(e!=="number"||Dl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var po=Array.isArray;function ci(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+qr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function fd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(W(91));return Ze({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function mm(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(W(92));if(po(n)){if(1<n.length)throw Error(W(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:qr(n)}}function y0(t,e){var n=qr(e.value),r=qr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function gm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function v0(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?v0(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Wa,x0=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Wa=Wa||document.createElement("div"),Wa.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Wa.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Mo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var _o={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Wb=["Webkit","ms","Moz","O"];Object.keys(_o).forEach(function(t){Wb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),_o[e]=_o[t]})});function w0(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||_o.hasOwnProperty(t)&&_o[t]?(""+e).trim():e+"px"}function _0(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=w0(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Gb=Ze({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function md(t,e){if(e){if(Gb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(W(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(W(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(e.style!=null&&typeof e.style!="object")throw Error(W(62))}}function gd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yd=null;function Dh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var vd=null,ui=null,di=null;function ym(t){if(t=pa(t)){if(typeof vd!="function")throw Error(W(280));var e=t.stateNode;e&&(e=Sc(e),vd(t.stateNode,t.type,e))}}function b0(t){ui?di?di.push(t):di=[t]:ui=t}function E0(){if(ui){var t=ui,e=di;if(di=ui=null,ym(t),e)for(t=0;t<e.length;t++)ym(e[t])}}function N0(t,e){return t(e)}function T0(){}var Nu=!1;function S0(t,e,n){if(Nu)return t(e,n);Nu=!0;try{return N0(t,e,n)}finally{Nu=!1,(ui!==null||di!==null)&&(T0(),E0())}}function Vo(t,e){var n=t.stateNode;if(n===null)return null;var r=Sc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(W(231,e,typeof n));return n}var xd=!1;if(er)try{var io={};Object.defineProperty(io,"passive",{get:function(){xd=!0}}),window.addEventListener("test",io,io),window.removeEventListener("test",io,io)}catch{xd=!1}function Kb(t,e,n,r,s,i,a,c,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(p){this.onError(p)}}var bo=!1,Ol=null,Ll=!1,wd=null,Qb={onError:function(t){bo=!0,Ol=t}};function Xb(t,e,n,r,s,i,a,c,u){bo=!1,Ol=null,Kb.apply(Qb,arguments)}function Yb(t,e,n,r,s,i,a,c,u){if(Xb.apply(this,arguments),bo){if(bo){var d=Ol;bo=!1,Ol=null}else throw Error(W(198));Ll||(Ll=!0,wd=d)}}function Vs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function I0(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function vm(t){if(Vs(t)!==t)throw Error(W(188))}function Jb(t){var e=t.alternate;if(!e){if(e=Vs(t),e===null)throw Error(W(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return vm(s),t;if(i===r)return vm(s),e;i=i.sibling}throw Error(W(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,c=s.child;c;){if(c===n){a=!0,n=s,r=i;break}if(c===r){a=!0,r=s,n=i;break}c=c.sibling}if(!a){for(c=i.child;c;){if(c===n){a=!0,n=i,r=s;break}if(c===r){a=!0,r=i,n=s;break}c=c.sibling}if(!a)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?t:e}function C0(t){return t=Jb(t),t!==null?k0(t):null}function k0(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=k0(t);if(e!==null)return e;t=t.sibling}return null}var A0=rn.unstable_scheduleCallback,xm=rn.unstable_cancelCallback,Zb=rn.unstable_shouldYield,e1=rn.unstable_requestPaint,st=rn.unstable_now,t1=rn.unstable_getCurrentPriorityLevel,Oh=rn.unstable_ImmediatePriority,j0=rn.unstable_UserBlockingPriority,Ml=rn.unstable_NormalPriority,n1=rn.unstable_LowPriority,P0=rn.unstable_IdlePriority,bc=null,Dn=null;function r1(t){if(Dn&&typeof Dn.onCommitFiberRoot=="function")try{Dn.onCommitFiberRoot(bc,t,void 0,(t.current.flags&128)===128)}catch{}}var Nn=Math.clz32?Math.clz32:o1,s1=Math.log,i1=Math.LN2;function o1(t){return t>>>=0,t===0?32:31-(s1(t)/i1|0)|0}var Ga=64,Ka=4194304;function mo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Vl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var c=a&~s;c!==0?r=mo(c):(i&=a,i!==0&&(r=mo(i)))}else a=n&~s,a!==0?r=mo(a):i!==0&&(r=mo(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Nn(e),s=1<<n,r|=t[n],e&=~s;return r}function a1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function l1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Nn(i),c=1<<a,u=s[a];u===-1?(!(c&n)||c&r)&&(s[a]=a1(c,e)):u<=e&&(t.expiredLanes|=c),i&=~c}}function _d(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function R0(){var t=Ga;return Ga<<=1,!(Ga&4194240)&&(Ga=64),t}function Tu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ha(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Nn(e),t[e]=n}function c1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Nn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Lh(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Nn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Le=0;function D0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var O0,Mh,L0,M0,V0,bd=!1,Qa=[],kr=null,Ar=null,jr=null,Fo=new Map,Uo=new Map,wr=[],u1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wm(t,e){switch(t){case"focusin":case"focusout":kr=null;break;case"dragenter":case"dragleave":Ar=null;break;case"mouseover":case"mouseout":jr=null;break;case"pointerover":case"pointerout":Fo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uo.delete(e.pointerId)}}function oo(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=pa(e),e!==null&&Mh(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function d1(t,e,n,r,s){switch(e){case"focusin":return kr=oo(kr,t,e,n,r,s),!0;case"dragenter":return Ar=oo(Ar,t,e,n,r,s),!0;case"mouseover":return jr=oo(jr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Fo.set(i,oo(Fo.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Uo.set(i,oo(Uo.get(i)||null,t,e,n,r,s)),!0}return!1}function F0(t){var e=gs(t.target);if(e!==null){var n=Vs(e);if(n!==null){if(e=n.tag,e===13){if(e=I0(n),e!==null){t.blockedOn=e,V0(t.priority,function(){L0(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function pl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ed(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);yd=r,n.target.dispatchEvent(r),yd=null}else return e=pa(n),e!==null&&Mh(e),t.blockedOn=n,!1;e.shift()}return!0}function _m(t,e,n){pl(t)&&n.delete(e)}function h1(){bd=!1,kr!==null&&pl(kr)&&(kr=null),Ar!==null&&pl(Ar)&&(Ar=null),jr!==null&&pl(jr)&&(jr=null),Fo.forEach(_m),Uo.forEach(_m)}function ao(t,e){t.blockedOn===e&&(t.blockedOn=null,bd||(bd=!0,rn.unstable_scheduleCallback(rn.unstable_NormalPriority,h1)))}function zo(t){function e(s){return ao(s,t)}if(0<Qa.length){ao(Qa[0],t);for(var n=1;n<Qa.length;n++){var r=Qa[n];r.blockedOn===t&&(r.blockedOn=null)}}for(kr!==null&&ao(kr,t),Ar!==null&&ao(Ar,t),jr!==null&&ao(jr,t),Fo.forEach(e),Uo.forEach(e),n=0;n<wr.length;n++)r=wr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<wr.length&&(n=wr[0],n.blockedOn===null);)F0(n),n.blockedOn===null&&wr.shift()}var hi=cr.ReactCurrentBatchConfig,Fl=!0;function f1(t,e,n,r){var s=Le,i=hi.transition;hi.transition=null;try{Le=1,Vh(t,e,n,r)}finally{Le=s,hi.transition=i}}function p1(t,e,n,r){var s=Le,i=hi.transition;hi.transition=null;try{Le=4,Vh(t,e,n,r)}finally{Le=s,hi.transition=i}}function Vh(t,e,n,r){if(Fl){var s=Ed(t,e,n,r);if(s===null)Ou(t,e,r,Ul,n),wm(t,r);else if(d1(s,t,e,n,r))r.stopPropagation();else if(wm(t,r),e&4&&-1<u1.indexOf(t)){for(;s!==null;){var i=pa(s);if(i!==null&&O0(i),i=Ed(t,e,n,r),i===null&&Ou(t,e,r,Ul,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Ou(t,e,r,null,n)}}var Ul=null;function Ed(t,e,n,r){if(Ul=null,t=Dh(r),t=gs(t),t!==null)if(e=Vs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=I0(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ul=t,null}function U0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(t1()){case Oh:return 1;case j0:return 4;case Ml:case n1:return 16;case P0:return 536870912;default:return 16}default:return 16}}var Sr=null,Fh=null,ml=null;function z0(){if(ml)return ml;var t,e=Fh,n=e.length,r,s="value"in Sr?Sr.value:Sr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return ml=s.slice(t,1<r?1-r:void 0)}function gl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Xa(){return!0}function bm(){return!1}function on(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Xa:bm,this.isPropagationStopped=bm,this}return Ze(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Xa)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Xa)},persist:function(){},isPersistent:Xa}),e}var Oi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uh=on(Oi),fa=Ze({},Oi,{view:0,detail:0}),m1=on(fa),Su,Iu,lo,Ec=Ze({},fa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==lo&&(lo&&t.type==="mousemove"?(Su=t.screenX-lo.screenX,Iu=t.screenY-lo.screenY):Iu=Su=0,lo=t),Su)},movementY:function(t){return"movementY"in t?t.movementY:Iu}}),Em=on(Ec),g1=Ze({},Ec,{dataTransfer:0}),y1=on(g1),v1=Ze({},fa,{relatedTarget:0}),Cu=on(v1),x1=Ze({},Oi,{animationName:0,elapsedTime:0,pseudoElement:0}),w1=on(x1),_1=Ze({},Oi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),b1=on(_1),E1=Ze({},Oi,{data:0}),Nm=on(E1),N1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},T1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},S1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function I1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=S1[t])?!!e[t]:!1}function zh(){return I1}var C1=Ze({},fa,{key:function(t){if(t.key){var e=N1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=gl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?T1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zh,charCode:function(t){return t.type==="keypress"?gl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?gl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),k1=on(C1),A1=Ze({},Ec,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tm=on(A1),j1=Ze({},fa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zh}),P1=on(j1),R1=Ze({},Oi,{propertyName:0,elapsedTime:0,pseudoElement:0}),D1=on(R1),O1=Ze({},Ec,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),L1=on(O1),M1=[9,13,27,32],Bh=er&&"CompositionEvent"in window,Eo=null;er&&"documentMode"in document&&(Eo=document.documentMode);var V1=er&&"TextEvent"in window&&!Eo,B0=er&&(!Bh||Eo&&8<Eo&&11>=Eo),Sm=" ",Im=!1;function $0(t,e){switch(t){case"keyup":return M1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function q0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Js=!1;function F1(t,e){switch(t){case"compositionend":return q0(e);case"keypress":return e.which!==32?null:(Im=!0,Sm);case"textInput":return t=e.data,t===Sm&&Im?null:t;default:return null}}function U1(t,e){if(Js)return t==="compositionend"||!Bh&&$0(t,e)?(t=z0(),ml=Fh=Sr=null,Js=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return B0&&e.locale!=="ko"?null:e.data;default:return null}}var z1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!z1[t.type]:e==="textarea"}function H0(t,e,n,r){b0(r),e=zl(e,"onChange"),0<e.length&&(n=new Uh("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var No=null,Bo=null;function B1(t){nv(t,0)}function Nc(t){var e=ti(t);if(m0(e))return t}function $1(t,e){if(t==="change")return e}var W0=!1;if(er){var ku;if(er){var Au="oninput"in document;if(!Au){var km=document.createElement("div");km.setAttribute("oninput","return;"),Au=typeof km.oninput=="function"}ku=Au}else ku=!1;W0=ku&&(!document.documentMode||9<document.documentMode)}function Am(){No&&(No.detachEvent("onpropertychange",G0),Bo=No=null)}function G0(t){if(t.propertyName==="value"&&Nc(Bo)){var e=[];H0(e,Bo,t,Dh(t)),S0(B1,e)}}function q1(t,e,n){t==="focusin"?(Am(),No=e,Bo=n,No.attachEvent("onpropertychange",G0)):t==="focusout"&&Am()}function H1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Nc(Bo)}function W1(t,e){if(t==="click")return Nc(e)}function G1(t,e){if(t==="input"||t==="change")return Nc(e)}function K1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Cn=typeof Object.is=="function"?Object.is:K1;function $o(t,e){if(Cn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!id.call(e,s)||!Cn(t[s],e[s]))return!1}return!0}function jm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Pm(t,e){var n=jm(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=jm(n)}}function K0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?K0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Q0(){for(var t=window,e=Dl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Dl(t.document)}return e}function $h(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Q1(t){var e=Q0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&K0(n.ownerDocument.documentElement,n)){if(r!==null&&$h(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Pm(n,i);var a=Pm(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var X1=er&&"documentMode"in document&&11>=document.documentMode,Zs=null,Nd=null,To=null,Td=!1;function Rm(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Td||Zs==null||Zs!==Dl(r)||(r=Zs,"selectionStart"in r&&$h(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),To&&$o(To,r)||(To=r,r=zl(Nd,"onSelect"),0<r.length&&(e=new Uh("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Zs)))}function Ya(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ei={animationend:Ya("Animation","AnimationEnd"),animationiteration:Ya("Animation","AnimationIteration"),animationstart:Ya("Animation","AnimationStart"),transitionend:Ya("Transition","TransitionEnd")},ju={},X0={};er&&(X0=document.createElement("div").style,"AnimationEvent"in window||(delete ei.animationend.animation,delete ei.animationiteration.animation,delete ei.animationstart.animation),"TransitionEvent"in window||delete ei.transitionend.transition);function Tc(t){if(ju[t])return ju[t];if(!ei[t])return t;var e=ei[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in X0)return ju[t]=e[n];return t}var Y0=Tc("animationend"),J0=Tc("animationiteration"),Z0=Tc("animationstart"),ev=Tc("transitionend"),tv=new Map,Dm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ts(t,e){tv.set(t,e),Ms(e,[t])}for(var Pu=0;Pu<Dm.length;Pu++){var Ru=Dm[Pu],Y1=Ru.toLowerCase(),J1=Ru[0].toUpperCase()+Ru.slice(1);ts(Y1,"on"+J1)}ts(Y0,"onAnimationEnd");ts(J0,"onAnimationIteration");ts(Z0,"onAnimationStart");ts("dblclick","onDoubleClick");ts("focusin","onFocus");ts("focusout","onBlur");ts(ev,"onTransitionEnd");wi("onMouseEnter",["mouseout","mouseover"]);wi("onMouseLeave",["mouseout","mouseover"]);wi("onPointerEnter",["pointerout","pointerover"]);wi("onPointerLeave",["pointerout","pointerover"]);Ms("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ms("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ms("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ms("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ms("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ms("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var go="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Z1=new Set("cancel close invalid load scroll toggle".split(" ").concat(go));function Om(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Yb(r,e,void 0,t),t.currentTarget=null}function nv(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var c=r[a],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==i&&s.isPropagationStopped())break e;Om(s,c,d),i=u}else for(a=0;a<r.length;a++){if(c=r[a],u=c.instance,d=c.currentTarget,c=c.listener,u!==i&&s.isPropagationStopped())break e;Om(s,c,d),i=u}}}if(Ll)throw t=wd,Ll=!1,wd=null,t}function $e(t,e){var n=e[Ad];n===void 0&&(n=e[Ad]=new Set);var r=t+"__bubble";n.has(r)||(rv(e,t,2,!1),n.add(r))}function Du(t,e,n){var r=0;e&&(r|=4),rv(n,t,r,e)}var Ja="_reactListening"+Math.random().toString(36).slice(2);function qo(t){if(!t[Ja]){t[Ja]=!0,u0.forEach(function(n){n!=="selectionchange"&&(Z1.has(n)||Du(n,!1,t),Du(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ja]||(e[Ja]=!0,Du("selectionchange",!1,e))}}function rv(t,e,n,r){switch(U0(e)){case 1:var s=f1;break;case 4:s=p1;break;default:s=Vh}n=s.bind(null,e,n,t),s=void 0,!xd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Ou(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;c!==null;){if(a=gs(c),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}c=c.parentNode}}r=r.return}S0(function(){var d=i,p=Dh(n),y=[];e:{var m=tv.get(t);if(m!==void 0){var T=Uh,w=t;switch(t){case"keypress":if(gl(n)===0)break e;case"keydown":case"keyup":T=k1;break;case"focusin":w="focus",T=Cu;break;case"focusout":w="blur",T=Cu;break;case"beforeblur":case"afterblur":T=Cu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":T=Em;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":T=y1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":T=P1;break;case Y0:case J0:case Z0:T=w1;break;case ev:T=D1;break;case"scroll":T=m1;break;case"wheel":T=L1;break;case"copy":case"cut":case"paste":T=b1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":T=Tm}var P=(e&4)!==0,I=!P&&t==="scroll",E=P?m!==null?m+"Capture":null:m;P=[];for(var x=d,b;x!==null;){b=x;var R=b.stateNode;if(b.tag===5&&R!==null&&(b=R,E!==null&&(R=Vo(x,E),R!=null&&P.push(Ho(x,R,b)))),I)break;x=x.return}0<P.length&&(m=new T(m,w,null,n,p),y.push({event:m,listeners:P}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",T=t==="mouseout"||t==="pointerout",m&&n!==yd&&(w=n.relatedTarget||n.fromElement)&&(gs(w)||w[tr]))break e;if((T||m)&&(m=p.window===p?p:(m=p.ownerDocument)?m.defaultView||m.parentWindow:window,T?(w=n.relatedTarget||n.toElement,T=d,w=w?gs(w):null,w!==null&&(I=Vs(w),w!==I||w.tag!==5&&w.tag!==6)&&(w=null)):(T=null,w=d),T!==w)){if(P=Em,R="onMouseLeave",E="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(P=Tm,R="onPointerLeave",E="onPointerEnter",x="pointer"),I=T==null?m:ti(T),b=w==null?m:ti(w),m=new P(R,x+"leave",T,n,p),m.target=I,m.relatedTarget=b,R=null,gs(p)===d&&(P=new P(E,x+"enter",w,n,p),P.target=b,P.relatedTarget=I,R=P),I=R,T&&w)t:{for(P=T,E=w,x=0,b=P;b;b=Hs(b))x++;for(b=0,R=E;R;R=Hs(R))b++;for(;0<x-b;)P=Hs(P),x--;for(;0<b-x;)E=Hs(E),b--;for(;x--;){if(P===E||E!==null&&P===E.alternate)break t;P=Hs(P),E=Hs(E)}P=null}else P=null;T!==null&&Lm(y,m,T,P,!1),w!==null&&I!==null&&Lm(y,I,w,P,!0)}}e:{if(m=d?ti(d):window,T=m.nodeName&&m.nodeName.toLowerCase(),T==="select"||T==="input"&&m.type==="file")var L=$1;else if(Cm(m))if(W0)L=G1;else{L=H1;var M=q1}else(T=m.nodeName)&&T.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(L=W1);if(L&&(L=L(t,d))){H0(y,L,n,p);break e}M&&M(t,m,d),t==="focusout"&&(M=m._wrapperState)&&M.controlled&&m.type==="number"&&hd(m,"number",m.value)}switch(M=d?ti(d):window,t){case"focusin":(Cm(M)||M.contentEditable==="true")&&(Zs=M,Nd=d,To=null);break;case"focusout":To=Nd=Zs=null;break;case"mousedown":Td=!0;break;case"contextmenu":case"mouseup":case"dragend":Td=!1,Rm(y,n,p);break;case"selectionchange":if(X1)break;case"keydown":case"keyup":Rm(y,n,p)}var N;if(Bh)e:{switch(t){case"compositionstart":var f="onCompositionStart";break e;case"compositionend":f="onCompositionEnd";break e;case"compositionupdate":f="onCompositionUpdate";break e}f=void 0}else Js?$0(t,n)&&(f="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(f="onCompositionStart");f&&(B0&&n.locale!=="ko"&&(Js||f!=="onCompositionStart"?f==="onCompositionEnd"&&Js&&(N=z0()):(Sr=p,Fh="value"in Sr?Sr.value:Sr.textContent,Js=!0)),M=zl(d,f),0<M.length&&(f=new Nm(f,t,null,n,p),y.push({event:f,listeners:M}),N?f.data=N:(N=q0(n),N!==null&&(f.data=N)))),(N=V1?F1(t,n):U1(t,n))&&(d=zl(d,"onBeforeInput"),0<d.length&&(p=new Nm("onBeforeInput","beforeinput",null,n,p),y.push({event:p,listeners:d}),p.data=N))}nv(y,e)})}function Ho(t,e,n){return{instance:t,listener:e,currentTarget:n}}function zl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Vo(t,n),i!=null&&r.unshift(Ho(t,i,s)),i=Vo(t,e),i!=null&&r.push(Ho(t,i,s))),t=t.return}return r}function Hs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Lm(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var c=n,u=c.alternate,d=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&d!==null&&(c=d,s?(u=Vo(n,i),u!=null&&a.unshift(Ho(n,u,c))):s||(u=Vo(n,i),u!=null&&a.push(Ho(n,u,c)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var eE=/\r\n?/g,tE=/\u0000|\uFFFD/g;function Mm(t){return(typeof t=="string"?t:""+t).replace(eE,`
`).replace(tE,"")}function Za(t,e,n){if(e=Mm(e),Mm(t)!==e&&n)throw Error(W(425))}function Bl(){}var Sd=null,Id=null;function Cd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var kd=typeof setTimeout=="function"?setTimeout:void 0,nE=typeof clearTimeout=="function"?clearTimeout:void 0,Vm=typeof Promise=="function"?Promise:void 0,rE=typeof queueMicrotask=="function"?queueMicrotask:typeof Vm<"u"?function(t){return Vm.resolve(null).then(t).catch(sE)}:kd;function sE(t){setTimeout(function(){throw t})}function Lu(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),zo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);zo(e)}function Pr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Fm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Li=Math.random().toString(36).slice(2),Rn="__reactFiber$"+Li,Wo="__reactProps$"+Li,tr="__reactContainer$"+Li,Ad="__reactEvents$"+Li,iE="__reactListeners$"+Li,oE="__reactHandles$"+Li;function gs(t){var e=t[Rn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[tr]||n[Rn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Fm(t);t!==null;){if(n=t[Rn])return n;t=Fm(t)}return e}t=n,n=t.parentNode}return null}function pa(t){return t=t[Rn]||t[tr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ti(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(W(33))}function Sc(t){return t[Wo]||null}var jd=[],ni=-1;function ns(t){return{current:t}}function He(t){0>ni||(t.current=jd[ni],jd[ni]=null,ni--)}function Fe(t,e){ni++,jd[ni]=t.current,t.current=e}var Hr={},Rt=ns(Hr),Kt=ns(!1),Ts=Hr;function _i(t,e){var n=t.type.contextTypes;if(!n)return Hr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Qt(t){return t=t.childContextTypes,t!=null}function $l(){He(Kt),He(Rt)}function Um(t,e,n){if(Rt.current!==Hr)throw Error(W(168));Fe(Rt,e),Fe(Kt,n)}function sv(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(W(108,qb(t)||"Unknown",s));return Ze({},n,r)}function ql(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Hr,Ts=Rt.current,Fe(Rt,t),Fe(Kt,Kt.current),!0}function zm(t,e,n){var r=t.stateNode;if(!r)throw Error(W(169));n?(t=sv(t,e,Ts),r.__reactInternalMemoizedMergedChildContext=t,He(Kt),He(Rt),Fe(Rt,t)):He(Kt),Fe(Kt,n)}var Kn=null,Ic=!1,Mu=!1;function iv(t){Kn===null?Kn=[t]:Kn.push(t)}function aE(t){Ic=!0,iv(t)}function rs(){if(!Mu&&Kn!==null){Mu=!0;var t=0,e=Le;try{var n=Kn;for(Le=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Kn=null,Ic=!1}catch(s){throw Kn!==null&&(Kn=Kn.slice(t+1)),A0(Oh,rs),s}finally{Le=e,Mu=!1}}return null}var ri=[],si=0,Hl=null,Wl=0,an=[],ln=0,Ss=null,Qn=1,Xn="";function hs(t,e){ri[si++]=Wl,ri[si++]=Hl,Hl=t,Wl=e}function ov(t,e,n){an[ln++]=Qn,an[ln++]=Xn,an[ln++]=Ss,Ss=t;var r=Qn;t=Xn;var s=32-Nn(r)-1;r&=~(1<<s),n+=1;var i=32-Nn(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Qn=1<<32-Nn(e)+s|n<<s|r,Xn=i+t}else Qn=1<<i|n<<s|r,Xn=t}function qh(t){t.return!==null&&(hs(t,1),ov(t,1,0))}function Hh(t){for(;t===Hl;)Hl=ri[--si],ri[si]=null,Wl=ri[--si],ri[si]=null;for(;t===Ss;)Ss=an[--ln],an[ln]=null,Xn=an[--ln],an[ln]=null,Qn=an[--ln],an[ln]=null}var nn=null,en=null,We=!1,_n=null;function av(t,e){var n=un(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Bm(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,nn=t,en=Pr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,nn=t,en=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ss!==null?{id:Qn,overflow:Xn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=un(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,nn=t,en=null,!0):!1;default:return!1}}function Pd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Rd(t){if(We){var e=en;if(e){var n=e;if(!Bm(t,e)){if(Pd(t))throw Error(W(418));e=Pr(n.nextSibling);var r=nn;e&&Bm(t,e)?av(r,n):(t.flags=t.flags&-4097|2,We=!1,nn=t)}}else{if(Pd(t))throw Error(W(418));t.flags=t.flags&-4097|2,We=!1,nn=t}}}function $m(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;nn=t}function el(t){if(t!==nn)return!1;if(!We)return $m(t),We=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Cd(t.type,t.memoizedProps)),e&&(e=en)){if(Pd(t))throw lv(),Error(W(418));for(;e;)av(t,e),e=Pr(e.nextSibling)}if($m(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(W(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){en=Pr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}en=null}}else en=nn?Pr(t.stateNode.nextSibling):null;return!0}function lv(){for(var t=en;t;)t=Pr(t.nextSibling)}function bi(){en=nn=null,We=!1}function Wh(t){_n===null?_n=[t]:_n.push(t)}var lE=cr.ReactCurrentBatchConfig;function xn(t,e){if(t&&t.defaultProps){e=Ze({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Gl=ns(null),Kl=null,ii=null,Gh=null;function Kh(){Gh=ii=Kl=null}function Qh(t){var e=Gl.current;He(Gl),t._currentValue=e}function Dd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function fi(t,e){Kl=t,Gh=ii=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Wt=!0),t.firstContext=null)}function fn(t){var e=t._currentValue;if(Gh!==t)if(t={context:t,memoizedValue:e,next:null},ii===null){if(Kl===null)throw Error(W(308));ii=t,Kl.dependencies={lanes:0,firstContext:t}}else ii=ii.next=t;return e}var ys=null;function Xh(t){ys===null?ys=[t]:ys.push(t)}function cv(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Xh(e)):(n.next=s.next,s.next=n),e.interleaved=n,nr(t,r)}function nr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var xr=!1;function Yh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Zn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Rr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ae&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,nr(t,n)}return s=r.interleaved,s===null?(e.next=e,Xh(r)):(e.next=s.next,s.next=e),r.interleaved=e,nr(t,n)}function yl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Lh(t,n)}}function qm(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ql(t,e,n,r){var s=t.updateQueue;xr=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,d=u.next;u.next=null,a===null?i=d:a.next=d,a=u;var p=t.alternate;p!==null&&(p=p.updateQueue,c=p.lastBaseUpdate,c!==a&&(c===null?p.firstBaseUpdate=d:c.next=d,p.lastBaseUpdate=u))}if(i!==null){var y=s.baseState;a=0,p=d=u=null,c=i;do{var m=c.lane,T=c.eventTime;if((r&m)===m){p!==null&&(p=p.next={eventTime:T,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var w=t,P=c;switch(m=e,T=n,P.tag){case 1:if(w=P.payload,typeof w=="function"){y=w.call(T,y,m);break e}y=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=P.payload,m=typeof w=="function"?w.call(T,y,m):w,m==null)break e;y=Ze({},y,m);break e;case 2:xr=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[c]:m.push(c))}else T={eventTime:T,lane:m,tag:c.tag,payload:c.payload,callback:c.callback,next:null},p===null?(d=p=T,u=y):p=p.next=T,a|=m;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;m=c,c=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(p===null&&(u=y),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=p,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Cs|=a,t.lanes=a,t.memoizedState=y}}function Hm(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(W(191,s));s.call(r)}}}var dv=new c0.Component().refs;function Od(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ze({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Cc={isMounted:function(t){return(t=t._reactInternals)?Vs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ft(),s=Or(t),i=Zn(r,s);i.payload=e,n!=null&&(i.callback=n),e=Rr(t,i,s),e!==null&&(Tn(e,t,s,r),yl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ft(),s=Or(t),i=Zn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Rr(t,i,s),e!==null&&(Tn(e,t,s,r),yl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ft(),r=Or(t),s=Zn(n,r);s.tag=2,e!=null&&(s.callback=e),e=Rr(t,s,r),e!==null&&(Tn(e,t,r,n),yl(e,t,r))}};function Wm(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!$o(n,r)||!$o(s,i):!0}function hv(t,e,n){var r=!1,s=Hr,i=e.contextType;return typeof i=="object"&&i!==null?i=fn(i):(s=Qt(e)?Ts:Rt.current,r=e.contextTypes,i=(r=r!=null)?_i(t,s):Hr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Cc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Gm(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Cc.enqueueReplaceState(e,e.state,null)}function Ld(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=dv,Yh(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=fn(i):(i=Qt(e)?Ts:Rt.current,s.context=_i(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Od(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Cc.enqueueReplaceState(s,s.state,null),Ql(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function co(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var c=s.refs;c===dv&&(c=s.refs={}),a===null?delete c[i]:c[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,t))}return t}function tl(t,e){throw t=Object.prototype.toString.call(e),Error(W(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Km(t){var e=t._init;return e(t._payload)}function fv(t){function e(E,x){if(t){var b=E.deletions;b===null?(E.deletions=[x],E.flags|=16):b.push(x)}}function n(E,x){if(!t)return null;for(;x!==null;)e(E,x),x=x.sibling;return null}function r(E,x){for(E=new Map;x!==null;)x.key!==null?E.set(x.key,x):E.set(x.index,x),x=x.sibling;return E}function s(E,x){return E=Lr(E,x),E.index=0,E.sibling=null,E}function i(E,x,b){return E.index=b,t?(b=E.alternate,b!==null?(b=b.index,b<x?(E.flags|=2,x):b):(E.flags|=2,x)):(E.flags|=1048576,x)}function a(E){return t&&E.alternate===null&&(E.flags|=2),E}function c(E,x,b,R){return x===null||x.tag!==6?(x=qu(b,E.mode,R),x.return=E,x):(x=s(x,b),x.return=E,x)}function u(E,x,b,R){var L=b.type;return L===Ys?p(E,x,b.props.children,R,b.key):x!==null&&(x.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===vr&&Km(L)===x.type)?(R=s(x,b.props),R.ref=co(E,x,b),R.return=E,R):(R=El(b.type,b.key,b.props,null,E.mode,R),R.ref=co(E,x,b),R.return=E,R)}function d(E,x,b,R){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=Hu(b,E.mode,R),x.return=E,x):(x=s(x,b.children||[]),x.return=E,x)}function p(E,x,b,R,L){return x===null||x.tag!==7?(x=_s(b,E.mode,R,L),x.return=E,x):(x=s(x,b),x.return=E,x)}function y(E,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=qu(""+x,E.mode,b),x.return=E,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case qa:return b=El(x.type,x.key,x.props,null,E.mode,b),b.ref=co(E,null,x),b.return=E,b;case Xs:return x=Hu(x,E.mode,b),x.return=E,x;case vr:var R=x._init;return y(E,R(x._payload),b)}if(po(x)||so(x))return x=_s(x,E.mode,b,null),x.return=E,x;tl(E,x)}return null}function m(E,x,b,R){var L=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return L!==null?null:c(E,x,""+b,R);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case qa:return b.key===L?u(E,x,b,R):null;case Xs:return b.key===L?d(E,x,b,R):null;case vr:return L=b._init,m(E,x,L(b._payload),R)}if(po(b)||so(b))return L!==null?null:p(E,x,b,R,null);tl(E,b)}return null}function T(E,x,b,R,L){if(typeof R=="string"&&R!==""||typeof R=="number")return E=E.get(b)||null,c(x,E,""+R,L);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case qa:return E=E.get(R.key===null?b:R.key)||null,u(x,E,R,L);case Xs:return E=E.get(R.key===null?b:R.key)||null,d(x,E,R,L);case vr:var M=R._init;return T(E,x,b,M(R._payload),L)}if(po(R)||so(R))return E=E.get(b)||null,p(x,E,R,L,null);tl(x,R)}return null}function w(E,x,b,R){for(var L=null,M=null,N=x,f=x=0,v=null;N!==null&&f<b.length;f++){N.index>f?(v=N,N=null):v=N.sibling;var _=m(E,N,b[f],R);if(_===null){N===null&&(N=v);break}t&&N&&_.alternate===null&&e(E,N),x=i(_,x,f),M===null?L=_:M.sibling=_,M=_,N=v}if(f===b.length)return n(E,N),We&&hs(E,f),L;if(N===null){for(;f<b.length;f++)N=y(E,b[f],R),N!==null&&(x=i(N,x,f),M===null?L=N:M.sibling=N,M=N);return We&&hs(E,f),L}for(N=r(E,N);f<b.length;f++)v=T(N,E,f,b[f],R),v!==null&&(t&&v.alternate!==null&&N.delete(v.key===null?f:v.key),x=i(v,x,f),M===null?L=v:M.sibling=v,M=v);return t&&N.forEach(function(k){return e(E,k)}),We&&hs(E,f),L}function P(E,x,b,R){var L=so(b);if(typeof L!="function")throw Error(W(150));if(b=L.call(b),b==null)throw Error(W(151));for(var M=L=null,N=x,f=x=0,v=null,_=b.next();N!==null&&!_.done;f++,_=b.next()){N.index>f?(v=N,N=null):v=N.sibling;var k=m(E,N,_.value,R);if(k===null){N===null&&(N=v);break}t&&N&&k.alternate===null&&e(E,N),x=i(k,x,f),M===null?L=k:M.sibling=k,M=k,N=v}if(_.done)return n(E,N),We&&hs(E,f),L;if(N===null){for(;!_.done;f++,_=b.next())_=y(E,_.value,R),_!==null&&(x=i(_,x,f),M===null?L=_:M.sibling=_,M=_);return We&&hs(E,f),L}for(N=r(E,N);!_.done;f++,_=b.next())_=T(N,E,f,_.value,R),_!==null&&(t&&_.alternate!==null&&N.delete(_.key===null?f:_.key),x=i(_,x,f),M===null?L=_:M.sibling=_,M=_);return t&&N.forEach(function(j){return e(E,j)}),We&&hs(E,f),L}function I(E,x,b,R){if(typeof b=="object"&&b!==null&&b.type===Ys&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case qa:e:{for(var L=b.key,M=x;M!==null;){if(M.key===L){if(L=b.type,L===Ys){if(M.tag===7){n(E,M.sibling),x=s(M,b.props.children),x.return=E,E=x;break e}}else if(M.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===vr&&Km(L)===M.type){n(E,M.sibling),x=s(M,b.props),x.ref=co(E,M,b),x.return=E,E=x;break e}n(E,M);break}else e(E,M);M=M.sibling}b.type===Ys?(x=_s(b.props.children,E.mode,R,b.key),x.return=E,E=x):(R=El(b.type,b.key,b.props,null,E.mode,R),R.ref=co(E,x,b),R.return=E,E=R)}return a(E);case Xs:e:{for(M=b.key;x!==null;){if(x.key===M)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){n(E,x.sibling),x=s(x,b.children||[]),x.return=E,E=x;break e}else{n(E,x);break}else e(E,x);x=x.sibling}x=Hu(b,E.mode,R),x.return=E,E=x}return a(E);case vr:return M=b._init,I(E,x,M(b._payload),R)}if(po(b))return w(E,x,b,R);if(so(b))return P(E,x,b,R);tl(E,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(n(E,x.sibling),x=s(x,b),x.return=E,E=x):(n(E,x),x=qu(b,E.mode,R),x.return=E,E=x),a(E)):n(E,x)}return I}var Ei=fv(!0),pv=fv(!1),ma={},On=ns(ma),Go=ns(ma),Ko=ns(ma);function vs(t){if(t===ma)throw Error(W(174));return t}function Jh(t,e){switch(Fe(Ko,e),Fe(Go,t),Fe(On,ma),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=pd(e,t)}He(On),Fe(On,e)}function Ni(){He(On),He(Go),He(Ko)}function mv(t){vs(Ko.current);var e=vs(On.current),n=pd(e,t.type);e!==n&&(Fe(Go,t),Fe(On,n))}function Zh(t){Go.current===t&&(He(On),He(Go))}var Xe=ns(0);function Xl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Vu=[];function ef(){for(var t=0;t<Vu.length;t++)Vu[t]._workInProgressVersionPrimary=null;Vu.length=0}var vl=cr.ReactCurrentDispatcher,Fu=cr.ReactCurrentBatchConfig,Is=0,Je=null,ut=null,pt=null,Yl=!1,So=!1,Qo=0,cE=0;function It(){throw Error(W(321))}function tf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Cn(t[n],e[n]))return!1;return!0}function nf(t,e,n,r,s,i){if(Is=i,Je=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,vl.current=t===null||t.memoizedState===null?fE:pE,t=n(r,s),So){i=0;do{if(So=!1,Qo=0,25<=i)throw Error(W(301));i+=1,pt=ut=null,e.updateQueue=null,vl.current=mE,t=n(r,s)}while(So)}if(vl.current=Jl,e=ut!==null&&ut.next!==null,Is=0,pt=ut=Je=null,Yl=!1,e)throw Error(W(300));return t}function rf(){var t=Qo!==0;return Qo=0,t}function jn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pt===null?Je.memoizedState=pt=t:pt=pt.next=t,pt}function pn(){if(ut===null){var t=Je.alternate;t=t!==null?t.memoizedState:null}else t=ut.next;var e=pt===null?Je.memoizedState:pt.next;if(e!==null)pt=e,ut=t;else{if(t===null)throw Error(W(310));ut=t,t={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},pt===null?Je.memoizedState=pt=t:pt=pt.next=t}return pt}function Xo(t,e){return typeof e=="function"?e(t):e}function Uu(t){var e=pn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=ut,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var c=a=null,u=null,d=i;do{var p=d.lane;if((Is&p)===p)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var y={lane:p,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=y,a=r):u=u.next=y,Je.lanes|=p,Cs|=p}d=d.next}while(d!==null&&d!==i);u===null?a=r:u.next=c,Cn(r,e.memoizedState)||(Wt=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Je.lanes|=i,Cs|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function zu(t){var e=pn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);Cn(i,e.memoizedState)||(Wt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function gv(){}function yv(t,e){var n=Je,r=pn(),s=e(),i=!Cn(r.memoizedState,s);if(i&&(r.memoizedState=s,Wt=!0),r=r.queue,sf(wv.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||pt!==null&&pt.memoizedState.tag&1){if(n.flags|=2048,Yo(9,xv.bind(null,n,r,s,e),void 0,null),mt===null)throw Error(W(349));Is&30||vv(n,e,s)}return s}function vv(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Je.updateQueue,e===null?(e={lastEffect:null,stores:null},Je.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function xv(t,e,n,r){e.value=n,e.getSnapshot=r,_v(e)&&bv(t)}function wv(t,e,n){return n(function(){_v(e)&&bv(t)})}function _v(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Cn(t,n)}catch{return!0}}function bv(t){var e=nr(t,1);e!==null&&Tn(e,t,1,-1)}function Qm(t){var e=jn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xo,lastRenderedState:t},e.queue=t,t=t.dispatch=hE.bind(null,Je,t),[e.memoizedState,t]}function Yo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Je.updateQueue,e===null?(e={lastEffect:null,stores:null},Je.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Ev(){return pn().memoizedState}function xl(t,e,n,r){var s=jn();Je.flags|=t,s.memoizedState=Yo(1|e,n,void 0,r===void 0?null:r)}function kc(t,e,n,r){var s=pn();r=r===void 0?null:r;var i=void 0;if(ut!==null){var a=ut.memoizedState;if(i=a.destroy,r!==null&&tf(r,a.deps)){s.memoizedState=Yo(e,n,i,r);return}}Je.flags|=t,s.memoizedState=Yo(1|e,n,i,r)}function Xm(t,e){return xl(8390656,8,t,e)}function sf(t,e){return kc(2048,8,t,e)}function Nv(t,e){return kc(4,2,t,e)}function Tv(t,e){return kc(4,4,t,e)}function Sv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Iv(t,e,n){return n=n!=null?n.concat([t]):null,kc(4,4,Sv.bind(null,e,t),n)}function of(){}function Cv(t,e){var n=pn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&tf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function kv(t,e){var n=pn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&tf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Av(t,e,n){return Is&21?(Cn(n,e)||(n=R0(),Je.lanes|=n,Cs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Wt=!0),t.memoizedState=n)}function uE(t,e){var n=Le;Le=n!==0&&4>n?n:4,t(!0);var r=Fu.transition;Fu.transition={};try{t(!1),e()}finally{Le=n,Fu.transition=r}}function jv(){return pn().memoizedState}function dE(t,e,n){var r=Or(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Pv(t))Rv(e,n);else if(n=cv(t,e,n,r),n!==null){var s=Ft();Tn(n,t,r,s),Dv(n,e,r)}}function hE(t,e,n){var r=Or(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Pv(t))Rv(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,c=i(a,n);if(s.hasEagerState=!0,s.eagerState=c,Cn(c,a)){var u=e.interleaved;u===null?(s.next=s,Xh(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=cv(t,e,s,r),n!==null&&(s=Ft(),Tn(n,t,r,s),Dv(n,e,r))}}function Pv(t){var e=t.alternate;return t===Je||e!==null&&e===Je}function Rv(t,e){So=Yl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Dv(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Lh(t,n)}}var Jl={readContext:fn,useCallback:It,useContext:It,useEffect:It,useImperativeHandle:It,useInsertionEffect:It,useLayoutEffect:It,useMemo:It,useReducer:It,useRef:It,useState:It,useDebugValue:It,useDeferredValue:It,useTransition:It,useMutableSource:It,useSyncExternalStore:It,useId:It,unstable_isNewReconciler:!1},fE={readContext:fn,useCallback:function(t,e){return jn().memoizedState=[t,e===void 0?null:e],t},useContext:fn,useEffect:Xm,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,xl(4194308,4,Sv.bind(null,e,t),n)},useLayoutEffect:function(t,e){return xl(4194308,4,t,e)},useInsertionEffect:function(t,e){return xl(4,2,t,e)},useMemo:function(t,e){var n=jn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=jn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=dE.bind(null,Je,t),[r.memoizedState,t]},useRef:function(t){var e=jn();return t={current:t},e.memoizedState=t},useState:Qm,useDebugValue:of,useDeferredValue:function(t){return jn().memoizedState=t},useTransition:function(){var t=Qm(!1),e=t[0];return t=uE.bind(null,t[1]),jn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Je,s=jn();if(We){if(n===void 0)throw Error(W(407));n=n()}else{if(n=e(),mt===null)throw Error(W(349));Is&30||vv(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Xm(wv.bind(null,r,i,t),[t]),r.flags|=2048,Yo(9,xv.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=jn(),e=mt.identifierPrefix;if(We){var n=Xn,r=Qn;n=(r&~(1<<32-Nn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Qo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=cE++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},pE={readContext:fn,useCallback:Cv,useContext:fn,useEffect:sf,useImperativeHandle:Iv,useInsertionEffect:Nv,useLayoutEffect:Tv,useMemo:kv,useReducer:Uu,useRef:Ev,useState:function(){return Uu(Xo)},useDebugValue:of,useDeferredValue:function(t){var e=pn();return Av(e,ut.memoizedState,t)},useTransition:function(){var t=Uu(Xo)[0],e=pn().memoizedState;return[t,e]},useMutableSource:gv,useSyncExternalStore:yv,useId:jv,unstable_isNewReconciler:!1},mE={readContext:fn,useCallback:Cv,useContext:fn,useEffect:sf,useImperativeHandle:Iv,useInsertionEffect:Nv,useLayoutEffect:Tv,useMemo:kv,useReducer:zu,useRef:Ev,useState:function(){return zu(Xo)},useDebugValue:of,useDeferredValue:function(t){var e=pn();return ut===null?e.memoizedState=t:Av(e,ut.memoizedState,t)},useTransition:function(){var t=zu(Xo)[0],e=pn().memoizedState;return[t,e]},useMutableSource:gv,useSyncExternalStore:yv,useId:jv,unstable_isNewReconciler:!1};function Ti(t,e){try{var n="",r=e;do n+=$b(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Bu(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Md(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var gE=typeof WeakMap=="function"?WeakMap:Map;function Ov(t,e,n){n=Zn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ec||(ec=!0,Gd=r),Md(t,e)},n}function Lv(t,e,n){n=Zn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Md(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Md(t,e),typeof r!="function"&&(Dr===null?Dr=new Set([this]):Dr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function Ym(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new gE;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=AE.bind(null,t,e,n),e.then(t,t))}function Jm(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Zm(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Zn(-1,1),e.tag=2,Rr(n,e,1))),n.lanes|=1),t)}var yE=cr.ReactCurrentOwner,Wt=!1;function Vt(t,e,n,r){e.child=t===null?pv(e,null,n,r):Ei(e,t.child,n,r)}function eg(t,e,n,r,s){n=n.render;var i=e.ref;return fi(e,s),r=nf(t,e,n,r,i,s),n=rf(),t!==null&&!Wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,rr(t,e,s)):(We&&n&&qh(e),e.flags|=1,Vt(t,e,r,s),e.child)}function tg(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!pf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Mv(t,e,i,r,s)):(t=El(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:$o,n(a,r)&&t.ref===e.ref)return rr(t,e,s)}return e.flags|=1,t=Lr(i,r),t.ref=e.ref,t.return=e,e.child=t}function Mv(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if($o(i,r)&&t.ref===e.ref)if(Wt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Wt=!0);else return e.lanes=t.lanes,rr(t,e,s)}return Vd(t,e,n,r,s)}function Vv(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fe(ai,Zt),Zt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Fe(ai,Zt),Zt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Fe(ai,Zt),Zt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Fe(ai,Zt),Zt|=r;return Vt(t,e,s,n),e.child}function Fv(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Vd(t,e,n,r,s){var i=Qt(n)?Ts:Rt.current;return i=_i(e,i),fi(e,s),n=nf(t,e,n,r,i,s),r=rf(),t!==null&&!Wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,rr(t,e,s)):(We&&r&&qh(e),e.flags|=1,Vt(t,e,n,s),e.child)}function ng(t,e,n,r,s){if(Qt(n)){var i=!0;ql(e)}else i=!1;if(fi(e,s),e.stateNode===null)wl(t,e),hv(e,n,r),Ld(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,c=e.memoizedProps;a.props=c;var u=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=fn(d):(d=Qt(n)?Ts:Rt.current,d=_i(e,d));var p=n.getDerivedStateFromProps,y=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function";y||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==r||u!==d)&&Gm(e,a,r,d),xr=!1;var m=e.memoizedState;a.state=m,Ql(e,r,a,s),u=e.memoizedState,c!==r||m!==u||Kt.current||xr?(typeof p=="function"&&(Od(e,n,p,r),u=e.memoizedState),(c=xr||Wm(e,n,c,r,m,u,d))?(y||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=d,r=c):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,uv(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:xn(e.type,c),a.props=d,y=e.pendingProps,m=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=fn(u):(u=Qt(n)?Ts:Rt.current,u=_i(e,u));var T=n.getDerivedStateFromProps;(p=typeof T=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==y||m!==u)&&Gm(e,a,r,u),xr=!1,m=e.memoizedState,a.state=m,Ql(e,r,a,s);var w=e.memoizedState;c!==y||m!==w||Kt.current||xr?(typeof T=="function"&&(Od(e,n,T,r),w=e.memoizedState),(d=xr||Wm(e,n,d,r,m,w,u)||!1)?(p||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,w,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,w,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||c===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=w),a.props=r,a.state=w,a.context=u,r=d):(typeof a.componentDidUpdate!="function"||c===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Fd(t,e,n,r,i,s)}function Fd(t,e,n,r,s,i){Fv(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&zm(e,n,!1),rr(t,e,i);r=e.stateNode,yE.current=e;var c=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Ei(e,t.child,null,i),e.child=Ei(e,null,c,i)):Vt(t,e,c,i),e.memoizedState=r.state,s&&zm(e,n,!0),e.child}function Uv(t){var e=t.stateNode;e.pendingContext?Um(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Um(t,e.context,!1),Jh(t,e.containerInfo)}function rg(t,e,n,r,s){return bi(),Wh(s),e.flags|=256,Vt(t,e,n,r),e.child}var Ud={dehydrated:null,treeContext:null,retryLane:0};function zd(t){return{baseLanes:t,cachePool:null,transitions:null}}function zv(t,e,n){var r=e.pendingProps,s=Xe.current,i=!1,a=(e.flags&128)!==0,c;if((c=a)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Fe(Xe,s&1),t===null)return Rd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Pc(a,r,0,null),t=_s(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=zd(n),e.memoizedState=Ud,t):af(e,a));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return vE(t,e,a,r,c,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Lr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Lr(c,i):(i=_s(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?zd(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=Ud,r}return i=t.child,t=i.sibling,r=Lr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function af(t,e){return e=Pc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function nl(t,e,n,r){return r!==null&&Wh(r),Ei(e,t.child,null,n),t=af(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function vE(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=Bu(Error(W(422))),nl(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Pc({mode:"visible",children:r.children},s,0,null),i=_s(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ei(e,t.child,null,a),e.child.memoizedState=zd(a),e.memoizedState=Ud,i);if(!(e.mode&1))return nl(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(W(419)),r=Bu(i,r,void 0),nl(t,e,a,r)}if(c=(a&t.childLanes)!==0,Wt||c){if(r=mt,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,nr(t,s),Tn(r,t,s,-1))}return ff(),r=Bu(Error(W(421))),nl(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=jE.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,en=Pr(s.nextSibling),nn=e,We=!0,_n=null,t!==null&&(an[ln++]=Qn,an[ln++]=Xn,an[ln++]=Ss,Qn=t.id,Xn=t.overflow,Ss=e),e=af(e,r.children),e.flags|=4096,e)}function sg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Dd(t.return,e,n)}function $u(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Bv(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Vt(t,e,r.children,n),r=Xe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&sg(t,n,e);else if(t.tag===19)sg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Fe(Xe,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Xl(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),$u(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Xl(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}$u(e,!0,n,null,i);break;case"together":$u(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function wl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function rr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Cs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(W(153));if(e.child!==null){for(t=e.child,n=Lr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Lr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function xE(t,e,n){switch(e.tag){case 3:Uv(e),bi();break;case 5:mv(e);break;case 1:Qt(e.type)&&ql(e);break;case 4:Jh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Fe(Gl,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Fe(Xe,Xe.current&1),e.flags|=128,null):n&e.child.childLanes?zv(t,e,n):(Fe(Xe,Xe.current&1),t=rr(t,e,n),t!==null?t.sibling:null);Fe(Xe,Xe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Bv(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Fe(Xe,Xe.current),r)break;return null;case 22:case 23:return e.lanes=0,Vv(t,e,n)}return rr(t,e,n)}var $v,Bd,qv,Hv;$v=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Bd=function(){};qv=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,vs(On.current);var i=null;switch(n){case"input":s=ud(t,s),r=ud(t,r),i=[];break;case"select":s=Ze({},s,{value:void 0}),r=Ze({},r,{value:void 0}),i=[];break;case"textarea":s=fd(t,s),r=fd(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Bl)}md(n,r);var a;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(a in c)c.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Lo.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(c=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(a in c)!c.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&c[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Lo.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&$e("scroll",t),i||c===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};Hv=function(t,e,n,r){n!==r&&(e.flags|=4)};function uo(t,e){if(!We)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ct(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function wE(t,e,n){var r=e.pendingProps;switch(Hh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ct(e),null;case 1:return Qt(e.type)&&$l(),Ct(e),null;case 3:return r=e.stateNode,Ni(),He(Kt),He(Rt),ef(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(el(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,_n!==null&&(Xd(_n),_n=null))),Bd(t,e),Ct(e),null;case 5:Zh(e);var s=vs(Ko.current);if(n=e.type,t!==null&&e.stateNode!=null)qv(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(W(166));return Ct(e),null}if(t=vs(On.current),el(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Rn]=e,r[Wo]=i,t=(e.mode&1)!==0,n){case"dialog":$e("cancel",r),$e("close",r);break;case"iframe":case"object":case"embed":$e("load",r);break;case"video":case"audio":for(s=0;s<go.length;s++)$e(go[s],r);break;case"source":$e("error",r);break;case"img":case"image":case"link":$e("error",r),$e("load",r);break;case"details":$e("toggle",r);break;case"input":fm(r,i),$e("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},$e("invalid",r);break;case"textarea":mm(r,i),$e("invalid",r)}md(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var c=i[a];a==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&Za(r.textContent,c,t),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&Za(r.textContent,c,t),s=["children",""+c]):Lo.hasOwnProperty(a)&&c!=null&&a==="onScroll"&&$e("scroll",r)}switch(n){case"input":Ha(r),pm(r,i,!0);break;case"textarea":Ha(r),gm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Bl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=v0(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Rn]=e,t[Wo]=r,$v(t,e,!1,!1),e.stateNode=t;e:{switch(a=gd(n,r),n){case"dialog":$e("cancel",t),$e("close",t),s=r;break;case"iframe":case"object":case"embed":$e("load",t),s=r;break;case"video":case"audio":for(s=0;s<go.length;s++)$e(go[s],t);s=r;break;case"source":$e("error",t),s=r;break;case"img":case"image":case"link":$e("error",t),$e("load",t),s=r;break;case"details":$e("toggle",t),s=r;break;case"input":fm(t,r),s=ud(t,r),$e("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ze({},r,{value:void 0}),$e("invalid",t);break;case"textarea":mm(t,r),s=fd(t,r),$e("invalid",t);break;default:s=r}md(n,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?_0(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&x0(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Mo(t,u):typeof u=="number"&&Mo(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Lo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&$e("scroll",t):u!=null&&Ah(t,i,u,a))}switch(n){case"input":Ha(t),pm(t,r,!1);break;case"textarea":Ha(t),gm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+qr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ci(t,!!r.multiple,i,!1):r.defaultValue!=null&&ci(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Bl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ct(e),null;case 6:if(t&&e.stateNode!=null)Hv(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(W(166));if(n=vs(Ko.current),vs(On.current),el(e)){if(r=e.stateNode,n=e.memoizedProps,r[Rn]=e,(i=r.nodeValue!==n)&&(t=nn,t!==null))switch(t.tag){case 3:Za(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Za(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Rn]=e,e.stateNode=r}return Ct(e),null;case 13:if(He(Xe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(We&&en!==null&&e.mode&1&&!(e.flags&128))lv(),bi(),e.flags|=98560,i=!1;else if(i=el(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(W(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[Rn]=e}else bi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ct(e),i=!1}else _n!==null&&(Xd(_n),_n=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Xe.current&1?dt===0&&(dt=3):ff())),e.updateQueue!==null&&(e.flags|=4),Ct(e),null);case 4:return Ni(),Bd(t,e),t===null&&qo(e.stateNode.containerInfo),Ct(e),null;case 10:return Qh(e.type._context),Ct(e),null;case 17:return Qt(e.type)&&$l(),Ct(e),null;case 19:if(He(Xe),i=e.memoizedState,i===null)return Ct(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)uo(i,!1);else{if(dt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Xl(t),a!==null){for(e.flags|=128,uo(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Fe(Xe,Xe.current&1|2),e.child}t=t.sibling}i.tail!==null&&st()>Si&&(e.flags|=128,r=!0,uo(i,!1),e.lanes=4194304)}else{if(!r)if(t=Xl(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),uo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!We)return Ct(e),null}else 2*st()-i.renderingStartTime>Si&&n!==1073741824&&(e.flags|=128,r=!0,uo(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=st(),e.sibling=null,n=Xe.current,Fe(Xe,r?n&1|2:n&1),e):(Ct(e),null);case 22:case 23:return hf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Zt&1073741824&&(Ct(e),e.subtreeFlags&6&&(e.flags|=8192)):Ct(e),null;case 24:return null;case 25:return null}throw Error(W(156,e.tag))}function _E(t,e){switch(Hh(e),e.tag){case 1:return Qt(e.type)&&$l(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ni(),He(Kt),He(Rt),ef(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Zh(e),null;case 13:if(He(Xe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(W(340));bi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return He(Xe),null;case 4:return Ni(),null;case 10:return Qh(e.type._context),null;case 22:case 23:return hf(),null;case 24:return null;default:return null}}var rl=!1,jt=!1,bE=typeof WeakSet=="function"?WeakSet:Set,oe=null;function oi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){nt(t,e,r)}else n.current=null}function $d(t,e,n){try{n()}catch(r){nt(t,e,r)}}var ig=!1;function EE(t,e){if(Sd=Fl,t=Q0(),$h(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,c=-1,u=-1,d=0,p=0,y=t,m=null;t:for(;;){for(var T;y!==n||s!==0&&y.nodeType!==3||(c=a+s),y!==i||r!==0&&y.nodeType!==3||(u=a+r),y.nodeType===3&&(a+=y.nodeValue.length),(T=y.firstChild)!==null;)m=y,y=T;for(;;){if(y===t)break t;if(m===n&&++d===s&&(c=a),m===i&&++p===r&&(u=a),(T=y.nextSibling)!==null)break;y=m,m=y.parentNode}y=T}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Id={focusedElem:t,selectionRange:n},Fl=!1,oe=e;oe!==null;)if(e=oe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,oe=t;else for(;oe!==null;){e=oe;try{var w=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var P=w.memoizedProps,I=w.memoizedState,E=e.stateNode,x=E.getSnapshotBeforeUpdate(e.elementType===e.type?P:xn(e.type,P),I);E.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(R){nt(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,oe=t;break}oe=e.return}return w=ig,ig=!1,w}function Io(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&$d(e,n,i)}s=s.next}while(s!==r)}}function Ac(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function qd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Wv(t){var e=t.alternate;e!==null&&(t.alternate=null,Wv(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Rn],delete e[Wo],delete e[Ad],delete e[iE],delete e[oE])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Gv(t){return t.tag===5||t.tag===3||t.tag===4}function og(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Gv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Hd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Bl));else if(r!==4&&(t=t.child,t!==null))for(Hd(t,e,n),t=t.sibling;t!==null;)Hd(t,e,n),t=t.sibling}function Wd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Wd(t,e,n),t=t.sibling;t!==null;)Wd(t,e,n),t=t.sibling}var vt=null,wn=!1;function mr(t,e,n){for(n=n.child;n!==null;)Kv(t,e,n),n=n.sibling}function Kv(t,e,n){if(Dn&&typeof Dn.onCommitFiberUnmount=="function")try{Dn.onCommitFiberUnmount(bc,n)}catch{}switch(n.tag){case 5:jt||oi(n,e);case 6:var r=vt,s=wn;vt=null,mr(t,e,n),vt=r,wn=s,vt!==null&&(wn?(t=vt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):vt.removeChild(n.stateNode));break;case 18:vt!==null&&(wn?(t=vt,n=n.stateNode,t.nodeType===8?Lu(t.parentNode,n):t.nodeType===1&&Lu(t,n),zo(t)):Lu(vt,n.stateNode));break;case 4:r=vt,s=wn,vt=n.stateNode.containerInfo,wn=!0,mr(t,e,n),vt=r,wn=s;break;case 0:case 11:case 14:case 15:if(!jt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&$d(n,e,a),s=s.next}while(s!==r)}mr(t,e,n);break;case 1:if(!jt&&(oi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){nt(n,e,c)}mr(t,e,n);break;case 21:mr(t,e,n);break;case 22:n.mode&1?(jt=(r=jt)||n.memoizedState!==null,mr(t,e,n),jt=r):mr(t,e,n);break;default:mr(t,e,n)}}function ag(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new bE),e.forEach(function(r){var s=PE.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function vn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,c=a;e:for(;c!==null;){switch(c.tag){case 5:vt=c.stateNode,wn=!1;break e;case 3:vt=c.stateNode.containerInfo,wn=!0;break e;case 4:vt=c.stateNode.containerInfo,wn=!0;break e}c=c.return}if(vt===null)throw Error(W(160));Kv(i,a,s),vt=null,wn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){nt(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Qv(e,t),e=e.sibling}function Qv(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(vn(e,t),An(t),r&4){try{Io(3,t,t.return),Ac(3,t)}catch(P){nt(t,t.return,P)}try{Io(5,t,t.return)}catch(P){nt(t,t.return,P)}}break;case 1:vn(e,t),An(t),r&512&&n!==null&&oi(n,n.return);break;case 5:if(vn(e,t),An(t),r&512&&n!==null&&oi(n,n.return),t.flags&32){var s=t.stateNode;try{Mo(s,"")}catch(P){nt(t,t.return,P)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&g0(s,i),gd(c,a);var d=gd(c,i);for(a=0;a<u.length;a+=2){var p=u[a],y=u[a+1];p==="style"?_0(s,y):p==="dangerouslySetInnerHTML"?x0(s,y):p==="children"?Mo(s,y):Ah(s,p,y,d)}switch(c){case"input":dd(s,i);break;case"textarea":y0(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var T=i.value;T!=null?ci(s,!!i.multiple,T,!1):m!==!!i.multiple&&(i.defaultValue!=null?ci(s,!!i.multiple,i.defaultValue,!0):ci(s,!!i.multiple,i.multiple?[]:"",!1))}s[Wo]=i}catch(P){nt(t,t.return,P)}}break;case 6:if(vn(e,t),An(t),r&4){if(t.stateNode===null)throw Error(W(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(P){nt(t,t.return,P)}}break;case 3:if(vn(e,t),An(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{zo(e.containerInfo)}catch(P){nt(t,t.return,P)}break;case 4:vn(e,t),An(t);break;case 13:vn(e,t),An(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(uf=st())),r&4&&ag(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(jt=(d=jt)||p,vn(e,t),jt=d):vn(e,t),An(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!p&&t.mode&1)for(oe=t,p=t.child;p!==null;){for(y=oe=p;oe!==null;){switch(m=oe,T=m.child,m.tag){case 0:case 11:case 14:case 15:Io(4,m,m.return);break;case 1:oi(m,m.return);var w=m.stateNode;if(typeof w.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,w.props=e.memoizedProps,w.state=e.memoizedState,w.componentWillUnmount()}catch(P){nt(r,n,P)}}break;case 5:oi(m,m.return);break;case 22:if(m.memoizedState!==null){cg(y);continue}}T!==null?(T.return=m,oe=T):cg(y)}p=p.sibling}e:for(p=null,y=t;;){if(y.tag===5){if(p===null){p=y;try{s=y.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=y.stateNode,u=y.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=w0("display",a))}catch(P){nt(t,t.return,P)}}}else if(y.tag===6){if(p===null)try{y.stateNode.nodeValue=d?"":y.memoizedProps}catch(P){nt(t,t.return,P)}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===t)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;p===y&&(p=null),y=y.return}p===y&&(p=null),y.sibling.return=y.return,y=y.sibling}}break;case 19:vn(e,t),An(t),r&4&&ag(t);break;case 21:break;default:vn(e,t),An(t)}}function An(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Gv(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Mo(s,""),r.flags&=-33);var i=og(t);Wd(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,c=og(t);Hd(t,c,a);break;default:throw Error(W(161))}}catch(u){nt(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function NE(t,e,n){oe=t,Xv(t)}function Xv(t,e,n){for(var r=(t.mode&1)!==0;oe!==null;){var s=oe,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||rl;if(!a){var c=s.alternate,u=c!==null&&c.memoizedState!==null||jt;c=rl;var d=jt;if(rl=a,(jt=u)&&!d)for(oe=s;oe!==null;)a=oe,u=a.child,a.tag===22&&a.memoizedState!==null?ug(s):u!==null?(u.return=a,oe=u):ug(s);for(;i!==null;)oe=i,Xv(i),i=i.sibling;oe=s,rl=c,jt=d}lg(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,oe=i):lg(t)}}function lg(t){for(;oe!==null;){var e=oe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:jt||Ac(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!jt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:xn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Hm(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Hm(e,a,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var p=d.memoizedState;if(p!==null){var y=p.dehydrated;y!==null&&zo(y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}jt||e.flags&512&&qd(e)}catch(m){nt(e,e.return,m)}}if(e===t){oe=null;break}if(n=e.sibling,n!==null){n.return=e.return,oe=n;break}oe=e.return}}function cg(t){for(;oe!==null;){var e=oe;if(e===t){oe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,oe=n;break}oe=e.return}}function ug(t){for(;oe!==null;){var e=oe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ac(4,e)}catch(u){nt(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){nt(e,s,u)}}var i=e.return;try{qd(e)}catch(u){nt(e,i,u)}break;case 5:var a=e.return;try{qd(e)}catch(u){nt(e,a,u)}}}catch(u){nt(e,e.return,u)}if(e===t){oe=null;break}var c=e.sibling;if(c!==null){c.return=e.return,oe=c;break}oe=e.return}}var TE=Math.ceil,Zl=cr.ReactCurrentDispatcher,lf=cr.ReactCurrentOwner,hn=cr.ReactCurrentBatchConfig,Ae=0,mt=null,ot=null,_t=0,Zt=0,ai=ns(0),dt=0,Jo=null,Cs=0,jc=0,cf=0,Co=null,qt=null,uf=0,Si=1/0,Gn=null,ec=!1,Gd=null,Dr=null,sl=!1,Ir=null,tc=0,ko=0,Kd=null,_l=-1,bl=0;function Ft(){return Ae&6?st():_l!==-1?_l:_l=st()}function Or(t){return t.mode&1?Ae&2&&_t!==0?_t&-_t:lE.transition!==null?(bl===0&&(bl=R0()),bl):(t=Le,t!==0||(t=window.event,t=t===void 0?16:U0(t.type)),t):1}function Tn(t,e,n,r){if(50<ko)throw ko=0,Kd=null,Error(W(185));ha(t,n,r),(!(Ae&2)||t!==mt)&&(t===mt&&(!(Ae&2)&&(jc|=n),dt===4&&_r(t,_t)),Xt(t,r),n===1&&Ae===0&&!(e.mode&1)&&(Si=st()+500,Ic&&rs()))}function Xt(t,e){var n=t.callbackNode;l1(t,e);var r=Vl(t,t===mt?_t:0);if(r===0)n!==null&&xm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&xm(n),e===1)t.tag===0?aE(dg.bind(null,t)):iv(dg.bind(null,t)),rE(function(){!(Ae&6)&&rs()}),n=null;else{switch(D0(r)){case 1:n=Oh;break;case 4:n=j0;break;case 16:n=Ml;break;case 536870912:n=P0;break;default:n=Ml}n=sx(n,Yv.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Yv(t,e){if(_l=-1,bl=0,Ae&6)throw Error(W(327));var n=t.callbackNode;if(pi()&&t.callbackNode!==n)return null;var r=Vl(t,t===mt?_t:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=nc(t,r);else{e=r;var s=Ae;Ae|=2;var i=Zv();(mt!==t||_t!==e)&&(Gn=null,Si=st()+500,ws(t,e));do try{CE();break}catch(c){Jv(t,c)}while(!0);Kh(),Zl.current=i,Ae=s,ot!==null?e=0:(mt=null,_t=0,e=dt)}if(e!==0){if(e===2&&(s=_d(t),s!==0&&(r=s,e=Qd(t,s))),e===1)throw n=Jo,ws(t,0),_r(t,r),Xt(t,st()),n;if(e===6)_r(t,r);else{if(s=t.current.alternate,!(r&30)&&!SE(s)&&(e=nc(t,r),e===2&&(i=_d(t),i!==0&&(r=i,e=Qd(t,i))),e===1))throw n=Jo,ws(t,0),_r(t,r),Xt(t,st()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(W(345));case 2:fs(t,qt,Gn);break;case 3:if(_r(t,r),(r&130023424)===r&&(e=uf+500-st(),10<e)){if(Vl(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Ft(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=kd(fs.bind(null,t,qt,Gn),e);break}fs(t,qt,Gn);break;case 4:if(_r(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-Nn(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=st()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*TE(r/1960))-r,10<r){t.timeoutHandle=kd(fs.bind(null,t,qt,Gn),r);break}fs(t,qt,Gn);break;case 5:fs(t,qt,Gn);break;default:throw Error(W(329))}}}return Xt(t,st()),t.callbackNode===n?Yv.bind(null,t):null}function Qd(t,e){var n=Co;return t.current.memoizedState.isDehydrated&&(ws(t,e).flags|=256),t=nc(t,e),t!==2&&(e=qt,qt=n,e!==null&&Xd(e)),t}function Xd(t){qt===null?qt=t:qt.push.apply(qt,t)}function SE(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Cn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function _r(t,e){for(e&=~cf,e&=~jc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Nn(e),r=1<<n;t[n]=-1,e&=~r}}function dg(t){if(Ae&6)throw Error(W(327));pi();var e=Vl(t,0);if(!(e&1))return Xt(t,st()),null;var n=nc(t,e);if(t.tag!==0&&n===2){var r=_d(t);r!==0&&(e=r,n=Qd(t,r))}if(n===1)throw n=Jo,ws(t,0),_r(t,e),Xt(t,st()),n;if(n===6)throw Error(W(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,fs(t,qt,Gn),Xt(t,st()),null}function df(t,e){var n=Ae;Ae|=1;try{return t(e)}finally{Ae=n,Ae===0&&(Si=st()+500,Ic&&rs())}}function ks(t){Ir!==null&&Ir.tag===0&&!(Ae&6)&&pi();var e=Ae;Ae|=1;var n=hn.transition,r=Le;try{if(hn.transition=null,Le=1,t)return t()}finally{Le=r,hn.transition=n,Ae=e,!(Ae&6)&&rs()}}function hf(){Zt=ai.current,He(ai)}function ws(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,nE(n)),ot!==null)for(n=ot.return;n!==null;){var r=n;switch(Hh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&$l();break;case 3:Ni(),He(Kt),He(Rt),ef();break;case 5:Zh(r);break;case 4:Ni();break;case 13:He(Xe);break;case 19:He(Xe);break;case 10:Qh(r.type._context);break;case 22:case 23:hf()}n=n.return}if(mt=t,ot=t=Lr(t.current,null),_t=Zt=e,dt=0,Jo=null,cf=jc=Cs=0,qt=Co=null,ys!==null){for(e=0;e<ys.length;e++)if(n=ys[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}ys=null}return t}function Jv(t,e){do{var n=ot;try{if(Kh(),vl.current=Jl,Yl){for(var r=Je.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Yl=!1}if(Is=0,pt=ut=Je=null,So=!1,Qo=0,lf.current=null,n===null||n.return===null){dt=1,Jo=e,ot=null;break}e:{var i=t,a=n.return,c=n,u=e;if(e=_t,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,p=c,y=p.tag;if(!(p.mode&1)&&(y===0||y===11||y===15)){var m=p.alternate;m?(p.updateQueue=m.updateQueue,p.memoizedState=m.memoizedState,p.lanes=m.lanes):(p.updateQueue=null,p.memoizedState=null)}var T=Jm(a);if(T!==null){T.flags&=-257,Zm(T,a,c,i,e),T.mode&1&&Ym(i,d,e),e=T,u=d;var w=e.updateQueue;if(w===null){var P=new Set;P.add(u),e.updateQueue=P}else w.add(u);break e}else{if(!(e&1)){Ym(i,d,e),ff();break e}u=Error(W(426))}}else if(We&&c.mode&1){var I=Jm(a);if(I!==null){!(I.flags&65536)&&(I.flags|=256),Zm(I,a,c,i,e),Wh(Ti(u,c));break e}}i=u=Ti(u,c),dt!==4&&(dt=2),Co===null?Co=[i]:Co.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var E=Ov(i,u,e);qm(i,E);break e;case 1:c=u;var x=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Dr===null||!Dr.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var R=Lv(i,c,e);qm(i,R);break e}}i=i.return}while(i!==null)}tx(n)}catch(L){e=L,ot===n&&n!==null&&(ot=n=n.return);continue}break}while(!0)}function Zv(){var t=Zl.current;return Zl.current=Jl,t===null?Jl:t}function ff(){(dt===0||dt===3||dt===2)&&(dt=4),mt===null||!(Cs&268435455)&&!(jc&268435455)||_r(mt,_t)}function nc(t,e){var n=Ae;Ae|=2;var r=Zv();(mt!==t||_t!==e)&&(Gn=null,ws(t,e));do try{IE();break}catch(s){Jv(t,s)}while(!0);if(Kh(),Ae=n,Zl.current=r,ot!==null)throw Error(W(261));return mt=null,_t=0,dt}function IE(){for(;ot!==null;)ex(ot)}function CE(){for(;ot!==null&&!Zb();)ex(ot)}function ex(t){var e=rx(t.alternate,t,Zt);t.memoizedProps=t.pendingProps,e===null?tx(t):ot=e,lf.current=null}function tx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=_E(n,e),n!==null){n.flags&=32767,ot=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{dt=6,ot=null;return}}else if(n=wE(n,e,Zt),n!==null){ot=n;return}if(e=e.sibling,e!==null){ot=e;return}ot=e=t}while(e!==null);dt===0&&(dt=5)}function fs(t,e,n){var r=Le,s=hn.transition;try{hn.transition=null,Le=1,kE(t,e,n,r)}finally{hn.transition=s,Le=r}return null}function kE(t,e,n,r){do pi();while(Ir!==null);if(Ae&6)throw Error(W(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(W(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(c1(t,i),t===mt&&(ot=mt=null,_t=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||sl||(sl=!0,sx(Ml,function(){return pi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=hn.transition,hn.transition=null;var a=Le;Le=1;var c=Ae;Ae|=4,lf.current=null,EE(t,n),Qv(n,t),Q1(Id),Fl=!!Sd,Id=Sd=null,t.current=n,NE(n),e1(),Ae=c,Le=a,hn.transition=i}else t.current=n;if(sl&&(sl=!1,Ir=t,tc=s),i=t.pendingLanes,i===0&&(Dr=null),r1(n.stateNode),Xt(t,st()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(ec)throw ec=!1,t=Gd,Gd=null,t;return tc&1&&t.tag!==0&&pi(),i=t.pendingLanes,i&1?t===Kd?ko++:(ko=0,Kd=t):ko=0,rs(),null}function pi(){if(Ir!==null){var t=D0(tc),e=hn.transition,n=Le;try{if(hn.transition=null,Le=16>t?16:t,Ir===null)var r=!1;else{if(t=Ir,Ir=null,tc=0,Ae&6)throw Error(W(331));var s=Ae;for(Ae|=4,oe=t.current;oe!==null;){var i=oe,a=i.child;if(oe.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(oe=d;oe!==null;){var p=oe;switch(p.tag){case 0:case 11:case 15:Io(8,p,i)}var y=p.child;if(y!==null)y.return=p,oe=y;else for(;oe!==null;){p=oe;var m=p.sibling,T=p.return;if(Wv(p),p===d){oe=null;break}if(m!==null){m.return=T,oe=m;break}oe=T}}}var w=i.alternate;if(w!==null){var P=w.child;if(P!==null){w.child=null;do{var I=P.sibling;P.sibling=null,P=I}while(P!==null)}}oe=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,oe=a;else e:for(;oe!==null;){if(i=oe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Io(9,i,i.return)}var E=i.sibling;if(E!==null){E.return=i.return,oe=E;break e}oe=i.return}}var x=t.current;for(oe=x;oe!==null;){a=oe;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,oe=b;else e:for(a=x;oe!==null;){if(c=oe,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Ac(9,c)}}catch(L){nt(c,c.return,L)}if(c===a){oe=null;break e}var R=c.sibling;if(R!==null){R.return=c.return,oe=R;break e}oe=c.return}}if(Ae=s,rs(),Dn&&typeof Dn.onPostCommitFiberRoot=="function")try{Dn.onPostCommitFiberRoot(bc,t)}catch{}r=!0}return r}finally{Le=n,hn.transition=e}}return!1}function hg(t,e,n){e=Ti(n,e),e=Ov(t,e,1),t=Rr(t,e,1),e=Ft(),t!==null&&(ha(t,1,e),Xt(t,e))}function nt(t,e,n){if(t.tag===3)hg(t,t,n);else for(;e!==null;){if(e.tag===3){hg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Dr===null||!Dr.has(r))){t=Ti(n,t),t=Lv(e,t,1),e=Rr(e,t,1),t=Ft(),e!==null&&(ha(e,1,t),Xt(e,t));break}}e=e.return}}function AE(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ft(),t.pingedLanes|=t.suspendedLanes&n,mt===t&&(_t&n)===n&&(dt===4||dt===3&&(_t&130023424)===_t&&500>st()-uf?ws(t,0):cf|=n),Xt(t,e)}function nx(t,e){e===0&&(t.mode&1?(e=Ka,Ka<<=1,!(Ka&130023424)&&(Ka=4194304)):e=1);var n=Ft();t=nr(t,e),t!==null&&(ha(t,e,n),Xt(t,n))}function jE(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),nx(t,n)}function PE(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(e),nx(t,n)}var rx;rx=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Kt.current)Wt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Wt=!1,xE(t,e,n);Wt=!!(t.flags&131072)}else Wt=!1,We&&e.flags&1048576&&ov(e,Wl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;wl(t,e),t=e.pendingProps;var s=_i(e,Rt.current);fi(e,n),s=nf(null,e,r,t,s,n);var i=rf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Qt(r)?(i=!0,ql(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Yh(e),s.updater=Cc,e.stateNode=s,s._reactInternals=e,Ld(e,r,t,n),e=Fd(null,e,r,!0,i,n)):(e.tag=0,We&&i&&qh(e),Vt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(wl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=DE(r),t=xn(r,t),s){case 0:e=Vd(null,e,r,t,n);break e;case 1:e=ng(null,e,r,t,n);break e;case 11:e=eg(null,e,r,t,n);break e;case 14:e=tg(null,e,r,xn(r.type,t),n);break e}throw Error(W(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),Vd(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),ng(t,e,r,s,n);case 3:e:{if(Uv(e),t===null)throw Error(W(387));r=e.pendingProps,i=e.memoizedState,s=i.element,uv(t,e),Ql(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ti(Error(W(423)),e),e=rg(t,e,r,n,s);break e}else if(r!==s){s=Ti(Error(W(424)),e),e=rg(t,e,r,n,s);break e}else for(en=Pr(e.stateNode.containerInfo.firstChild),nn=e,We=!0,_n=null,n=pv(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(bi(),r===s){e=rr(t,e,n);break e}Vt(t,e,r,n)}e=e.child}return e;case 5:return mv(e),t===null&&Rd(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Cd(r,s)?a=null:i!==null&&Cd(r,i)&&(e.flags|=32),Fv(t,e),Vt(t,e,a,n),e.child;case 6:return t===null&&Rd(e),null;case 13:return zv(t,e,n);case 4:return Jh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ei(e,null,r,n):Vt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),eg(t,e,r,s,n);case 7:return Vt(t,e,e.pendingProps,n),e.child;case 8:return Vt(t,e,e.pendingProps.children,n),e.child;case 12:return Vt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Fe(Gl,r._currentValue),r._currentValue=a,i!==null)if(Cn(i.value,a)){if(i.children===s.children&&!Kt.current){e=rr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){a=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Zn(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var p=d.pending;p===null?u.next=u:(u.next=p.next,p.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Dd(i.return,n,e),c.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(W(341));a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),Dd(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Vt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,fi(e,n),s=fn(s),r=r(s),e.flags|=1,Vt(t,e,r,n),e.child;case 14:return r=e.type,s=xn(r,e.pendingProps),s=xn(r.type,s),tg(t,e,r,s,n);case 15:return Mv(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),wl(t,e),e.tag=1,Qt(r)?(t=!0,ql(e)):t=!1,fi(e,n),hv(e,r,s),Ld(e,r,s,n),Fd(null,e,r,!0,t,n);case 19:return Bv(t,e,n);case 22:return Vv(t,e,n)}throw Error(W(156,e.tag))};function sx(t,e){return A0(t,e)}function RE(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function un(t,e,n,r){return new RE(t,e,n,r)}function pf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function DE(t){if(typeof t=="function")return pf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ph)return 11;if(t===Rh)return 14}return 2}function Lr(t,e){var n=t.alternate;return n===null?(n=un(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function El(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")pf(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Ys:return _s(n.children,s,i,e);case jh:a=8,s|=8;break;case od:return t=un(12,n,e,s|2),t.elementType=od,t.lanes=i,t;case ad:return t=un(13,n,e,s),t.elementType=ad,t.lanes=i,t;case ld:return t=un(19,n,e,s),t.elementType=ld,t.lanes=i,t;case f0:return Pc(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case d0:a=10;break e;case h0:a=9;break e;case Ph:a=11;break e;case Rh:a=14;break e;case vr:a=16,r=null;break e}throw Error(W(130,t==null?t:typeof t,""))}return e=un(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function _s(t,e,n,r){return t=un(7,t,r,e),t.lanes=n,t}function Pc(t,e,n,r){return t=un(22,t,r,e),t.elementType=f0,t.lanes=n,t.stateNode={isHidden:!1},t}function qu(t,e,n){return t=un(6,t,null,e),t.lanes=n,t}function Hu(t,e,n){return e=un(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function OE(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tu(0),this.expirationTimes=Tu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function mf(t,e,n,r,s,i,a,c,u){return t=new OE(t,e,n,c,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=un(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yh(i),t}function LE(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Xs,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function ix(t){if(!t)return Hr;t=t._reactInternals;e:{if(Vs(t)!==t||t.tag!==1)throw Error(W(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Qt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(W(171))}if(t.tag===1){var n=t.type;if(Qt(n))return sv(t,n,e)}return e}function ox(t,e,n,r,s,i,a,c,u){return t=mf(n,r,!0,t,s,i,a,c,u),t.context=ix(null),n=t.current,r=Ft(),s=Or(n),i=Zn(r,s),i.callback=e??null,Rr(n,i,s),t.current.lanes=s,ha(t,s,r),Xt(t,r),t}function Rc(t,e,n,r){var s=e.current,i=Ft(),a=Or(s);return n=ix(n),e.context===null?e.context=n:e.pendingContext=n,e=Zn(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Rr(s,e,a),t!==null&&(Tn(t,s,a,i),yl(t,s,a)),a}function rc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function fg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function gf(t,e){fg(t,e),(t=t.alternate)&&fg(t,e)}function ME(){return null}var ax=typeof reportError=="function"?reportError:function(t){console.error(t)};function yf(t){this._internalRoot=t}Dc.prototype.render=yf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(W(409));Rc(t,e,null,null)};Dc.prototype.unmount=yf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ks(function(){Rc(null,t,null,null)}),e[tr]=null}};function Dc(t){this._internalRoot=t}Dc.prototype.unstable_scheduleHydration=function(t){if(t){var e=M0();t={blockedOn:null,target:t,priority:e};for(var n=0;n<wr.length&&e!==0&&e<wr[n].priority;n++);wr.splice(n,0,t),n===0&&F0(t)}};function vf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Oc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function pg(){}function VE(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=rc(a);i.call(d)}}var a=ox(e,r,t,0,null,!1,!1,"",pg);return t._reactRootContainer=a,t[tr]=a.current,qo(t.nodeType===8?t.parentNode:t),ks(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var d=rc(u);c.call(d)}}var u=mf(t,0,!1,null,null,!1,!1,"",pg);return t._reactRootContainer=u,t[tr]=u.current,qo(t.nodeType===8?t.parentNode:t),ks(function(){Rc(e,u,n,r)}),u}function Lc(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var c=s;s=function(){var u=rc(a);c.call(u)}}Rc(e,a,t,s)}else a=VE(n,e,t,s,r);return rc(a)}O0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=mo(e.pendingLanes);n!==0&&(Lh(e,n|1),Xt(e,st()),!(Ae&6)&&(Si=st()+500,rs()))}break;case 13:ks(function(){var r=nr(t,1);if(r!==null){var s=Ft();Tn(r,t,1,s)}}),gf(t,1)}};Mh=function(t){if(t.tag===13){var e=nr(t,134217728);if(e!==null){var n=Ft();Tn(e,t,134217728,n)}gf(t,134217728)}};L0=function(t){if(t.tag===13){var e=Or(t),n=nr(t,e);if(n!==null){var r=Ft();Tn(n,t,e,r)}gf(t,e)}};M0=function(){return Le};V0=function(t,e){var n=Le;try{return Le=t,e()}finally{Le=n}};vd=function(t,e,n){switch(e){case"input":if(dd(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Sc(r);if(!s)throw Error(W(90));m0(r),dd(r,s)}}}break;case"textarea":y0(t,n);break;case"select":e=n.value,e!=null&&ci(t,!!n.multiple,e,!1)}};N0=df;T0=ks;var FE={usingClientEntryPoint:!1,Events:[pa,ti,Sc,b0,E0,df]},ho={findFiberByHostInstance:gs,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},UE={bundleType:ho.bundleType,version:ho.version,rendererPackageName:ho.rendererPackageName,rendererConfig:ho.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:cr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=C0(t),t===null?null:t.stateNode},findFiberByHostInstance:ho.findFiberByHostInstance||ME,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var il=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!il.isDisabled&&il.supportsFiber)try{bc=il.inject(UE),Dn=il}catch{}}sn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FE;sn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vf(e))throw Error(W(200));return LE(t,e,null,n)};sn.createRoot=function(t,e){if(!vf(t))throw Error(W(299));var n=!1,r="",s=ax;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=mf(t,1,!1,null,null,n,!1,r,s),t[tr]=e.current,qo(t.nodeType===8?t.parentNode:t),new yf(e)};sn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(W(188)):(t=Object.keys(t).join(","),Error(W(268,t)));return t=C0(e),t=t===null?null:t.stateNode,t};sn.flushSync=function(t){return ks(t)};sn.hydrate=function(t,e,n){if(!Oc(e))throw Error(W(200));return Lc(null,t,e,!0,n)};sn.hydrateRoot=function(t,e,n){if(!vf(t))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=ax;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=ox(e,null,t,1,n??null,s,!1,i,a),t[tr]=e.current,qo(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Dc(e)};sn.render=function(t,e,n){if(!Oc(e))throw Error(W(200));return Lc(null,t,e,!1,n)};sn.unmountComponentAtNode=function(t){if(!Oc(t))throw Error(W(40));return t._reactRootContainer?(ks(function(){Lc(null,null,t,!1,function(){t._reactRootContainer=null,t[tr]=null})}),!0):!1};sn.unstable_batchedUpdates=df;sn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Oc(n))throw Error(W(200));if(t==null||t._reactInternals===void 0)throw Error(W(38));return Lc(t,e,n,!1,r)};sn.version="18.2.0-next-9e3b772b8-20220608";function lx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(lx)}catch(t){console.error(t)}}lx(),o0.exports=sn;var zE=o0.exports,cx,mg=zE;cx=mg.createRoot,mg.hydrateRoot;/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BE=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),$E=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),gg=t=>{const e=$E(t);return e.charAt(0).toUpperCase()+e.slice(1)},ux=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),qE=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var HE={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WE=F.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:a,...c},u)=>F.createElement("svg",{ref:u,...HE,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:ux("lucide",s),...!i&&!qE(c)&&{"aria-hidden":"true"},...c},[...a.map(([d,p])=>F.createElement(d,p)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=(t,e)=>{const n=F.forwardRef(({className:r,...s},i)=>F.createElement(WE,{ref:i,iconNode:e,className:ux(`lucide-${BE(gg(t))}`,`lucide-${t}`,r),...s}));return n.displayName=gg(t),n};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GE=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],KE=Ge("box",GE);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QE=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],XE=Ge("calendar",QE);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YE=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],JE=Ge("camera",YE);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZE=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],eN=Ge("chart-pie",ZE);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tN=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Wu=Ge("chevron-down",tN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nN=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Gu=Ge("chevron-up",nN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],sN=Ge("circle-alert",rN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iN=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],oN=Ge("clipboard",iN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aN=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],lN=Ge("crown",aN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cN=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],uN=Ge("dollar-sign",cN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dN=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],hN=Ge("image",dN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fN=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],mi=Ge("package",fN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pN=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],dx=Ge("pen",pN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mN=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],hx=Ge("plus",mN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gN=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],fx=Ge("save",gN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yN=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],vN=Ge("scissors",yN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xN=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],px=Ge("search",xN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wN=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Zo=Ge("trash-2",wN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _N=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],bN=Ge("trending-down",_N);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EN=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],yg=Ge("trending-up",EN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NN=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],mx=Ge("triangle-alert",NN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TN=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],SN=Ge("truck",TN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IN=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],gx=Ge("users",IN);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CN=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Wr=Ge("x",CN);function kN({inventoryItems:t=[],soldCounts:e={},onViewItem:n,onAddClick:r}){const[s,i]=F.useState(""),[a,c]=F.useState("all"),[u,d]=F.useState("name"),p=m=>m?Object.values(m).reduce((T,w)=>T+(parseInt(w)||0),0):0,y=F.useMemo(()=>{let m=[...t];if(s){const T=s.toLowerCase();m=m.filter(w=>w.name&&w.name.toLowerCase().includes(T)||w.websiteProductName&&w.websiteProductName.toLowerCase().includes(T)||w.location&&w.location.toLowerCase().includes(T))}return a==="fabrics"&&(m=m.filter(T=>T.type==="fabric")),a==="outfits"&&(m=m.filter(T=>T.type==="outfit")),a==="low"&&(m=m.filter(T=>T.type==="fabric"&&T.currentLength<5)),m.sort((T,w)=>{if(u==="name")return(T.name||"").localeCompare(w.name||"");if(u==="stock"){const P=T.type==="fabric"?T.currentLength:p(T.stockBreakdown);return(w.type==="fabric"?w.currentLength:p(w.stockBreakdown))-P}if(u==="potential"){const P=T.type==="fabric"&&T.potentialOutfits||0;return(w.type==="fabric"&&w.potentialOutfits||0)-P}return 0}),m},[t,s,a,u]);return o.jsxs("div",{className:"space-y-4 fade-in",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("h2",{className:"text-2xl font-bold text-white",children:"Inventory"}),r&&o.jsxs("button",{onClick:r,className:"text-sm bg-lime-glow text-emerald-pine px-4 py-2 rounded-full font-bold shadow-lg hover:shadow-xl flex items-center gap-1",children:[o.jsx(hx,{className:"w-4 h-4"})," Add Item"]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx("span",{className:"absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400",children:o.jsx(px,{className:"w-5 h-5"})}),o.jsx("input",{className:"w-full pl-10 p-3 bg-white rounded-xl border-2 border-lime-glow shadow-sm text-sm text-gray-900 placeholder-gray-400",placeholder:"Search...",value:s,onChange:m=>i(m.target.value)})]}),o.jsxs("select",{className:"text-xs bg-white border-2 border-lime-glow rounded-lg p-2 text-emerald-pine font-semibold outline-none shadow-sm",value:u,onChange:m=>d(m.target.value),children:[o.jsx("option",{value:"name",children:"Name (A-Z)"}),o.jsx("option",{value:"stock",children:"Stock Level (High)"}),o.jsx("option",{value:"potential",children:"Potential (High)"})]})]}),o.jsx("div",{className:"flex space-x-2 overflow-x-auto no-scrollbar pb-2",children:["all","fabrics","outfits","low"].map(m=>o.jsx("button",{onClick:()=>c(m),className:`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap capitalize transition-all ${a===m?"bg-emerald-pine text-lime-glow shadow-lg":"bg-lime-glow text-emerald-pine border-2 border-lime-glow"}`,children:m},m))}),o.jsx("div",{className:"grid grid-cols-2 gap-4 p-2",children:y.map(m=>{if(m.type==="fabric"){const w=m.currentLength>0&&m.currentLength<5;return o.jsxs("div",{className:"relative aspect-[4/5] rounded-2xl overflow-hidden shadow-md bg-white cursor-pointer",onClick:()=>n&&n(m),children:[o.jsx("img",{src:m.imageUrl,className:"w-full h-full object-cover"}),o.jsxs("div",{className:"absolute bottom-0 w-full bg-gradient-to-t from-black/80 to-transparent p-3 pt-6",children:[o.jsx("h4",{className:"text-white font-bold text-sm truncate",children:m.name}),o.jsxs("p",{className:"text-xs text-gray-300",children:[(parseFloat(m.currentLength)||0).toFixed(1)," ",m.unit]})]}),w&&o.jsx("div",{className:"absolute top-2 right-2 bg-red-500 text-white text-[9px] font-bold px-2 py-0.5 rounded-full",children:"Low"})]},m.id)}else{const w=p(m.stockBreakdown),P=(e[m.name]||0)+(parseInt(m.manualSoldCount)||0);return o.jsxs("div",{className:"relative aspect-[4/5] rounded-2xl overflow-hidden shadow-md bg-white cursor-pointer",onClick:()=>n&&n(m),children:[o.jsx("img",{src:m.imageUrl,className:"w-full h-full object-cover"}),o.jsxs("div",{className:"absolute bottom-0 w-full bg-gradient-to-t from-black/80 to-transparent p-3 pt-6",children:[o.jsx("h4",{className:"text-white font-bold text-sm truncate",children:m.name}),o.jsxs("p",{className:"text-xs text-gray-300 font-bold",children:["Stock: ",w," ",o.jsxs("span",{className:"opacity-60 font-normal",children:["| Sold: ",P]})]})]})]},m.id)}})}),y.length===0&&o.jsx("div",{className:"text-center py-8 text-gray-500",children:s?`No items match "${s}"`:"No items in this category"})]})}const AN=()=>{};var vg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},jN=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],c=t[n++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},vx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,c=a?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,p=i>>2,y=(i&3)<<4|c>>4;let m=(c&15)<<2|d>>6,T=d&63;u||(T=64,a||(m=64)),r.push(n[p],n[y],n[m],n[T])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(yx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):jN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const y=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||c==null||d==null||y==null)throw new PN;const m=i<<2|c>>4;if(r.push(m),d!==64){const T=c<<4&240|d>>2;if(r.push(T),y!==64){const w=d<<6&192|y;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class PN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const RN=function(t){const e=yx(t);return vx.encodeByteArray(e,!0)},sc=function(t){return RN(t).replace(/\./g,"")},xx=function(t){try{return vx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ON=()=>DN().__FIREBASE_DEFAULTS__,LN=()=>{if(typeof process>"u"||typeof vg>"u")return;const t=vg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},MN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&xx(t[1]);return e&&JSON.parse(e)},Mc=()=>{try{return AN()||ON()||LN()||MN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},wx=t=>{var e,n;return(n=(e=Mc())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},VN=t=>{const e=wx(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},_x=()=>{var t;return(t=Mc())===null||t===void 0?void 0:t.config},bx=t=>{var e;return(e=Mc())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mi(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ex(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UN(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[sc(JSON.stringify(n)),sc(JSON.stringify(a)),""].join(".")}const Ao={};function zN(){const t={prod:[],emulator:[]};for(const e of Object.keys(Ao))Ao[e]?t.emulator.push(e):t.prod.push(e);return t}function BN(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let xg=!1;function Nx(t,e){if(typeof window>"u"||typeof document>"u"||!Mi(window.location.host)||Ao[t]===e||Ao[t]||xg)return;Ao[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=zN().prod.length>0;function a(){const m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,T){m.setAttribute("width","24"),m.setAttribute("id",T),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{xg=!0,a()},m}function p(m,T){m.setAttribute("id",T),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function y(){const m=BN(r),T=n("text"),w=document.getElementById(T)||document.createElement("span"),P=n("learnmore"),I=document.getElementById(P)||document.createElement("a"),E=n("preprendIcon"),x=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const b=m.element;c(b),p(I,P);const R=d();u(x,E),b.append(x,w,I,R),document.body.appendChild(b)}i?(w.innerText="Preview backend disconnected.",x.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(x.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $N(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Dt())}function qN(){var t;const e=(t=Mc())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function HN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function WN(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function GN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function KN(){const t=Dt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function QN(){return!qN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function XN(){try{return typeof indexedDB=="object"}catch{return!1}}function YN(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JN="FirebaseError";class ur extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=JN,Object.setPrototypeOf(this,ur.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ga.prototype.create)}}class ga{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?ZN(i,r):"Error",c=`${this.serviceName}: ${a} (${s}).`;return new ur(s,c,r)}}function ZN(t,e){return t.replace(eT,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const eT=/\{\$([^}]+)}/g;function tT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function As(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(wg(i)&&wg(a)){if(!As(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function wg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ya(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function nT(t,e){const n=new rT(t,e);return n.subscribe.bind(n)}class rT{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");sT(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Ku),s.error===void 0&&(s.error=Ku),s.complete===void 0&&(s.complete=Ku);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function sT(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Ku(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ot(t){return t&&t._delegate?t._delegate:t}class js{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ps="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new FN;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(aT(e))try{this.getOrInitializeService({instanceIdentifier:ps})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ps){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ps){return this.instances.has(e)}getOptions(e=ps){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:oT(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ps){return this.component?this.component.multipleInstances?e:ps:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function oT(t){return t===ps?void 0:t}function aT(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new iT(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ee;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ee||(Ee={}));const cT={debug:Ee.DEBUG,verbose:Ee.VERBOSE,info:Ee.INFO,warn:Ee.WARN,error:Ee.ERROR,silent:Ee.SILENT},uT=Ee.INFO,dT={[Ee.DEBUG]:"log",[Ee.VERBOSE]:"log",[Ee.INFO]:"info",[Ee.WARN]:"warn",[Ee.ERROR]:"error"},hT=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=dT[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class xf{constructor(e){this.name=e,this._logLevel=uT,this._logHandler=hT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ee))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?cT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ee.DEBUG,...e),this._logHandler(this,Ee.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ee.VERBOSE,...e),this._logHandler(this,Ee.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ee.INFO,...e),this._logHandler(this,Ee.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ee.WARN,...e),this._logHandler(this,Ee.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ee.ERROR,...e),this._logHandler(this,Ee.ERROR,...e)}}const fT=(t,e)=>e.some(n=>t instanceof n);let _g,bg;function pT(){return _g||(_g=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function mT(){return bg||(bg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Tx=new WeakMap,Yd=new WeakMap,Sx=new WeakMap,Qu=new WeakMap,wf=new WeakMap;function gT(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Mr(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&Tx.set(n,t)}).catch(()=>{}),wf.set(e,t),e}function yT(t){if(Yd.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Yd.set(t,e)}let Jd={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Yd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Sx.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Mr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function vT(t){Jd=t(Jd)}function xT(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Xu(this),e,...n);return Sx.set(r,e.sort?e.sort():[e]),Mr(r)}:mT().includes(t)?function(...e){return t.apply(Xu(this),e),Mr(Tx.get(this))}:function(...e){return Mr(t.apply(Xu(this),e))}}function wT(t){return typeof t=="function"?xT(t):(t instanceof IDBTransaction&&yT(t),fT(t,pT())?new Proxy(t,Jd):t)}function Mr(t){if(t instanceof IDBRequest)return gT(t);if(Qu.has(t))return Qu.get(t);const e=wT(t);return e!==t&&(Qu.set(t,e),wf.set(e,t)),e}const Xu=t=>wf.get(t);function _T(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),c=Mr(a);return r&&a.addEventListener("upgradeneeded",u=>{r(Mr(a.result),u.oldVersion,u.newVersion,Mr(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const bT=["get","getKey","getAll","getAllKeys","count"],ET=["put","add","delete","clear"],Yu=new Map;function Eg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Yu.get(e))return Yu.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=ET.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||bT.includes(n)))return;const i=async function(a,...c){const u=this.transaction(a,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[n](...c),s&&u.done]))[0]};return Yu.set(e,i),i}vT(t=>({...t,get:(e,n,r)=>Eg(e,n)||t.get(e,n,r),has:(e,n)=>!!Eg(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(TT(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function TT(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Zd="@firebase/app",Ng="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sr=new xf("@firebase/app"),ST="@firebase/app-compat",IT="@firebase/analytics-compat",CT="@firebase/analytics",kT="@firebase/app-check-compat",AT="@firebase/app-check",jT="@firebase/auth",PT="@firebase/auth-compat",RT="@firebase/database",DT="@firebase/data-connect",OT="@firebase/database-compat",LT="@firebase/functions",MT="@firebase/functions-compat",VT="@firebase/installations",FT="@firebase/installations-compat",UT="@firebase/messaging",zT="@firebase/messaging-compat",BT="@firebase/performance",$T="@firebase/performance-compat",qT="@firebase/remote-config",HT="@firebase/remote-config-compat",WT="@firebase/storage",GT="@firebase/storage-compat",KT="@firebase/firestore",QT="@firebase/ai",XT="@firebase/firestore-compat",YT="firebase",JT="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eh="[DEFAULT]",ZT={[Zd]:"fire-core",[ST]:"fire-core-compat",[CT]:"fire-analytics",[IT]:"fire-analytics-compat",[AT]:"fire-app-check",[kT]:"fire-app-check-compat",[jT]:"fire-auth",[PT]:"fire-auth-compat",[RT]:"fire-rtdb",[DT]:"fire-data-connect",[OT]:"fire-rtdb-compat",[LT]:"fire-fn",[MT]:"fire-fn-compat",[VT]:"fire-iid",[FT]:"fire-iid-compat",[UT]:"fire-fcm",[zT]:"fire-fcm-compat",[BT]:"fire-perf",[$T]:"fire-perf-compat",[qT]:"fire-rc",[HT]:"fire-rc-compat",[WT]:"fire-gcs",[GT]:"fire-gcs-compat",[KT]:"fire-fst",[XT]:"fire-fst-compat",[QT]:"fire-vertex","fire-js":"fire-js",[YT]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ic=new Map,eS=new Map,th=new Map;function Tg(t,e){try{t.container.addComponent(e)}catch(n){sr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ii(t){const e=t.name;if(th.has(e))return sr.debug(`There were multiple attempts to register component ${e}.`),!1;th.set(e,t);for(const n of ic.values())Tg(n,t);for(const n of eS.values())Tg(n,t);return!0}function _f(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function bn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Vr=new ga("app","Firebase",tS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new js("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Vr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vi=JT;function Ix(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:eh,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw Vr.create("bad-app-name",{appName:String(s)});if(n||(n=_x()),!n)throw Vr.create("no-options");const i=ic.get(s);if(i){if(As(n,i.options)&&As(r,i.config))return i;throw Vr.create("duplicate-app",{appName:s})}const a=new lT(s);for(const u of th.values())a.addComponent(u);const c=new nS(n,r,a);return ic.set(s,c),c}function Cx(t=eh){const e=ic.get(t);if(!e&&t===eh&&_x())return Ix();if(!e)throw Vr.create("no-app",{appName:t});return e}function Fr(t,e,n){var r;let s=(r=ZT[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const c=[`Unable to register library "${s}" with version "${e}":`];i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&c.push("and"),a&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),sr.warn(c.join(" "));return}Ii(new js(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS="firebase-heartbeat-database",sS=1,ea="firebase-heartbeat-store";let Ju=null;function kx(){return Ju||(Ju=_T(rS,sS,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ea)}catch(n){console.warn(n)}}}}).catch(t=>{throw Vr.create("idb-open",{originalErrorMessage:t.message})})),Ju}async function iS(t){try{const n=(await kx()).transaction(ea),r=await n.objectStore(ea).get(Ax(t));return await n.done,r}catch(e){if(e instanceof ur)sr.warn(e.message);else{const n=Vr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});sr.warn(n.message)}}}async function Sg(t,e){try{const r=(await kx()).transaction(ea,"readwrite");await r.objectStore(ea).put(e,Ax(t)),await r.done}catch(n){if(n instanceof ur)sr.warn(n.message);else{const r=Vr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});sr.warn(r.message)}}}function Ax(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oS=1024,aS=30;class lS{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new uS(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Ig();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>aS){const a=dS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){sr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Ig(),{heartbeatsToSend:r,unsentEntries:s}=cS(this._heartbeatsCache.heartbeats),i=sc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return sr.warn(n),""}}}function Ig(){return new Date().toISOString().substring(0,10)}function cS(t,e=oS){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Cg(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Cg(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class uS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return XN()?YN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await iS(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Sg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Sg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Cg(t){return sc(JSON.stringify({version:2,heartbeats:t})).length}function dS(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(t){Ii(new js("platform-logger",e=>new NT(e),"PRIVATE")),Ii(new js("heartbeat",e=>new lS(e),"PRIVATE")),Fr(Zd,Ng,t),Fr(Zd,Ng,"esm2017"),Fr("fire-js","")}hS("");var fS="firebase",pS="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fr(fS,pS,"app");function bf(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function jx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const mS=jx,Px=new ga("auth","Firebase",jx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oc=new xf("@firebase/auth");function gS(t,...e){oc.logLevel<=Ee.WARN&&oc.warn(`Auth (${Vi}): ${t}`,...e)}function Nl(t,...e){oc.logLevel<=Ee.ERROR&&oc.error(`Auth (${Vi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ir(t,...e){throw Ef(t,...e)}function Ln(t,...e){return Ef(t,...e)}function Rx(t,e,n){const r=Object.assign(Object.assign({},mS()),{[e]:n});return new ga("auth","Firebase",r).create(e,{appName:t.name})}function Ur(t){return Rx(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ef(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Px.create(t,...e)}function he(t,e,...n){if(!t)throw Ef(e,...n)}function Yn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Nl(e),new Error(e)}function or(t,e){t||Yn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function yS(){return kg()==="http:"||kg()==="https:"}function kg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(yS()||WN()||"connection"in navigator)?navigator.onLine:!0}function xS(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e,n){this.shortDelay=e,this.longDelay=n,or(n>e,"Short delay should be less than long delay!"),this.isMobile=$N()||GN()}get(){return vS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nf(t,e){or(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Yn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Yn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Yn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _S=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],bS=new va(3e4,6e4);function Vc(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Fi(t,e,n,r,s={}){return Ox(t,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const c=ya(Object.assign({key:t.config.apiKey},a)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:u},i);return HN()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Mi(t.emulatorConfig.host)&&(d.credentials="include"),Dx.fetch()(await Mx(t,t.config.apiHost,n,c),d)})}async function Ox(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},wS),e);try{const s=new ES(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw ol(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw ol(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw ol(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw ol(t,"user-disabled",a);const p=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Rx(t,p,d);ir(t,p)}}catch(s){if(s instanceof ur)throw s;ir(t,"network-request-failed",{message:String(s)})}}async function Lx(t,e,n,r,s={}){const i=await Fi(t,e,n,r,s);return"mfaPendingCredential"in i&&ir(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function Mx(t,e,n,r){const s=`${e}${n}?${r}`,i=t,a=i.config.emulator?Nf(t.config,s):`${t.config.apiScheme}://${s}`;return _S.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}class ES{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Ln(this.auth,"network-request-failed")),bS.get())})}}function ol(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Ln(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NS(t,e){return Fi(t,"POST","/v1/accounts:delete",e)}async function ac(t,e){return Fi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function TS(t,e=!1){const n=Ot(t),r=await n.getIdToken(e),s=Tf(r);he(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:jo(Zu(s.auth_time)),issuedAtTime:jo(Zu(s.iat)),expirationTime:jo(Zu(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Zu(t){return Number(t)*1e3}function Tf(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Nl("JWT malformed, contained fewer than 3 sections"),null;try{const s=xx(n);return s?JSON.parse(s):(Nl("Failed to decode base64 JWT payload"),null)}catch(s){return Nl("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Ag(t){const e=Tf(t);return he(e,"internal-error"),he(typeof e.exp<"u","internal-error"),he(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ta(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ur&&SS(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function SS({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IS{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=jo(this.lastLoginAt),this.creationTime=jo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lc(t){var e;const n=t.auth,r=await t.getIdToken(),s=await ta(t,ac(n,{idToken:r}));he(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Vx(i.providerUserInfo):[],c=kS(t.providerData,a),u=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(c!=null&&c.length),p=u?d:!1,y={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new rh(i.createdAt,i.lastLoginAt),isAnonymous:p};Object.assign(t,y)}async function CS(t){const e=Ot(t);await lc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function kS(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Vx(t){return t.map(e=>{var{providerId:n}=e,r=bf(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AS(t,e){const n=await Ox(t,{},async()=>{const r=ya({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=await Mx(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return t.emulatorConfig&&Mi(t.emulatorConfig.host)&&(u.credentials="include"),Dx.fetch()(a,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function jS(t,e){return Fi(t,"POST","/v2/accounts:revokeToken",Vc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){he(e.idToken,"internal-error"),he(typeof e.idToken<"u","internal-error"),he(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ag(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){he(e.length!==0,"internal-error");const n=Ag(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(he(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await AS(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,a=new gi;return r&&(he(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(he(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(he(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new gi,this.toJSON())}_performRefresh(){return Yn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gr(t,e){he(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class En{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=bf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new IS(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new rh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await ta(this,this.stsTokenManager.getToken(this.auth,e));return he(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return TS(this,e)}reload(){return CS(this)}_assign(e){this!==e&&(he(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new En(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){he(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await lc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(bn(this.auth.app))return Promise.reject(Ur(this.auth));const e=await this.getIdToken();return await ta(this,NS(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,a,c,u,d,p;const y=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(s=n.email)!==null&&s!==void 0?s:void 0,T=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,w=(a=n.photoURL)!==null&&a!==void 0?a:void 0,P=(c=n.tenantId)!==null&&c!==void 0?c:void 0,I=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,E=(d=n.createdAt)!==null&&d!==void 0?d:void 0,x=(p=n.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:b,emailVerified:R,isAnonymous:L,providerData:M,stsTokenManager:N}=n;he(b&&N,e,"internal-error");const f=gi.fromJSON(this.name,N);he(typeof b=="string",e,"internal-error"),gr(y,e.name),gr(m,e.name),he(typeof R=="boolean",e,"internal-error"),he(typeof L=="boolean",e,"internal-error"),gr(T,e.name),gr(w,e.name),gr(P,e.name),gr(I,e.name),gr(E,e.name),gr(x,e.name);const v=new En({uid:b,auth:e,email:m,emailVerified:R,displayName:y,isAnonymous:L,photoURL:w,phoneNumber:T,tenantId:P,stsTokenManager:f,createdAt:E,lastLoginAt:x});return M&&Array.isArray(M)&&(v.providerData=M.map(_=>Object.assign({},_))),I&&(v._redirectEventId=I),v}static async _fromIdTokenResponse(e,n,r=!1){const s=new gi;s.updateFromServerResponse(n);const i=new En({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await lc(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];he(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Vx(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new gi;c.updateFromIdToken(r);const u=new En({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:a}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new rh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jg=new Map;function Jn(t){or(t instanceof Function,"Expected a class definition");let e=jg.get(t);return e?(or(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,jg.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Fx.type="NONE";const Pg=Fx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tl(t,e,n){return`firebase:${t}:${e}:${n}`}class yi{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Tl(this.userKey,s.apiKey,i),this.fullPersistenceKey=Tl("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await ac(this.auth,{idToken:e}).catch(()=>{});return n?En._fromGetAccountInfoResponse(this.auth,n,e):null}return En._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new yi(Jn(Pg),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Jn(Pg);const a=Tl(r,e.config.apiKey,e.name);let c=null;for(const d of n)try{const p=await d._get(a);if(p){let y;if(typeof p=="string"){const m=await ac(e,{idToken:p}).catch(()=>{});if(!m)break;y=await En._fromGetAccountInfoResponse(e,m,p)}else y=En._fromJSON(e,p);d!==i&&(c=y),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new yi(i,e,r):(i=u[0],c&&await i._set(a,c.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(a)}catch{}})),new yi(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if($x(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ux(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Hx(e))return"Blackberry";if(Wx(e))return"Webos";if(zx(e))return"Safari";if((e.includes("chrome/")||Bx(e))&&!e.includes("edge/"))return"Chrome";if(qx(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Ux(t=Dt()){return/firefox\//i.test(t)}function zx(t=Dt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Bx(t=Dt()){return/crios\//i.test(t)}function $x(t=Dt()){return/iemobile/i.test(t)}function qx(t=Dt()){return/android/i.test(t)}function Hx(t=Dt()){return/blackberry/i.test(t)}function Wx(t=Dt()){return/webos/i.test(t)}function Sf(t=Dt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function PS(t=Dt()){var e;return Sf(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function RS(){return KN()&&document.documentMode===10}function Gx(t=Dt()){return Sf(t)||qx(t)||Wx(t)||Hx(t)||/windows phone/i.test(t)||$x(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(t,e=[]){let n;switch(t){case"Browser":n=Rg(Dt());break;case"Worker":n=`${Rg(Dt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Vi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DS{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((a,c)=>{try{const u=e(i);a(u)}catch(u){c(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OS(t,e={}){return Fi(t,"GET","/v2/passwordPolicy",Vc(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LS=6;class MS{constructor(e){var n,r,s,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:LS,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,a,c;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(a=u.containsNumericCharacter)!==null&&a!==void 0?a:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Dg(this),this.idTokenSubscription=new Dg(this),this.beforeStateQueue=new DS(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Px,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Jn(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await yi.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await ac(this,{idToken:e}),r=await En._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(bn(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,c=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!a||a===c)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return he(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await lc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=xS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(bn(this.app))return Promise.reject(Ur(this));const n=e?Ot(e):null;return n&&he(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&he(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return bn(this.app)?Promise.reject(Ur(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return bn(this.app)?Promise.reject(Ur(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Jn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await OS(this),n=new MS(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ga("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await jS(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Jn(e)||this._popupRedirectResolver;he(n,this,"argument-error"),this.redirectPersistenceManager=await yi.create(this,[Jn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(he(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{a=!0,u()}}else{const u=e.addObserver(n);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return he(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Kx(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;if(bn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&gS(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Fc(t){return Ot(t)}class Dg{constructor(e){this.auth=e,this.observer=null,this.addObserver=nT(n=>this.observer=n)}get next(){return he(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let If={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function FS(t){If=t}function US(t){return If.loadJS(t)}function zS(){return If.gapiScript}function BS(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $S(t,e){const n=_f(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(As(i,e??{}))return s;ir(s,"already-initialized")}return n.initialize({options:e})}function qS(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Jn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function HS(t,e,n){const r=Fc(t);he(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Qx(e),{host:a,port:c}=WS(e),u=c===null?"":`:${c}`,d={url:`${i}//${a}${u}/`},p=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){he(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),he(As(d,r.config.emulator)&&As(p,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=p,r.settings.appVerificationDisabledForTesting=!0,Mi(a)?(Ex(`${i}//${a}${u}`),Nx("Auth",!0)):GS()}function Qx(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function WS(t){const e=Qx(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Og(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:Og(a)}}}function Og(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function GS(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xx{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Yn("not implemented")}_getIdTokenResponse(e){return Yn("not implemented")}_linkToIdToken(e,n){return Yn("not implemented")}_getReauthenticationResolver(e){return Yn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vi(t,e){return Lx(t,"POST","/v1/accounts:signInWithIdp",Vc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KS="http://localhost";class Ps extends Xx{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ps(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ir("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=bf(n,["providerId","signInMethod"]);if(!r||!s)return null;const a=new Ps(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return vi(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,vi(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,vi(e,n)}buildRequest(){const e={requestUri:KS,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ya(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yx{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa extends Yx{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br extends xa{constructor(){super("facebook.com")}static credential(e){return Ps._fromParams({providerId:br.PROVIDER_ID,signInMethod:br.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return br.credentialFromTaggedObject(e)}static credentialFromError(e){return br.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return br.credential(e.oauthAccessToken)}catch{return null}}}br.FACEBOOK_SIGN_IN_METHOD="facebook.com";br.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er extends xa{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ps._fromParams({providerId:Er.PROVIDER_ID,signInMethod:Er.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Er.credentialFromTaggedObject(e)}static credentialFromError(e){return Er.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Er.credential(n,r)}catch{return null}}}Er.GOOGLE_SIGN_IN_METHOD="google.com";Er.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr extends xa{constructor(){super("github.com")}static credential(e){return Ps._fromParams({providerId:Nr.PROVIDER_ID,signInMethod:Nr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Nr.credentialFromTaggedObject(e)}static credentialFromError(e){return Nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Nr.credential(e.oauthAccessToken)}catch{return null}}}Nr.GITHUB_SIGN_IN_METHOD="github.com";Nr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr extends xa{constructor(){super("twitter.com")}static credential(e,n){return Ps._fromParams({providerId:Tr.PROVIDER_ID,signInMethod:Tr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Tr.credentialFromTaggedObject(e)}static credentialFromError(e){return Tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Tr.credential(n,r)}catch{return null}}}Tr.TWITTER_SIGN_IN_METHOD="twitter.com";Tr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QS(t,e){return Lx(t,"POST","/v1/accounts:signUp",Vc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await En._fromIdTokenResponse(e,r,s),a=Lg(r);return new Gr({user:i,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Lg(r);return new Gr({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Lg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XS(t){var e;if(bn(t.app))return Promise.reject(Ur(t));const n=Fc(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new Gr({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await QS(n,{returnSecureToken:!0}),s=await Gr._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc extends ur{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,cc.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new cc(e,n,r,s)}}function Jx(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?cc._fromErrorAndOperation(t,i,e,r):i})}async function YS(t,e,n=!1){const r=await ta(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Gr._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JS(t,e,n=!1){const{auth:r}=t;if(bn(r.app))return Promise.reject(Ur(r));const s="reauthenticate";try{const i=await ta(t,Jx(r,s,e,t),n);he(i.idToken,r,"internal-error");const a=Tf(i.idToken);he(a,r,"internal-error");const{sub:c}=a;return he(t.uid===c,r,"user-mismatch"),Gr._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&ir(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZS(t,e,n=!1){if(bn(t.app))return Promise.reject(Ur(t));const r="signIn",s=await Jx(t,r,e),i=await Gr._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function eI(t,e,n,r){return Ot(t).onIdTokenChanged(e,n,r)}function tI(t,e,n){return Ot(t).beforeAuthStateChanged(e,n)}const uc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zx{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(uc,"1"),this.storage.removeItem(uc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nI=1e3,rI=10;class ew extends Zx{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Gx(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);RS()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,rI):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},nI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}ew.type="LOCAL";const sI=ew;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw extends Zx{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}tw.type="SESSION";const nw=tw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iI(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Uc(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(a).map(async d=>d(n.origin,i)),u=await iI(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Uc.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cf(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((c,u)=>{const d=Cf("",20);s.port1.start();const p=setTimeout(()=>{u(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(y){const m=y;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(p),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(m.data.response);break;default:clearTimeout(p),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mn(){return window}function aI(t){Mn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rw(){return typeof Mn().WorkerGlobalScope<"u"&&typeof Mn().importScripts=="function"}async function lI(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function cI(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function uI(){return rw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sw="firebaseLocalStorageDb",dI=1,dc="firebaseLocalStorage",iw="fbase_key";class wa{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function zc(t,e){return t.transaction([dc],e?"readwrite":"readonly").objectStore(dc)}function hI(){const t=indexedDB.deleteDatabase(sw);return new wa(t).toPromise()}function sh(){const t=indexedDB.open(sw,dI);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(dc,{keyPath:iw})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(dc)?e(r):(r.close(),await hI(),e(await sh()))})})}async function Mg(t,e,n){const r=zc(t,!0).put({[iw]:e,value:n});return new wa(r).toPromise()}async function fI(t,e){const n=zc(t,!1).get(e),r=await new wa(n).toPromise();return r===void 0?null:r.value}function Vg(t,e){const n=zc(t,!0).delete(e);return new wa(n).toPromise()}const pI=800,mI=3;class ow{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await sh(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>mI)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return rw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Uc._getInstance(uI()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await lI(),!this.activeServiceWorker)return;this.sender=new oI(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||cI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await sh();return await Mg(e,uc,"1"),await Vg(e,uc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Mg(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>fI(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Vg(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=zc(s,!1).getAll();return new wa(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),pI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ow.type="LOCAL";const gI=ow;new va(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yI(t,e){return e?Jn(e):(he(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf extends Xx{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return vi(e,this._buildIdpRequest())}_linkToIdToken(e,n){return vi(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return vi(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function vI(t){return ZS(t.auth,new kf(t),t.bypassAuthState)}function xI(t){const{auth:e,user:n}=t;return he(n,e,"internal-error"),JS(n,new kf(t),t.bypassAuthState)}async function wI(t){const{auth:e,user:n}=t;return he(n,e,"internal-error"),YS(n,new kf(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return vI;case"linkViaPopup":case"linkViaRedirect":return wI;case"reauthViaPopup":case"reauthViaRedirect":return xI;default:ir(this.auth,"internal-error")}}resolve(e){or(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){or(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I=new va(2e3,1e4);class li extends aw{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,li.currentPopupAction&&li.currentPopupAction.cancel(),li.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return he(e,this.auth,"internal-error"),e}async onExecution(){or(this.filter.length===1,"Popup operations only handle one event");const e=Cf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ln(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ln(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,li.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ln(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,_I.get())};e()}}li.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bI="pendingRedirect",Sl=new Map;class EI extends aw{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Sl.get(this.auth._key());if(!e){try{const r=await NI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Sl.set(this.auth._key(),e)}return this.bypassAuthState||Sl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function NI(t,e){const n=II(e),r=SI(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function TI(t,e){Sl.set(t._key(),e)}function SI(t){return Jn(t._redirectPersistence)}function II(t){return Tl(bI,t.config.apiKey,t.name)}async function CI(t,e,n=!1){if(bn(t.app))return Promise.reject(Ur(t));const r=Fc(t),s=yI(r,e),a=await new EI(r,s,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kI=10*60*1e3;class AI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!jI(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!lw(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Ln(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=kI&&this.cachedEventUids.clear(),this.cachedEventUids.has(Fg(e))}saveEventToCache(e){this.cachedEventUids.add(Fg(e)),this.lastProcessedEventTime=Date.now()}}function Fg(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function lw({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function jI(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return lw(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PI(t,e={}){return Fi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,DI=/^https?/;async function OI(t){if(t.config.emulator)return;const{authorizedDomains:e}=await PI(t);for(const n of e)try{if(LI(n))return}catch{}ir(t,"unauthorized-domain")}function LI(t){const e=nh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!DI.test(n))return!1;if(RI.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MI=new va(3e4,6e4);function Ug(){const t=Mn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function VI(t){return new Promise((e,n)=>{var r,s,i;function a(){Ug(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ug(),n(Ln(t,"network-request-failed"))},timeout:MI.get()})}if(!((s=(r=Mn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Mn().gapi)===null||i===void 0)&&i.load)a();else{const c=BS("iframefcb");return Mn()[c]=()=>{gapi.load?a():n(Ln(t,"network-request-failed"))},US(`${zS()}?onload=${c}`).catch(u=>n(u))}}).catch(e=>{throw Il=null,e})}let Il=null;function FI(t){return Il=Il||VI(t),Il}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI=new va(5e3,15e3),zI="__/auth/iframe",BI="emulator/auth/iframe",$I={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},qI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function HI(t){const e=t.config;he(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Nf(e,BI):`https://${t.config.authDomain}/${zI}`,r={apiKey:e.apiKey,appName:t.name,v:Vi},s=qI.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${ya(r).slice(1)}`}async function WI(t){const e=await FI(t),n=Mn().gapi;return he(n,t,"internal-error"),e.open({where:document.body,url:HI(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$I,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=Ln(t,"network-request-failed"),c=Mn().setTimeout(()=>{i(a)},UI.get());function u(){Mn().clearTimeout(c),s(r)}r.ping(u).then(u,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},KI=500,QI=600,XI="_blank",YI="http://localhost";class zg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function JI(t,e,n,r=KI,s=QI){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},GI),{width:r.toString(),height:s.toString(),top:i,left:a}),d=Dt().toLowerCase();n&&(c=Bx(d)?XI:n),Ux(d)&&(e=e||YI,u.scrollbars="yes");const p=Object.entries(u).reduce((m,[T,w])=>`${m}${T}=${w},`,"");if(PS(d)&&c!=="_self")return ZI(e||"",c),new zg(null);const y=window.open(e||"",c,p);he(y,t,"popup-blocked");try{y.focus()}catch{}return new zg(y)}function ZI(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eC="__/auth/handler",tC="emulator/auth/handler",nC=encodeURIComponent("fac");async function Bg(t,e,n,r,s,i){he(t.config.authDomain,t,"auth-domain-config-required"),he(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Vi,eventId:s};if(e instanceof Yx){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",tT(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,y]of Object.entries({}))a[p]=y}if(e instanceof xa){const p=e.getScopes().filter(y=>y!=="");p.length>0&&(a.scopes=p.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const p of Object.keys(c))c[p]===void 0&&delete c[p];const u=await t._getAppCheckToken(),d=u?`#${nC}=${encodeURIComponent(u)}`:"";return`${rC(t)}?${ya(c).slice(1)}${d}`}function rC({config:t}){return t.emulator?Nf(t,tC):`https://${t.authDomain}/${eC}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ed="webStorageSupport";class sC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=nw,this._completeRedirectFn=CI,this._overrideRedirectResult=TI}async _openPopup(e,n,r,s){var i;or((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await Bg(e,n,r,nh(),s);return JI(e,a,Cf())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Bg(e,n,r,nh(),s);return aI(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(or(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await WI(e),r=new AI(e);return n.register("authEvent",s=>(he(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(ed,{type:ed},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[ed];a!==void 0&&n(!!a),ir(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=OI(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Gx()||zx()||Sf()}}const iC=sC;var $g="@firebase/auth",qg="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){he(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aC(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function lC(t){Ii(new js("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;he(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Kx(t)},d=new VS(r,s,i,u);return qS(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ii(new js("auth-internal",e=>{const n=Fc(e.getProvider("auth").getImmediate());return(r=>new oC(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fr($g,qg,aC(t)),Fr($g,qg,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cC=5*60,uC=bx("authIdTokenMaxAge")||cC;let Hg=null;const dC=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>uC)return;const s=n==null?void 0:n.token;Hg!==s&&(Hg=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function hC(t=Cx()){const e=_f(t,"auth");if(e.isInitialized())return e.getImmediate();const n=$S(t,{popupRedirectResolver:iC,persistence:[gI,sI,nw]}),r=bx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=dC(i.toString());tI(n,a,()=>a(n.currentUser)),eI(n,c=>a(c))}}const s=wx("auth");return s&&HS(n,`http://${s}`),n}function fC(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}FS({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Ln("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",fC().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});lC("Browser");var Wg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var zr,cw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,f){function v(){}v.prototype=f.prototype,N.D=f.prototype,N.prototype=new v,N.prototype.constructor=N,N.C=function(_,k,j){for(var C=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)C[ge-2]=arguments[ge];return f.prototype[k].apply(_,C)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(N,f,v){v||(v=0);var _=Array(16);if(typeof f=="string")for(var k=0;16>k;++k)_[k]=f.charCodeAt(v++)|f.charCodeAt(v++)<<8|f.charCodeAt(v++)<<16|f.charCodeAt(v++)<<24;else for(k=0;16>k;++k)_[k]=f[v++]|f[v++]<<8|f[v++]<<16|f[v++]<<24;f=N.g[0],v=N.g[1],k=N.g[2];var j=N.g[3],C=f+(j^v&(k^j))+_[0]+3614090360&4294967295;f=v+(C<<7&4294967295|C>>>25),C=j+(k^f&(v^k))+_[1]+3905402710&4294967295,j=f+(C<<12&4294967295|C>>>20),C=k+(v^j&(f^v))+_[2]+606105819&4294967295,k=j+(C<<17&4294967295|C>>>15),C=v+(f^k&(j^f))+_[3]+3250441966&4294967295,v=k+(C<<22&4294967295|C>>>10),C=f+(j^v&(k^j))+_[4]+4118548399&4294967295,f=v+(C<<7&4294967295|C>>>25),C=j+(k^f&(v^k))+_[5]+1200080426&4294967295,j=f+(C<<12&4294967295|C>>>20),C=k+(v^j&(f^v))+_[6]+2821735955&4294967295,k=j+(C<<17&4294967295|C>>>15),C=v+(f^k&(j^f))+_[7]+4249261313&4294967295,v=k+(C<<22&4294967295|C>>>10),C=f+(j^v&(k^j))+_[8]+1770035416&4294967295,f=v+(C<<7&4294967295|C>>>25),C=j+(k^f&(v^k))+_[9]+2336552879&4294967295,j=f+(C<<12&4294967295|C>>>20),C=k+(v^j&(f^v))+_[10]+4294925233&4294967295,k=j+(C<<17&4294967295|C>>>15),C=v+(f^k&(j^f))+_[11]+2304563134&4294967295,v=k+(C<<22&4294967295|C>>>10),C=f+(j^v&(k^j))+_[12]+1804603682&4294967295,f=v+(C<<7&4294967295|C>>>25),C=j+(k^f&(v^k))+_[13]+4254626195&4294967295,j=f+(C<<12&4294967295|C>>>20),C=k+(v^j&(f^v))+_[14]+2792965006&4294967295,k=j+(C<<17&4294967295|C>>>15),C=v+(f^k&(j^f))+_[15]+1236535329&4294967295,v=k+(C<<22&4294967295|C>>>10),C=f+(k^j&(v^k))+_[1]+4129170786&4294967295,f=v+(C<<5&4294967295|C>>>27),C=j+(v^k&(f^v))+_[6]+3225465664&4294967295,j=f+(C<<9&4294967295|C>>>23),C=k+(f^v&(j^f))+_[11]+643717713&4294967295,k=j+(C<<14&4294967295|C>>>18),C=v+(j^f&(k^j))+_[0]+3921069994&4294967295,v=k+(C<<20&4294967295|C>>>12),C=f+(k^j&(v^k))+_[5]+3593408605&4294967295,f=v+(C<<5&4294967295|C>>>27),C=j+(v^k&(f^v))+_[10]+38016083&4294967295,j=f+(C<<9&4294967295|C>>>23),C=k+(f^v&(j^f))+_[15]+3634488961&4294967295,k=j+(C<<14&4294967295|C>>>18),C=v+(j^f&(k^j))+_[4]+3889429448&4294967295,v=k+(C<<20&4294967295|C>>>12),C=f+(k^j&(v^k))+_[9]+568446438&4294967295,f=v+(C<<5&4294967295|C>>>27),C=j+(v^k&(f^v))+_[14]+3275163606&4294967295,j=f+(C<<9&4294967295|C>>>23),C=k+(f^v&(j^f))+_[3]+4107603335&4294967295,k=j+(C<<14&4294967295|C>>>18),C=v+(j^f&(k^j))+_[8]+1163531501&4294967295,v=k+(C<<20&4294967295|C>>>12),C=f+(k^j&(v^k))+_[13]+2850285829&4294967295,f=v+(C<<5&4294967295|C>>>27),C=j+(v^k&(f^v))+_[2]+4243563512&4294967295,j=f+(C<<9&4294967295|C>>>23),C=k+(f^v&(j^f))+_[7]+1735328473&4294967295,k=j+(C<<14&4294967295|C>>>18),C=v+(j^f&(k^j))+_[12]+2368359562&4294967295,v=k+(C<<20&4294967295|C>>>12),C=f+(v^k^j)+_[5]+4294588738&4294967295,f=v+(C<<4&4294967295|C>>>28),C=j+(f^v^k)+_[8]+2272392833&4294967295,j=f+(C<<11&4294967295|C>>>21),C=k+(j^f^v)+_[11]+1839030562&4294967295,k=j+(C<<16&4294967295|C>>>16),C=v+(k^j^f)+_[14]+4259657740&4294967295,v=k+(C<<23&4294967295|C>>>9),C=f+(v^k^j)+_[1]+2763975236&4294967295,f=v+(C<<4&4294967295|C>>>28),C=j+(f^v^k)+_[4]+1272893353&4294967295,j=f+(C<<11&4294967295|C>>>21),C=k+(j^f^v)+_[7]+4139469664&4294967295,k=j+(C<<16&4294967295|C>>>16),C=v+(k^j^f)+_[10]+3200236656&4294967295,v=k+(C<<23&4294967295|C>>>9),C=f+(v^k^j)+_[13]+681279174&4294967295,f=v+(C<<4&4294967295|C>>>28),C=j+(f^v^k)+_[0]+3936430074&4294967295,j=f+(C<<11&4294967295|C>>>21),C=k+(j^f^v)+_[3]+3572445317&4294967295,k=j+(C<<16&4294967295|C>>>16),C=v+(k^j^f)+_[6]+76029189&4294967295,v=k+(C<<23&4294967295|C>>>9),C=f+(v^k^j)+_[9]+3654602809&4294967295,f=v+(C<<4&4294967295|C>>>28),C=j+(f^v^k)+_[12]+3873151461&4294967295,j=f+(C<<11&4294967295|C>>>21),C=k+(j^f^v)+_[15]+530742520&4294967295,k=j+(C<<16&4294967295|C>>>16),C=v+(k^j^f)+_[2]+3299628645&4294967295,v=k+(C<<23&4294967295|C>>>9),C=f+(k^(v|~j))+_[0]+4096336452&4294967295,f=v+(C<<6&4294967295|C>>>26),C=j+(v^(f|~k))+_[7]+1126891415&4294967295,j=f+(C<<10&4294967295|C>>>22),C=k+(f^(j|~v))+_[14]+2878612391&4294967295,k=j+(C<<15&4294967295|C>>>17),C=v+(j^(k|~f))+_[5]+4237533241&4294967295,v=k+(C<<21&4294967295|C>>>11),C=f+(k^(v|~j))+_[12]+1700485571&4294967295,f=v+(C<<6&4294967295|C>>>26),C=j+(v^(f|~k))+_[3]+2399980690&4294967295,j=f+(C<<10&4294967295|C>>>22),C=k+(f^(j|~v))+_[10]+4293915773&4294967295,k=j+(C<<15&4294967295|C>>>17),C=v+(j^(k|~f))+_[1]+2240044497&4294967295,v=k+(C<<21&4294967295|C>>>11),C=f+(k^(v|~j))+_[8]+1873313359&4294967295,f=v+(C<<6&4294967295|C>>>26),C=j+(v^(f|~k))+_[15]+4264355552&4294967295,j=f+(C<<10&4294967295|C>>>22),C=k+(f^(j|~v))+_[6]+2734768916&4294967295,k=j+(C<<15&4294967295|C>>>17),C=v+(j^(k|~f))+_[13]+1309151649&4294967295,v=k+(C<<21&4294967295|C>>>11),C=f+(k^(v|~j))+_[4]+4149444226&4294967295,f=v+(C<<6&4294967295|C>>>26),C=j+(v^(f|~k))+_[11]+3174756917&4294967295,j=f+(C<<10&4294967295|C>>>22),C=k+(f^(j|~v))+_[2]+718787259&4294967295,k=j+(C<<15&4294967295|C>>>17),C=v+(j^(k|~f))+_[9]+3951481745&4294967295,N.g[0]=N.g[0]+f&4294967295,N.g[1]=N.g[1]+(k+(C<<21&4294967295|C>>>11))&4294967295,N.g[2]=N.g[2]+k&4294967295,N.g[3]=N.g[3]+j&4294967295}r.prototype.u=function(N,f){f===void 0&&(f=N.length);for(var v=f-this.blockSize,_=this.B,k=this.h,j=0;j<f;){if(k==0)for(;j<=v;)s(this,N,j),j+=this.blockSize;if(typeof N=="string"){for(;j<f;)if(_[k++]=N.charCodeAt(j++),k==this.blockSize){s(this,_),k=0;break}}else for(;j<f;)if(_[k++]=N[j++],k==this.blockSize){s(this,_),k=0;break}}this.h=k,this.o+=f},r.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var f=1;f<N.length-8;++f)N[f]=0;var v=8*this.o;for(f=N.length-8;f<N.length;++f)N[f]=v&255,v/=256;for(this.u(N),N=Array(16),f=v=0;4>f;++f)for(var _=0;32>_;_+=8)N[v++]=this.g[f]>>>_&255;return N};function i(N,f){var v=c;return Object.prototype.hasOwnProperty.call(v,N)?v[N]:v[N]=f(N)}function a(N,f){this.h=f;for(var v=[],_=!0,k=N.length-1;0<=k;k--){var j=N[k]|0;_&&j==f||(v[k]=j,_=!1)}this.g=v}var c={};function u(N){return-128<=N&&128>N?i(N,function(f){return new a([f|0],0>f?-1:0)}):new a([N|0],0>N?-1:0)}function d(N){if(isNaN(N)||!isFinite(N))return y;if(0>N)return I(d(-N));for(var f=[],v=1,_=0;N>=v;_++)f[_]=N/v|0,v*=4294967296;return new a(f,0)}function p(N,f){if(N.length==0)throw Error("number format error: empty string");if(f=f||10,2>f||36<f)throw Error("radix out of range: "+f);if(N.charAt(0)=="-")return I(p(N.substring(1),f));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=d(Math.pow(f,8)),_=y,k=0;k<N.length;k+=8){var j=Math.min(8,N.length-k),C=parseInt(N.substring(k,k+j),f);8>j?(j=d(Math.pow(f,j)),_=_.j(j).add(d(C))):(_=_.j(v),_=_.add(d(C)))}return _}var y=u(0),m=u(1),T=u(16777216);t=a.prototype,t.m=function(){if(P(this))return-I(this).m();for(var N=0,f=1,v=0;v<this.g.length;v++){var _=this.i(v);N+=(0<=_?_:4294967296+_)*f,f*=4294967296}return N},t.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(w(this))return"0";if(P(this))return"-"+I(this).toString(N);for(var f=d(Math.pow(N,6)),v=this,_="";;){var k=R(v,f).g;v=E(v,k.j(f));var j=((0<v.g.length?v.g[0]:v.h)>>>0).toString(N);if(v=k,w(v))return j+_;for(;6>j.length;)j="0"+j;_=j+_}},t.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function w(N){if(N.h!=0)return!1;for(var f=0;f<N.g.length;f++)if(N.g[f]!=0)return!1;return!0}function P(N){return N.h==-1}t.l=function(N){return N=E(this,N),P(N)?-1:w(N)?0:1};function I(N){for(var f=N.g.length,v=[],_=0;_<f;_++)v[_]=~N.g[_];return new a(v,~N.h).add(m)}t.abs=function(){return P(this)?I(this):this},t.add=function(N){for(var f=Math.max(this.g.length,N.g.length),v=[],_=0,k=0;k<=f;k++){var j=_+(this.i(k)&65535)+(N.i(k)&65535),C=(j>>>16)+(this.i(k)>>>16)+(N.i(k)>>>16);_=C>>>16,j&=65535,C&=65535,v[k]=C<<16|j}return new a(v,v[v.length-1]&-2147483648?-1:0)};function E(N,f){return N.add(I(f))}t.j=function(N){if(w(this)||w(N))return y;if(P(this))return P(N)?I(this).j(I(N)):I(I(this).j(N));if(P(N))return I(this.j(I(N)));if(0>this.l(T)&&0>N.l(T))return d(this.m()*N.m());for(var f=this.g.length+N.g.length,v=[],_=0;_<2*f;_++)v[_]=0;for(_=0;_<this.g.length;_++)for(var k=0;k<N.g.length;k++){var j=this.i(_)>>>16,C=this.i(_)&65535,ge=N.i(k)>>>16,ae=N.i(k)&65535;v[2*_+2*k]+=C*ae,x(v,2*_+2*k),v[2*_+2*k+1]+=j*ae,x(v,2*_+2*k+1),v[2*_+2*k+1]+=C*ge,x(v,2*_+2*k+1),v[2*_+2*k+2]+=j*ge,x(v,2*_+2*k+2)}for(_=0;_<f;_++)v[_]=v[2*_+1]<<16|v[2*_];for(_=f;_<2*f;_++)v[_]=0;return new a(v,0)};function x(N,f){for(;(N[f]&65535)!=N[f];)N[f+1]+=N[f]>>>16,N[f]&=65535,f++}function b(N,f){this.g=N,this.h=f}function R(N,f){if(w(f))throw Error("division by zero");if(w(N))return new b(y,y);if(P(N))return f=R(I(N),f),new b(I(f.g),I(f.h));if(P(f))return f=R(N,I(f)),new b(I(f.g),f.h);if(30<N.g.length){if(P(N)||P(f))throw Error("slowDivide_ only works with positive integers.");for(var v=m,_=f;0>=_.l(N);)v=L(v),_=L(_);var k=M(v,1),j=M(_,1);for(_=M(_,2),v=M(v,2);!w(_);){var C=j.add(_);0>=C.l(N)&&(k=k.add(v),j=C),_=M(_,1),v=M(v,1)}return f=E(N,k.j(f)),new b(k,f)}for(k=y;0<=N.l(f);){for(v=Math.max(1,Math.floor(N.m()/f.m())),_=Math.ceil(Math.log(v)/Math.LN2),_=48>=_?1:Math.pow(2,_-48),j=d(v),C=j.j(f);P(C)||0<C.l(N);)v-=_,j=d(v),C=j.j(f);w(j)&&(j=m),k=k.add(j),N=E(N,C)}return new b(k,N)}t.A=function(N){return R(this,N).h},t.and=function(N){for(var f=Math.max(this.g.length,N.g.length),v=[],_=0;_<f;_++)v[_]=this.i(_)&N.i(_);return new a(v,this.h&N.h)},t.or=function(N){for(var f=Math.max(this.g.length,N.g.length),v=[],_=0;_<f;_++)v[_]=this.i(_)|N.i(_);return new a(v,this.h|N.h)},t.xor=function(N){for(var f=Math.max(this.g.length,N.g.length),v=[],_=0;_<f;_++)v[_]=this.i(_)^N.i(_);return new a(v,this.h^N.h)};function L(N){for(var f=N.g.length+1,v=[],_=0;_<f;_++)v[_]=N.i(_)<<1|N.i(_-1)>>>31;return new a(v,N.h)}function M(N,f){var v=f>>5;f%=32;for(var _=N.g.length-v,k=[],j=0;j<_;j++)k[j]=0<f?N.i(j+v)>>>f|N.i(j+v+1)<<32-f:N.i(j+v);return new a(k,N.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,cw=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,zr=a}).apply(typeof Wg<"u"?Wg:typeof self<"u"?self:typeof window<"u"?window:{});var al=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var uw,yo,dw,Cl,ih,hw,fw,pw;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,g){return l==Array.prototype||l==Object.prototype||(l[h]=g.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof al=="object"&&al];for(var h=0;h<l.length;++h){var g=l[h];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(l,h){if(h)e:{var g=r;l=l.split(".");for(var S=0;S<l.length-1;S++){var D=l[S];if(!(D in g))break e;g=g[D]}l=l[l.length-1],S=g[l],h=h(S),h!=S&&h!=null&&e(g,l,{configurable:!0,writable:!0,value:h})}}function i(l,h){l instanceof String&&(l+="");var g=0,S=!1,D={next:function(){if(!S&&g<l.length){var U=g++;return{value:h(U,l[U]),done:!1}}return S=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}s("Array.prototype.values",function(l){return l||function(){return i(this,function(h,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},c=this||self;function u(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function d(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function p(l,h,g){return l.call.apply(l.bind,arguments)}function y(l,h,g){if(!l)throw Error();if(2<arguments.length){var S=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,S),l.apply(h,D)}}return function(){return l.apply(h,arguments)}}function m(l,h,g){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:y,m.apply(null,arguments)}function T(l,h){var g=Array.prototype.slice.call(arguments,1);return function(){var S=g.slice();return S.push.apply(S,arguments),l.apply(this,S)}}function w(l,h){function g(){}g.prototype=h.prototype,l.aa=h.prototype,l.prototype=new g,l.prototype.constructor=l,l.Qb=function(S,D,U){for(var Y=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)Y[Me-2]=arguments[Me];return h.prototype[D].apply(S,Y)}}function P(l){const h=l.length;if(0<h){const g=Array(h);for(let S=0;S<h;S++)g[S]=l[S];return g}return[]}function I(l,h){for(let g=1;g<arguments.length;g++){const S=arguments[g];if(u(S)){const D=l.length||0,U=S.length||0;l.length=D+U;for(let Y=0;Y<U;Y++)l[D+Y]=S[Y]}else l.push(S)}}class E{constructor(h,g){this.i=h,this.j=g,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function x(l){return/^[\s\xa0]*$/.test(l)}function b(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function R(l){return R[" "](l),l}R[" "]=function(){};var L=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function M(l,h,g){for(const S in l)h.call(g,l[S],S,l)}function N(l,h){for(const g in l)h.call(void 0,l[g],g,l)}function f(l){const h={};for(const g in l)h[g]=l[g];return h}const v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _(l,h){let g,S;for(let D=1;D<arguments.length;D++){S=arguments[D];for(g in S)l[g]=S[g];for(let U=0;U<v.length;U++)g=v[U],Object.prototype.hasOwnProperty.call(S,g)&&(l[g]=S[g])}}function k(l){var h=1;l=l.split(":");const g=[];for(;0<h&&l.length;)g.push(l.shift()),h--;return l.length&&g.push(l.join(":")),g}function j(l){c.setTimeout(()=>{throw l},0)}function C(){var l=$;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class ge{constructor(){this.h=this.g=null}add(h,g){const S=ae.get();S.set(h,g),this.h?this.h.next=S:this.g=S,this.h=S}}var ae=new E(()=>new Se,l=>l.reset());class Se{constructor(){this.next=this.g=this.h=null}set(h,g){this.h=h,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let ne,O=!1,$=new ge,ee=()=>{const l=c.Promise.resolve(void 0);ne=()=>{l.then(X)}};var X=()=>{for(var l;l=C();){try{l.h.call(l.g)}catch(g){j(g)}var h=ae;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}O=!1};function J(){this.s=this.s,this.C=this.C}J.prototype.s=!1,J.prototype.ma=function(){this.s||(this.s=!0,this.N())},J.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function A(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}A.prototype.h=function(){this.defaultPrevented=!0};var H=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};c.addEventListener("test",g,h),c.removeEventListener("test",g,h)}catch{}return l}();function K(l,h){if(A.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var g=this.type=l.type,S=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(L){e:{try{R(h.nodeName);var D=!0;break e}catch{}D=!1}D||(h=null)}}else g=="mouseover"?h=l.fromElement:g=="mouseout"&&(h=l.toElement);this.relatedTarget=h,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:V[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&K.aa.h.call(this)}}w(K,A);var V={2:"touch",3:"pen",4:"mouse"};K.prototype.h=function(){K.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var z="closure_listenable_"+(1e6*Math.random()|0),G=0;function se(l,h,g,S,D){this.listener=l,this.proxy=null,this.src=h,this.type=g,this.capture=!!S,this.ha=D,this.key=++G,this.da=this.fa=!1}function ue(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Z(l){this.src=l,this.g={},this.h=0}Z.prototype.add=function(l,h,g,S,D){var U=l.toString();l=this.g[U],l||(l=this.g[U]=[],this.h++);var Y=we(l,h,S,D);return-1<Y?(h=l[Y],g||(h.fa=!1)):(h=new se(h,this.src,U,!!S,D),h.fa=g,l.push(h)),h};function ye(l,h){var g=h.type;if(g in l.g){var S=l.g[g],D=Array.prototype.indexOf.call(S,h,void 0),U;(U=0<=D)&&Array.prototype.splice.call(S,D,1),U&&(ue(h),l.g[g].length==0&&(delete l.g[g],l.h--))}}function we(l,h,g,S){for(var D=0;D<l.length;++D){var U=l[D];if(!U.da&&U.listener==h&&U.capture==!!g&&U.ha==S)return D}return-1}var _e="closure_lm_"+(1e6*Math.random()|0),ve={};function le(l,h,g,S,D){if(Array.isArray(h)){for(var U=0;U<h.length;U++)le(l,h[U],g,S,D);return null}return g=ze(g),l&&l[z]?l.K(h,g,d(S)?!!S.capture:!1,D):Lt(l,h,g,!1,S,D)}function Lt(l,h,g,S,D,U){if(!h)throw Error("Invalid event type");var Y=d(D)?!!D.capture:!!D,Me=mn(l);if(Me||(l[_e]=Me=new Z(l)),g=Me.add(h,g,S,Y,U),g.proxy)return g;if(S=pe(),g.proxy=S,S.src=l,S.listener=g,l.addEventListener)H||(D=Y),D===void 0&&(D=!1),l.addEventListener(h.toString(),S,D);else if(l.attachEvent)l.attachEvent(Yt(h.toString()),S);else if(l.addListener&&l.removeListener)l.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return g}function pe(){function l(g){return h.call(l.src,l.listener,g)}const h=Bt;return l}function Oe(l,h,g,S,D){if(Array.isArray(h))for(var U=0;U<h.length;U++)Oe(l,h[U],g,S,D);else S=d(S)?!!S.capture:!!S,g=ze(g),l&&l[z]?(l=l.i,h=String(h).toString(),h in l.g&&(U=l.g[h],g=we(U,g,S,D),-1<g&&(ue(U[g]),Array.prototype.splice.call(U,g,1),U.length==0&&(delete l.g[h],l.h--)))):l&&(l=mn(l))&&(h=l.g[h.toString()],l=-1,h&&(l=we(h,g,S,D)),(g=-1<l?h[l]:null)&&gt(g))}function gt(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[z])ye(h.i,l);else{var g=l.type,S=l.proxy;h.removeEventListener?h.removeEventListener(g,S,l.capture):h.detachEvent?h.detachEvent(Yt(g),S):h.addListener&&h.removeListener&&h.removeListener(S),(g=mn(h))?(ye(g,l),g.h==0&&(g.src=null,h[_e]=null)):ue(l)}}}function Yt(l){return l in ve?ve[l]:ve[l]="on"+l}function Bt(l,h){if(l.da)l=!0;else{h=new K(h,this);var g=l.listener,S=l.ha||l.src;l.fa&&gt(l),l=g.call(S,h)}return l}function mn(l){return l=l[_e],l instanceof Z?l:null}var Ke="__closure_events_fn_"+(1e9*Math.random()>>>0);function ze(l){return typeof l=="function"?l:(l[Ke]||(l[Ke]=function(h){return l.handleEvent(h)}),l[Ke])}function be(){J.call(this),this.i=new Z(this),this.M=this,this.F=null}w(be,J),be.prototype[z]=!0,be.prototype.removeEventListener=function(l,h,g,S){Oe(this,l,h,g,S)};function je(l,h){var g,S=l.F;if(S)for(g=[];S;S=S.F)g.push(S);if(l=l.M,S=h.type||h,typeof h=="string")h=new A(h,l);else if(h instanceof A)h.target=h.target||l;else{var D=h;h=new A(S,l),_(h,D)}if(D=!0,g)for(var U=g.length-1;0<=U;U--){var Y=h.g=g[U];D=Nt(Y,S,!0,h)&&D}if(Y=h.g=l,D=Nt(Y,S,!0,h)&&D,D=Nt(Y,S,!1,h)&&D,g)for(U=0;U<g.length;U++)Y=h.g=g[U],D=Nt(Y,S,!1,h)&&D}be.prototype.N=function(){if(be.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var g=l.g[h],S=0;S<g.length;S++)ue(g[S]);delete l.g[h],l.h--}}this.F=null},be.prototype.K=function(l,h,g,S){return this.i.add(String(l),h,!1,g,S)},be.prototype.L=function(l,h,g,S){return this.i.add(String(l),h,!0,g,S)};function Nt(l,h,g,S){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var D=!0,U=0;U<h.length;++U){var Y=h[U];if(Y&&!Y.da&&Y.capture==g){var Me=Y.listener,yt=Y.ha||Y.src;Y.fa&&ye(l.i,Y),D=Me.call(yt,S)!==!1&&D}}return D&&!S.defaultPrevented}function dr(l,h,g){if(typeof l=="function")g&&(l=m(l,g));else if(l&&typeof l.handleEvent=="function")l=m(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:c.setTimeout(l,h||0)}function as(l){l.g=dr(()=>{l.g=null,l.i&&(l.i=!1,as(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class Q extends J{constructor(h,g){super(),this.m=h,this.l=g,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:as(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ie(l){J.call(this),this.h=l,this.g={}}w(ie,J);var Ie=[];function gn(l){M(l.g,function(h,g){this.g.hasOwnProperty(g)&&gt(h)},l),l.g={}}ie.prototype.N=function(){ie.aa.N.call(this),gn(this)},ie.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Hi=c.JSON.stringify,H_=c.JSON.parse,W_=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function iu(){}iu.prototype.h=null;function gp(l){return l.h||(l.h=l.i())}function yp(){}var Wi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ou(){A.call(this,"d")}w(ou,A);function au(){A.call(this,"c")}w(au,A);var ls={},vp=null;function Ca(){return vp=vp||new be}ls.La="serverreachability";function xp(l){A.call(this,ls.La,l)}w(xp,A);function Gi(l){const h=Ca();je(h,new xp(h))}ls.STAT_EVENT="statevent";function wp(l,h){A.call(this,ls.STAT_EVENT,l),this.stat=h}w(wp,A);function Mt(l){const h=Ca();je(h,new wp(h,l))}ls.Ma="timingevent";function _p(l,h){A.call(this,ls.Ma,l),this.size=h}w(_p,A);function Ki(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},h)}function Qi(){this.g=!0}Qi.prototype.xa=function(){this.g=!1};function G_(l,h,g,S,D,U){l.info(function(){if(l.g)if(U)for(var Y="",Me=U.split("&"),yt=0;yt<Me.length;yt++){var Pe=Me[yt].split("=");if(1<Pe.length){var Tt=Pe[0];Pe=Pe[1];var St=Tt.split("_");Y=2<=St.length&&St[1]=="type"?Y+(Tt+"="+Pe+"&"):Y+(Tt+"=redacted&")}}else Y=null;else Y=U;return"XMLHTTP REQ ("+S+") [attempt "+D+"]: "+h+`
`+g+`
`+Y})}function K_(l,h,g,S,D,U,Y){l.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+D+"]: "+h+`
`+g+`
`+U+" "+Y})}function zs(l,h,g,S){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+X_(l,g)+(S?" "+S:"")})}function Q_(l,h){l.info(function(){return"TIMEOUT: "+h})}Qi.prototype.info=function(){};function X_(l,h){if(!l.g)return h;if(!h)return null;try{var g=JSON.parse(h);if(g){for(l=0;l<g.length;l++)if(Array.isArray(g[l])){var S=g[l];if(!(2>S.length)){var D=S[1];if(Array.isArray(D)&&!(1>D.length)){var U=D[0];if(U!="noop"&&U!="stop"&&U!="close")for(var Y=1;Y<D.length;Y++)D[Y]=""}}}}return Hi(g)}catch{return h}}var ka={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},bp={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},lu;function Aa(){}w(Aa,iu),Aa.prototype.g=function(){return new XMLHttpRequest},Aa.prototype.i=function(){return{}},lu=new Aa;function hr(l,h,g,S){this.j=l,this.i=h,this.l=g,this.R=S||1,this.U=new ie(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ep}function Ep(){this.i=null,this.g="",this.h=!1}var Np={},cu={};function uu(l,h,g){l.L=1,l.v=Da(qn(h)),l.m=g,l.P=!0,Tp(l,null)}function Tp(l,h){l.F=Date.now(),ja(l),l.A=qn(l.v);var g=l.A,S=l.R;Array.isArray(S)||(S=[String(S)]),Fp(g.i,"t",S),l.C=0,g=l.j.J,l.h=new Ep,l.g=rm(l.j,g?h:null,!l.m),0<l.O&&(l.M=new Q(m(l.Y,l,l.g),l.O)),h=l.U,g=l.g,S=l.ca;var D="readystatechange";Array.isArray(D)||(D&&(Ie[0]=D.toString()),D=Ie);for(var U=0;U<D.length;U++){var Y=le(g,D[U],S||h.handleEvent,!1,h.h||h);if(!Y)break;h.g[Y.key]=Y}h=l.H?f(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),Gi(),G_(l.i,l.u,l.A,l.l,l.R,l.m)}hr.prototype.ca=function(l){l=l.target;const h=this.M;h&&Hn(l)==3?h.j():this.Y(l)},hr.prototype.Y=function(l){try{if(l==this.g)e:{const St=Hn(this.g);var h=this.g.Ba();const qs=this.g.Z();if(!(3>St)&&(St!=3||this.g&&(this.h.h||this.g.oa()||Wp(this.g)))){this.J||St!=4||h==7||(h==8||0>=qs?Gi(3):Gi(2)),du(this);var g=this.g.Z();this.X=g;t:if(Sp(this)){var S=Wp(this.g);l="";var D=S.length,U=Hn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){cs(this),Xi(this);var Y="";break t}this.h.i=new c.TextDecoder}for(h=0;h<D;h++)this.h.h=!0,l+=this.h.i.decode(S[h],{stream:!(U&&h==D-1)});S.length=0,this.h.g+=l,this.C=0,Y=this.h.g}else Y=this.g.oa();if(this.o=g==200,K_(this.i,this.u,this.A,this.l,this.R,St,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Me,yt=this.g;if((Me=yt.g?yt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(Me)){var Pe=Me;break t}}Pe=null}if(g=Pe)zs(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,hu(this,g);else{this.o=!1,this.s=3,Mt(12),cs(this),Xi(this);break e}}if(this.P){g=!0;let yn;for(;!this.J&&this.C<Y.length;)if(yn=Y_(this,Y),yn==cu){St==4&&(this.s=4,Mt(14),g=!1),zs(this.i,this.l,null,"[Incomplete Response]");break}else if(yn==Np){this.s=4,Mt(15),zs(this.i,this.l,Y,"[Invalid Chunk]"),g=!1;break}else zs(this.i,this.l,yn,null),hu(this,yn);if(Sp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),St!=4||Y.length!=0||this.h.h||(this.s=1,Mt(16),g=!1),this.o=this.o&&g,!g)zs(this.i,this.l,Y,"[Invalid Chunked Response]"),cs(this),Xi(this);else if(0<Y.length&&!this.W){this.W=!0;var Tt=this.j;Tt.g==this&&Tt.ba&&!Tt.M&&(Tt.j.info("Great, no buffering proxy detected. Bytes received: "+Y.length),vu(Tt),Tt.M=!0,Mt(11))}}else zs(this.i,this.l,Y,null),hu(this,Y);St==4&&cs(this),this.o&&!this.J&&(St==4?Zp(this.j,this):(this.o=!1,ja(this)))}else pb(this.g),g==400&&0<Y.indexOf("Unknown SID")?(this.s=3,Mt(12)):(this.s=0,Mt(13)),cs(this),Xi(this)}}}catch{}finally{}};function Sp(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function Y_(l,h){var g=l.C,S=h.indexOf(`
`,g);return S==-1?cu:(g=Number(h.substring(g,S)),isNaN(g)?Np:(S+=1,S+g>h.length?cu:(h=h.slice(S,S+g),l.C=S+g,h)))}hr.prototype.cancel=function(){this.J=!0,cs(this)};function ja(l){l.S=Date.now()+l.I,Ip(l,l.I)}function Ip(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Ki(m(l.ba,l),h)}function du(l){l.B&&(c.clearTimeout(l.B),l.B=null)}hr.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(Q_(this.i,this.A),this.L!=2&&(Gi(),Mt(17)),cs(this),this.s=2,Xi(this)):Ip(this,this.S-l)};function Xi(l){l.j.G==0||l.J||Zp(l.j,l)}function cs(l){du(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,gn(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function hu(l,h){try{var g=l.j;if(g.G!=0&&(g.g==l||fu(g.h,l))){if(!l.K&&fu(g.h,l)&&g.G==3){try{var S=g.Da.g.parse(h)}catch{S=null}if(Array.isArray(S)&&S.length==3){var D=S;if(D[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<l.F)Ua(g),Va(g);else break e;yu(g),Mt(18)}}else g.za=D[1],0<g.za-g.T&&37500>D[2]&&g.F&&g.v==0&&!g.C&&(g.C=Ki(m(g.Za,g),6e3));if(1>=Ap(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else ds(g,11)}else if((l.K||g.g==l)&&Ua(g),!x(h))for(D=g.Da.g.parse(h),h=0;h<D.length;h++){let Pe=D[h];if(g.T=Pe[0],Pe=Pe[1],g.G==2)if(Pe[0]=="c"){g.K=Pe[1],g.ia=Pe[2];const Tt=Pe[3];Tt!=null&&(g.la=Tt,g.j.info("VER="+g.la));const St=Pe[4];St!=null&&(g.Aa=St,g.j.info("SVER="+g.Aa));const qs=Pe[5];qs!=null&&typeof qs=="number"&&0<qs&&(S=1.5*qs,g.L=S,g.j.info("backChannelRequestTimeoutMs_="+S)),S=g;const yn=l.g;if(yn){const Ba=yn.g?yn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ba){var U=S.h;U.g||Ba.indexOf("spdy")==-1&&Ba.indexOf("quic")==-1&&Ba.indexOf("h2")==-1||(U.j=U.l,U.g=new Set,U.h&&(pu(U,U.h),U.h=null))}if(S.D){const xu=yn.g?yn.g.getResponseHeader("X-HTTP-Session-Id"):null;xu&&(S.ya=xu,Be(S.I,S.D,xu))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-l.F,g.j.info("Handshake RTT: "+g.R+"ms")),S=g;var Y=l;if(S.qa=nm(S,S.J?S.ia:null,S.W),Y.K){jp(S.h,Y);var Me=Y,yt=S.L;yt&&(Me.I=yt),Me.B&&(du(Me),ja(Me)),S.g=Y}else Yp(S);0<g.i.length&&Fa(g)}else Pe[0]!="stop"&&Pe[0]!="close"||ds(g,7);else g.G==3&&(Pe[0]=="stop"||Pe[0]=="close"?Pe[0]=="stop"?ds(g,7):gu(g):Pe[0]!="noop"&&g.l&&g.l.ta(Pe),g.v=0)}}Gi(4)}catch{}}var J_=class{constructor(l,h){this.g=l,this.map=h}};function Cp(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function kp(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Ap(l){return l.h?1:l.g?l.g.size:0}function fu(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function pu(l,h){l.g?l.g.add(h):l.h=h}function jp(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}Cp.prototype.cancel=function(){if(this.i=Pp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Pp(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const g of l.g.values())h=h.concat(g.D);return h}return P(l.i)}function Z_(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var h=[],g=l.length,S=0;S<g;S++)h.push(l[S]);return h}h=[],g=0;for(S in l)h[g++]=l[S];return h}function eb(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var h=[];l=l.length;for(var g=0;g<l;g++)h.push(g);return h}h=[],g=0;for(const S in l)h[g++]=S;return h}}}function Rp(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var g=eb(l),S=Z_(l),D=S.length,U=0;U<D;U++)h.call(void 0,S[U],g&&g[U],l)}var Dp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function tb(l,h){if(l){l=l.split("&");for(var g=0;g<l.length;g++){var S=l[g].indexOf("="),D=null;if(0<=S){var U=l[g].substring(0,S);D=l[g].substring(S+1)}else U=l[g];h(U,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function us(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof us){this.h=l.h,Pa(this,l.j),this.o=l.o,this.g=l.g,Ra(this,l.s),this.l=l.l;var h=l.i,g=new Zi;g.i=h.i,h.g&&(g.g=new Map(h.g),g.h=h.h),Op(this,g),this.m=l.m}else l&&(h=String(l).match(Dp))?(this.h=!1,Pa(this,h[1]||"",!0),this.o=Yi(h[2]||""),this.g=Yi(h[3]||"",!0),Ra(this,h[4]),this.l=Yi(h[5]||"",!0),Op(this,h[6]||"",!0),this.m=Yi(h[7]||"")):(this.h=!1,this.i=new Zi(null,this.h))}us.prototype.toString=function(){var l=[],h=this.j;h&&l.push(Ji(h,Lp,!0),":");var g=this.g;return(g||h=="file")&&(l.push("//"),(h=this.o)&&l.push(Ji(h,Lp,!0),"@"),l.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&l.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(Ji(g,g.charAt(0)=="/"?sb:rb,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",Ji(g,ob)),l.join("")};function qn(l){return new us(l)}function Pa(l,h,g){l.j=g?Yi(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function Ra(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function Op(l,h,g){h instanceof Zi?(l.i=h,ab(l.i,l.h)):(g||(h=Ji(h,ib)),l.i=new Zi(h,l.h))}function Be(l,h,g){l.i.set(h,g)}function Da(l){return Be(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Yi(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Ji(l,h,g){return typeof l=="string"?(l=encodeURI(l).replace(h,nb),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function nb(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Lp=/[#\/\?@]/g,rb=/[#\?:]/g,sb=/[#\?]/g,ib=/[#\?@]/g,ob=/#/g;function Zi(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function fr(l){l.g||(l.g=new Map,l.h=0,l.i&&tb(l.i,function(h,g){l.add(decodeURIComponent(h.replace(/\+/g," ")),g)}))}t=Zi.prototype,t.add=function(l,h){fr(this),this.i=null,l=Bs(this,l);var g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(h),this.h+=1,this};function Mp(l,h){fr(l),h=Bs(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Vp(l,h){return fr(l),h=Bs(l,h),l.g.has(h)}t.forEach=function(l,h){fr(this),this.g.forEach(function(g,S){g.forEach(function(D){l.call(h,D,S,this)},this)},this)},t.na=function(){fr(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),g=[];for(let S=0;S<h.length;S++){const D=l[S];for(let U=0;U<D.length;U++)g.push(h[S])}return g},t.V=function(l){fr(this);let h=[];if(typeof l=="string")Vp(this,l)&&(h=h.concat(this.g.get(Bs(this,l))));else{l=Array.from(this.g.values());for(let g=0;g<l.length;g++)h=h.concat(l[g])}return h},t.set=function(l,h){return fr(this),this.i=null,l=Bs(this,l),Vp(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function Fp(l,h,g){Mp(l,h),0<g.length&&(l.i=null,l.g.set(Bs(l,h),P(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var g=0;g<h.length;g++){var S=h[g];const U=encodeURIComponent(String(S)),Y=this.V(S);for(S=0;S<Y.length;S++){var D=U;Y[S]!==""&&(D+="="+encodeURIComponent(String(Y[S]))),l.push(D)}}return this.i=l.join("&")};function Bs(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function ab(l,h){h&&!l.j&&(fr(l),l.i=null,l.g.forEach(function(g,S){var D=S.toLowerCase();S!=D&&(Mp(this,S),Fp(this,D,g))},l)),l.j=h}function lb(l,h){const g=new Qi;if(c.Image){const S=new Image;S.onload=T(pr,g,"TestLoadImage: loaded",!0,h,S),S.onerror=T(pr,g,"TestLoadImage: error",!1,h,S),S.onabort=T(pr,g,"TestLoadImage: abort",!1,h,S),S.ontimeout=T(pr,g,"TestLoadImage: timeout",!1,h,S),c.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=l}else h(!1)}function cb(l,h){const g=new Qi,S=new AbortController,D=setTimeout(()=>{S.abort(),pr(g,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:S.signal}).then(U=>{clearTimeout(D),U.ok?pr(g,"TestPingServer: ok",!0,h):pr(g,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(D),pr(g,"TestPingServer: error",!1,h)})}function pr(l,h,g,S,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),S(g)}catch{}}function ub(){this.g=new W_}function db(l,h,g){const S=g||"";try{Rp(l,function(D,U){let Y=D;d(D)&&(Y=Hi(D)),h.push(S+U+"="+encodeURIComponent(Y))})}catch(D){throw h.push(S+"type="+encodeURIComponent("_badmap")),D}}function Oa(l){this.l=l.Ub||null,this.j=l.eb||!1}w(Oa,iu),Oa.prototype.g=function(){return new La(this.l,this.j)},Oa.prototype.i=function(l){return function(){return l}}({});function La(l,h){be.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(La,be),t=La.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,to(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||c).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,eo(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,to(this)),this.g&&(this.readyState=3,to(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Up(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Up(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?eo(this):to(this),this.readyState==3&&Up(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,eo(this))},t.Qa=function(l){this.g&&(this.response=l,eo(this))},t.ga=function(){this.g&&eo(this)};function eo(l){l.readyState=4,l.l=null,l.j=null,l.v=null,to(l)}t.setRequestHeader=function(l,h){this.u.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var g=h.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=h.next();return l.join(`\r
`)};function to(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(La.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function zp(l){let h="";return M(l,function(g,S){h+=S,h+=":",h+=g,h+=`\r
`}),h}function mu(l,h,g){e:{for(S in g){var S=!1;break e}S=!0}S||(g=zp(g),typeof l=="string"?g!=null&&encodeURIComponent(String(g)):Be(l,h,g))}function tt(l){be.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(tt,be);var hb=/^https?$/i,fb=["POST","PUT"];t=tt.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,h,g,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():lu.g(),this.v=this.o?gp(this.o):gp(lu),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(U){Bp(this,U);return}if(l=g||"",g=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var D in S)g.set(D,S[D]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(const U of S.keys())g.set(U,S.get(U));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(g.keys()).find(U=>U.toLowerCase()=="content-type"),D=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(fb,h,void 0))||S||D||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[U,Y]of g)this.g.setRequestHeader(U,Y);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Hp(this),this.u=!0,this.g.send(l),this.u=!1}catch(U){Bp(this,U)}};function Bp(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,$p(l),Ma(l)}function $p(l){l.A||(l.A=!0,je(l,"complete"),je(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,je(this,"complete"),je(this,"abort"),Ma(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ma(this,!0)),tt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?qp(this):this.bb())},t.bb=function(){qp(this)};function qp(l){if(l.h&&typeof a<"u"&&(!l.v[1]||Hn(l)!=4||l.Z()!=2)){if(l.u&&Hn(l)==4)dr(l.Ea,0,l);else if(je(l,"readystatechange"),Hn(l)==4){l.h=!1;try{const Y=l.Z();e:switch(Y){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var g;if(!(g=h)){var S;if(S=Y===0){var D=String(l.D).match(Dp)[1]||null;!D&&c.self&&c.self.location&&(D=c.self.location.protocol.slice(0,-1)),S=!hb.test(D?D.toLowerCase():"")}g=S}if(g)je(l,"complete"),je(l,"success");else{l.m=6;try{var U=2<Hn(l)?l.g.statusText:""}catch{U=""}l.l=U+" ["+l.Z()+"]",$p(l)}}finally{Ma(l)}}}}function Ma(l,h){if(l.g){Hp(l);const g=l.g,S=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||je(l,"ready");try{g.onreadystatechange=S}catch{}}}function Hp(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function Hn(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<Hn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),H_(h)}};function Wp(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function pb(l){const h={};l=(l.g&&2<=Hn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<l.length;S++){if(x(l[S]))continue;var g=k(l[S]);const D=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const U=h[D]||[];h[D]=U,U.push(g)}N(h,function(S){return S.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function no(l,h,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||h}function Gp(l){this.Aa=0,this.i=[],this.j=new Qi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=no("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=no("baseRetryDelayMs",5e3,l),this.cb=no("retryDelaySeedMs",1e4,l),this.Wa=no("forwardChannelMaxRetries",2,l),this.wa=no("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Cp(l&&l.concurrentRequestLimit),this.Da=new ub,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Gp.prototype,t.la=8,t.G=1,t.connect=function(l,h,g,S){Mt(0),this.W=l,this.H=h||{},g&&S!==void 0&&(this.H.OSID=g,this.H.OAID=S),this.F=this.X,this.I=nm(this,null,this.W),Fa(this)};function gu(l){if(Kp(l),l.G==3){var h=l.U++,g=qn(l.I);if(Be(g,"SID",l.K),Be(g,"RID",h),Be(g,"TYPE","terminate"),ro(l,g),h=new hr(l,l.j,h),h.L=2,h.v=Da(qn(g)),g=!1,c.navigator&&c.navigator.sendBeacon)try{g=c.navigator.sendBeacon(h.v.toString(),"")}catch{}!g&&c.Image&&(new Image().src=h.v,g=!0),g||(h.g=rm(h.j,null),h.g.ea(h.v)),h.F=Date.now(),ja(h)}tm(l)}function Va(l){l.g&&(vu(l),l.g.cancel(),l.g=null)}function Kp(l){Va(l),l.u&&(c.clearTimeout(l.u),l.u=null),Ua(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function Fa(l){if(!kp(l.h)&&!l.s){l.s=!0;var h=l.Ga;ne||ee(),O||(ne(),O=!0),$.add(h,l),l.B=0}}function mb(l,h){return Ap(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Ki(m(l.Ga,l,h),em(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const D=new hr(this,this.j,l);let U=this.o;if(this.S&&(U?(U=f(U),_(U,this.S)):U=this.S),this.m!==null||this.O||(D.H=U,U=null),this.P)e:{for(var h=0,g=0;g<this.i.length;g++){t:{var S=this.i[g];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(h+=S,4096<h){h=g;break e}if(h===4096||g===this.i.length-1){h=g+1;break e}}h=1e3}else h=1e3;h=Xp(this,D,h),g=qn(this.I),Be(g,"RID",l),Be(g,"CVER",22),this.D&&Be(g,"X-HTTP-Session-Id",this.D),ro(this,g),U&&(this.O?h="headers="+encodeURIComponent(String(zp(U)))+"&"+h:this.m&&mu(g,this.m,U)),pu(this.h,D),this.Ua&&Be(g,"TYPE","init"),this.P?(Be(g,"$req",h),Be(g,"SID","null"),D.T=!0,uu(D,g,null)):uu(D,g,h),this.G=2}}else this.G==3&&(l?Qp(this,l):this.i.length==0||kp(this.h)||Qp(this))};function Qp(l,h){var g;h?g=h.l:g=l.U++;const S=qn(l.I);Be(S,"SID",l.K),Be(S,"RID",g),Be(S,"AID",l.T),ro(l,S),l.m&&l.o&&mu(S,l.m,l.o),g=new hr(l,l.j,g,l.B+1),l.m===null&&(g.H=l.o),h&&(l.i=h.D.concat(l.i)),h=Xp(l,g,1e3),g.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),pu(l.h,g),uu(g,S,h)}function ro(l,h){l.H&&M(l.H,function(g,S){Be(h,S,g)}),l.l&&Rp({},function(g,S){Be(h,S,g)})}function Xp(l,h,g){g=Math.min(l.i.length,g);var S=l.l?m(l.l.Na,l.l,l):null;e:{var D=l.i;let U=-1;for(;;){const Y=["count="+g];U==-1?0<g?(U=D[0].g,Y.push("ofs="+U)):U=0:Y.push("ofs="+U);let Me=!0;for(let yt=0;yt<g;yt++){let Pe=D[yt].g;const Tt=D[yt].map;if(Pe-=U,0>Pe)U=Math.max(0,D[yt].g-100),Me=!1;else try{db(Tt,Y,"req"+Pe+"_")}catch{S&&S(Tt)}}if(Me){S=Y.join("&");break e}}}return l=l.i.splice(0,g),h.D=l,S}function Yp(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;ne||ee(),O||(ne(),O=!0),$.add(h,l),l.v=0}}function yu(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Ki(m(l.Fa,l),em(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Jp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Ki(m(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Mt(10),Va(this),Jp(this))};function vu(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Jp(l){l.g=new hr(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=qn(l.qa);Be(h,"RID","rpc"),Be(h,"SID",l.K),Be(h,"AID",l.T),Be(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&Be(h,"TO",l.ja),Be(h,"TYPE","xmlhttp"),ro(l,h),l.m&&l.o&&mu(h,l.m,l.o),l.L&&(l.g.I=l.L);var g=l.g;l=l.ia,g.L=1,g.v=Da(qn(h)),g.m=null,g.P=!0,Tp(g,l)}t.Za=function(){this.C!=null&&(this.C=null,Va(this),yu(this),Mt(19))};function Ua(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function Zp(l,h){var g=null;if(l.g==h){Ua(l),vu(l),l.g=null;var S=2}else if(fu(l.h,h))g=h.D,jp(l.h,h),S=1;else return;if(l.G!=0){if(h.o)if(S==1){g=h.m?h.m.length:0,h=Date.now()-h.F;var D=l.B;S=Ca(),je(S,new _p(S,g)),Fa(l)}else Yp(l);else if(D=h.s,D==3||D==0&&0<h.X||!(S==1&&mb(l,h)||S==2&&yu(l)))switch(g&&0<g.length&&(h=l.h,h.i=h.i.concat(g)),D){case 1:ds(l,5);break;case 4:ds(l,10);break;case 3:ds(l,6);break;default:ds(l,2)}}}function em(l,h){let g=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(g*=2),g*h}function ds(l,h){if(l.j.info("Error code "+h),h==2){var g=m(l.fb,l),S=l.Xa;const D=!S;S=new us(S||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Pa(S,"https"),Da(S),D?lb(S.toString(),g):cb(S.toString(),g)}else Mt(2);l.G=0,l.l&&l.l.sa(h),tm(l),Kp(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Mt(2)):(this.j.info("Failed to ping google.com"),Mt(1))};function tm(l){if(l.G=0,l.ka=[],l.l){const h=Pp(l.h);(h.length!=0||l.i.length!=0)&&(I(l.ka,h),I(l.ka,l.i),l.h.i.length=0,P(l.i),l.i.length=0),l.l.ra()}}function nm(l,h,g){var S=g instanceof us?qn(g):new us(g);if(S.g!="")h&&(S.g=h+"."+S.g),Ra(S,S.s);else{var D=c.location;S=D.protocol,h=h?h+"."+D.hostname:D.hostname,D=+D.port;var U=new us(null);S&&Pa(U,S),h&&(U.g=h),D&&Ra(U,D),g&&(U.l=g),S=U}return g=l.D,h=l.ya,g&&h&&Be(S,g,h),Be(S,"VER",l.la),ro(l,S),S}function rm(l,h,g){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new tt(new Oa({eb:g})):new tt(l.pa),h.Ha(l.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function sm(){}t=sm.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function za(){}za.prototype.g=function(l,h){return new Jt(l,h)};function Jt(l,h){be.call(this),this.g=new Gp(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!x(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!x(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new $s(this)}w(Jt,be),Jt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Jt.prototype.close=function(){gu(this.g)},Jt.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.u&&(g={},g.__data__=Hi(l),l=g);h.i.push(new J_(h.Ya++,l)),h.G==3&&Fa(h)},Jt.prototype.N=function(){this.g.l=null,delete this.j,gu(this.g),delete this.g,Jt.aa.N.call(this)};function im(l){ou.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const g in h){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}w(im,ou);function om(){au.call(this),this.status=1}w(om,au);function $s(l){this.g=l}w($s,sm),$s.prototype.ua=function(){je(this.g,"a")},$s.prototype.ta=function(l){je(this.g,new im(l))},$s.prototype.sa=function(l){je(this.g,new om)},$s.prototype.ra=function(){je(this.g,"b")},za.prototype.createWebChannel=za.prototype.g,Jt.prototype.send=Jt.prototype.o,Jt.prototype.open=Jt.prototype.m,Jt.prototype.close=Jt.prototype.close,pw=function(){return new za},fw=function(){return Ca()},hw=ls,ih={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ka.NO_ERROR=0,ka.TIMEOUT=8,ka.HTTP_ERROR=6,Cl=ka,bp.COMPLETE="complete",dw=bp,yp.EventType=Wi,Wi.OPEN="a",Wi.CLOSE="b",Wi.ERROR="c",Wi.MESSAGE="d",be.prototype.listen=be.prototype.K,yo=yp,tt.prototype.listenOnce=tt.prototype.L,tt.prototype.getLastError=tt.prototype.Ka,tt.prototype.getLastErrorCode=tt.prototype.Ba,tt.prototype.getStatus=tt.prototype.Z,tt.prototype.getResponseJson=tt.prototype.Oa,tt.prototype.getResponseText=tt.prototype.oa,tt.prototype.send=tt.prototype.ea,tt.prototype.setWithCredentials=tt.prototype.Ha,uw=tt}).apply(typeof al<"u"?al:typeof self<"u"?self:typeof window<"u"?window:{});const Gg="@firebase/firestore",Kg="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}At.UNAUTHENTICATED=new At(null),At.GOOGLE_CREDENTIALS=new At("google-credentials-uid"),At.FIRST_PARTY=new At("first-party-uid"),At.MOCK_USER=new At("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ui="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rs=new xf("@firebase/firestore");function Ws(){return Rs.logLevel}function re(t,...e){if(Rs.logLevel<=Ee.DEBUG){const n=e.map(Af);Rs.debug(`Firestore (${Ui}): ${t}`,...n)}}function ar(t,...e){if(Rs.logLevel<=Ee.ERROR){const n=e.map(Af);Rs.error(`Firestore (${Ui}): ${t}`,...n)}}function Kr(t,...e){if(Rs.logLevel<=Ee.WARN){const n=e.map(Af);Rs.warn(`Firestore (${Ui}): ${t}`,...n)}}function Af(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function de(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,mw(t,r,n)}function mw(t,e,n){let r=`FIRESTORE (${Ui}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw ar(r),new Error(r)}function De(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||mw(e,s,r)}function me(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class te extends ur{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class pC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(At.UNAUTHENTICATED))}shutdown(){}}class mC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class gC{constructor(e){this.t=e,this.currentUser=At.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){De(this.o===void 0,42304);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Br;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Br,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(re("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Br)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(De(typeof r.accessToken=="string",31837,{l:r}),new gw(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return De(e===null||typeof e=="string",2055,{h:e}),new At(e)}}class yC{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=At.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class vC{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new yC(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(At.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Qg{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class xC{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,bn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){De(this.o===void 0,3512);const r=i=>{i.error!=null&&re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,re("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Qg(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(De(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Qg(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wC(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yw(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=wC(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function xe(t,e){return t<e?-1:t>e?1:0}function oh(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),s=e.codePointAt(n);if(r!==s){if(r<128&&s<128)return xe(r,s);{const i=yw(),a=_C(i.encode(Xg(t,n)),i.encode(Xg(e,n)));return a!==0?a:xe(r,s)}}n+=r>65535?2:1}return xe(t.length,e.length)}function Xg(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function _C(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return xe(t[n],e[n]);return xe(t.length,e.length)}function Ci(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yg="__name__";class Pn{constructor(e,n,r){n===void 0?n=0:n>e.length&&de(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&de(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Pn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Pn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Pn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return xe(e.length,n.length)}static compareSegments(e,n){const r=Pn.isNumericId(e),s=Pn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Pn.extractNumericId(e).compare(Pn.extractNumericId(n)):oh(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return zr.fromString(e.substring(4,e.length-2))}}class Ve extends Pn{construct(e,n,r){return new Ve(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new te(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ve(n)}static emptyPath(){return new Ve([])}}const bC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wt extends Pn{construct(e,n,r){return new wt(e,n,r)}static isValidIdentifier(e){return bC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Yg}static keyField(){return new wt([Yg])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new te(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new te(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new te(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else c==="`"?(a=!a,s++):c!=="."||a?(r+=c,s++):(i(),s++)}if(i(),a)throw new te(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new wt(n)}static emptyPath(){return new wt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.path=e}static fromPath(e){return new ce(Ve.fromString(e))}static fromName(e){return new ce(Ve.fromString(e).popFirst(5))}static empty(){return new ce(Ve.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ve.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ve.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ce(new Ve(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vw(t,e,n){if(!n)throw new te(B.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function EC(t,e,n,r){if(e===!0&&r===!0)throw new te(B.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Jg(t){if(!ce.isDocumentKey(t))throw new te(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Zg(t){if(ce.isDocumentKey(t))throw new te(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function xw(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Bc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":de(12329,{type:typeof t})}function Vn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new te(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Bc(t);throw new te(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lt(t,e){const n={typeString:t};return e&&(n.value=e),n}function _a(t,e){if(!xw(t))throw new te(B.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const a=t[r];if(s&&typeof a!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new te(B.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ey=-62135596800,ty=1e6;class qe{static now(){return qe.fromMillis(Date.now())}static fromDate(e){return qe.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*ty);return new qe(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new te(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new te(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<ey)throw new te(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new te(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ty}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:qe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(_a(e,qe._jsonSchema))return new qe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ey;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}qe._jsonSchemaVersion="firestore/timestamp/1.0",qe._jsonSchema={type:lt("string",qe._jsonSchemaVersion),seconds:lt("number"),nanoseconds:lt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{static fromTimestamp(e){return new fe(e)}static min(){return new fe(new qe(0,0))}static max(){return new fe(new qe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na=-1;function NC(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=fe.fromTimestamp(r===1e9?new qe(n+1,0):new qe(n,r));return new Qr(s,ce.empty(),e)}function TC(t){return new Qr(t.readTime,t.key,na)}class Qr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Qr(fe.min(),ce.empty(),na)}static max(){return new Qr(fe.max(),ce.empty(),na)}}function SC(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ce.comparator(t.documentKey,e.documentKey),n!==0?n:xe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class CC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zi(t){if(t.code!==B.FAILED_PRECONDITION||t.message!==IC)throw t;re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&de(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new q((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof q?n:q.resolve(n)}catch(n){return q.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):q.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):q.reject(n)}static resolve(e){return new q((n,r)=>{n(e)})}static reject(e){return new q((n,r)=>{r(e)})}static waitFor(e){return new q((n,r)=>{let s=0,i=0,a=!1;e.forEach(c=>{++s,c.next(()=>{++i,a&&i===s&&n()},u=>r(u))}),a=!0,i===s&&n()})}static or(e){let n=q.resolve(!1);for(const r of e)n=n.next(s=>s?q.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new q((r,s)=>{const i=e.length,a=new Array(i);let c=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(p=>{a[d]=p,++c,c===i&&r(a)},p=>s(p))}})}static doWhile(e,n){return new q((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function kC(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Bi(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}$c.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pf=-1;function qc(t){return t==null}function hc(t){return t===0&&1/t==-1/0}function AC(t){return typeof t=="number"&&Number.isInteger(t)&&!hc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ww="";function jC(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=ny(e)),e=PC(t.get(n),e);return ny(e)}function PC(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case ww:n+="";break;default:n+=i}}return n}function ny(t){return t+ww+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ry(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ss(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function _w(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e,n){this.comparator=e,this.root=n||xt.EMPTY}insert(e,n){return new et(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,xt.BLACK,null,null))}remove(e){return new et(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ll(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ll(this.root,e,this.comparator,!1)}getReverseIterator(){return new ll(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ll(this.root,e,this.comparator,!0)}}class ll{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class xt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??xt.RED,this.left=s??xt.EMPTY,this.right=i??xt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new xt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return xt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return xt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,xt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,xt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw de(43730,{key:this.key,value:this.value});if(this.right.isRed())throw de(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw de(27949);return e+(this.isRed()?0:1)}}xt.EMPTY=null,xt.RED=!0,xt.BLACK=!1;xt.EMPTY=new class{constructor(){this.size=0}get key(){throw de(57766)}get value(){throw de(16141)}get color(){throw de(16727)}get left(){throw de(29726)}get right(){throw de(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new xt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.comparator=e,this.data=new et(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new sy(this.data.getIterator())}getIteratorFrom(e){return new sy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof ht)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ht(this.comparator);return n.data=e,n}}class sy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this.fields=e,e.sort(wt.comparator)}static empty(){return new tn([])}unionWith(e){let n=new ht(wt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new tn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ci(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new bw("Invalid base64 string: "+i):i}}(e);return new Et(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new Et(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Et.EMPTY_BYTE_STRING=new Et("");const RC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xr(t){if(De(!!t,39018),typeof t=="string"){let e=0;const n=RC.exec(t);if(De(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:rt(t.seconds),nanos:rt(t.nanos)}}function rt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Yr(t){return typeof t=="string"?Et.fromBase64String(t):Et.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ew="server_timestamp",Nw="__type__",Tw="__previous_value__",Sw="__local_write_time__";function Rf(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[Nw])===null||n===void 0?void 0:n.stringValue)===Ew}function Hc(t){const e=t.mapValue.fields[Tw];return Rf(e)?Hc(e):e}function ra(t){const e=Xr(t.mapValue.fields[Sw].timestampValue);return new qe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,n,r,s,i,a,c,u,d,p){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=p}}const fc="(default)";class sa{constructor(e,n){this.projectId=e,this.database=n||fc}static empty(){return new sa("","")}get isDefaultDatabase(){return this.database===fc}isEqual(e){return e instanceof sa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw="__type__",OC="__max__",cl={mapValue:{}},Cw="__vector__",pc="value";function Jr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Rf(t)?4:MC(t)?9007199254740991:LC(t)?10:11:de(28295,{value:t})}function $n(t,e){if(t===e)return!0;const n=Jr(t);if(n!==Jr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ra(t).isEqual(ra(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Xr(s.timestampValue),c=Xr(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Yr(s.bytesValue).isEqual(Yr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return rt(s.geoPointValue.latitude)===rt(i.geoPointValue.latitude)&&rt(s.geoPointValue.longitude)===rt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return rt(s.integerValue)===rt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=rt(s.doubleValue),c=rt(i.doubleValue);return a===c?hc(a)===hc(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return Ci(t.arrayValue.values||[],e.arrayValue.values||[],$n);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},c=i.mapValue.fields||{};if(ry(a)!==ry(c))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(c[u]===void 0||!$n(a[u],c[u])))return!1;return!0}(t,e);default:return de(52216,{left:t})}}function ia(t,e){return(t.values||[]).find(n=>$n(n,e))!==void 0}function ki(t,e){if(t===e)return 0;const n=Jr(t),r=Jr(e);if(n!==r)return xe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return xe(t.booleanValue,e.booleanValue);case 2:return function(i,a){const c=rt(i.integerValue||i.doubleValue),u=rt(a.integerValue||a.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return iy(t.timestampValue,e.timestampValue);case 4:return iy(ra(t),ra(e));case 5:return oh(t.stringValue,e.stringValue);case 6:return function(i,a){const c=Yr(i),u=Yr(a);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const c=i.split("/"),u=a.split("/");for(let d=0;d<c.length&&d<u.length;d++){const p=xe(c[d],u[d]);if(p!==0)return p}return xe(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const c=xe(rt(i.latitude),rt(a.latitude));return c!==0?c:xe(rt(i.longitude),rt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return oy(t.arrayValue,e.arrayValue);case 10:return function(i,a){var c,u,d,p;const y=i.fields||{},m=a.fields||{},T=(c=y[pc])===null||c===void 0?void 0:c.arrayValue,w=(u=m[pc])===null||u===void 0?void 0:u.arrayValue,P=xe(((d=T==null?void 0:T.values)===null||d===void 0?void 0:d.length)||0,((p=w==null?void 0:w.values)===null||p===void 0?void 0:p.length)||0);return P!==0?P:oy(T,w)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===cl.mapValue&&a===cl.mapValue)return 0;if(i===cl.mapValue)return 1;if(a===cl.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),d=a.fields||{},p=Object.keys(d);u.sort(),p.sort();for(let y=0;y<u.length&&y<p.length;++y){const m=oh(u[y],p[y]);if(m!==0)return m;const T=ki(c[u[y]],d[p[y]]);if(T!==0)return T}return xe(u.length,p.length)}(t.mapValue,e.mapValue);default:throw de(23264,{le:n})}}function iy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return xe(t,e);const n=Xr(t),r=Xr(e),s=xe(n.seconds,r.seconds);return s!==0?s:xe(n.nanos,r.nanos)}function oy(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=ki(n[s],r[s]);if(i)return i}return xe(n.length,r.length)}function Ai(t){return ah(t)}function ah(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Xr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Yr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ce.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=ah(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${ah(n.fields[a])}`;return s+"}"}(t.mapValue):de(61005,{value:t})}function kl(t){switch(Jr(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Hc(t);return e?16+kl(e):16;case 5:return 2*t.stringValue.length;case 6:return Yr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+kl(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return ss(r.fields,(i,a)=>{s+=i.length+kl(a)}),s}(t.mapValue);default:throw de(13486,{value:t})}}function ay(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function lh(t){return!!t&&"integerValue"in t}function Df(t){return!!t&&"arrayValue"in t}function ly(t){return!!t&&"nullValue"in t}function cy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Al(t){return!!t&&"mapValue"in t}function LC(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[Iw])===null||n===void 0?void 0:n.stringValue)===Cw}function Po(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ss(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Po(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Po(t.arrayValue.values[n]);return e}return Object.assign({},t)}function MC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===OC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.value=e}static empty(){return new Ht({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Al(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Po(n)}setAll(e){let n=wt.emptyPath(),r={},s=[];e.forEach((a,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=c.popLast()}a?r[c.lastSegment()]=Po(a):s.push(c.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Al(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return $n(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Al(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ss(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Ht(Po(this.value))}}function kw(t){const e=[];return ss(t.fields,(n,r)=>{const s=new wt([n]);if(Al(r)){const i=kw(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new tn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e,n,r,s,i,a,c){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Pt(e,0,fe.min(),fe.min(),fe.min(),Ht.empty(),0)}static newFoundDocument(e,n,r,s){return new Pt(e,1,n,fe.min(),r,s,0)}static newNoDocument(e,n){return new Pt(e,2,n,fe.min(),fe.min(),Ht.empty(),0)}static newUnknownDocument(e,n){return new Pt(e,3,n,fe.min(),fe.min(),Ht.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ht.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ht.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Pt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Pt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{constructor(e,n){this.position=e,this.inclusive=n}}function uy(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=ce.comparator(ce.fromName(a.referenceValue),n.key):r=ki(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function dy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!$n(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(e,n="asc"){this.field=e,this.dir=n}}function VC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{}class at extends Aw{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new UC(e,n,r):n==="array-contains"?new $C(e,r):n==="in"?new qC(e,r):n==="not-in"?new HC(e,r):n==="array-contains-any"?new WC(e,r):new at(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new zC(e,r):new BC(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(ki(n,this.value)):n!==null&&Jr(this.value)===Jr(n)&&this.matchesComparison(ki(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return de(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class kn extends Aw{constructor(e,n){super(),this.filters=e,this.op=n,this.he=null}static create(e,n){return new kn(e,n)}matches(e){return jw(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function jw(t){return t.op==="and"}function Pw(t){return FC(t)&&jw(t)}function FC(t){for(const e of t.filters)if(e instanceof kn)return!1;return!0}function ch(t){if(t instanceof at)return t.field.canonicalString()+t.op.toString()+Ai(t.value);if(Pw(t))return t.filters.map(e=>ch(e)).join(",");{const e=t.filters.map(n=>ch(n)).join(",");return`${t.op}(${e})`}}function Rw(t,e){return t instanceof at?function(r,s){return s instanceof at&&r.op===s.op&&r.field.isEqual(s.field)&&$n(r.value,s.value)}(t,e):t instanceof kn?function(r,s){return s instanceof kn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,c)=>i&&Rw(a,s.filters[c]),!0):!1}(t,e):void de(19439)}function Dw(t){return t instanceof at?function(n){return`${n.field.canonicalString()} ${n.op} ${Ai(n.value)}`}(t):t instanceof kn?function(n){return n.op.toString()+" {"+n.getFilters().map(Dw).join(" ,")+"}"}(t):"Filter"}class UC extends at{constructor(e,n,r){super(e,n,r),this.key=ce.fromName(r.referenceValue)}matches(e){const n=ce.comparator(e.key,this.key);return this.matchesComparison(n)}}class zC extends at{constructor(e,n){super(e,"in",n),this.keys=Ow("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class BC extends at{constructor(e,n){super(e,"not-in",n),this.keys=Ow("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Ow(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ce.fromName(r.referenceValue))}class $C extends at{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Df(n)&&ia(n.arrayValue,this.value)}}class qC extends at{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ia(this.value.arrayValue,n)}}class HC extends at{constructor(e,n){super(e,"not-in",n)}matches(e){if(ia(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!ia(this.value.arrayValue,n)}}class WC extends at{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Df(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ia(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(e,n=null,r=[],s=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=c,this.Pe=null}}function hy(t,e=null,n=[],r=[],s=null,i=null,a=null){return new GC(t,e,n,r,s,i,a)}function Of(t){const e=me(t);if(e.Pe===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ch(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),qc(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ai(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ai(r)).join(",")),e.Pe=n}return e.Pe}function Lf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!VC(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Rw(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!dy(t.startAt,e.startAt)&&dy(t.endAt,e.endAt)}function uh(t){return ce.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e,n=null,r=[],s=[],i=null,a="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=u,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function KC(t,e,n,r,s,i,a,c){return new $i(t,e,n,r,s,i,a,c)}function Mf(t){return new $i(t)}function fy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Lw(t){return t.collectionGroup!==null}function Ro(t){const e=me(t);if(e.Te===null){e.Te=[];const n=new Set;for(const i of e.explicitOrderBy)e.Te.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new ht(wt.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Te.push(new oa(i,r))}),n.has(wt.keyField().canonicalString())||e.Te.push(new oa(wt.keyField(),r))}return e.Te}function Fn(t){const e=me(t);return e.Ie||(e.Ie=QC(e,Ro(t))),e.Ie}function QC(t,e){if(t.limitType==="F")return hy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new oa(s.field,i)});const n=t.endAt?new mc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new mc(t.startAt.position,t.startAt.inclusive):null;return hy(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function dh(t,e){const n=t.filters.concat([e]);return new $i(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function hh(t,e,n){return new $i(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Wc(t,e){return Lf(Fn(t),Fn(e))&&t.limitType===e.limitType}function Mw(t){return`${Of(Fn(t))}|lt:${t.limitType}`}function Gs(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Dw(s)).join(", ")}]`),qc(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Ai(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Ai(s)).join(",")),`Target(${r})`}(Fn(t))}; limitType=${t.limitType})`}function Gc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ce.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Ro(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,c,u){const d=uy(a,c,u);return a.inclusive?d<=0:d<0}(r.startAt,Ro(r),s)||r.endAt&&!function(a,c,u){const d=uy(a,c,u);return a.inclusive?d>=0:d>0}(r.endAt,Ro(r),s))}(t,e)}function XC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Vw(t){return(e,n)=>{let r=!1;for(const s of Ro(t)){const i=YC(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function YC(t,e,n){const r=t.field.isKeyField()?ce.comparator(e.key,n.key):function(i,a,c){const u=a.data.field(i),d=c.data.field(i);return u!==null&&d!==null?ki(u,d):de(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return de(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ss(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return _w(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JC=new et(ce.comparator);function lr(){return JC}const Fw=new et(ce.comparator);function vo(...t){let e=Fw;for(const n of t)e=e.insert(n.key,n);return e}function Uw(t){let e=Fw;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function xs(){return Do()}function zw(){return Do()}function Do(){return new Fs(t=>t.toString(),(t,e)=>t.isEqual(e))}const ZC=new et(ce.comparator),ek=new ht(ce.comparator);function Ne(...t){let e=ek;for(const n of t)e=e.add(n);return e}const tk=new ht(xe);function nk(){return tk}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vf(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:hc(e)?"-0":e}}function Bw(t){return{integerValue:""+t}}function $w(t,e){return AC(e)?Bw(e):Vf(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(){this._=void 0}}function rk(t,e,n){return t instanceof aa?function(s,i){const a={fields:{[Nw]:{stringValue:Ew},[Sw]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Rf(i)&&(i=Hc(i)),i&&(a.fields[Tw]=i),{mapValue:a}}(n,e):t instanceof la?Hw(t,e):t instanceof ca?Ww(t,e):function(s,i){const a=qw(s,i),c=py(a)+py(s.Ee);return lh(a)&&lh(s.Ee)?Bw(c):Vf(s.serializer,c)}(t,e)}function sk(t,e,n){return t instanceof la?Hw(t,e):t instanceof ca?Ww(t,e):n}function qw(t,e){return t instanceof ua?function(r){return lh(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class aa extends Kc{}class la extends Kc{constructor(e){super(),this.elements=e}}function Hw(t,e){const n=Gw(e);for(const r of t.elements)n.some(s=>$n(s,r))||n.push(r);return{arrayValue:{values:n}}}class ca extends Kc{constructor(e){super(),this.elements=e}}function Ww(t,e){let n=Gw(e);for(const r of t.elements)n=n.filter(s=>!$n(s,r));return{arrayValue:{values:n}}}class ua extends Kc{constructor(e,n){super(),this.serializer=e,this.Ee=n}}function py(t){return rt(t.integerValue||t.doubleValue)}function Gw(t){return Df(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(e,n){this.field=e,this.transform=n}}function ik(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof la&&s instanceof la||r instanceof ca&&s instanceof ca?Ci(r.elements,s.elements,$n):r instanceof ua&&s instanceof ua?$n(r.Ee,s.Ee):r instanceof aa&&s instanceof aa}(t.transform,e.transform)}class ok{constructor(e,n){this.version=e,this.transformResults=n}}class Sn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Sn}static exists(e){return new Sn(void 0,e)}static updateTime(e){return new Sn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function jl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Qc{}function Qw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ff(t.key,Sn.none()):new ba(t.key,t.data,Sn.none());{const n=t.data,r=Ht.empty();let s=new ht(wt.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new is(t.key,r,new tn(s.toArray()),Sn.none())}}function ak(t,e,n){t instanceof ba?function(s,i,a){const c=s.value.clone(),u=gy(s.fieldTransforms,i,a.transformResults);c.setAll(u),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):t instanceof is?function(s,i,a){if(!jl(s.precondition,i))return void i.convertToUnknownDocument(a.version);const c=gy(s.fieldTransforms,i,a.transformResults),u=i.data;u.setAll(Xw(s)),u.setAll(c),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Oo(t,e,n,r){return t instanceof ba?function(i,a,c,u){if(!jl(i.precondition,a))return c;const d=i.value.clone(),p=yy(i.fieldTransforms,u,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof is?function(i,a,c,u){if(!jl(i.precondition,a))return c;const d=yy(i.fieldTransforms,u,a),p=a.data;return p.setAll(Xw(i)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(y=>y.field))}(t,e,n,r):function(i,a,c){return jl(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,n)}function lk(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=qw(r.transform,s||null);i!=null&&(n===null&&(n=Ht.empty()),n.set(r.field,i))}return n||null}function my(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ci(r,s,(i,a)=>ik(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ba extends Qc{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class is extends Qc{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Xw(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function gy(t,e,n){const r=new Map;De(t.length===n.length,32656,{Ae:n.length,Re:t.length});for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,c=e.data.field(i.field);r.set(i.field,sk(a,c,n[s]))}return r}function yy(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,rk(i,a,e))}return r}class Ff extends Qc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ck extends Qc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&ak(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Oo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Oo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=zw();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=n.has(s.key)?null:c;const u=Qw(a,c);u!==null&&r.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(fe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ne())}isEqual(e){return this.batchId===e.batchId&&Ci(this.mutations,e.mutations,(n,r)=>my(n,r))&&Ci(this.baseMutations,e.baseMutations,(n,r)=>my(n,r))}}class Uf{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){De(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let s=function(){return ZC}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Uf(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var it,Ce;function fk(t){switch(t){case B.OK:return de(64938);case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0;default:return de(15467,{code:t})}}function Yw(t){if(t===void 0)return ar("GRPC error has no .code"),B.UNKNOWN;switch(t){case it.OK:return B.OK;case it.CANCELLED:return B.CANCELLED;case it.UNKNOWN:return B.UNKNOWN;case it.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case it.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case it.INTERNAL:return B.INTERNAL;case it.UNAVAILABLE:return B.UNAVAILABLE;case it.UNAUTHENTICATED:return B.UNAUTHENTICATED;case it.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case it.NOT_FOUND:return B.NOT_FOUND;case it.ALREADY_EXISTS:return B.ALREADY_EXISTS;case it.PERMISSION_DENIED:return B.PERMISSION_DENIED;case it.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case it.ABORTED:return B.ABORTED;case it.OUT_OF_RANGE:return B.OUT_OF_RANGE;case it.UNIMPLEMENTED:return B.UNIMPLEMENTED;case it.DATA_LOSS:return B.DATA_LOSS;default:return de(39323,{code:t})}}(Ce=it||(it={}))[Ce.OK=0]="OK",Ce[Ce.CANCELLED=1]="CANCELLED",Ce[Ce.UNKNOWN=2]="UNKNOWN",Ce[Ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ce[Ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ce[Ce.NOT_FOUND=5]="NOT_FOUND",Ce[Ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ce[Ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ce[Ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ce[Ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ce[Ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ce[Ce.ABORTED=10]="ABORTED",Ce[Ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ce[Ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ce[Ce.INTERNAL=13]="INTERNAL",Ce[Ce.UNAVAILABLE=14]="UNAVAILABLE",Ce[Ce.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pk=new zr([4294967295,4294967295],0);function vy(t){const e=yw().encode(t),n=new cw;return n.update(e),new Uint8Array(n.digest())}function xy(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new zr([n,r],0),new zr([s,i],0)]}class zf{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new xo(`Invalid padding: ${n}`);if(r<0)throw new xo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new xo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new xo(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*e.length-n,this.ge=zr.fromNumber(this.fe)}pe(e,n,r){let s=e.add(n.multiply(zr.fromNumber(r)));return s.compare(pk)===1&&(s=new zr([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const n=vy(e),[r,s]=xy(n);for(let i=0;i<this.hashCount;i++){const a=this.pe(r,s,i);if(!this.ye(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new zf(i,s,n);return r.forEach(c=>a.insert(c)),a}insert(e){if(this.fe===0)return;const n=vy(e),[r,s]=xy(n);for(let i=0;i<this.hashCount;i++){const a=this.pe(r,s,i);this.we(a)}}we(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class xo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Ea.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Xc(fe.min(),s,new et(xe),lr(),Ne())}}class Ea{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ea(r,n,Ne(),Ne(),Ne())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(e,n,r,s){this.Se=e,this.removedTargetIds=n,this.key=r,this.be=s}}class Jw{constructor(e,n){this.targetId=e,this.De=n}}class Zw{constructor(e,n,r=Et.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class wy{constructor(){this.ve=0,this.Ce=_y(),this.Fe=Et.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Ne(),n=Ne(),r=Ne();return this.Ce.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:de(38017,{changeType:i})}}),new Ea(this.Fe,this.Me,e,n,r)}ke(){this.xe=!1,this.Ce=_y()}qe(e,n){this.xe=!0,this.Ce=this.Ce.insert(e,n)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,De(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class mk{constructor(e){this.We=e,this.Ge=new Map,this.ze=lr(),this.je=ul(),this.Je=ul(),this.He=new et(xe)}Ye(e){for(const n of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(n,e.be):this.Xe(n,e.key,e.be);for(const n of e.removedTargetIds)this.Xe(n,e.key,e.be)}et(e){this.forEachTarget(e,n=>{const r=this.tt(n);switch(e.state){case 0:this.nt(n)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(e.resumeToken));break;default:de(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ge.forEach((r,s)=>{this.nt(s)&&n(s)})}it(e){const n=e.targetId,r=e.De.count,s=this.st(n);if(s){const i=s.target;if(uh(i))if(r===0){const a=new ce(i.path);this.Xe(n,a,Pt.newNoDocument(a,fe.min()))}else De(r===1,20013,{expectedCount:r});else{const a=this.ot(n);if(a!==r){const c=this._t(e),u=c?this.ut(c,e,a):1;if(u!==0){this.rt(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,d)}}}}}_t(e){const n=e.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,c;try{a=Yr(r).toUint8Array()}catch(u){if(u instanceof bw)return Kr("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new zf(a,s,i)}catch(u){return Kr(u instanceof xo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.fe===0?null:c}ut(e,n,r){return n.De.count===r-this.ht(e,n.targetId)?0:2}ht(e,n){const r=this.We.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.We.lt(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.Xe(n,i,null),s++)}),s}Pt(e){const n=new Map;this.Ge.forEach((i,a)=>{const c=this.st(a);if(c){if(i.current&&uh(c.target)){const u=new ce(c.target.path);this.Tt(u).has(a)||this.It(a,u)||this.Xe(a,u,Pt.newNoDocument(u,e))}i.Ne&&(n.set(a,i.Le()),i.ke())}});let r=Ne();this.Je.forEach((i,a)=>{let c=!0;a.forEachWhile(u=>{const d=this.st(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(i))}),this.ze.forEach((i,a)=>a.setReadTime(e));const s=new Xc(e,n,this.He,this.ze,r);return this.ze=lr(),this.je=ul(),this.Je=ul(),this.He=new et(xe),s}Ze(e,n){if(!this.nt(e))return;const r=this.It(e,n.key)?2:0;this.tt(e).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(e)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(e))}Xe(e,n,r){if(!this.nt(e))return;const s=this.tt(e);this.It(e,n)?s.qe(n,1):s.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(e)),this.Je=this.Je.insert(n,this.dt(n).add(e)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const n=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let n=this.Ge.get(e);return n||(n=new wy,this.Ge.set(e,n)),n}dt(e){let n=this.Je.get(e);return n||(n=new ht(xe),this.Je=this.Je.insert(e,n)),n}Tt(e){let n=this.je.get(e);return n||(n=new ht(xe),this.je=this.je.insert(e,n)),n}nt(e){const n=this.st(e)!==null;return n||re("WatchChangeAggregator","Detected inactive target",e),n}st(e){const n=this.Ge.get(e);return n&&n.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new wy),this.We.getRemoteKeysForTarget(e).forEach(n=>{this.Xe(e,n,null)})}It(e,n){return this.We.getRemoteKeysForTarget(e).has(n)}}function ul(){return new et(ce.comparator)}function _y(){return new et(ce.comparator)}const gk={asc:"ASCENDING",desc:"DESCENDING"},yk={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vk={and:"AND",or:"OR"};class xk{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function fh(t,e){return t.useProto3Json||qc(e)?e:{value:e}}function gc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function e_(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function wk(t,e){return gc(t,e.toTimestamp())}function Un(t){return De(!!t,49232),fe.fromTimestamp(function(n){const r=Xr(n);return new qe(r.seconds,r.nanos)}(t))}function Bf(t,e){return ph(t,e).canonicalString()}function ph(t,e){const n=function(s){return new Ve(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function t_(t){const e=Ve.fromString(t);return De(o_(e),10190,{key:e.toString()}),e}function mh(t,e){return Bf(t.databaseId,e.path)}function td(t,e){const n=t_(e);if(n.get(1)!==t.databaseId.projectId)throw new te(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new te(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ce(r_(n))}function n_(t,e){return Bf(t.databaseId,e)}function _k(t){const e=t_(t);return e.length===4?Ve.emptyPath():r_(e)}function gh(t){return new Ve(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function r_(t){return De(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function by(t,e,n){return{name:mh(t,e),fields:n.value.mapValue.fields}}function bk(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:de(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,p){return d.useProto3Json?(De(p===void 0||typeof p=="string",58123),Et.fromBase64String(p||"")):(De(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Et.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(d){const p=d.code===void 0?B.UNKNOWN:Yw(d.code);return new te(p,d.message||"")}(a);n=new Zw(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=td(t,r.document.name),i=Un(r.document.updateTime),a=r.document.createTime?Un(r.document.createTime):fe.min(),c=new Ht({mapValue:{fields:r.document.fields}}),u=Pt.newFoundDocument(s,i,a,c),d=r.targetIds||[],p=r.removedTargetIds||[];n=new Pl(d,p,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=td(t,r.document),i=r.readTime?Un(r.readTime):fe.min(),a=Pt.newNoDocument(s,i),c=r.removedTargetIds||[];n=new Pl([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=td(t,r.document),i=r.removedTargetIds||[];n=new Pl([],i,s,null)}else{if(!("filter"in e))return de(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new hk(s,i),c=r.targetId;n=new Jw(c,a)}}return n}function Ek(t,e){let n;if(e instanceof ba)n={update:by(t,e.key,e.value)};else if(e instanceof Ff)n={delete:mh(t,e.key)};else if(e instanceof is)n={update:by(t,e.key,e.data),updateMask:Pk(e.fieldMask)};else{if(!(e instanceof ck))return de(16599,{Rt:e.type});n={verify:mh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const c=a.transform;if(c instanceof aa)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof la)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof ca)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof ua)return{fieldPath:a.field.canonicalString(),increment:c.Ee};throw de(20930,{transform:a.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:wk(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:de(27497)}(t,e.precondition)),n}function Nk(t,e){return t&&t.length>0?(De(e!==void 0,14353),t.map(n=>function(s,i){let a=s.updateTime?Un(s.updateTime):Un(i);return a.isEqual(fe.min())&&(a=Un(i)),new ok(a,s.transformResults||[])}(n,e))):[]}function Tk(t,e){return{documents:[n_(t,e.path)]}}function Sk(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=n_(t,s);const i=function(d){if(d.length!==0)return i_(kn.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(d){if(d.length!==0)return d.map(p=>function(m){return{field:Ks(m.field),direction:kk(m.dir)}}(p))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const c=fh(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{Vt:n,parent:s}}function Ik(t){let e=_k(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){De(r===1,65062);const p=n.from[0];p.allDescendants?s=p.collectionId:e=e.child(p.collectionId)}let i=[];n.where&&(i=function(y){const m=s_(y);return m instanceof kn&&Pw(m)?m.getFilters():[m]}(n.where));let a=[];n.orderBy&&(a=function(y){return y.map(m=>function(w){return new oa(Qs(w.field),function(I){switch(I){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(m))}(n.orderBy));let c=null;n.limit&&(c=function(y){let m;return m=typeof y=="object"?y.value:y,qc(m)?null:m}(n.limit));let u=null;n.startAt&&(u=function(y){const m=!!y.before,T=y.values||[];return new mc(T,m)}(n.startAt));let d=null;return n.endAt&&(d=function(y){const m=!y.before,T=y.values||[];return new mc(T,m)}(n.endAt)),KC(e,s,a,i,c,"F",u,d)}function Ck(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return de(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function s_(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Qs(n.unaryFilter.field);return at.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Qs(n.unaryFilter.field);return at.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Qs(n.unaryFilter.field);return at.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Qs(n.unaryFilter.field);return at.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return de(61313);default:return de(60726)}}(t):t.fieldFilter!==void 0?function(n){return at.create(Qs(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return de(58110);default:return de(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return kn.create(n.compositeFilter.filters.map(r=>s_(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return de(1026)}}(n.compositeFilter.op))}(t):de(30097,{filter:t})}function kk(t){return gk[t]}function Ak(t){return yk[t]}function jk(t){return vk[t]}function Ks(t){return{fieldPath:t.canonicalString()}}function Qs(t){return wt.fromServerFormat(t.fieldPath)}function i_(t){return t instanceof at?function(n){if(n.op==="=="){if(cy(n.value))return{unaryFilter:{field:Ks(n.field),op:"IS_NAN"}};if(ly(n.value))return{unaryFilter:{field:Ks(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(cy(n.value))return{unaryFilter:{field:Ks(n.field),op:"IS_NOT_NAN"}};if(ly(n.value))return{unaryFilter:{field:Ks(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ks(n.field),op:Ak(n.op),value:n.value}}}(t):t instanceof kn?function(n){const r=n.getFilters().map(s=>i_(s));return r.length===1?r[0]:{compositeFilter:{op:jk(n.op),filters:r}}}(t):de(54877,{filter:t})}function Pk(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function o_(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e,n,r,s,i=fe.min(),a=fe.min(),c=Et.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Cr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Cr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Cr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Cr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk{constructor(e){this.gt=e}}function Dk(t){const e=Ik({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?hh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ok{constructor(){this.Dn=new Lk}addToCollectionParentIndex(e,n){return this.Dn.add(n),q.resolve()}getCollectionParents(e,n){return q.resolve(this.Dn.getEntries(n))}addFieldIndex(e,n){return q.resolve()}deleteFieldIndex(e,n){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,n){return q.resolve()}getDocumentsMatchingTarget(e,n){return q.resolve(null)}getIndexType(e,n){return q.resolve(0)}getFieldIndexes(e,n){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,n){return q.resolve(Qr.min())}getMinOffsetFromCollectionGroup(e,n){return q.resolve(Qr.min())}updateCollectionGroup(e,n,r){return q.resolve()}updateIndexEntries(e,n){return q.resolve()}}class Lk{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new ht(Ve.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ht(Ve.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ey={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},a_=41943040;class $t{static withCacheSize(e){return new $t(e,$t.DEFAULT_COLLECTION_PERCENTILE,$t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */$t.DEFAULT_COLLECTION_PERCENTILE=10,$t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,$t.DEFAULT=new $t(a_,$t.DEFAULT_COLLECTION_PERCENTILE,$t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),$t.DISABLED=new $t(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new ji(0)}static ur(){return new ji(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ny="LruGarbageCollector",Mk=1048576;function Ty([t,e],[n,r]){const s=xe(t,n);return s===0?xe(e,r):s}class Vk{constructor(e){this.Tr=e,this.buffer=new ht(Ty),this.Ir=0}dr(){return++this.Ir}Er(e){const n=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Ty(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Fk{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){re(Ny,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Bi(n)?re(Ny,"Ignoring IndexedDB error during garbage collection: ",n):await zi(n)}await this.Rr(3e5)})}}class Uk{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.mr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return q.resolve($c.ue);const r=new Vk(n);return this.Vr.forEachTarget(e,s=>r.Er(s.sequenceNumber)).next(()=>this.Vr.gr(e,s=>r.Er(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(re("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(Ey)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(re("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ey):this.pr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,n){let r,s,i,a,c,u,d;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(re("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),s=this.params.maximumSequenceNumbersToCollect):s=y,a=Date.now(),this.nthSequenceNumber(e,s))).next(y=>(r=y,c=Date.now(),this.removeTargets(e,r,n))).next(y=>(i=y,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(y=>(d=Date.now(),Ws()<=Ee.DEBUG&&re("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${s} in `+(c-a)+`ms
	Removed ${i} targets in `+(u-c)+`ms
	Removed ${y} documents in `+(d-u)+`ms
Total Duration: ${d-p}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:y})))}}function zk(t,e){return new Uk(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(){this.changes=new Fs(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Pt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?q.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $k{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Oo(r.mutation,s,tn.empty(),qe.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ne()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ne()){const s=xs();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=vo();return i.forEach((c,u)=>{a=a.insert(c,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=xs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ne()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,c)=>{n.set(a,c)})})}computeViews(e,n,r,s){let i=lr();const a=Do(),c=function(){return Do()}();return n.forEach((u,d)=>{const p=r.get(d.key);s.has(d.key)&&(p===void 0||p.mutation instanceof is)?i=i.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),Oo(p.mutation,d,p.mutation.getFieldMask(),qe.now())):a.set(d.key,tn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,p)=>a.set(d,p)),n.forEach((d,p)=>{var y;return c.set(d,new $k(p,(y=a.get(d))!==null&&y!==void 0?y:null))}),c))}recalculateAndSaveOverlays(e,n){const r=Do();let s=new et((a,c)=>a-c),i=Ne();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const c of a)c.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let p=r.get(u)||tn.empty();p=c.applyToLocalView(d,p),r.set(u,p);const y=(s.get(c.batchId)||Ne()).add(u);s=s.insert(c.batchId,y)})}).next(()=>{const a=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,p=u.value,y=zw();p.forEach(m=>{if(!i.has(m)){const T=Qw(n.get(m),r.get(m));T!==null&&y.set(m,T),i=i.add(m)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,y))}return q.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return ce.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Lw(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):q.resolve(xs());let c=na,u=i;return a.next(d=>q.forEach(d,(p,y)=>(c<y.largestBatchId&&(c=y.largestBatchId),i.get(p)?q.resolve():this.remoteDocumentCache.getEntry(e,p).next(m=>{u=u.insert(p,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,Ne())).next(p=>({batchId:c,changes:Uw(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ce(n)).next(r=>{let s=vo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=vo();return this.indexManager.getCollectionParents(e,i).next(c=>q.forEach(c,u=>{const d=function(y,m){return new $i(m,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(p=>{p.forEach((y,m)=>{a=a.insert(y,m)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((u,d)=>{const p=d.getKey();a.get(p)===null&&(a=a.insert(p,Pt.newInvalidDocument(p)))});let c=vo();return a.forEach((u,d)=>{const p=i.get(u);p!==void 0&&Oo(p.mutation,d,tn.empty(),qe.now()),Gc(n,d)&&(c=c.insert(u,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,n){return q.resolve(this.Br.get(n))}saveBundleMetadata(e,n){return this.Br.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Un(s.createTime)}}(n)),q.resolve()}getNamedQuery(e,n){return q.resolve(this.Lr.get(n))}saveNamedQuery(e,n){return this.Lr.set(n.name,function(s){return{name:s.name,query:Dk(s.bundledQuery),readTime:Un(s.readTime)}}(n)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{constructor(){this.overlays=new et(ce.comparator),this.kr=new Map}getOverlay(e,n){return q.resolve(this.overlays.get(n))}getOverlays(e,n){const r=xs();return q.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.wt(e,n,i)}),q.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.kr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.kr.delete(r)),q.resolve()}getOverlaysForCollection(e,n,r){const s=xs(),i=n.length+1,a=new ce(n.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return q.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new et((d,p)=>d-p);const a=this.overlays.getIterator();for(;a.hasNext();){const d=a.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let p=i.get(d.largestBatchId);p===null&&(p=xs(),i=i.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const c=xs(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,p)=>c.set(d,p)),!(c.size()>=s)););return q.resolve(c)}wt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.kr.get(s.largestBatchId).delete(r.key);this.kr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new dk(n,r));let i=this.kr.get(n);i===void 0&&(i=Ne(),this.kr.set(n,i)),this.kr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gk{constructor(){this.sessionToken=Et.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $f{constructor(){this.qr=new ht(ft.Qr),this.$r=new ht(ft.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,n){const r=new ft(e,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new ft(e,n))}Gr(e,n){e.forEach(r=>this.removeReference(r,n))}zr(e){const n=new ce(new Ve([])),r=new ft(n,e),s=new ft(n,e+1),i=[];return this.$r.forEachInRange([r,s],a=>{this.Wr(a),i.push(a.key)}),i}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const n=new ce(new Ve([])),r=new ft(n,e),s=new ft(n,e+1);let i=Ne();return this.$r.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new ft(e,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class ft{constructor(e,n){this.key=e,this.Hr=n}static Qr(e,n){return ce.comparator(e.key,n.key)||xe(e.Hr,n.Hr)}static Ur(e,n){return xe(e.Hr,n.Hr)||ce.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new ht(ft.Qr)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new uk(i,n,r,s);this.mutationQueue.push(a);for(const c of s)this.Yr=this.Yr.add(new ft(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return q.resolve(a)}lookupMutationBatch(e,n){return q.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Xr(r),i=s<0?0:s;return q.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?Pf:this.er-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new ft(n,0),s=new ft(n,Number.POSITIVE_INFINITY),i=[];return this.Yr.forEachInRange([r,s],a=>{const c=this.Zr(a.Hr);i.push(c)}),q.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ht(xe);return n.forEach(s=>{const i=new ft(s,0),a=new ft(s,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([i,a],c=>{r=r.add(c.Hr)})}),q.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ce.isDocumentKey(i)||(i=i.child(""));const a=new ft(new ce(i),0);let c=new ht(xe);return this.Yr.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(c=c.add(u.Hr)),!0)},a),q.resolve(this.ei(c))}ei(e){const n=[];return e.forEach(r=>{const s=this.Zr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){De(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return q.forEach(n.mutations,s=>{const i=new ft(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,n){const r=new ft(n,0),s=this.Yr.firstAfterOrEqual(r);return q.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}ti(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{constructor(e){this.ni=e,this.docs=function(){return new et(ce.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return q.resolve(r?r.document.mutableCopy():Pt.newInvalidDocument(n))}getEntries(e,n){let r=lr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Pt.newInvalidDocument(s))}),q.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=lr();const a=n.path,c=new ce(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:p}}=u.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||SC(TC(p),r)<=0||(s.has(p.key)||Gc(n,p))&&(i=i.insert(p.key,p.mutableCopy()))}return q.resolve(i)}getAllFromCollectionGroup(e,n,r,s){de(9500)}ri(e,n){return q.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Xk(this)}getSize(e){return q.resolve(this.size)}}class Xk extends Bk{constructor(e){super(),this.Or=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Or.addEntry(e,s)):this.Or.removeEntry(r)}),q.waitFor(n)}getFromCache(e,n){return this.Or.getEntry(e,n)}getAllFromCache(e,n){return this.Or.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yk{constructor(e){this.persistence=e,this.ii=new Fs(n=>Of(n),Lf),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.si=0,this.oi=new $f,this.targetCount=0,this._i=ji.ar()}forEachTarget(e,n){return this.ii.forEach((r,s)=>n(s)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),q.resolve()}hr(e){this.ii.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this._i=new ji(n),this.highestTargetId=n),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,n){return this.hr(n),this.targetCount+=1,q.resolve()}updateTargetData(e,n){return this.hr(n),q.resolve()}removeTargetData(e,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.ii.forEach((a,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.ii.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),q.waitFor(i).next(()=>s)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,n){const r=this.ii.get(n)||null;return q.resolve(r)}addMatchingKeys(e,n,r){return this.oi.Kr(n,r),q.resolve()}removeMatchingKeys(e,n,r){this.oi.Gr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),q.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.oi.zr(n),q.resolve()}getMatchingKeysForTargetId(e,n){const r=this.oi.Jr(n);return q.resolve(r)}containsKey(e,n){return q.resolve(this.oi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(e,n){this.ai={},this.overlays={},this.ui=new $c(0),this.ci=!1,this.ci=!0,this.li=new Gk,this.referenceDelegate=e(this),this.hi=new Yk(this),this.indexManager=new Ok,this.remoteDocumentCache=function(s){return new Qk(s)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new Rk(n),this.Ti=new Hk(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Wk,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ai[e.toKey()];return r||(r=new Kk(n,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,n,r){re("MemoryPersistence","Starting transaction:",e);const s=new Jk(this.ui.next());return this.referenceDelegate.Ii(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ei(e,n){return q.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,n)))}}class Jk extends CC{constructor(e){super(),this.currentSequenceNumber=e}}class qf{constructor(e){this.persistence=e,this.Ai=new $f,this.Ri=null}static Vi(e){return new qf(e)}get mi(){if(this.Ri)return this.Ri;throw de(60996)}addReference(e,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),q.resolve()}removeReference(e,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),q.resolve()}markPotentiallyOrphaned(e,n){return this.mi.add(n.toString()),q.resolve()}removeTarget(e,n){this.Ai.zr(n.targetId).forEach(s=>this.mi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.mi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ii(){this.Ri=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.mi,r=>{const s=ce.fromPath(r);return this.fi(e,s).next(i=>{i||n.removeEntry(s,fe.min())})}).next(()=>(this.Ri=null,n.apply(e)))}updateLimboDocument(e,n){return this.fi(e,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(e){return 0}fi(e,n){return q.or([()=>q.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class yc{constructor(e,n){this.persistence=e,this.gi=new Fs(r=>jC(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=zk(this,n)}static Vi(e,n){return new yc(e,n)}Ii(){}di(e){return q.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}mr(e){const n=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}yr(e){let n=0;return this.gr(e,r=>{n++}).next(()=>n)}gr(e,n){return q.forEach(this.gi,(r,s)=>this.Sr(e,r,s).next(i=>i?q.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ri(e,a=>this.Sr(e,a,n).next(c=>{c||(r++,i.removeEntry(a,fe.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.gi.set(n,e.currentSequenceNumber),q.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),q.resolve()}removeReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,n){return this.gi.set(n,e.currentSequenceNumber),q.resolve()}Pi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=kl(e.data.value)),n}Sr(e,n,r){return q.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.gi.get(n);return q.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hf{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Is=r,this.ds=s}static Es(e,n){let r=Ne(),s=Ne();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Hf(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return QN()?8:kC(Dt())>0?6:4}()}initialize(e,n){this.gs=e,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ps(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ys(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new Zk;return this.ws(e,n,a).next(c=>{if(i.result=c,this.Rs)return this.Ss(e,n,a,c.size)})}).next(()=>i.result)}Ss(e,n,r,s){return r.documentReadCount<this.Vs?(Ws()<=Ee.DEBUG&&re("QueryEngine","SDK will not create cache indexes for query:",Gs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),q.resolve()):(Ws()<=Ee.DEBUG&&re("QueryEngine","Query:",Gs(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.fs*s?(Ws()<=Ee.DEBUG&&re("QueryEngine","The SDK decides to create cache indexes for query:",Gs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fn(n))):q.resolve())}ps(e,n){if(fy(n))return q.resolve(null);let r=Fn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=hh(n,null,"F"),r=Fn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=Ne(...i);return this.gs.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.bs(n,c);return this.Ds(n,d,a,u.readTime)?this.ps(e,hh(n,null,"F")):this.vs(e,d,n,u)}))})))}ys(e,n,r,s){return fy(n)||s.isEqual(fe.min())?q.resolve(null):this.gs.getDocuments(e,r).next(i=>{const a=this.bs(n,i);return this.Ds(n,a,r,s)?q.resolve(null):(Ws()<=Ee.DEBUG&&re("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Gs(n)),this.vs(e,a,n,NC(s,na)).next(c=>c))})}bs(e,n){let r=new ht(Vw(e));return n.forEach((s,i)=>{Gc(e,i)&&(r=r.add(i))}),r}Ds(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ws(e,n,r){return Ws()<=Ee.DEBUG&&re("QueryEngine","Using full collection scan to execute query:",Gs(n)),this.gs.getDocumentsMatchingQuery(e,n,Qr.min(),r)}vs(e,n,r,s){return this.gs.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wf="LocalStore",t2=3e8;class n2{constructor(e,n,r,s){this.persistence=e,this.Cs=n,this.serializer=s,this.Fs=new et(xe),this.Ms=new Fs(i=>Of(i),Lf),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qk(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Fs))}}function r2(t,e,n,r){return new n2(t,e,n,r)}async function c_(t,e){const n=me(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Ns(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],c=[];let u=Ne();for(const d of s){a.push(d.batchId);for(const p of d.mutations)u=u.add(p.key)}for(const d of i){c.push(d.batchId);for(const p of d.mutations)u=u.add(p.key)}return n.localDocuments.getDocuments(r,u).next(d=>({Bs:d,removedBatchIds:a,addedBatchIds:c}))})})}function s2(t,e){const n=me(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Os.newChangeBuffer({trackRemovals:!0});return function(c,u,d,p){const y=d.batch,m=y.keys();let T=q.resolve();return m.forEach(w=>{T=T.next(()=>p.getEntry(u,w)).next(P=>{const I=d.docVersions.get(w);De(I!==null,48541),P.version.compareTo(I)<0&&(y.applyToRemoteDocument(P,d),P.isValidDocument()&&(P.setReadTime(d.commitVersion),p.addEntry(P)))})}),T.next(()=>c.mutationQueue.removeMutationBatch(u,y))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=Ne();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function u_(t){const e=me(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.hi.getLastRemoteSnapshotVersion(n))}function i2(t,e){const n=me(t),r=e.snapshotVersion;let s=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.Os.newChangeBuffer({trackRemovals:!0});s=n.Fs;const c=[];e.targetChanges.forEach((p,y)=>{const m=s.get(y);if(!m)return;c.push(n.hi.removeMatchingKeys(i,p.removedDocuments,y).next(()=>n.hi.addMatchingKeys(i,p.addedDocuments,y)));let T=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(y)!==null?T=T.withResumeToken(Et.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):p.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(p.resumeToken,r)),s=s.insert(y,T),function(P,I,E){return P.resumeToken.approximateByteSize()===0||I.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=t2?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(m,T,p)&&c.push(n.hi.updateTargetData(i,T))});let u=lr(),d=Ne();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,p))}),c.push(o2(i,a,e.documentUpdates).next(p=>{u=p.Ls,d=p.ks})),!r.isEqual(fe.min())){const p=n.hi.getLastRemoteSnapshotVersion(i).next(y=>n.hi.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(p)}return q.waitFor(c).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.Fs=s,i))}function o2(t,e,n){let r=Ne(),s=Ne();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=lr();return n.forEach((c,u)=>{const d=i.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(fe.min())?(e.removeEntry(c,u.readTime),a=a.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),a=a.insert(c,u)):re(Wf,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{Ls:a,ks:s}})}function a2(t,e){const n=me(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Pf),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function l2(t,e){const n=me(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.hi.getTargetData(r,e).next(i=>i?(s=i,q.resolve(s)):n.hi.allocateTargetId(r).next(a=>(s=new Cr(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Fs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(e,r.targetId)),r})}async function yh(t,e,n){const r=me(t),s=r.Fs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Bi(a))throw a;re(Wf,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(s.target)}function Sy(t,e,n){const r=me(t);let s=fe.min(),i=Ne();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,d,p){const y=me(u),m=y.Ms.get(p);return m!==void 0?q.resolve(y.Fs.get(m)):y.hi.getTargetData(d,p)}(r,a,Fn(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(a,c.targetId).next(u=>{i=u})}).next(()=>r.Cs.getDocumentsMatchingQuery(a,e,n?s:fe.min(),n?i:Ne())).next(c=>(c2(r,XC(e),c),{documents:c,qs:i})))}function c2(t,e,n){let r=t.xs.get(e)||fe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.xs.set(e,r)}class Iy{constructor(){this.activeTargetIds=nk()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class u2{constructor(){this.Fo=new Iy,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,n,r){this.Mo[e]=n}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Iy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cy="ConnectivityMonitor";class ky{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){re(Cy,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){re(Cy,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dl=null;function vh(){return dl===null?dl=function(){return 268435456+Math.round(2147483648*Math.random())}():dl++,"0x"+dl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nd="RestConnection",h2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class f2{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.Ko=this.databaseId.database===fc?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,n,r,s,i){const a=vh(),c=this.Go(e,n.toUriEncodedString());re(nd,`Sending RPC '${e}' ${a}:`,c,r);const u={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(u,s,i);const{host:d}=new URL(c),p=Mi(d);return this.jo(e,c,u,r,p).then(y=>(re(nd,`Received RPC '${e}' ${a}: `,y),y),y=>{throw Kr(nd,`RPC '${e}' ${a} failed with error: `,y,"url: ",c,"request:",r),y})}Jo(e,n,r,s,i,a){return this.Wo(e,n,r,s,i)}zo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ui}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}Go(e,n){const r=h2[e];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kt="WebChannelConnection";class m2 extends f2{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,n,r,s,i){const a=vh();return new Promise((c,u)=>{const d=new uw;d.setWithCredentials(!0),d.listenOnce(dw.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Cl.NO_ERROR:const y=d.getResponseJson();re(kt,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(y)),c(y);break;case Cl.TIMEOUT:re(kt,`RPC '${e}' ${a} timed out`),u(new te(B.DEADLINE_EXCEEDED,"Request time out"));break;case Cl.HTTP_ERROR:const m=d.getStatus();if(re(kt,`RPC '${e}' ${a} failed with status:`,m,"response text:",d.getResponseText()),m>0){let T=d.getResponseJson();Array.isArray(T)&&(T=T[0]);const w=T==null?void 0:T.error;if(w&&w.status&&w.message){const P=function(E){const x=E.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(x)>=0?x:B.UNKNOWN}(w.status);u(new te(P,w.message))}else u(new te(B.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new te(B.UNAVAILABLE,"Connection failed."));break;default:de(9055,{c_:e,streamId:a,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{re(kt,`RPC '${e}' ${a} completed.`)}});const p=JSON.stringify(s);re(kt,`RPC '${e}' ${a} sending request:`,s),d.send(n,"POST",p,r,15)})}P_(e,n,r){const s=vh(),i=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=pw(),c=fw(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.zo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const p=i.join("");re(kt,`Creating RPC '${e}' stream ${s}: ${p}`,u);const y=a.createWebChannel(p,u);this.T_(y);let m=!1,T=!1;const w=new p2({Ho:I=>{T?re(kt,`Not sending because RPC '${e}' stream ${s} is closed:`,I):(m||(re(kt,`Opening RPC '${e}' stream ${s} transport.`),y.open(),m=!0),re(kt,`RPC '${e}' stream ${s} sending:`,I),y.send(I))},Yo:()=>y.close()}),P=(I,E,x)=>{I.listen(E,b=>{try{x(b)}catch(R){setTimeout(()=>{throw R},0)}})};return P(y,yo.EventType.OPEN,()=>{T||(re(kt,`RPC '${e}' stream ${s} transport opened.`),w.s_())}),P(y,yo.EventType.CLOSE,()=>{T||(T=!0,re(kt,`RPC '${e}' stream ${s} transport closed`),w.__(),this.I_(y))}),P(y,yo.EventType.ERROR,I=>{T||(T=!0,Kr(kt,`RPC '${e}' stream ${s} transport errored. Name:`,I.name,"Message:",I.message),w.__(new te(B.UNAVAILABLE,"The operation could not be completed")))}),P(y,yo.EventType.MESSAGE,I=>{var E;if(!T){const x=I.data[0];De(!!x,16349);const b=x,R=(b==null?void 0:b.error)||((E=b[0])===null||E===void 0?void 0:E.error);if(R){re(kt,`RPC '${e}' stream ${s} received error:`,R);const L=R.status;let M=function(v){const _=it[v];if(_!==void 0)return Yw(_)}(L),N=R.message;M===void 0&&(M=B.INTERNAL,N="Unknown error status: "+L+" with message "+R.message),T=!0,w.__(new te(M,N)),y.close()}else re(kt,`RPC '${e}' stream ${s} received:`,x),w.a_(x)}}),P(c,hw.STAT_EVENT,I=>{I.stat===ih.PROXY?re(kt,`RPC '${e}' stream ${s} detected buffering proxy`):I.stat===ih.NOPROXY&&re(kt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{w.o_()},0),w}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(n=>n===e)}}function rd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yc(t){return new xk(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Fi=e,this.timerId=n,this.d_=r,this.E_=s,this.A_=i,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),s=Math.max(0,n-r);s>0&&re("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,s,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay="PersistentStream";class h_{constructor(e,n,r,s,i,a,c,u){this.Fi=e,this.w_=r,this.S_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new d_(e,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():n&&n.code===B.RESOURCE_EXHAUSTED?(ar(n.toString()),ar("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(n)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.b_===n&&this.W_(r,s)},r=>{e(()=>{const s=new te(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(s)})})}W_(e,n){const r=this.K_(this.b_);this.stream=this.z_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(s=>{r(()=>this.G_(s))}),this.stream.onMessage(s=>{r(()=>++this.C_==1?this.j_(s):this.onNext(s))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return re(Ay,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return n=>{this.Fi.enqueueAndForget(()=>this.b_===e?n():(re(Ay,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class g2 extends h_{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}z_(e,n){return this.connection.P_("Listen",e,n)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const n=bk(this.serializer,e),r=function(i){if(!("targetChange"in i))return fe.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?fe.min():a.readTime?Un(a.readTime):fe.min()}(e);return this.listener.J_(n,r)}H_(e){const n={};n.database=gh(this.serializer),n.addTarget=function(i,a){let c;const u=a.target;if(c=uh(u)?{documents:Tk(i,u)}:{query:Sk(i,u).Vt},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=e_(i,a.resumeToken);const d=fh(i,a.expectedCount);d!==null&&(c.expectedCount=d)}else if(a.snapshotVersion.compareTo(fe.min())>0){c.readTime=gc(i,a.snapshotVersion.toTimestamp());const d=fh(i,a.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const r=Ck(this.serializer,e);r&&(n.labels=r),this.k_(n)}Y_(e){const n={};n.database=gh(this.serializer),n.removeTarget=e,this.k_(n)}}class y2 extends h_{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,n){return this.connection.P_("Write",e,n)}j_(e){return De(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,De(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){De(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const n=Nk(e.writeResults,e.commitTime),r=Un(e.commitTime);return this.listener.ta(r,n)}na(){const e={};e.database=gh(this.serializer),this.k_(e)}X_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Ek(this.serializer,r))};this.k_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{}class x2 extends v2{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ra=!1}ia(){if(this.ra)throw new te(B.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Wo(e,ph(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new te(B.UNKNOWN,i.toString())})}Jo(e,n,r,s,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Jo(e,ph(n,r),s,a,c,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new te(B.UNKNOWN,a.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class w2{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ar(n),this._a=!1):re("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ds="RemoteStore";class _2{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=i,this.Ea.xo(a=>{r.enqueueAndForget(async()=>{Us(this)&&(re(Ds,"Restarting streams for network reachability change."),await async function(u){const d=me(u);d.Ia.add(4),await Na(d),d.Aa.set("Unknown"),d.Ia.delete(4),await Jc(d)}(this))})}),this.Aa=new w2(r,s)}}async function Jc(t){if(Us(t))for(const e of t.da)await e(!0)}async function Na(t){for(const e of t.da)await e(!1)}function f_(t,e){const n=me(t);n.Ta.has(e.targetId)||(n.Ta.set(e.targetId,e),Xf(n)?Qf(n):qi(n).x_()&&Kf(n,e))}function Gf(t,e){const n=me(t),r=qi(n);n.Ta.delete(e),r.x_()&&p_(n,e),n.Ta.size===0&&(r.x_()?r.B_():Us(n)&&n.Aa.set("Unknown"))}function Kf(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}qi(t).H_(e)}function p_(t,e){t.Ra.$e(e),qi(t).Y_(e)}function Qf(t){t.Ra=new mk({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),qi(t).start(),t.Aa.aa()}function Xf(t){return Us(t)&&!qi(t).M_()&&t.Ta.size>0}function Us(t){return me(t).Ia.size===0}function m_(t){t.Ra=void 0}async function b2(t){t.Aa.set("Online")}async function E2(t){t.Ta.forEach((e,n)=>{Kf(t,e)})}async function N2(t,e){m_(t),Xf(t)?(t.Aa.la(e),Qf(t)):t.Aa.set("Unknown")}async function T2(t,e,n){if(t.Aa.set("Online"),e instanceof Zw&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const c of i.targetIds)s.Ta.has(c)&&(await s.remoteSyncer.rejectListen(c,a),s.Ta.delete(c),s.Ra.removeTarget(c))}(t,e)}catch(r){re(Ds,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await vc(t,r)}else if(e instanceof Pl?t.Ra.Ye(e):e instanceof Jw?t.Ra.it(e):t.Ra.et(e),!n.isEqual(fe.min()))try{const r=await u_(t.localStore);n.compareTo(r)>=0&&await function(i,a){const c=i.Ra.Pt(a);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const p=i.Ta.get(d);p&&i.Ta.set(d,p.withResumeToken(u.resumeToken,a))}}),c.targetMismatches.forEach((u,d)=>{const p=i.Ta.get(u);if(!p)return;i.Ta.set(u,p.withResumeToken(Et.EMPTY_BYTE_STRING,p.snapshotVersion)),p_(i,u);const y=new Cr(p.target,u,d,p.sequenceNumber);Kf(i,y)}),i.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){re(Ds,"Failed to raise snapshot:",r),await vc(t,r)}}async function vc(t,e,n){if(!Bi(e))throw e;t.Ia.add(1),await Na(t),t.Aa.set("Offline"),n||(n=()=>u_(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{re(Ds,"Retrying IndexedDB access"),await n(),t.Ia.delete(1),await Jc(t)})}function g_(t,e){return e().catch(n=>vc(t,n,e))}async function Zc(t){const e=me(t),n=Zr(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Pf;for(;S2(e);)try{const s=await a2(e.localStore,r);if(s===null){e.Pa.length===0&&n.B_();break}r=s.batchId,I2(e,s)}catch(s){await vc(e,s)}y_(e)&&v_(e)}function S2(t){return Us(t)&&t.Pa.length<10}function I2(t,e){t.Pa.push(e);const n=Zr(t);n.x_()&&n.Z_&&n.X_(e.mutations)}function y_(t){return Us(t)&&!Zr(t).M_()&&t.Pa.length>0}function v_(t){Zr(t).start()}async function C2(t){Zr(t).na()}async function k2(t){const e=Zr(t);for(const n of t.Pa)e.X_(n.mutations)}async function A2(t,e,n){const r=t.Pa.shift(),s=Uf.from(r,e,n);await g_(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Zc(t)}async function j2(t,e){e&&Zr(t).Z_&&await async function(r,s){if(function(a){return fk(a)&&a!==B.ABORTED}(s.code)){const i=r.Pa.shift();Zr(r).N_(),await g_(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Zc(r)}}(t,e),y_(t)&&v_(t)}async function jy(t,e){const n=me(t);n.asyncQueue.verifyOperationInProgress(),re(Ds,"RemoteStore received new credentials");const r=Us(n);n.Ia.add(3),await Na(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ia.delete(3),await Jc(n)}async function P2(t,e){const n=me(t);e?(n.Ia.delete(2),await Jc(n)):e||(n.Ia.add(2),await Na(n),n.Aa.set("Unknown"))}function qi(t){return t.Va||(t.Va=function(n,r,s){const i=me(n);return i.ia(),new g2(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:b2.bind(null,t),e_:E2.bind(null,t),n_:N2.bind(null,t),J_:T2.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),Xf(t)?Qf(t):t.Aa.set("Unknown")):(await t.Va.stop(),m_(t))})),t.Va}function Zr(t){return t.ma||(t.ma=function(n,r,s){const i=me(n);return i.ia(),new y2(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:C2.bind(null,t),n_:j2.bind(null,t),ea:k2.bind(null,t),ta:A2.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await Zc(t)):(await t.ma.stop(),t.Pa.length>0&&(re(Ds,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Br,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,c=new Yf(e,n,a,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new te(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Jf(t,e){if(ar("AsyncQueue",`${e}: ${t}`),Bi(t))return new te(B.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{static emptySet(e){return new xi(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ce.comparator(n.key,r.key):(n,r)=>ce.comparator(n.key,r.key),this.keyedMap=vo(),this.sortedSet=new et(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof xi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new xi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(){this.fa=new et(ce.comparator)}track(e){const n=e.doc.key,r=this.fa.get(n);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(n,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(n):e.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):de(63341,{At:e,ga:r}):this.fa=this.fa.insert(n,e)}pa(){const e=[];return this.fa.inorderTraversal((n,r)=>{e.push(r)}),e}}class Pi{constructor(e,n,r,s,i,a,c,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(c=>{a.push({type:0,doc:c})}),new Pi(e,n,xi.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Wc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class D2{constructor(){this.queries=Ry(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const s=me(n),i=s.queries;s.queries=Ry(),i.forEach((a,c)=>{for(const u of c.wa)u.onError(r)})})(this,new te(B.ABORTED,"Firestore shutting down"))}}function Ry(){return new Fs(t=>Mw(t),Wc)}async function x_(t,e){const n=me(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.Sa()&&e.ba()&&(r=2):(i=new R2,r=e.ba()?0:1);try{switch(r){case 0:i.ya=await n.onListen(s,!0);break;case 1:i.ya=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const c=Jf(a,`Initialization of query '${Gs(e.query)}' failed`);return void e.onError(c)}n.queries.set(s,i),i.wa.push(e),e.va(n.onlineState),i.ya&&e.Ca(i.ya)&&Zf(n)}async function w_(t,e){const n=me(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.wa.indexOf(e);a>=0&&(i.wa.splice(a,1),i.wa.length===0?s=e.ba()?0:1:!i.Sa()&&e.ba()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function O2(t,e){const n=me(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const c of a.wa)c.Ca(s)&&(r=!0);a.ya=s}}r&&Zf(n)}function L2(t,e,n){const r=me(t),s=r.queries.get(e);if(s)for(const i of s.wa)i.onError(n);r.queries.delete(e)}function Zf(t){t.Da.forEach(e=>{e.next()})}var xh,Dy;(Dy=xh||(xh={})).Fa="default",Dy.Cache="cache";class __{constructor(e,n,r){this.query=e,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Pi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),n=!0):this.Ba(e,this.onlineState)&&(this.La(e),n=!0),this.Oa=e,n}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),n=!0),n}Ba(e,n){if(!e.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(e){e=Pi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==xh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_{constructor(e){this.key=e}}class E_{constructor(e){this.key=e}}class M2{constructor(e,n){this.query=e,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Ne(),this.mutatedKeys=Ne(),this.Xa=Vw(e),this.eu=new xi(this.Xa)}get tu(){return this.Ha}nu(e,n){const r=n?n.ru:new Py,s=n?n.eu:this.eu;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((p,y)=>{const m=s.get(p),T=Gc(this.query,y)?y:null,w=!!m&&this.mutatedKeys.has(m.key),P=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let I=!1;m&&T?m.data.isEqual(T.data)?w!==P&&(r.track({type:3,doc:T}),I=!0):this.iu(m,T)||(r.track({type:2,doc:T}),I=!0,(u&&this.Xa(T,u)>0||d&&this.Xa(T,d)<0)&&(c=!0)):!m&&T?(r.track({type:0,doc:T}),I=!0):m&&!T&&(r.track({type:1,doc:m}),I=!0,(u||d)&&(c=!0)),I&&(T?(a=a.add(T),i=P?i.add(p):i.delete(p)):(a=a.delete(p),i=i.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{eu:a,ru:r,Ds:c,mutatedKeys:i}}iu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const a=e.ru.pa();a.sort((p,y)=>function(T,w){const P=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return de(20277,{At:I})}};return P(T)-P(w)}(p.type,y.type)||this.Xa(p.doc,y.doc)),this.su(r),s=s!=null&&s;const c=n&&!s?this.ou():[],u=this.Za.size===0&&this.current&&!s?1:0,d=u!==this.Ya;return this.Ya=u,a.length!==0||d?{snapshot:new Pi(this.query,e.eu,i,a,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:c}:{_u:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Py,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=Ne(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return e.forEach(r=>{this.Za.has(r)||n.push(new E_(r))}),this.Za.forEach(r=>{e.has(r)||n.push(new b_(r))}),n}uu(e){this.Ha=e.qs,this.Za=Ne();const n=this.nu(e.documents);return this.applyChanges(n,!0)}cu(){return Pi.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const ep="SyncEngine";class V2{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class F2{constructor(e){this.key=e,this.lu=!1}}class U2{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.hu={},this.Pu=new Fs(c=>Mw(c),Wc),this.Tu=new Map,this.Iu=new Set,this.du=new et(ce.comparator),this.Eu=new Map,this.Au=new $f,this.Ru={},this.Vu=new Map,this.mu=ji.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function z2(t,e,n=!0){const r=k_(t);let s;const i=r.Pu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.cu()):s=await N_(r,e,n,!0),s}async function B2(t,e){const n=k_(t);await N_(n,e,!0,!1)}async function N_(t,e,n,r){const s=await l2(t.localStore,Fn(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let c;return r&&(c=await $2(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&f_(t.remoteStore,s),c}async function $2(t,e,n,r,s){t.gu=(y,m,T)=>async function(P,I,E,x){let b=I.view.nu(E);b.Ds&&(b=await Sy(P.localStore,I.query,!1).then(({documents:N})=>I.view.nu(N,b)));const R=x&&x.targetChanges.get(I.targetId),L=x&&x.targetMismatches.get(I.targetId)!=null,M=I.view.applyChanges(b,P.isPrimaryClient,R,L);return Ly(P,I.targetId,M._u),M.snapshot}(t,y,m,T);const i=await Sy(t.localStore,e,!0),a=new M2(e,i.qs),c=a.nu(i.documents),u=Ea.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=a.applyChanges(c,t.isPrimaryClient,u);Ly(t,n,d._u);const p=new V2(e,n,a);return t.Pu.set(e,p),t.Tu.has(n)?t.Tu.get(n).push(e):t.Tu.set(n,[e]),d.snapshot}async function q2(t,e,n){const r=me(t),s=r.Pu.get(e),i=r.Tu.get(s.targetId);if(i.length>1)return r.Tu.set(s.targetId,i.filter(a=>!Wc(a,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await yh(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Gf(r.remoteStore,s.targetId),wh(r,s.targetId)}).catch(zi)):(wh(r,s.targetId),await yh(r.localStore,s.targetId,!0))}async function H2(t,e){const n=me(t),r=n.Pu.get(e),s=n.Tu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Gf(n.remoteStore,r.targetId))}async function W2(t,e,n){const r=Z2(t);try{const s=await function(a,c){const u=me(a),d=qe.now(),p=c.reduce((T,w)=>T.add(w.key),Ne());let y,m;return u.persistence.runTransaction("Locally write mutations","readwrite",T=>{let w=lr(),P=Ne();return u.Os.getEntries(T,p).next(I=>{w=I,w.forEach((E,x)=>{x.isValidDocument()||(P=P.add(E))})}).next(()=>u.localDocuments.getOverlayedDocuments(T,w)).next(I=>{y=I;const E=[];for(const x of c){const b=lk(x,y.get(x.key).overlayedDocument);b!=null&&E.push(new is(x.key,b,kw(b.value.mapValue),Sn.exists(!0)))}return u.mutationQueue.addMutationBatch(T,d,E,c)}).next(I=>{m=I;const E=I.applyToLocalDocumentSet(y,P);return u.documentOverlayCache.saveOverlays(T,I.batchId,E)})}).then(()=>({batchId:m.batchId,changes:Uw(y)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,c,u){let d=a.Ru[a.currentUser.toKey()];d||(d=new et(xe)),d=d.insert(c,u),a.Ru[a.currentUser.toKey()]=d}(r,s.batchId,n),await Ta(r,s.changes),await Zc(r.remoteStore)}catch(s){const i=Jf(s,"Failed to persist write");n.reject(i)}}async function T_(t,e){const n=me(t);try{const r=await i2(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Eu.get(i);a&&(De(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.lu=!0:s.modifiedDocuments.size>0?De(a.lu,14607):s.removedDocuments.size>0&&(De(a.lu,42227),a.lu=!1))}),await Ta(n,r,e)}catch(r){await zi(r)}}function Oy(t,e,n){const r=me(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Pu.forEach((i,a)=>{const c=a.view.va(e);c.snapshot&&s.push(c.snapshot)}),function(a,c){const u=me(a);u.onlineState=c;let d=!1;u.queries.forEach((p,y)=>{for(const m of y.wa)m.va(c)&&(d=!0)}),d&&Zf(u)}(r.eventManager,e),s.length&&r.hu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function G2(t,e,n){const r=me(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Eu.get(e),i=s&&s.key;if(i){let a=new et(ce.comparator);a=a.insert(i,Pt.newNoDocument(i,fe.min()));const c=Ne().add(i),u=new Xc(fe.min(),new Map,new et(xe),a,c);await T_(r,u),r.du=r.du.remove(i),r.Eu.delete(e),tp(r)}else await yh(r.localStore,e,!1).then(()=>wh(r,e,n)).catch(zi)}async function K2(t,e){const n=me(t),r=e.batch.batchId;try{const s=await s2(n.localStore,e);I_(n,r,null),S_(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ta(n,s)}catch(s){await zi(s)}}async function Q2(t,e,n){const r=me(t);try{const s=await function(a,c){const u=me(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return u.mutationQueue.lookupMutationBatch(d,c).next(y=>(De(y!==null,37113),p=y.keys(),u.mutationQueue.removeMutationBatch(d,y))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,p,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>u.localDocuments.getDocuments(d,p))})}(r.localStore,e);I_(r,e,n),S_(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ta(r,s)}catch(s){await zi(s)}}function S_(t,e){(t.Vu.get(e)||[]).forEach(n=>{n.resolve()}),t.Vu.delete(e)}function I_(t,e,n){const r=me(t);let s=r.Ru[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ru[r.currentUser.toKey()]=s}}function wh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Tu.get(e))t.Pu.delete(r),n&&t.hu.pu(r,n);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(r=>{t.Au.containsKey(r)||C_(t,r)})}function C_(t,e){t.Iu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Gf(t.remoteStore,n),t.du=t.du.remove(e),t.Eu.delete(n),tp(t))}function Ly(t,e,n){for(const r of n)r instanceof b_?(t.Au.addReference(r.key,e),X2(t,r)):r instanceof E_?(re(ep,"Document no longer in limbo: "+r.key),t.Au.removeReference(r.key,e),t.Au.containsKey(r.key)||C_(t,r.key)):de(19791,{yu:r})}function X2(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Iu.has(r)||(re(ep,"New document in limbo: "+n),t.Iu.add(r),tp(t))}function tp(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const n=new ce(Ve.fromString(e)),r=t.mu.next();t.Eu.set(r,new F2(n)),t.du=t.du.insert(n,r),f_(t.remoteStore,new Cr(Fn(Mf(n.path)),r,"TargetPurposeLimboResolution",$c.ue))}}async function Ta(t,e,n){const r=me(t),s=[],i=[],a=[];r.Pu.isEmpty()||(r.Pu.forEach((c,u)=>{a.push(r.gu(u,e,n).then(d=>{var p;if((d||n)&&r.isPrimaryClient){const y=d?!d.fromCache:(p=n==null?void 0:n.targetChanges.get(u.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(u.targetId,y?"current":"not-current")}if(d){s.push(d);const y=Hf.Es(u.targetId,d);i.push(y)}}))}),await Promise.all(a),r.hu.J_(s),await async function(u,d){const p=me(u);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>q.forEach(d,m=>q.forEach(m.Is,T=>p.persistence.referenceDelegate.addReference(y,m.targetId,T)).next(()=>q.forEach(m.ds,T=>p.persistence.referenceDelegate.removeReference(y,m.targetId,T)))))}catch(y){if(!Bi(y))throw y;re(Wf,"Failed to update sequence numbers: "+y)}for(const y of d){const m=y.targetId;if(!y.fromCache){const T=p.Fs.get(m),w=T.snapshotVersion,P=T.withLastLimboFreeSnapshotVersion(w);p.Fs=p.Fs.insert(m,P)}}}(r.localStore,i))}async function Y2(t,e){const n=me(t);if(!n.currentUser.isEqual(e)){re(ep,"User change. New user:",e.toKey());const r=await c_(n.localStore,e);n.currentUser=e,function(i,a){i.Vu.forEach(c=>{c.forEach(u=>{u.reject(new te(B.CANCELLED,a))})}),i.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ta(n,r.Bs)}}function J2(t,e){const n=me(t),r=n.Eu.get(e);if(r&&r.lu)return Ne().add(r.key);{let s=Ne();const i=n.Tu.get(e);if(!i)return s;for(const a of i){const c=n.Pu.get(a);s=s.unionWith(c.view.tu)}return s}}function k_(t){const e=me(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=T_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=J2.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=G2.bind(null,e),e.hu.J_=O2.bind(null,e.eventManager),e.hu.pu=L2.bind(null,e.eventManager),e}function Z2(t){const e=me(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=K2.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Q2.bind(null,e),e}class xc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Yc(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,n){return null}Fu(e,n){return null}vu(e){return r2(this.persistence,new e2,e.initialUser,this.serializer)}Du(e){return new l_(qf.Vi,this.serializer)}bu(e){return new u2}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}xc.provider={build:()=>new xc};class eA extends xc{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,n){De(this.persistence.referenceDelegate instanceof yc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new Fk(r,e.asyncQueue,n)}Du(e){const n=this.cacheSizeBytes!==void 0?$t.withCacheSize(this.cacheSizeBytes):$t.DEFAULT;return new l_(r=>yc.Vi(r,n),this.serializer)}}class _h{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Oy(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Y2.bind(null,this.syncEngine),await P2(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new D2}()}createDatastore(e){const n=Yc(e.databaseInfo.databaseId),r=function(i){return new m2(i)}(e.databaseInfo);return function(i,a,c,u){return new x2(i,a,c,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,c){return new _2(r,s,i,a,c)}(this.localStore,this.datastore,e.asyncQueue,n=>Oy(this.syncEngine,n,0),function(){return ky.C()?new ky:new d2}())}createSyncEngine(e,n){return function(s,i,a,c,u,d,p){const y=new U2(s,i,a,c,u,d);return p&&(y.fu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=me(s);re(Ds,"RemoteStore shutting down."),i.Ia.add(5),await Na(i),i.Ea.shutdown(),i.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}_h.provider={build:()=>new _h};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ar("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const es="FirestoreClient";class tA{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=At.UNAUTHENTICATED,this.clientId=jf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{re(es,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(re(es,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Br;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Jf(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function sd(t,e){t.asyncQueue.verifyOperationInProgress(),re(es,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await c_(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>{Kr("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{re("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(s=>{Kr("Terminating Firestore due to IndexedDb database deletion failed",s)})}),t._offlineComponents=e}async function My(t,e){t.asyncQueue.verifyOperationInProgress();const n=await nA(t);re(es,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>jy(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>jy(e.remoteStore,s)),t._onlineComponents=e}async function nA(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){re(es,"Using user provided OfflineComponentProvider");try{await sd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===B.FAILED_PRECONDITION||s.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Kr("Error using user provided cache. Falling back to memory cache: "+n),await sd(t,new xc)}}else re(es,"Using default OfflineComponentProvider"),await sd(t,new eA(void 0));return t._offlineComponents}async function j_(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(re(es,"Using user provided OnlineComponentProvider"),await My(t,t._uninitializedComponentsProvider._online)):(re(es,"Using default OnlineComponentProvider"),await My(t,new _h))),t._onlineComponents}function rA(t){return j_(t).then(e=>e.syncEngine)}async function bh(t){const e=await j_(t),n=e.eventManager;return n.onListen=z2.bind(null,e.syncEngine),n.onUnlisten=q2.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=B2.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=H2.bind(null,e.syncEngine),n}function sA(t,e,n={}){const r=new Br;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,u,d){const p=new A_({next:m=>{p.Ou(),a.enqueueAndForget(()=>w_(i,y)),m.fromCache&&u.source==="server"?d.reject(new te(B.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),y=new __(c,p,{includeMetadataChanges:!0,ka:!0});return x_(i,y)}(await bh(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vy=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R_="firestore.googleapis.com",Fy=!0;class Uy{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new te(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=R_,this.ssl=Fy}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:Fy;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=a_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Mk)throw new te(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}EC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=P_((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new te(B.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new te(B.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new te(B.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class eu{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Uy({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new te(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new te(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Uy(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new pC;switch(r.type){case"firstParty":return new vC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new te(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Vy.get(n);r&&(re("ComponentProvider","Removing Datastore"),Vy.delete(n),r.terminate())}(this),Promise.resolve()}}function iA(t,e,n,r={}){var s;t=Vn(t,eu);const i=Mi(e),a=t._getSettings(),c=Object.assign(Object.assign({},a),{emulatorOptions:t._getEmulatorOptions()}),u=`${e}:${n}`;i&&(Ex(`https://${u}`),Nx("Firestore",!0)),a.host!==R_&&a.host!==u&&Kr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},a),{host:u,ssl:i,emulatorOptions:r});if(!As(d,c)&&(t._setSettings(d),r.mockUserToken)){let p,y;if(typeof r.mockUserToken=="string")p=r.mockUserToken,y=At.MOCK_USER;else{p=UN(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new te(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new At(m)}t._authCredentials=new mC(new gw(p,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new os(this.firestore,e,this._query)}}class ct{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $r(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ct(this.firestore,e,this._key)}toJSON(){return{type:ct._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(_a(n,ct._jsonSchema))return new ct(e,r||null,new ce(Ve.fromString(n.referencePath)))}}ct._jsonSchemaVersion="firestore/documentReference/1.0",ct._jsonSchema={type:lt("string",ct._jsonSchemaVersion),referencePath:lt("string")};class $r extends os{constructor(e,n,r){super(e,n,Mf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ct(this.firestore,null,new ce(e))}withConverter(e){return new $r(this.firestore,e,this._path)}}function Qe(t,e,...n){if(t=Ot(t),vw("collection","path",e),t instanceof eu){const r=Ve.fromString(e,...n);return Zg(r),new $r(t,null,r)}{if(!(t instanceof ct||t instanceof $r))throw new te(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ve.fromString(e,...n));return Zg(r),new $r(t.firestore,null,r)}}function Re(t,e,...n){if(t=Ot(t),arguments.length===1&&(e=jf.newId()),vw("doc","path",e),t instanceof eu){const r=Ve.fromString(e,...n);return Jg(r),new ct(t,null,new ce(r))}{if(!(t instanceof ct||t instanceof $r))throw new te(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ve.fromString(e,...n));return Jg(r),new ct(t.firestore,t instanceof $r?t.converter:null,new ce(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zy="AsyncQueue";class By{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new d_(this,"async_queue_retry"),this.oc=()=>{const r=rd();r&&re(zy,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const n=rd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const n=rd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new Br;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Bi(e))throw e;re(zy,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const n=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,ar("INTERNAL UNHANDLED ERROR: ",$y(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(e,n,r){this.ac(),this.sc.indexOf(e)>-1&&(n=0);const s=Yf.createAndSchedule(this,e,n,r,i=>this.lc(i));return this.ec.push(s),s}ac(){this.tc&&de(47125,{hc:$y(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const n of this.ec)if(n.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const n=this.ec.indexOf(e);this.ec.splice(n,1)}}function $y(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qy(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Os extends eu{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new By,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new By(e),this._firestoreClient=void 0,await e}}}function oA(t,e){const n=typeof t=="object"?t:Cx(),r=typeof t=="string"?t:fc,s=_f(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=VN("firestore");i&&iA(s,...i)}return s}function np(t){if(t._terminated)throw new te(B.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||aA(t),t._firestoreClient}function aA(t){var e,n,r;const s=t._freezeSettings(),i=function(c,u,d,p){return new DC(c,u,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,P_(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new tA(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new cn(Et.fromBase64String(e))}catch(n){throw new te(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new cn(Et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:cn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(_a(e,cn._jsonSchema))return cn.fromBase64String(e.bytes)}}cn._jsonSchemaVersion="firestore/bytes/1.0",cn._jsonSchema={type:lt("string",cn._jsonSchemaVersion),bytes:lt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new te(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new te(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new te(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:zn._jsonSchemaVersion}}static fromJSON(e){if(_a(e,zn._jsonSchema))return new zn(e.latitude,e.longitude)}}zn._jsonSchemaVersion="firestore/geoPoint/1.0",zn._jsonSchema={type:lt("string",zn._jsonSchemaVersion),latitude:lt("number"),longitude:lt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Bn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(_a(e,Bn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Bn(e.vectorValues);throw new te(B.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Bn._jsonSchemaVersion="firestore/vectorValue/1.0",Bn._jsonSchema={type:lt("string",Bn._jsonSchemaVersion),vectorValues:lt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lA=/^__.*__$/;class cA{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new is(e,this.data,this.fieldMask,n,this.fieldTransforms):new ba(e,this.data,n,this.fieldTransforms)}}class D_{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new is(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function O_(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw de(40011,{Ec:t})}}class rp{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Ac(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new rp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Rc({path:r,mc:!1});return s.fc(e),s}gc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Rc({path:r,mc:!1});return s.Ac(),s}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return wc(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(O_(this.Ec)&&lA.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class uA{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Yc(e)}Dc(e,n,r,s=!1){return new rp({Ec:e,methodName:n,bc:r,path:wt.emptyPath(),mc:!1,Sc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function sp(t){const e=t._freezeSettings(),n=Yc(t._databaseId);return new uA(t._databaseId,!!e.ignoreUndefinedProperties,n)}function dA(t,e,n,r,s,i={}){const a=t.Dc(i.merge||i.mergeFields?2:0,e,n,s);ap("Data must be an object, but it was:",a,r);const c=L_(r,a);let u,d;if(i.merge)u=new tn(a.fieldMask),d=a.fieldTransforms;else if(i.mergeFields){const p=[];for(const y of i.mergeFields){const m=Eh(e,y,n);if(!a.contains(m))throw new te(B.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);V_(p,m)||p.push(m)}u=new tn(p),d=a.fieldTransforms.filter(y=>u.covers(y.field))}else u=null,d=a.fieldTransforms;return new cA(new Ht(c),u,d)}class nu extends Sa{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof nu}}class ip extends Sa{_toFieldTransform(e){return new Kw(e.path,new aa)}isEqual(e){return e instanceof ip}}class op extends Sa{constructor(e,n){super(e),this.Cc=n}_toFieldTransform(e){const n=new ua(e.serializer,$w(e.serializer,this.Cc));return new Kw(e.path,n)}isEqual(e){return e instanceof op&&this.Cc===e.Cc}}function hA(t,e,n,r){const s=t.Dc(1,e,n);ap("Data must be an object, but it was:",s,r);const i=[],a=Ht.empty();ss(r,(u,d)=>{const p=lp(e,u,n);d=Ot(d);const y=s.gc(p);if(d instanceof nu)i.push(p);else{const m=Ia(d,y);m!=null&&(i.push(p),a.set(p,m))}});const c=new tn(i);return new D_(a,c,s.fieldTransforms)}function fA(t,e,n,r,s,i){const a=t.Dc(1,e,n),c=[Eh(e,r,n)],u=[s];if(i.length%2!=0)throw new te(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)c.push(Eh(e,i[m])),u.push(i[m+1]);const d=[],p=Ht.empty();for(let m=c.length-1;m>=0;--m)if(!V_(d,c[m])){const T=c[m];let w=u[m];w=Ot(w);const P=a.gc(T);if(w instanceof nu)d.push(T);else{const I=Ia(w,P);I!=null&&(d.push(T),p.set(T,I))}}const y=new tn(d);return new D_(p,y,a.fieldTransforms)}function pA(t,e,n,r=!1){return Ia(n,t.Dc(r?4:3,e))}function Ia(t,e){if(M_(t=Ot(t)))return ap("Unsupported field value:",e,t),L_(t,e);if(t instanceof Sa)return function(r,s){if(!O_(s.Ec))throw s.wc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.wc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const c of r){let u=Ia(c,s.yc(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Ot(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return $w(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=qe.fromDate(r);return{timestampValue:gc(s.serializer,i)}}if(r instanceof qe){const i=new qe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:gc(s.serializer,i)}}if(r instanceof zn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof cn)return{bytesValue:e_(s.serializer,r._byteString)};if(r instanceof ct){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.wc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Bf(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Bn)return function(a,c){return{mapValue:{fields:{[Iw]:{stringValue:Cw},[pc]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw c.wc("VectorValues must only contain numeric values.");return Vf(c.serializer,d)})}}}}}}(r,s);throw s.wc(`Unsupported field value: ${Bc(r)}`)}(t,e)}function L_(t,e){const n={};return _w(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ss(t,(r,s)=>{const i=Ia(s,e.Vc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function M_(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof qe||t instanceof zn||t instanceof cn||t instanceof ct||t instanceof Sa||t instanceof Bn)}function ap(t,e,n){if(!M_(n)||!xw(n)){const r=Bc(n);throw r==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+r)}}function Eh(t,e,n){if((e=Ot(e))instanceof tu)return e._internalPath;if(typeof e=="string")return lp(t,e);throw wc("Field path arguments must be of type string or ",t,!1,void 0,n)}const mA=new RegExp("[~\\*/\\[\\]]");function lp(t,e,n){if(e.search(mA)>=0)throw wc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new tu(...e.split("."))._internalPath}catch{throw wc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function wc(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${r}`),a&&(u+=` in document ${s}`),u+=")"),new te(B.INVALID_ARGUMENT,c+t+u)}function V_(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ct(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new gA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ru("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class gA extends F_{data(){return super.data()}}function ru(t,e){return typeof e=="string"?lp(t,e):e instanceof tu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U_(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new te(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cp{}class z_ extends cp{}function up(t,e,...n){let r=[];e instanceof cp&&r.push(e),r=r.concat(n),function(i){const a=i.filter(u=>u instanceof dp).length,c=i.filter(u=>u instanceof su).length;if(a>1||a>0&&c>0)throw new te(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class su extends z_{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new su(e,n,r)}_apply(e){const n=this._parse(e);return B_(e._query,n),new os(e.firestore,e.converter,dh(e._query,n))}_parse(e){const n=sp(e.firestore);return function(i,a,c,u,d,p,y){let m;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new te(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Wy(y,p);const w=[];for(const P of y)w.push(Hy(u,i,P));m={arrayValue:{values:w}}}else m=Hy(u,i,y)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Wy(y,p),m=pA(c,a,y,p==="in"||p==="not-in");return at.create(d,p,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function yA(t,e,n){const r=e,s=ru("where",t);return su._create(s,r,n)}class dp extends cp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new dp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:kn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const c=i.getFlattenedFilters();for(const u of c)B_(a,u),a=dh(a,u)}(e._query,n),new os(e.firestore,e.converter,dh(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class hp extends z_{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new hp(e,n)}_apply(e){const n=function(s,i,a){if(s.startAt!==null)throw new te(B.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new te(B.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new oa(i,a)}(e._query,this._field,this._direction);return new os(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new $i(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function vA(t,e="asc"){const n=e,r=ru("orderBy",t);return hp._create(r,n)}function Hy(t,e,n){if(typeof(n=Ot(n))=="string"){if(n==="")throw new te(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Lw(e)&&n.indexOf("/")!==-1)throw new te(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ve.fromString(n));if(!ce.isDocumentKey(r))throw new te(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ay(t,new ce(r))}if(n instanceof ct)return ay(t,n._key);throw new te(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Bc(n)}.`)}function Wy(t,e){if(!Array.isArray(t)||t.length===0)throw new te(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function B_(t,e){const n=function(s,i){for(const a of s)for(const c of a.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new te(B.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new te(B.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class xA{convertValue(e,n="none"){switch(Jr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Yr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw de(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ss(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n[pc].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>rt(a.doubleValue));return new Bn(i)}convertGeoPoint(e){return new zn(rt(e.latitude),rt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Hc(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ra(e));default:return null}}convertTimestamp(e){const n=Xr(e);return new qe(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ve.fromString(e);De(o_(r),9688,{name:e});const s=new sa(r.get(1),r.get(3)),i=new ce(r.popFirst(5));return s.isEqual(n)||ar(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wA(t,e,n){let r;return r=t?t.toFirestore(e):e,r}class wo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class bs extends F_{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Rl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(ru("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new te(B.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=bs._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}bs._jsonSchemaVersion="firestore/documentSnapshot/1.0",bs._jsonSchema={type:lt("string",bs._jsonSchemaVersion),bundleSource:lt("string","DocumentSnapshot"),bundleName:lt("string"),bundle:lt("string")};class Rl extends bs{data(e={}){return super.data(e)}}class Es{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new wo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Rl(this._firestore,this._userDataWriter,r.key,r,new wo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new te(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(c=>{const u=new Rl(s._firestore,s._userDataWriter,c.doc.key,c.doc,new wo(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new Rl(s._firestore,s._userDataWriter,c.doc.key,c.doc,new wo(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,p=-1;return c.type!==0&&(d=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),p=a.indexOf(c.doc.key)),{type:_A(c.type),doc:u,oldIndex:d,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new te(B.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Es._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=jf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function _A(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return de(61501,{type:t})}}Es._jsonSchemaVersion="firestore/querySnapshot/1.0",Es._jsonSchema={type:lt("string",Es._jsonSchemaVersion),bundleSource:lt("string","QuerySnapshot"),bundleName:lt("string"),bundle:lt("string")};class fp extends xA{constructor(e){super(),this.firestore=e}convertBytes(e){return new cn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ct(this.firestore,null,n)}}function yr(t){t=Vn(t,os);const e=Vn(t.firestore,Os),n=np(e),r=new fp(e);return U_(t._query),sA(n,t._query).then(s=>new Es(e,r,t,s))}function Ye(t,e,n,...r){t=Vn(t,ct);const s=Vn(t.firestore,Os),i=sp(s);let a;return a=typeof(e=Ot(e))=="string"||e instanceof tu?fA(i,"updateDoc",t._key,e,n,r):hA(i,"updateDoc",t._key,e),pp(s,[a.toMutation(t._key,Sn.exists(!0))])}function Ls(t){return pp(Vn(t.firestore,Os),[new Ff(t._key,Sn.none())])}function Gt(t,e){const n=Vn(t.firestore,Os),r=Re(t),s=wA(t.converter,e);return pp(n,[dA(sp(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Sn.exists(!1))]).then(()=>r)}function bA(t,...e){var n,r,s;t=Ot(t);let i={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||qy(e[a])||(i=e[a++]);const c={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(qy(e[a])){const y=e[a];e[a]=(n=y.next)===null||n===void 0?void 0:n.bind(y),e[a+1]=(r=y.error)===null||r===void 0?void 0:r.bind(y),e[a+2]=(s=y.complete)===null||s===void 0?void 0:s.bind(y)}let u,d,p;if(t instanceof ct)d=Vn(t.firestore,Os),p=Mf(t._key.path),u={next:y=>{e[a]&&e[a](EA(d,t,y))},error:e[a+1],complete:e[a+2]};else{const y=Vn(t,os);d=Vn(y.firestore,Os),p=y._query;const m=new fp(d);u={next:T=>{e[a]&&e[a](new Es(d,m,y,T))},error:e[a+1],complete:e[a+2]},U_(t._query)}return function(m,T,w,P){const I=new A_(P),E=new __(T,I,w);return m.asyncQueue.enqueueAndForget(async()=>x_(await bh(m),E)),()=>{I.Ou(),m.asyncQueue.enqueueAndForget(async()=>w_(await bh(m),E))}}(np(d),p,c,u)}function pp(t,e){return function(r,s){const i=new Br;return r.asyncQueue.enqueueAndForget(async()=>W2(await rA(r),s,i)),i.promise}(np(t),e)}function EA(t,e,n){const r=n.docs.get(e._key),s=new fp(t);return new bs(t,s,e._key,r,new wo(n.hasPendingWrites,n.fromCache),e.converter)}function ke(){return new ip("serverTimestamp")}function Ri(t){return new op("increment",t)}(function(e,n=!0){(function(s){Ui=s})(Vi),Ii(new js("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),c=new Os(new gC(r.getProvider("auth-internal")),new xC(a,r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new te(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new sa(d.options.projectId,p)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),Fr(Gg,Kg,e),Fr(Gg,Kg,"esm2017")})();const NA={VITE_FIREBASE_API_KEY:"AIzaSyDUK-H7scDD-9t_yVASmG34ypw7AlKwNTY",VITE_FIREBASE_APP_ID:"1:97524547700:web:08f8d39ed9be7ec75a9121",VITE_FIREBASE_AUTH_DOMAIN:"poshakh-stock.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"97524547700",VITE_FIREBASE_PROJECT_ID:"poshakh-stock",VITE_FIREBASE_STORAGE_BUCKET:"poshakh-stock.firebasestorage.app"},Gy={apiKey:"AIzaSyDUK-H7scDD-9t_yVASmG34ypw7AlKwNTY",authDomain:"poshakh-stock.firebaseapp.com",projectId:"poshakh-stock",storageBucket:"poshakh-stock.firebasestorage.app",messagingSenderId:"97524547700",appId:"1:97524547700:web:08f8d39ed9be7ec75a9121"};let Ns;function mp(t){const e=typeof import.meta<"u"?NA:{},n={apiKey:e.VITE_FIREBASE_API_KEY,authDomain:e.VITE_FIREBASE_AUTH_DOMAIN,projectId:e.VITE_FIREBASE_PROJECT_ID,storageBucket:e.VITE_FIREBASE_STORAGE_BUCKET,messagingSenderId:e.VITE_FIREBASE_MESSAGING_SENDER_ID,appId:e.VITE_FIREBASE_APP_ID},r=Object.values(n).some(s=>s)?{...Gy,...Object.fromEntries(Object.entries(n).filter(([,s])=>s))}:Gy;return Ns||(Ns=Ix(r)),Ns}function TA(){Ns||mp();const t=hC(Ns);return XS(t)}function Ue(){return Ns||mp(),oA(Ns)}const In="fabrics",dn="production_orders";function SA({allOrders:t=[],inventoryItems:e=[],productionBatches:n=[],userProfile:r,onViewOrder:s,onShowLegacyModal:i,onCancelOrder:a,onDeleteOrder:c,onOpenShipping:u,onCreateProductionBatch:d,onReceiveBatch:p,onDataChanged:y}){const[m,T]=F.useState({orderNumber:"",fabricId:"",lengthToCut:"",outfitName:"",customerName:"",size:"M",stitchingCost:"",acquisitionCost:""}),[w,P]=F.useState({orderNumber:"",outfitId:"",size:"M",quantity:"1",customerName:"",phone:"",address:""}),[I,E]=F.useState([]),[x,b]=F.useState("active"),[R,L]=F.useState("date_desc"),[M,N]=F.useState(!1),[f,v]=F.useState({batches:!1,stock:!1,production:!1}),_=F.useMemo(()=>e.filter(A=>A.type==="fabric"&&A.currentLength>0),[e]),k=F.useMemo(()=>e.filter(A=>A.type==="outfit"),[e]),j=F.useMemo(()=>e.filter(A=>A.type!=="outfit"?!1:Object.values(A.stockBreakdown||{}).reduce((K,V)=>K+(parseInt(V)||0),0)>0).map(A=>({...A,totalStock:Object.values(A.stockBreakdown||{}).reduce((H,K)=>H+(parseInt(K)||0),0)})),[e]),C=j.find(A=>A.id===w.outfitId),ge=F.useMemo(()=>{let A=[...t];return A=A.filter(H=>H.status!=="Imported"),x==="active"?A=A.filter(H=>H.status!=="Cancelled"&&H.status!=="Order Shipped (Completed)"):x==="completed"&&(A=A.filter(H=>H.status==="Order Shipped (Completed)"||H.status==="Cancelled")),A.sort((H,K)=>{var G,se;const V=(G=H.createdAt)!=null&&G.toMillis?H.createdAt.toMillis():0,z=(se=K.createdAt)!=null&&se.toMillis?K.createdAt.toMillis():0;return R==="date_desc"?z-V:R==="date_asc"?V-z:0}),A},[t,x,R]),ae=A=>{A.preventDefault();const{orderNumber:H,fabricId:K,lengthToCut:V,outfitName:z,size:G,stitchingCost:se,acquisitionCost:ue}=m;if(!H||!K)return;const Z=e.find(_e=>_e.id===K),ye=parseFloat(V)||0,we={...m,fabricName:(Z==null?void 0:Z.name)||"Unknown",unit:(Z==null?void 0:Z.unit)||"m",cutAmount:ye,stitchingCost:parseFloat(se)||0,acquisitionCost:parseFloat(ue)||0,imageUrl:(Z==null?void 0:Z.imageUrl)||""};E([...I,we]),T({...m,lengthToCut:"",outfitName:"",customerName:"",stitchingCost:"",acquisitionCost:""})},Se=A=>E(I.filter((H,K)=>K!==A)),ne=async()=>{N(!0);try{const A=Ue(),H=I.map(async K=>{if(K.fabricId){const V=Re(A,In,K.fabricId);K.cutAmount>0&&(await Ye(V,{currentLength:Ri(-K.cutAmount),updatedAt:ke()}),await Gt(Qe(V,"history"),{amountUsed:K.cutAmount,orderNumber:K.orderNumber,productName:K.outfitName,status:"Sent to Tailor",type:"CUT",usedByEmail:r==null?void 0:r.name,usedAt:ke()}))}await Gt(Qe(A,dn),{fabricId:K.fabricId||"",fabricName:K.fabricName,outfitName:K.outfitName,orderNumber:K.orderNumber,customerName:K.customerName,cutAmount:K.cutAmount,unit:K.unit,size:K.size,stitchingCost:K.stitchingCost,acquisitionCost:K.acquisitionCost,imageUrl:K.imageUrl,status:"Sent to Tailor",usedByEmail:r==null?void 0:r.name,createdAt:ke()})});await Promise.all(H),E([]),y&&await y()}catch(A){console.error("Batch submit error:",A)}N(!1)},O=async A=>{const H=t.find(G=>G.id===A);if(!H||H.orderType!=="stock"){const G=Ue();await Ye(Re(G,dn,A),{status:"Received from Tailor",updatedAt:ke()}),y&&await y();return}const K=["S","M","L","XL","XXL"],V={};let z=0;for(const G of K){const se=prompt(`Please enter the quantity for size ${G} (or 0 to skip):`,"0");if(se===null)return;const ue=parseInt(se)||0;ue>0&&(V[G]=ue,z+=ue)}if(z===0){alert("No quantities entered. Receipt cancelled.");return}N(!0);try{const G=Ue();await Ye(Re(G,dn,A),{status:"Received from Tailor",receivedBreakdown:V,updatedAt:ke()});const se=e.find(ue=>ue.name===H.outfitName&&ue.type==="outfit");if(se){const ue=Re(G,In,se.id),Z={};for(const[ye,we]of Object.entries(V))Z[`stockBreakdown.${ye}`]=Ri(we);Z.updatedAt=ke(),await Ye(ue,Z);for(const[ye,we]of Object.entries(V))await Gt(Qe(ue,"history"),{type:"OUTFIT_ADD",amount:we,size:ye,status:"Received",orderNumber:H.orderNumber||A,user:{name:(r==null?void 0:r.displayName)||"Unknown",email:(r==null?void 0:r.email)||""},timestamp:ke()})}y&&await y()}catch(G){console.error("Error receiving order:",G),alert("Failed to receive order: "+G.message)}finally{N(!1)}},$=async A=>{var _e;A.preventDefault();const{orderNumber:H,outfitId:K,size:V,quantity:z,customerName:G,phone:se,address:ue}=w;if(!H||!K||!V||!z){alert("Please fill all required fields");return}const Z=e.find(ve=>ve.id===K);if(!Z){alert("Outfit not found");return}const ye=parseInt(z),we=parseInt((_e=Z.stockBreakdown)==null?void 0:_e[V])||0;if(ye>we){alert(`Not enough stock! Only ${we} pieces available in size ${V}`);return}N(!0);try{const ve=Ue();await Gt(Qe(ve,dn),{orderNumber:H,outfitId:K,outfitName:Z.name,imageUrl:Z.imageUrl||"",size:V,quantity:ye,customerName:G,phone:se,address:ue,productionCostPerPiece:Z.productionCostPerPiece||0,status:"Ready to Ship",orderType:"stock",usedByEmail:r==null?void 0:r.name,createdAt:ke()});const le=Z.stockBreakdown||{};await Ye(Re(ve,In,K),{stockBreakdown:{...le,[V]:we-ye},updatedAt:ke()}),alert(` Order #${H} created!
${ye} x ${Z.name} (${V})
Stock deducted: ${we}  ${we-ye}`),P({orderNumber:"",outfitId:"",size:"M",quantity:"1",customerName:"",phone:"",address:""}),y&&await y()}catch(ve){console.error("Stock order error:",ve),alert("Error creating order: "+ve.message)}finally{N(!1)}},ee=F.useMemo(()=>e.filter(A=>A.type==="outfit").map(A=>{const H=Object.values(A.stockBreakdown||{}).reduce((K,V)=>K+(parseInt(V)||0),0);return{...A,totalStock:H}}).filter(A=>A.totalStock<5).sort((A,H)=>A.totalStock-H.totalStock),[e]),X=F.useMemo(()=>[...n].sort((A,H)=>{var z,G;const K=(z=A.receivedDate)!=null&&z.toDate?A.receivedDate.toDate():new Date(A.receivedDate);return((G=H.receivedDate)!=null&&G.toDate?H.receivedDate.toDate():new Date(H.receivedDate))-K}).slice(0,3),[n]),J=A=>A?(A.toDate?A.toDate():new Date(A)).toLocaleDateString("en-IN",{day:"numeric",month:"short"}):"N/A";return o.jsxs("div",{className:"space-y-6 fade-in",children:[d&&o.jsxs("div",{className:"bg-emerald-pine/10 p-5 rounded-3xl shadow-card border-2 border-emerald-pine",children:[o.jsxs("div",{className:"flex justify-between items-start mb-3",children:[o.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>v(A=>({...A,batches:!A.batches})),children:[o.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2 text-lime-glow",children:[o.jsx(mi,{className:"w-5 h-5"}),"Production Batches",f.batches?o.jsx(Gu,{className:"w-4 h-4"}):o.jsx(Wu,{className:"w-4 h-4"})]}),o.jsx("p",{className:"text-xs text-lime-glow/70 mt-1",children:"Convert fabric to outfits"})]}),f.batches&&o.jsx("button",{onClick:d,className:"bg-lime-glow text-emerald-pine px-4 py-2 rounded-xl font-bold text-sm hover:shadow-lg",children:"+ New Batch"})]}),f.batches&&o.jsxs(o.Fragment,{children:[ee.length>0&&o.jsxs("div",{className:"bg-green-tea/30 p-3 rounded-xl mb-3 border-2 border-lime-glow",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2 text-lime-glow",children:[o.jsx(sN,{className:"w-4 h-4"}),o.jsx("span",{className:"text-xs font-bold",children:"Low Stock Alert"})]}),o.jsx("div",{className:"space-y-1",children:ee.slice(0,3).map((A,H)=>o.jsxs("div",{className:"flex justify-between text-xs text-lime-glow",children:[o.jsx("span",{children:A.name}),o.jsxs("span",{className:"font-bold",children:[A.totalStock," left"]})]},H))})]}),X.length>0?o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs opacity-80 text-lime-glow mb-2",children:"Recent Batches:"}),X.map((A,H)=>o.jsx("div",{onClick:()=>p&&p(A),className:"bg-white/10 backdrop-blur-sm p-3 rounded-xl border border-lime-glow/30 cursor-pointer hover:bg-white/20 active:scale-[0.98] transition-all",children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("p",{className:"font-bold text-sm text-lime-glow",children:A.outfitName}),A.status==="Completed"?o.jsx("span",{className:"bg-lime-glow/20 text-lime-glow px-2 py-0.5 rounded text-[10px] font-bold border border-lime-glow/50",children:" Received"}):o.jsx("span",{className:"bg-amber-600/80 text-white px-2 py-0.5 rounded text-[10px] font-bold border border-amber-500",children:"Pending"})]}),o.jsxs("p",{className:"text-xs opacity-80 text-lime-glow/70",children:[A.totalReceivedPieces||A.totalPieces," pcs from ",A.fabricName]})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("p",{className:"text-xs font-bold text-lime-glow",children:["",(A.totalCostPerPiece||0).toFixed(0),"/pc"]}),o.jsx("p",{className:"text-xs opacity-70 text-lime-glow/70",children:J(A.receivedDate||A.createdAt)})]})]})},H))]}):o.jsxs("div",{className:"text-center py-6 bg-white/10 backdrop-blur-sm rounded-xl",children:[o.jsx(mi,{className:"w-8 h-8 mx-auto mb-2 opacity-50 text-lime-glow"}),o.jsx("p",{className:"text-sm opacity-80 text-lime-glow",children:"No production batches yet"}),o.jsx("button",{onClick:d,className:"mt-3 bg-lime-glow text-emerald-pine px-4 py-2 rounded-xl font-bold text-xs",children:"Create First Batch"})]})]})]}),o.jsxs("div",{className:"bg-emerald-pine p-5 rounded-3xl shadow-card text-white",children:[o.jsxs("div",{className:"cursor-pointer mb-3",onClick:()=>v(A=>({...A,stock:!A.stock})),children:[o.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[o.jsx(mi,{className:"w-5 h-5"}),"Ready Stock Orders",f.stock?o.jsx(Gu,{className:"w-4 h-4"}):o.jsx(Wu,{className:"w-4 h-4"})]}),o.jsx("p",{className:"text-xs opacity-90 mt-1",children:"Fulfill customer orders from produced inventory"})]}),f.stock&&o.jsxs("form",{onSubmit:$,className:"space-y-3",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold opacity-90",children:"Order Number *"}),o.jsx("input",{className:"w-full p-2.5 rounded-xl mt-1 bg-white text-emerald-pine text-sm border-2 border-lime-glow font-semibold",value:w.orderNumber,onChange:A=>P({...w,orderNumber:A.target.value}),placeholder:"e.g., 1001",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold opacity-90",children:"Select Outfit *"}),o.jsxs("select",{className:"w-full p-2.5 rounded-xl mt-1 bg-white text-emerald-pine text-sm border-2 border-lime-glow font-semibold",value:w.outfitId,onChange:A=>P({...w,outfitId:A.target.value}),required:!0,children:[o.jsx("option",{value:"",children:"Choose outfit..."}),j.map(A=>o.jsxs("option",{value:A.id,children:[A.name," (",A.totalStock," pcs)"]},A.id))]})]})]}),C&&o.jsxs("div",{className:"bg-white backdrop-blur-sm p-3 rounded-xl",children:[o.jsx("p",{className:"text-xs font-bold mb-2",children:"Available Stock:"}),o.jsx("div",{className:"flex gap-2 flex-wrap",children:["S","M","L","XL","XXL"].map(A=>{var K;const H=parseInt((K=C.stockBreakdown)==null?void 0:K[A])||0;return H===0?null:o.jsxs("div",{className:"bg-white px-2 py-1 rounded-lg text-xs",children:[o.jsxs("span",{className:"font-bold",children:[A,":"]})," ",H]},A)})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold opacity-90",children:"Size *"}),o.jsx("select",{className:"w-full p-2.5 rounded-xl mt-1 bg-white text-emerald-pine text-sm border-2 border-lime-glow font-semibold",value:w.size,onChange:A=>P({...w,size:A.target.value}),required:!0,children:["S","M","L","XL","XXL"].map(A=>{var H;return o.jsxs("option",{value:A,children:[A," ",C&&`(${parseInt((H=C.stockBreakdown)==null?void 0:H[A])||0} available)`]},A)})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold opacity-90",children:"Quantity *"}),o.jsx("input",{type:"number",min:"1",className:"w-full p-2.5 rounded-xl mt-1 bg-white text-emerald-pine text-sm border-2 border-lime-glow font-semibold",value:w.quantity,onChange:A=>P({...w,quantity:A.target.value}),placeholder:"1",required:!0})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold opacity-90",children:"Customer Name"}),o.jsx("input",{className:"w-full p-2.5 rounded-xl mt-1 bg-white text-emerald-pine text-sm border-2 border-lime-glow font-semibold",value:w.customerName,onChange:A=>P({...w,customerName:A.target.value}),placeholder:"Customer name"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold opacity-90",children:"Phone"}),o.jsx("input",{className:"w-full p-2.5 rounded-xl mt-1 bg-white text-emerald-pine text-sm border-2 border-lime-glow font-semibold",value:w.phone,onChange:A=>P({...w,phone:A.target.value}),placeholder:"Phone number"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold opacity-90",children:"Address"}),o.jsx("input",{className:"w-full p-2.5 rounded-xl mt-1 bg-white text-emerald-pine text-sm border-2 border-lime-glow font-semibold",value:w.address,onChange:A=>P({...w,address:A.target.value}),placeholder:"Delivery address"})]})]}),o.jsx("button",{type:"submit",disabled:M||!w.outfitId,className:"w-full bg-green-tea text-emerald-pine font-bold py-3 rounded-xl hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:M?"Creating Order...":"Create Order"}),j.length===0&&o.jsx("div",{className:"text-center py-4 bg-white backdrop-blur-sm rounded-xl",children:o.jsx("p",{className:"text-xs opacity-80",children:"No outfits in stock. Create production batches first!"})})]})]}),o.jsxs("div",{className:"bg-white p-5 rounded-3xl shadow-soft border-l-4 border-brand border dark:border-gray-800",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("div",{className:"flex-1 cursor-pointer",onClick:()=>v(A=>({...A,production:!A.production})),children:o.jsxs("h3",{className:"text-lg font-bold text-black flex items-center gap-2",children:[o.jsx(vN,{className:"w-5 h-5 text-brand"})," Production Queue",f.production?o.jsx(Gu,{className:"w-5 h-5 text-gray-400"}):o.jsx(Wu,{className:"w-5 h-5 text-gray-400"})]})}),f.production&&i&&o.jsx("button",{onClick:i,className:"text-xs bg-gray-100 text-gray-600 dark:text-gray-400 dark:text-gray-500 px-3 py-1.5 rounded-full font-bold hover:bg-gray-200 flex items-center gap-1",children:"+ Log Past Order"})]}),f.production&&o.jsxs(o.Fragment,{children:[o.jsxs("form",{onSubmit:ae,className:"space-y-3",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-emerald-pine uppercase",children:"Order #"}),o.jsx("input",{className:"w-full p-2 bg-white text-black rounded-xl mt-1 border-2 border-lime-glow font-semibold text-sm placeholder-gray-400",value:m.orderNumber,onChange:A=>T({...m,orderNumber:A.target.value}),placeholder:"101"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-emerald-pine uppercase",children:"Select Fabric"}),o.jsxs("select",{className:"w-full p-2 bg-white text-black rounded-xl mt-1 border-2 border-lime-glow font-semibold text-sm appearance-none cursor-pointer",value:m.fabricId,onChange:A=>T({...m,fabricId:A.target.value}),children:[o.jsx("option",{value:"",children:"-- Choose --"}),_.map(A=>o.jsx("option",{value:A.id,children:A.name},A.id))]})]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-emerald-pine uppercase",children:"Cut Amt"}),o.jsx("input",{type:"number",step:"0.1",className:"w-full p-2 bg-white text-black rounded-xl mt-1 border-2 border-lime-glow font-semibold text-sm placeholder-gray-400",value:m.lengthToCut,onChange:A=>T({...m,lengthToCut:A.target.value}),placeholder:"0.0"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-emerald-pine uppercase",children:"Stitching "}),o.jsx("input",{type:"number",className:"w-full p-2 bg-white text-black rounded-xl mt-1 border-2 border-lime-glow font-semibold text-sm placeholder-gray-400",value:m.stitchingCost,onChange:A=>T({...m,stitchingCost:A.target.value}),placeholder:"0.00"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-emerald-pine uppercase",children:"Acq. Cost "}),o.jsx("input",{type:"number",className:"w-full p-2 bg-white text-black rounded-xl mt-1 border-2 border-lime-glow font-semibold text-sm placeholder-gray-400",value:m.acquisitionCost,onChange:A=>T({...m,acquisitionCost:A.target.value}),placeholder:"0.00"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-emerald-pine uppercase",children:"Target Outfit"}),o.jsx("input",{list:"outfit-suggestions",className:"w-full p-2 bg-white text-black rounded-xl mt-1 border-2 border-lime-glow font-semibold text-sm placeholder-gray-400",value:m.outfitName,onChange:A=>T({...m,outfitName:A.target.value}),placeholder:"e.g. Mirae"}),o.jsx("datalist",{id:"outfit-suggestions",children:k.map(A=>o.jsx("option",{value:A.name},A.id))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-emerald-pine uppercase block mb-1",children:"Target Size"}),o.jsx("div",{className:"flex bg-emerald-pine/10 p-1 rounded-xl gap-1 overflow-x-auto no-scrollbar border-2 border-lime-glow",children:["S","M","L","XL","XXL","Custom"].map(A=>o.jsx("button",{type:"button",onClick:()=>T({...m,size:A}),className:`px-3 py-2 rounded-lg text-xs font-bold transition-all ${m.size===A?"bg-lime-glow text-emerald-pine shadow-md":"text-lime-glow hover:bg-lime-glow/20"}`,children:A},A))})]}),o.jsx("button",{type:"submit",className:"w-full bg-lime-glow text-emerald-pine py-2 rounded-xl font-bold text-sm hover:shadow-lg",children:"+ Add to Queue"})]}),I.length>0&&o.jsxs("div",{className:"mt-4 border-t pt-4",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsxs("h4",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 dark:text-gray-500 uppercase",children:["Pending Batch (",I.length,")"]}),o.jsx("button",{onClick:()=>E([]),className:"text-[10px] text-red-500 hover:underline",children:"Clear All"})]}),o.jsx("div",{className:"space-y-2 mb-4",children:I.map((A,H)=>o.jsxs("div",{className:"flex justify-between items-center text-sm bg-gray-50 dark:bg-gray-900 p-2 rounded-lg",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-bold text-brand",children:A.fabricName}),A.cutAmount>0&&o.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 dark:text-gray-500 ml-2",children:["Cut: ",A.cutAmount," ",A.unit]}),o.jsxs("p",{className:"text-[10px] text-gray-400",children:["#",A.orderNumber,"  ",A.outfitName," (",A.size,")"]})]}),o.jsx("button",{onClick:()=>Se(H),className:"text-red-400 hover:text-red-600",children:o.jsx(Wr,{className:"w-4 h-4"})})]},H))}),o.jsx("button",{onClick:ne,disabled:M,className:"w-full bg-lime-glow text-emerald-pine py-3 rounded-xl font-bold text-sm shadow-md hover:shadow-lg",children:M?"Processing...":"Submit Batch to Production"})]})]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-end mb-3",children:[o.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[o.jsx(oN,{className:"w-5 h-5 text-lime-glow"})," Order History"]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("select",{className:"text-xs bg-white border-2 border-lime-glow rounded-xl px-3 py-2 text-emerald-pine font-semibold shadow-md hover:shadow-lg",value:R,onChange:A=>L(A.target.value),children:[o.jsx("option",{value:"date_desc",children:"Newest"}),o.jsx("option",{value:"date_asc",children:"Oldest"})]}),o.jsxs("select",{className:"text-xs bg-white border-2 border-lime-glow rounded-xl px-3 py-2 text-emerald-pine font-semibold shadow-md hover:shadow-lg",value:x,onChange:A=>b(A.target.value),children:[o.jsx("option",{value:"active",children:"Active Only"}),o.jsx("option",{value:"completed",children:"Completed/Cancelled"})]})]})]}),o.jsx("div",{className:"space-y-3",children:ge.map(A=>o.jsxs("div",{onClick:()=>s&&s(A),className:`bg-emerald-pine/20 border-2 border-lime-glow/40 p-4 rounded-2xl shadow-card flex flex-col gap-3 relative cursor-pointer hover:border-lime-glow/60 active:scale-95 transition-all ${A.status==="Cancelled"?"opacity-60 grayscale":""}`,children:[A.status!=="Cancelled"&&A.status!=="Order Shipped (Completed)"&&o.jsx("button",{onClick:H=>{H.stopPropagation(),a&&a(A)},className:"absolute top-3 right-3 text-white/40 hover:text-red-500",children:o.jsx(Wr,{className:"w-5 h-5"})}),(A.status==="Cancelled"||A.status==="Order Shipped (Completed)")&&o.jsx("button",{onClick:H=>{H.stopPropagation(),console.log("Delete button clicked for order:",A.id),c&&c(A.id)},className:"absolute bottom-3 right-3 text-white/40 hover:text-red-500 z-10 p-2",children:o.jsx(Zo,{className:"w-5 h-5"})}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("img",{src:A.imageUrl,className:"w-14 h-14 rounded-xl bg-gray-800 object-cover"}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsxs("span",{className:"font-mono text-lime-glow font-bold text-sm",children:["#",A.orderNumber]}),A.orderType==="stock"&&o.jsx("span",{className:"text-[10px] font-bold px-2 py-0.5 rounded bg-lime-glow/20 text-lime-glow border border-lime-glow/50",children:"STOCK"}),o.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded border ${A.status==="Sent to Tailor"?"bg-amber-600/80 text-white border-amber-500":A.status==="Ready to Ship"?"bg-emerald-700/80 text-white border-emerald-600":A.status.includes("Shipped")?"bg-lime-glow/20 text-lime-glow border-lime-glow/50":"bg-gray-700 text-white border-gray-600"}`,children:A.status})]}),o.jsxs("h4",{className:"font-bold text-white text-sm",children:[A.outfitName||"Unspecified",o.jsxs("span",{className:"text-xs bg-emerald-pine/60 border border-lime-glow/40 px-1 rounded ml-1 text-lime-glow",children:[A.quantity?`${A.quantity}x `:"","Size ",A.size]})]}),A.orderType==="stock"?o.jsxs("p",{className:"text-xs text-lime-glow",children:["",(A.productionCostPerPiece||0).toFixed(2),"/pc"]}):o.jsxs("p",{className:"text-xs text-lime-glow",children:["Cost: ",A.stitchingCost||0]})]})]}),A.status!=="Cancelled"&&o.jsx("div",{className:"bg-emerald-pine/40 border border-lime-glow/30 p-2 rounded-xl flex justify-between items-center mt-1",children:A.status==="Sent to Tailor"?o.jsx("button",{onClick:H=>{H.stopPropagation(),O(A.id)},className:"text-xs font-bold text-lime-glow hover:underline",children:"Mark Received"}):A.status==="Received from Tailor"||A.status==="Ready to Ship"?o.jsxs("button",{onClick:H=>{H.stopPropagation(),u&&u(A.id)},className:"text-xs font-bold text-lime-glow hover:underline flex items-center gap-1",children:[o.jsx(SN,{className:"w-3 h-3"})," Ship It"]}):o.jsx("span",{className:"text-[10px] text-lime-glow font-bold",children:"Done"})}),(A.customerName||A.phone||A.address)&&o.jsxs("div",{className:"text-[10px] text-white/80 mt-1 border-t border-lime-glow/30 pt-1",children:[A.customerName," ",A.phone&&` ${A.phone}`," ",A.address&&` ${A.address}`]})]},A.id))})]})]})}function IA({onSuccess:t,onDataChanged:e}){const[n,r]=F.useState("fabric"),[s,i]=F.useState({name:"",websiteProductName:"",totalLength:"",unit:"meters",lengthRequiredPerOutfit:"",costPerMeter:"",parentFabricId:"",stockBreakdown:{S:0,M:0,L:0,XL:0,XXL:0},location:"",stitchingCost:"",sellingPrice:""}),[a,c]=F.useState(null),[u,d]=F.useState(!1),[p,y]=F.useState(""),m=w=>new Promise((P,I)=>{const E=new FileReader;E.readAsDataURL(w),E.onload=()=>P(E.result),E.onerror=x=>I(x)}),T=async w=>{w.preventDefault(),d(!0),y("");try{let P=`https://placehold.co/150x150/${n==="fabric"?"2e7d32":"7c3aed"}/ffffff?text=${s.name.substring(0,2).toUpperCase()}`;a&&(P=await m(a));const I={...s,type:n,imageUrl:P,updatedAt:ke(),createdAt:ke()};n==="fabric"&&(I.currentLength=parseFloat(s.totalLength),I.lengthRequiredPerOutfit=parseFloat(s.lengthRequiredPerOutfit),I.costPerMeter=parseFloat(s.costPerMeter),I.totalLength=parseFloat(s.totalLength),I.currentOrderStatus="None"),n==="outfit"&&(I.stitchingCost=parseFloat(s.stitchingCost)||0,I.sellingPrice=parseFloat(s.sellingPrice)||0,I.lengthRequiredPerOutfit=parseFloat(s.lengthRequiredPerOutfit)||0);const E=Ue();await Gt(Qe(E,In),I),i({name:"",websiteProductName:"",totalLength:"",unit:"meters",lengthRequiredPerOutfit:"",costPerMeter:"",parentFabricId:"",stockBreakdown:{S:0,M:0,L:0,XL:0,XXL:0},location:"",stitchingCost:"",sellingPrice:""}),c(null),e&&await e(),t&&t()}catch(P){y(P.message)}d(!1)};return o.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[o.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Add New Item"}),o.jsxs("div",{className:"bg-emerald-pine rounded-3xl p-1 flex gap-1 mb-6 border-2 border-lime-glow",children:[o.jsx("button",{onClick:()=>r("fabric"),className:`flex-1 py-2 rounded-2xl text-sm font-bold transition-all ${n==="fabric"?"bg-lime-glow text-emerald-pine shadow":"text-lime-glow/60"}`,children:"Fabric"}),o.jsx("button",{onClick:()=>r("outfit"),className:`flex-1 py-2 rounded-2xl text-sm font-bold transition-all ${n==="outfit"?"bg-lime-glow text-emerald-pine shadow":"text-lime-glow/60"}`,children:"Outfit"})]}),o.jsxs("form",{onSubmit:T,className:"space-y-4",children:[p&&o.jsx("div",{className:"p-3 bg-red-50 text-red-600 text-sm rounded-xl",children:p}),o.jsxs("div",{className:"flex gap-3 items-center",children:[o.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-xl flex items-center justify-center overflow-hidden",children:a?o.jsx("img",{src:URL.createObjectURL(a),alt:"Preview",className:"w-full h-full object-cover"}):o.jsx("span",{className:"text-4xl text-gray-300",children:s.name?s.name.substring(0,2).toUpperCase():"+"})}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("label",{className:"px-4 py-2 bg-gray-100 text-gray-600 dark:text-gray-400 dark:text-gray-500 rounded-xl text-sm font-bold cursor-pointer hover:bg-gray-200",children:[" Camera",o.jsx("input",{type:"file",hidden:!0,capture:"environment",accept:"image/*",onChange:w=>c(w.target.files[0])})]}),o.jsxs("label",{className:"px-4 py-2 bg-gray-100 text-gray-600 dark:text-gray-400 dark:text-gray-500 rounded-xl text-sm font-bold cursor-pointer hover:bg-gray-200",children:[" Gallery",o.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:w=>c(w.target.files[0])})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow uppercase",children:"Item Name"}),o.jsx("input",{required:!0,className:"w-full p-3 bg-white text-emerald-pine rounded-xl border-2 border-lime-glow font-semibold mt-1",placeholder:n==="fabric"?"e.g. Green Silk":"e.g. Mirae Suit",value:s.name,onChange:w=>i({...s,name:w.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow uppercase",children:"Website Product Name (Optional)"}),o.jsx("input",{className:"w-full p-3 bg-white text-emerald-pine rounded-xl border-2 border-lime-glow font-semibold mt-1",placeholder:"Display name for e-commerce",value:s.websiteProductName,onChange:w=>i({...s,websiteProductName:w.target.value})})]}),n==="fabric"?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow uppercase",children:"Total Length"}),o.jsx("input",{type:"number",step:"0.1",required:!0,className:"w-full p-3 bg-white text-emerald-pine rounded-xl border-2 border-lime-glow font-semibold mt-1",placeholder:"e.g. 10.5",value:s.totalLength,onChange:w=>i({...s,totalLength:w.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow uppercase",children:"Unit"}),o.jsxs("select",{className:"w-full p-3 bg-white text-emerald-pine rounded-xl border-2 border-lime-glow font-semibold mt-1",value:s.unit,onChange:w=>i({...s,unit:w.target.value}),children:[o.jsx("option",{value:"meters",children:"Meters"}),o.jsx("option",{value:"yards",children:"Yards"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow uppercase",children:"Length per Outfit"}),o.jsx("input",{type:"number",step:"0.1",required:!0,className:"w-full p-3 bg-white text-emerald-pine rounded-xl border-2 border-lime-glow font-semibold mt-1",placeholder:"e.g. 2.5",value:s.lengthRequiredPerOutfit,onChange:w=>i({...s,lengthRequiredPerOutfit:w.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow uppercase",children:"Cost per Meter ()"}),o.jsx("input",{type:"number",step:"0.01",required:!0,className:"w-full p-3 bg-white text-emerald-pine rounded-xl border-2 border-lime-glow font-semibold mt-1",placeholder:"e.g. 450",value:s.costPerMeter,onChange:w=>i({...s,costPerMeter:w.target.value})})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow uppercase",children:"Location"}),o.jsx("input",{className:"w-full p-3 bg-white text-emerald-pine rounded-xl border-2 border-lime-glow font-semibold mt-1",placeholder:"e.g. Shelf A3",value:s.location,onChange:w=>i({...s,location:w.target.value})})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow uppercase",children:"Selling Price ()"}),o.jsx("input",{type:"number",required:!0,className:"w-full p-3 bg-white text-emerald-pine rounded-xl border-2 border-lime-glow font-semibold mt-1",placeholder:"e.g. 2999",value:s.sellingPrice,onChange:w=>i({...s,sellingPrice:w.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow uppercase",children:"Stitching Cost ()"}),o.jsx("input",{type:"number",className:"w-full p-3 bg-white text-emerald-pine rounded-xl border-2 border-lime-glow font-semibold mt-1",placeholder:"e.g. 500",value:s.stitchingCost,onChange:w=>i({...s,stitchingCost:w.target.value})})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow uppercase",children:"Fabric Length Required"}),o.jsx("input",{type:"number",step:"0.1",className:"w-full p-3 bg-white text-emerald-pine rounded-xl border-2 border-lime-glow font-semibold mt-1",placeholder:"e.g. 2.5",value:s.lengthRequiredPerOutfit,onChange:w=>i({...s,lengthRequiredPerOutfit:w.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow uppercase",children:"Location"}),o.jsx("input",{className:"w-full p-3 bg-white text-emerald-pine rounded-xl border-2 border-lime-glow font-semibold mt-1",placeholder:"e.g. Rack B2",value:s.location,onChange:w=>i({...s,location:w.target.value})})]})]}),o.jsx("button",{type:"submit",disabled:u,className:"w-full py-4 rounded-xl font-bold text-emerald-pine shadow-lg mt-4 bg-lime-glow hover:shadow-xl active:shadow-md disabled:opacity-50",children:u?"Saving...":"Add Item"})]})]})}var $_={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){((n,r)=>{t.exports=r()})(gb,function n(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},s,i=!r.document&&!!r.postMessage,a=r.IS_PAPA_WORKER||!1,c={},u=0,d={};function p(f){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(v){var _=L(v);_.chunkSize=parseInt(_.chunkSize),v.step||v.chunk||(_.chunkSize=null),this._handle=new P(_),(this._handle.streamer=this)._config=_}).call(this,f),this.parseChunk=function(v,_){var k=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<k){let C=this._config.newline;C||(j=this._config.quoteChar||'"',C=this._handle.guessLineEndings(v,j)),v=[...v.split(C).slice(k)].join(C)}this.isFirstChunk&&N(this._config.beforeFirstChunk)&&(j=this._config.beforeFirstChunk(v))!==void 0&&(v=j),this.isFirstChunk=!1,this._halted=!1;var k=this._partialLine+v,j=(this._partialLine="",this._handle.parse(k,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(v=j.meta.cursor,k=(this._finished||(this._partialLine=k.substring(v-this._baseIndex),this._baseIndex=v),j&&j.data&&(this._rowCount+=j.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),a)r.postMessage({results:j,workerId:d.WORKER_ID,finished:k});else if(N(this._config.chunk)&&!_){if(this._config.chunk(j,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=j=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(j.data),this._completeResults.errors=this._completeResults.errors.concat(j.errors),this._completeResults.meta=j.meta),this._completed||!k||!N(this._config.complete)||j&&j.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),k||j&&j.meta.paused||this._nextChunk(),j}this._halted=!0},this._sendError=function(v){N(this._config.error)?this._config.error(v):a&&this._config.error&&r.postMessage({workerId:d.WORKER_ID,error:v,finished:!1})}}function y(f){var v;(f=f||{}).chunkSize||(f.chunkSize=d.RemoteChunkSize),p.call(this,f),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(_){this._input=_,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(v=new XMLHttpRequest,this._config.withCredentials&&(v.withCredentials=this._config.withCredentials),i||(v.onload=M(this._chunkLoaded,this),v.onerror=M(this._chunkError,this)),v.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var _,k=this._config.downloadRequestHeaders;for(_ in k)v.setRequestHeader(_,k[_])}var j;this._config.chunkSize&&(j=this._start+this._config.chunkSize-1,v.setRequestHeader("Range","bytes="+this._start+"-"+j));try{v.send(this._config.downloadRequestBody)}catch(C){this._chunkError(C.message)}i&&v.status===0&&this._chunkError()}},this._chunkLoaded=function(){v.readyState===4&&(v.status<200||400<=v.status?this._chunkError():(this._start+=this._config.chunkSize||v.responseText.length,this._finished=!this._config.chunkSize||this._start>=(_=>(_=_.getResponseHeader("Content-Range"))!==null?parseInt(_.substring(_.lastIndexOf("/")+1)):-1)(v),this.parseChunk(v.responseText)))},this._chunkError=function(_){_=v.statusText||_,this._sendError(new Error(_))}}function m(f){(f=f||{}).chunkSize||(f.chunkSize=d.LocalChunkSize),p.call(this,f);var v,_,k=typeof FileReader<"u";this.stream=function(j){this._input=j,_=j.slice||j.webkitSlice||j.mozSlice,k?((v=new FileReader).onload=M(this._chunkLoaded,this),v.onerror=M(this._chunkError,this)):v=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var j=this._input,C=(this._config.chunkSize&&(C=Math.min(this._start+this._config.chunkSize,this._input.size),j=_.call(j,this._start,C)),v.readAsText(j,this._config.encoding));k||this._chunkLoaded({target:{result:C}})},this._chunkLoaded=function(j){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(j.target.result)},this._chunkError=function(){this._sendError(v.error)}}function T(f){var v;p.call(this,f=f||{}),this.stream=function(_){return v=_,this._nextChunk()},this._nextChunk=function(){var _,k;if(!this._finished)return _=this._config.chunkSize,v=_?(k=v.substring(0,_),v.substring(_)):(k=v,""),this._finished=!v,this.parseChunk(k)}}function w(f){p.call(this,f=f||{});var v=[],_=!0,k=!1;this.pause=function(){p.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){p.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(j){this._input=j,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){k&&v.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),v.length?this.parseChunk(v.shift()):_=!0},this._streamData=M(function(j){try{v.push(typeof j=="string"?j:j.toString(this._config.encoding)),_&&(_=!1,this._checkIsFinished(),this.parseChunk(v.shift()))}catch(C){this._streamError(C)}},this),this._streamError=M(function(j){this._streamCleanUp(),this._sendError(j)},this),this._streamEnd=M(function(){this._streamCleanUp(),k=!0,this._streamData("")},this),this._streamCleanUp=M(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function P(f){var v,_,k,j,C=Math.pow(2,53),ge=-C,ae=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Se=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,ne=this,O=0,$=0,ee=!1,X=!1,J=[],A={data:[],errors:[],meta:{}};function H(G){return f.skipEmptyLines==="greedy"?G.join("").trim()==="":G.length===1&&G[0].length===0}function K(){if(A&&k&&(z("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),k=!1),f.skipEmptyLines&&(A.data=A.data.filter(function(Z){return!H(Z)})),V()){let Z=function(ye,we){N(f.transformHeader)&&(ye=f.transformHeader(ye,we)),J.push(ye)};if(A)if(Array.isArray(A.data[0])){for(var G=0;V()&&G<A.data.length;G++)A.data[G].forEach(Z);A.data.splice(0,1)}else A.data.forEach(Z)}function se(Z,ye){for(var we=f.header?{}:[],_e=0;_e<Z.length;_e++){var ve=_e,le=Z[_e],le=((Lt,pe)=>(Oe=>(f.dynamicTypingFunction&&f.dynamicTyping[Oe]===void 0&&(f.dynamicTyping[Oe]=f.dynamicTypingFunction(Oe)),(f.dynamicTyping[Oe]||f.dynamicTyping)===!0))(Lt)?pe==="true"||pe==="TRUE"||pe!=="false"&&pe!=="FALSE"&&((Oe=>{if(ae.test(Oe)&&(Oe=parseFloat(Oe),ge<Oe&&Oe<C))return 1})(pe)?parseFloat(pe):Se.test(pe)?new Date(pe):pe===""?null:pe):pe)(ve=f.header?_e>=J.length?"__parsed_extra":J[_e]:ve,le=f.transform?f.transform(le,ve):le);ve==="__parsed_extra"?(we[ve]=we[ve]||[],we[ve].push(le)):we[ve]=le}return f.header&&(_e>J.length?z("FieldMismatch","TooManyFields","Too many fields: expected "+J.length+" fields but parsed "+_e,$+ye):_e<J.length&&z("FieldMismatch","TooFewFields","Too few fields: expected "+J.length+" fields but parsed "+_e,$+ye)),we}var ue;A&&(f.header||f.dynamicTyping||f.transform)&&(ue=1,!A.data.length||Array.isArray(A.data[0])?(A.data=A.data.map(se),ue=A.data.length):A.data=se(A.data,0),f.header&&A.meta&&(A.meta.fields=J),$+=ue)}function V(){return f.header&&J.length===0}function z(G,se,ue,Z){G={type:G,code:se,message:ue},Z!==void 0&&(G.row=Z),A.errors.push(G)}N(f.step)&&(j=f.step,f.step=function(G){A=G,V()?K():(K(),A.data.length!==0&&(O+=G.data.length,f.preview&&O>f.preview?_.abort():(A.data=A.data[0],j(A,ne))))}),this.parse=function(G,se,ue){var Z=f.quoteChar||'"',Z=(f.newline||(f.newline=this.guessLineEndings(G,Z)),k=!1,f.delimiter?N(f.delimiter)&&(f.delimiter=f.delimiter(G),A.meta.delimiter=f.delimiter):((Z=((ye,we,_e,ve,le)=>{var Lt,pe,Oe,gt;le=le||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var Yt=0;Yt<le.length;Yt++){for(var Bt,mn=le[Yt],Ke=0,ze=0,be=0,je=(Oe=void 0,new E({comments:ve,delimiter:mn,newline:we,preview:10}).parse(ye)),Nt=0;Nt<je.data.length;Nt++)_e&&H(je.data[Nt])?be++:(Bt=je.data[Nt].length,ze+=Bt,Oe===void 0?Oe=Bt:0<Bt&&(Ke+=Math.abs(Bt-Oe),Oe=Bt));0<je.data.length&&(ze/=je.data.length-be),(pe===void 0||Ke<=pe)&&(gt===void 0||gt<ze)&&1.99<ze&&(pe=Ke,Lt=mn,gt=ze)}return{successful:!!(f.delimiter=Lt),bestDelimiter:Lt}})(G,f.newline,f.skipEmptyLines,f.comments,f.delimitersToGuess)).successful?f.delimiter=Z.bestDelimiter:(k=!0,f.delimiter=d.DefaultDelimiter),A.meta.delimiter=f.delimiter),L(f));return f.preview&&f.header&&Z.preview++,v=G,_=new E(Z),A=_.parse(v,se,ue),K(),ee?{meta:{paused:!0}}:A||{meta:{paused:!1}}},this.paused=function(){return ee},this.pause=function(){ee=!0,_.abort(),v=N(f.chunk)?"":v.substring(_.getCharIndex())},this.resume=function(){ne.streamer._halted?(ee=!1,ne.streamer.parseChunk(v,!0)):setTimeout(ne.resume,3)},this.aborted=function(){return X},this.abort=function(){X=!0,_.abort(),A.meta.aborted=!0,N(f.complete)&&f.complete(A),v=""},this.guessLineEndings=function(ye,Z){ye=ye.substring(0,1048576);var Z=new RegExp(I(Z)+"([^]*?)"+I(Z),"gm"),ue=(ye=ye.replace(Z,"")).split("\r"),Z=ye.split(`
`),ye=1<Z.length&&Z[0].length<ue[0].length;if(ue.length===1||ye)return`
`;for(var we=0,_e=0;_e<ue.length;_e++)ue[_e][0]===`
`&&we++;return we>=ue.length/2?`\r
`:"\r"}}function I(f){return f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function E(f){var v=(f=f||{}).delimiter,_=f.newline,k=f.comments,j=f.step,C=f.preview,ge=f.fastMode,ae=null,Se=!1,ne=f.quoteChar==null?'"':f.quoteChar,O=ne;if(f.escapeChar!==void 0&&(O=f.escapeChar),(typeof v!="string"||-1<d.BAD_DELIMITERS.indexOf(v))&&(v=","),k===v)throw new Error("Comment character same as delimiter");k===!0?k="#":(typeof k!="string"||-1<d.BAD_DELIMITERS.indexOf(k))&&(k=!1),_!==`
`&&_!=="\r"&&_!==`\r
`&&(_=`
`);var $=0,ee=!1;this.parse=function(X,J,A){if(typeof X!="string")throw new Error("Input must be a string");var H=X.length,K=v.length,V=_.length,z=k.length,G=N(j),se=[],ue=[],Z=[],ye=$=0;if(!X)return Ke();if(ge||ge!==!1&&X.indexOf(ne)===-1){for(var we=X.split(_),_e=0;_e<we.length;_e++){if(Z=we[_e],$+=Z.length,_e!==we.length-1)$+=_.length;else if(A)return Ke();if(!k||Z.substring(0,z)!==k){if(G){if(se=[],gt(Z.split(v)),ze(),ee)return Ke()}else gt(Z.split(v));if(C&&C<=_e)return se=se.slice(0,C),Ke(!0)}}return Ke()}for(var ve=X.indexOf(v,$),le=X.indexOf(_,$),Lt=new RegExp(I(O)+I(ne),"g"),pe=X.indexOf(ne,$);;)if(X[$]===ne)for(pe=$,$++;;){if((pe=X.indexOf(ne,pe+1))===-1)return A||ue.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:se.length,index:$}),Bt();if(pe===H-1)return Bt(X.substring($,pe).replace(Lt,ne));if(ne===O&&X[pe+1]===O)pe++;else if(ne===O||pe===0||X[pe-1]!==O){ve!==-1&&ve<pe+1&&(ve=X.indexOf(v,pe+1));var Oe=Yt((le=le!==-1&&le<pe+1?X.indexOf(_,pe+1):le)===-1?ve:Math.min(ve,le));if(X.substr(pe+1+Oe,K)===v){Z.push(X.substring($,pe).replace(Lt,ne)),X[$=pe+1+Oe+K]!==ne&&(pe=X.indexOf(ne,$)),ve=X.indexOf(v,$),le=X.indexOf(_,$);break}if(Oe=Yt(le),X.substring(pe+1+Oe,pe+1+Oe+V)===_){if(Z.push(X.substring($,pe).replace(Lt,ne)),mn(pe+1+Oe+V),ve=X.indexOf(v,$),pe=X.indexOf(ne,$),G&&(ze(),ee))return Ke();if(C&&se.length>=C)return Ke(!0);break}ue.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:se.length,index:$}),pe++}}else if(k&&Z.length===0&&X.substring($,$+z)===k){if(le===-1)return Ke();$=le+V,le=X.indexOf(_,$),ve=X.indexOf(v,$)}else if(ve!==-1&&(ve<le||le===-1))Z.push(X.substring($,ve)),$=ve+K,ve=X.indexOf(v,$);else{if(le===-1)break;if(Z.push(X.substring($,le)),mn(le+V),G&&(ze(),ee))return Ke();if(C&&se.length>=C)return Ke(!0)}return Bt();function gt(be){se.push(be),ye=$}function Yt(be){var je=0;return je=be!==-1&&(be=X.substring(pe+1,be))&&be.trim()===""?be.length:je}function Bt(be){return A||(be===void 0&&(be=X.substring($)),Z.push(be),$=H,gt(Z),G&&ze()),Ke()}function mn(be){$=be,gt(Z),Z=[],le=X.indexOf(_,$)}function Ke(be){if(f.header&&!J&&se.length&&!Se){var je=se[0],Nt=Object.create(null),dr=new Set(je);let as=!1;for(let Q=0;Q<je.length;Q++){let ie=je[Q];if(Nt[ie=N(f.transformHeader)?f.transformHeader(ie,Q):ie]){let Ie,gn=Nt[ie];for(;Ie=ie+"_"+gn,gn++,dr.has(Ie););dr.add(Ie),je[Q]=Ie,Nt[ie]++,as=!0,(ae=ae===null?{}:ae)[Ie]=ie}else Nt[ie]=1,je[Q]=ie;dr.add(ie)}as&&console.warn("Duplicate headers found and renamed."),Se=!0}return{data:se,errors:ue,meta:{delimiter:v,linebreak:_,aborted:ee,truncated:!!be,cursor:ye+(J||0),renamedHeaders:ae}}}function ze(){j(Ke()),se=[],ue=[]}},this.abort=function(){ee=!0},this.getCharIndex=function(){return $}}function x(f){var v=f.data,_=c[v.workerId],k=!1;if(v.error)_.userError(v.error,v.file);else if(v.results&&v.results.data){var j={abort:function(){k=!0,b(v.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:R,resume:R};if(N(_.userStep)){for(var C=0;C<v.results.data.length&&(_.userStep({data:v.results.data[C],errors:v.results.errors,meta:v.results.meta},j),!k);C++);delete v.results}else N(_.userChunk)&&(_.userChunk(v.results,j,v.file),delete v.results)}v.finished&&!k&&b(v.workerId,v.results)}function b(f,v){var _=c[f];N(_.userComplete)&&_.userComplete(v),_.terminate(),delete c[f]}function R(){throw new Error("Not implemented.")}function L(f){if(typeof f!="object"||f===null)return f;var v,_=Array.isArray(f)?[]:{};for(v in f)_[v]=L(f[v]);return _}function M(f,v){return function(){f.apply(v,arguments)}}function N(f){return typeof f=="function"}return d.parse=function(f,v){var _=(v=v||{}).dynamicTyping||!1;if(N(_)&&(v.dynamicTypingFunction=_,_={}),v.dynamicTyping=_,v.transform=!!N(v.transform)&&v.transform,!v.worker||!d.WORKERS_SUPPORTED)return _=null,d.NODE_STREAM_INPUT,typeof f=="string"?(f=(k=>k.charCodeAt(0)!==65279?k:k.slice(1))(f),_=new(v.download?y:T)(v)):f.readable===!0&&N(f.read)&&N(f.on)?_=new w(v):(r.File&&f instanceof File||f instanceof Object)&&(_=new m(v)),_.stream(f);(_=(()=>{var k;return!!d.WORKERS_SUPPORTED&&(k=(()=>{var j=r.URL||r.webkitURL||null,C=n.toString();return d.BLOB_URL||(d.BLOB_URL=j.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",C,")();"],{type:"text/javascript"})))})(),(k=new r.Worker(k)).onmessage=x,k.id=u++,c[k.id]=k)})()).userStep=v.step,_.userChunk=v.chunk,_.userComplete=v.complete,_.userError=v.error,v.step=N(v.step),v.chunk=N(v.chunk),v.complete=N(v.complete),v.error=N(v.error),delete v.worker,_.postMessage({input:f,config:v,workerId:_.id})},d.unparse=function(f,v){var _=!1,k=!0,j=",",C=`\r
`,ge='"',ae=ge+ge,Se=!1,ne=null,O=!1,$=((()=>{if(typeof v=="object"){if(typeof v.delimiter!="string"||d.BAD_DELIMITERS.filter(function(J){return v.delimiter.indexOf(J)!==-1}).length||(j=v.delimiter),typeof v.quotes!="boolean"&&typeof v.quotes!="function"&&!Array.isArray(v.quotes)||(_=v.quotes),typeof v.skipEmptyLines!="boolean"&&typeof v.skipEmptyLines!="string"||(Se=v.skipEmptyLines),typeof v.newline=="string"&&(C=v.newline),typeof v.quoteChar=="string"&&(ge=v.quoteChar),typeof v.header=="boolean"&&(k=v.header),Array.isArray(v.columns)){if(v.columns.length===0)throw new Error("Option columns is empty");ne=v.columns}v.escapeChar!==void 0&&(ae=v.escapeChar+ge),v.escapeFormulae instanceof RegExp?O=v.escapeFormulae:typeof v.escapeFormulae=="boolean"&&v.escapeFormulae&&(O=/^[=+\-@\t\r].*$/)}})(),new RegExp(I(ge),"g"));if(typeof f=="string"&&(f=JSON.parse(f)),Array.isArray(f)){if(!f.length||Array.isArray(f[0]))return ee(null,f,Se);if(typeof f[0]=="object")return ee(ne||Object.keys(f[0]),f,Se)}else if(typeof f=="object")return typeof f.data=="string"&&(f.data=JSON.parse(f.data)),Array.isArray(f.data)&&(f.fields||(f.fields=f.meta&&f.meta.fields||ne),f.fields||(f.fields=Array.isArray(f.data[0])?f.fields:typeof f.data[0]=="object"?Object.keys(f.data[0]):[]),Array.isArray(f.data[0])||typeof f.data[0]=="object"||(f.data=[f.data])),ee(f.fields||[],f.data||[],Se);throw new Error("Unable to serialize unrecognized input");function ee(J,A,H){var K="",V=(typeof J=="string"&&(J=JSON.parse(J)),typeof A=="string"&&(A=JSON.parse(A)),Array.isArray(J)&&0<J.length),z=!Array.isArray(A[0]);if(V&&k){for(var G=0;G<J.length;G++)0<G&&(K+=j),K+=X(J[G],G);0<A.length&&(K+=C)}for(var se=0;se<A.length;se++){var ue=(V?J:A[se]).length,Z=!1,ye=V?Object.keys(A[se]).length===0:A[se].length===0;if(H&&!V&&(Z=H==="greedy"?A[se].join("").trim()==="":A[se].length===1&&A[se][0].length===0),H==="greedy"&&V){for(var we=[],_e=0;_e<ue;_e++){var ve=z?J[_e]:_e;we.push(A[se][ve])}Z=we.join("").trim()===""}if(!Z){for(var le=0;le<ue;le++){0<le&&!ye&&(K+=j);var Lt=V&&z?J[le]:le;K+=X(A[se][Lt],le)}se<A.length-1&&(!H||0<ue&&!ye)&&(K+=C)}}return K}function X(J,A){var H,K;return J==null?"":J.constructor===Date?JSON.stringify(J).slice(1,25):(K=!1,O&&typeof J=="string"&&O.test(J)&&(J="'"+J,K=!0),H=J.toString().replace($,ae),(K=K||_===!0||typeof _=="function"&&_(J,A)||Array.isArray(_)&&_[A]||((V,z)=>{for(var G=0;G<z.length;G++)if(-1<V.indexOf(z[G]))return!0;return!1})(H,d.BAD_DELIMITERS)||-1<H.indexOf(j)||H.charAt(0)===" "||H.charAt(H.length-1)===" ")?ge+H+ge:H)}},d.RECORD_SEP="",d.UNIT_SEP="",d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!i&&!!r.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=E,d.ParserHandle=P,d.NetworkStreamer=y,d.FileStreamer=m,d.StringStreamer=T,d.ReadableStreamStreamer=w,r.jQuery&&((s=r.jQuery).fn.parse=function(f){var v=f.config||{},_=[];return this.each(function(C){if(!(s(this).prop("tagName").toUpperCase()==="INPUT"&&s(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var ge=0;ge<this.files.length;ge++)_.push({file:this.files[ge],inputElem:this,instanceConfig:s.extend({},v)})}),k(),this;function k(){if(_.length===0)N(f.complete)&&f.complete();else{var C,ge,ae,Se,ne=_[0];if(N(f.before)){var O=f.before(ne.file,ne.inputElem);if(typeof O=="object"){if(O.action==="abort")return C="AbortError",ge=ne.file,ae=ne.inputElem,Se=O.reason,void(N(f.error)&&f.error({name:C},ge,ae,Se));if(O.action==="skip")return void j();typeof O.config=="object"&&(ne.instanceConfig=s.extend(ne.instanceConfig,O.config))}else if(O==="skip")return void j()}var $=ne.instanceConfig.complete;ne.instanceConfig.complete=function(ee){N($)&&$(ee,ne.file,ne.inputElem),j()},d.parse(ne.file,ne.instanceConfig)}}function j(){_.splice(0,1),k()}}),a&&(r.onmessage=function(f){f=f.data,d.WORKER_ID===void 0&&f&&(d.WORKER_ID=f.workerId),typeof f.input=="string"?r.postMessage({workerId:d.WORKER_ID,results:d.parse(f.input,f.config),finished:!0}):(r.File&&f.input instanceof File||f.input instanceof Object)&&(f=d.parse(f.input,f.config))&&r.postMessage({workerId:d.WORKER_ID,results:f,finished:!0})}),(y.prototype=Object.create(p.prototype)).constructor=y,(m.prototype=Object.create(p.prototype)).constructor=m,(T.prototype=Object.create(T.prototype)).constructor=T,(w.prototype=Object.create(p.prototype)).constructor=w,d})})($_);var CA=$_.exports;const Ky=Qy(CA);function kA(){const[t,e]=F.useState(""),[n,r]=F.useState(!1),[s,i]=F.useState(!1),[a,c]=F.useState(""),[u,d]=F.useState([]),[p,y]=F.useState(""),m=()=>{if(!t)return c("Provide sheet id");r(!0);const P=`https://docs.google.com/spreadsheets/d/${t}/export?format=csv`;Ky.parse(P,{download:!0,header:!0,complete:I=>{const E=(I.data||[]).filter(x=>Object.values(x).some(b=>b!=null&&b!==""));d(E),c(`Fetched ${E.length} rows  preview below. Tap Import to save.`),r(!1)},error:I=>{c("Fetch failed: "+I.message),r(!1)}})},T=()=>{if(!p)return c("Paste CSV content or fetch a sheet");try{const I=(Ky.parse(p,{header:!0}).data||[]).filter(E=>Object.values(E).some(x=>x!=null&&x!==""));d(I),c(`Parsed ${I.length} rows from pasted CSV.`)}catch(P){c("Parse failed: "+P.message)}},w=async()=>{if(!u||!u.length)return c("No data to import");i(!0);try{const P=Ue();let I=0;for(const E of u)await Gt(Qe(P,dn),{importedData:E,createdAt:ke()}),I++;c(`Imported ${I} rows`),d([]),y("")}catch(P){c("Import failed: "+P.message)}i(!1)};return o.jsxs("div",{className:"p-4 max-w-3xl mx-auto",children:[o.jsx("h3",{className:"font-bold mb-3 text-lg",children:"Import Google Sheet / CSV"}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-3",children:[o.jsx("input",{value:t,onChange:P=>e(P.target.value),placeholder:"Google Sheet ID (or leave blank)",className:"flex-1 p-3 rounded border bg-white text-sm"}),o.jsx("button",{onClick:m,className:"w-full sm:w-auto px-4 py-3 bg-green-600 text-white rounded shadow",disabled:n,children:n?"Fetching":"Fetch Sheet"})]}),o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Paste raw CSV data"}),o.jsx("textarea",{rows:6,value:p,onChange:P=>y(P.target.value),placeholder:"Paste CSV here",className:"w-full mt-2 p-3 rounded border bg-white text-sm font-mono"}),o.jsxs("div",{className:"flex gap-2 mt-2",children:[o.jsx("button",{onClick:T,className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded",children:"Parse Pasted CSV"}),o.jsx("button",{onClick:()=>{y(""),d([]),c("Cleared")},className:"px-4 py-3 bg-gray-100 rounded",children:"Clear"})]})]}),o.jsxs("div",{className:"mb-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h4",{className:"text-sm font-bold",children:"Preview"}),o.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[u.length," rows"]})]}),u.length>0?o.jsxs("div",{className:"overflow-x-auto border rounded-lg bg-white",children:[o.jsxs("table",{className:"w-full text-xs table-auto",children:[o.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900 text-gray-600",children:o.jsx("tr",{children:Object.keys(u[0]).slice(0,10).map(P=>o.jsx("th",{className:"p-2 border-b",children:P},P))})}),o.jsx("tbody",{children:u.slice(0,5).map((P,I)=>o.jsx("tr",{className:"border-b hover:bg-gray-50",children:Object.values(P).slice(0,10).map((E,x)=>o.jsx("td",{className:"p-2 align-top whitespace-nowrap overflow-hidden text-ellipsis max-w-[10rem]",children:E},x))},I))})]}),o.jsx("div",{className:"text-[11px] text-gray-500 dark:text-gray-400 dark:text-gray-500 p-2",children:"Showing first 5 rows"})]}):o.jsx("div",{className:"text-center py-6 text-gray-400 dark:text-gray-500 bg-white border rounded-lg",children:"No data loaded."})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:w,disabled:s||u.length===0,className:"flex-1 px-4 py-3 bg-green-600 text-white rounded shadow",children:s?"Importing":"Import Parsed Data"}),o.jsx("button",{onClick:()=>{d([]),c("Cleared parsed data")},className:"px-4 py-3 bg-gray-100 rounded",children:"Reset"})]}),a&&o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 dark:text-gray-500 mt-3",children:a})]})}function AA({allOrders:t=[],inventoryItems:e=[],userRole:n="admin"}){const[r,s]=F.useState("all"),i=p=>{const y=parseFloat(p);return isNaN(y)?0:y},a=p=>p?Object.values(p).reduce((y,m)=>y+(parseInt(m)||0),0):0,c=(p,y)=>{if(!p.parentFabricId)return 0;const m=y.find(P=>P.id===p.parentFabricId);if(!m)return 0;const T=(parseFloat(m.costPerMeter)||0)*(parseFloat(p.lengthRequiredPerOutfit)||0),w=parseFloat(p.stitchingCost)||0;return T+w},u=F.useMemo(()=>{let p=0,y=0,m=0,T=0;e.forEach(E=>{if(E.type==="outfit"){const x=a(E.stockBreakdown);y+=x,p+=x*(E.sellingPrice||0);const b=c(E,e);T+=x*b}else if(E.type==="fabric"){const x=parseFloat(E.currentLength)||0,b=parseFloat(E.costPerMeter)||0,R=parseFloat(E.lengthRequiredPerOutfit)||1,L=parseFloat(E.sellingPrice)>0?parseFloat(E.sellingPrice):1500;m+=x*b;const M=Math.floor(x/(R>0?R:1));p+=M*L}});const w=m+T,P=p-w,I=w>0?P/w*100:0;return{potentialRevenue:p,totalStockCount:y,totalFabricCostValuation:m,totalOutfitCostValuation:T,totalStockValuation:w,percentageIncrease:I,totalPotentialRevenue:p,totalStockValue:w,revenuePerMeter:y>0?p/y:0}},[e]),d=F.useMemo(()=>{const p=new Date().getMonth(),y=new Date().getFullYear(),m=t.filter(ae=>{var Se;if(ae.status==="Cancelled")return!1;if(r==="month"){let ne=null;return(Se=ae.createdAt)!=null&&Se.toDate?ne=ae.createdAt.toDate():ae.dateString&&(ne=new Date(ae.dateString)),!ne||isNaN(ne.getTime())?!1:ne.getMonth()===p&&ne.getFullYear()===y}return!0});let T=0,w=0,P=0,I=0,E=0,x=0,b=0,R=0,L=0,M=0;const N={},f=new Date;f.setHours(0,0,0,0),m.forEach(ae=>{const Se=e.find(H=>H.id===ae.fabricId)||{costPerMeter:0},ne=parseFloat(ae.cutAmount)||0,O=ne*(parseFloat(Se.costPerMeter)||0),$=i(ae.stitchingCost),ee=i(ae.acquisitionCost)||i(ae.codCharge),X=i(ae.shippingCost),J=i(ae.otherExpenses),A=i(ae.finalSellingPrice)||i(ae.orderTotal);if(A>0||ae.status==="Order Shipped (Completed)"){T+=A,w++,I+=ne,E+=O,x+=$,b+=X,R+=ee+J;const H=A-O-$-ee-X-J;P+=H,ae.createdAt&&typeof ae.createdAt.toDate=="function"&&ae.createdAt.toDate()>=f;const K=(ae.paymentMethod||"").toLowerCase();if(K.includes("cod")||K.includes("cash")?L++:M++,ae.customerName){const V=ae.customerName.toLowerCase().trim();N[V]||(N[V]={name:ae.customerName,revenue:0,orders:0}),N[V].revenue+=A,N[V].orders++}}});const v=T>0?P/T*100:0,_=I>0?T/I:0,k=w>0?P/w:0,j=Object.values(N).sort((ae,Se)=>Se.revenue-ae.revenue).slice(0,5),C=Object.keys(N).length,ge=C>0?T/C:0;return{totalRevenue:T.toFixed(0),totalProfit:P.toFixed(0),netProfit:parseInt(P),totalSold:w,dailyProfit:k.toFixed(0),revPerMeter:_.toFixed(0),profitMargin:v.toFixed(1),breakdown:{fabric:E,stitch:x,ship:b,cod:R,ops:R+b},paymentSplit:{cod:L,prepaid:M},customerMetrics:{totalCustomers:C,avgRevenue:ge,topCustomers:j}}},[e,t,r]);return o.jsxs(o.Fragment,{children:[n==="admin"&&o.jsx("div",{className:"flex justify-end mb-6",children:o.jsxs("div",{className:"bg-transparent p-1 rounded-3xl flex text-xs font-bold shadow-sm border-3 border-lime-glow",children:[o.jsx("button",{onClick:()=>s("all"),className:`px-5 py-2 rounded-2xl transition-all font-semibold ${r==="all"?"bg-emerald-pine text-lime-glow shadow-lg":"text-emerald-pine/60 hover:text-emerald-pine"}`,children:"All Time"}),o.jsx("button",{onClick:()=>s("month"),className:`px-5 py-2 rounded-2xl transition-all font-semibold ${r==="month"?"bg-emerald-pine text-lime-glow shadow-lg":"text-emerald-pine/60 hover:text-emerald-pine"}`,children:"This Month"})]})}),o.jsx("div",{className:"mb-6",children:o.jsx("div",{className:"bg-lime-glow p-8 rounded-3xl shadow-xl relative overflow-hidden",children:o.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-emerald-pine mb-3 font-medium uppercase tracking-wider",children:"Your Total Revenue"}),n==="admin"?o.jsxs("h3",{className:"text-5xl font-bold mb-4 text-emerald-pine",children:["",parseInt(d.totalRevenue).toLocaleString()]}):o.jsx("h3",{className:"text-5xl font-bold mb-4 text-emerald-pine",children:d.totalSold}),o.jsxs("p",{className:"text-base text-emerald-pine/80",children:[d.totalSold," Orders"]})]}),o.jsx("div",{className:"flex flex-col justify-end text-right",children:n==="admin"&&o.jsxs(o.Fragment,{children:[o.jsxs("p",{className:"text-4xl font-bold text-emerald-pine mb-2",children:["",d.netProfit.toLocaleString()]}),o.jsxs("p",{className:"text-sm text-emerald-pine/80",children:["Net Profit (",d.profitMargin,"%)"]})]})})]})})}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[o.jsxs("div",{className:"bg-lime-glow p-4 rounded-3xl shadow-lg border-2 border-lime-glow",children:[o.jsx("p",{className:"text-xs text-emerald-pine font-semibold uppercase mb-2",children:"Avg Profit/Order"}),o.jsxs("p",{className:"text-2xl font-bold text-emerald-pine",children:["",parseInt(d.dailyProfit).toLocaleString()]})]}),o.jsxs("div",{className:"bg-lime-glow p-4 rounded-3xl shadow-lg border-2 border-lime-glow",children:[o.jsx("p",{className:"text-xs text-emerald-pine font-semibold uppercase mb-2",children:"Rev / Meter"}),o.jsxs("p",{className:"text-2xl font-bold text-emerald-pine",children:["",u.revenuePerMeter.toLocaleString()]})]}),o.jsxs("div",{className:"bg-lime-glow p-4 rounded-3xl shadow-lg border-2 border-lime-glow",children:[o.jsx("p",{className:"text-xs text-emerald-pine font-semibold uppercase mb-2",children:"Potential Rev"}),o.jsxs("p",{className:"text-2xl font-bold text-emerald-pine",children:["",(u.totalPotentialRevenue/1e3).toFixed(1),"k"]}),o.jsxs("p",{className:"text-[10px] font-bold text-emerald-pine/80 mt-1",children:["+",u.percentageIncrease.toFixed(0),"% ROI"]})]}),o.jsxs("div",{className:"bg-lime-glow p-4 rounded-3xl shadow-lg border-2 border-lime-glow",children:[o.jsx("p",{className:"text-xs text-emerald-pine font-semibold uppercase mb-2",children:"Stock Value"}),o.jsxs("p",{className:"text-2xl font-bold text-emerald-pine",children:["",(u.totalStockValue/1e3).toFixed(1),"k"]}),o.jsxs("div",{className:"flex gap-2 text-[9px] mt-1 text-emerald-pine/70",children:[o.jsxs("span",{children:["Fab: ",(u.totalFabricCostValuation/1e3).toFixed(1),"k"]}),o.jsx("span",{children:"|"}),o.jsxs("span",{children:["Out: ",(u.totalOutfitCostValuation/1e3).toFixed(1),"k"]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[o.jsxs("div",{className:"bg-lime-glow p-5 rounded-3xl shadow-lg border-2 border-lime-glow",children:[o.jsx("p",{className:"text-xs text-emerald-pine font-semibold uppercase mb-3",children:"Expenses Breakdown"}),o.jsxs("div",{className:"text-sm space-y-2",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-emerald-pine/80",children:"Fabric"})," ",o.jsxs("span",{className:"font-bold text-emerald-pine",children:["",(d.breakdown.fabric/1e3).toFixed(1),"k"]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-emerald-pine/80",children:"Stitch"})," ",o.jsxs("span",{className:"font-bold text-emerald-pine",children:["",(d.breakdown.stitch/1e3).toFixed(1),"k"]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-emerald-pine/80",children:"Ship"})," ",o.jsxs("span",{className:"font-bold text-emerald-pine",children:["",(d.breakdown.ship/1e3).toFixed(1),"k"]})]}),o.jsxs("div",{className:"border-t border-emerald-pine/30 pt-2 flex justify-between",children:[o.jsx("span",{className:"text-emerald-pine font-semibold",children:"COD/Acq"})," ",o.jsxs("span",{className:"font-bold text-emerald-pine",children:["",(d.breakdown.cod/1e3).toFixed(1),"k"]})]})]})]}),o.jsxs("div",{className:"bg-lime-glow p-5 rounded-3xl shadow-lg border-2 border-lime-glow",children:[o.jsx("p",{className:"text-xs text-emerald-pine font-semibold uppercase mb-3",children:"Payment Split"}),o.jsxs("div",{className:"flex items-center justify-around h-24",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-3xl font-bold text-emerald-pine",children:d.paymentSplit.cod}),o.jsx("p",{className:"text-xs text-emerald-pine/70 mt-1",children:"COD"})]}),o.jsx("div",{className:"w-px h-12 bg-emerald-pine/30"}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-3xl font-bold text-emerald-pine",children:d.paymentSplit.prepaid}),o.jsx("p",{className:"text-xs text-emerald-pine/70 mt-1",children:"Prepaid"})]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"bg-lime-glow p-5 rounded-3xl shadow-lg border-2 border-lime-glow",children:[o.jsx("p",{className:"text-xs text-emerald-pine font-semibold uppercase mb-3",children:"Customer Metrics"}),o.jsxs("div",{className:"flex items-end justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-3xl font-bold text-emerald-pine",children:d.customerMetrics.totalCustomers}),o.jsx("p",{className:"text-[10px] text-emerald-pine/70 mt-1",children:"Total Customers"})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("p",{className:"text-2xl font-bold text-emerald-pine",children:["",(d.customerMetrics.avgRevenue/1e3).toFixed(1),"k"]}),o.jsx("p",{className:"text-[10px] text-emerald-pine/70 mt-1",children:"Avg Revenue"})]})]})]}),o.jsxs("div",{className:"bg-emerald-pine p-5 rounded-3xl shadow-lg border-2 border-lime-glow",children:[o.jsx("p",{className:"text-xs text-lime-glow font-semibold uppercase mb-1",children:" Top Customer"}),d.customerMetrics.topCustomers.length>0?o.jsxs("div",{children:[o.jsx("p",{className:"text-lg font-bold text-lime-glow mt-2",children:d.customerMetrics.topCustomers[0].name}),o.jsxs("p",{className:"text-2xl font-bold text-lime-glow mt-1",children:["",(d.customerMetrics.topCustomers[0].revenue/1e3).toFixed(1),"k"]}),o.jsxs("p",{className:"text-xs text-lime-glow/80 mt-2",children:[d.customerMetrics.topCustomers[0].orders," orders"]})]}):o.jsx("p",{className:"text-xs text-lime-glow/50 mt-2",children:"No customers yet"})]})]})]})}function jA({outfit:t,inventoryItem:e,onClose:n}){if(!t||!e)return null;const r=["S","M","L","XL","XXL"],s=e.stockBreakdown||{},i=c=>parseInt(s[c])||0,a=r.reduce((c,u)=>c+i(u),0);return o.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-end sm:items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white w-full sm:max-w-md rounded-t-3xl sm:rounded-3xl shadow-2xl",children:[o.jsxs("div",{className:"flex justify-between items-center p-4 sm:p-6 border-b-2 border-lime-glow bg-gradient-to-r from-emerald-pine to-emerald-800",children:[o.jsx("h2",{className:"text-lg sm:text-xl font-bold text-white",children:t.name}),o.jsx("button",{onClick:n,className:"text-white hover:text-gray-200 text-2xl",children:""})]}),o.jsxs("div",{className:"p-4 sm:p-6",children:[o.jsx("div",{className:"mb-6",children:o.jsx("div",{className:"w-full h-40 bg-gray-100 rounded-2xl overflow-hidden mb-4",children:o.jsx("img",{src:t.imageUrl,className:"w-full h-full object-cover"})})}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[o.jsxs("div",{className:"bg-lime-glow/20 p-3 rounded-xl",children:[o.jsx("p",{className:"text-xs text-emerald-pine font-semibold uppercase",children:"Total Stock"}),o.jsx("p",{className:"text-2xl font-bold text-emerald-pine",children:a})]}),o.jsxs("div",{className:"bg-green-100 p-3 rounded-xl",children:[o.jsx("p",{className:"text-xs text-green-700 font-semibold uppercase",children:"Sold"}),o.jsx("p",{className:"text-2xl font-bold text-green-700",children:t.qty||0})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("h3",{className:"text-sm font-bold text-gray-800 mb-3",children:"Stock by Size"}),r.map(c=>{const u=i(c),d=a>0?u/a*100:0;return o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-emerald-pine text-white rounded-lg flex items-center justify-center font-bold text-sm",children:c}),o.jsx("div",{className:"flex-1",children:o.jsx("div",{className:"bg-gray-200 h-8 rounded-lg overflow-hidden",children:o.jsx("div",{className:"bg-gradient-to-r from-lime-glow to-green-tea h-full flex items-center justify-center transition-all",style:{width:`${d}%`},children:u>0&&o.jsx("span",{className:"text-xs font-bold text-emerald-pine",children:u})})})}),o.jsxs("div",{className:"text-right w-12",children:[o.jsx("p",{className:"font-bold text-emerald-pine",children:u}),o.jsxs("p",{className:"text-xs text-gray-500",children:[d.toFixed(0),"%"]})]})]},c)})]}),o.jsx("div",{className:"mt-6 pt-4 border-t-2 border-gray-200",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-gray-600 font-semibold",children:"Total Revenue"}),o.jsxs("span",{className:"text-lg font-bold text-green-600",children:["",(t.revenue||0).toLocaleString()]})]})})]}),o.jsx("div",{className:"border-t-2 border-gray-200 p-4 sm:p-6 flex justify-end",children:o.jsx("button",{onClick:n,className:"px-6 py-2 bg-emerald-pine text-white font-bold rounded-xl hover:bg-emerald-800 transition",children:"Close"})})]})})}function PA({allOrders:t=[],inventoryItems:e=[]}){const[n,r]=F.useState(null),[s,i]=F.useState(null),a=y=>{if(typeof y=="number")return y;if(!y)return 0;const m=String(y).replace(/[^0-9.-]/g,"");return parseFloat(m)||0},c=y=>y?Object.values(y).reduce((m,T)=>m+(parseFloat(T)||0),0):0,u=F.useMemo(()=>e.filter(y=>y.type==="outfit").map(y=>({name:y.name,imageUrl:y.imageUrl||`https://placehold.co/150x150/e2e8f0/64748b?text=${y.name.substring(0,3)}`,stock:c(y.stockBreakdown),revenue:0,qty:0,inInventory:!0})),[e]),d=F.useMemo(()=>{const y={};return u.forEach(m=>{y[m.name.toLowerCase()]={...m}}),t.forEach(m=>{if(m.status==="Cancelled")return;const w=(m.outfitName||m.productName||"Unknown").trim().toLowerCase(),P=a(m.finalSellingPrice)||a(m.orderTotal)||0;y[w]&&(y[w].revenue+=P,y[w].qty+=parseInt(m.quantity)||1)}),Object.values(y).sort((m,T)=>T.revenue-m.revenue)},[t,u]),p=F.useMemo(()=>{const y=new Set(e.filter(T=>T.type==="outfit").map(T=>T.name.toLowerCase())),m=[];return t.forEach(T=>{if(T.status==="Cancelled")return;const w=(T.outfitName||T.productName||"").trim();if(!(!w||w==="Unknown")&&!y.has(w.toLowerCase())){const P=m.find(I=>I.name.toLowerCase()===w.toLowerCase());P?(P.count+=1,P.orderIds.push(T.orderNumber||T.id)):m.push({name:w,count:1,orderIds:[T.orderNumber||T.id],imageUrl:T.imageUrl||`https://placehold.co/150x150/fef3c7/f59e0b?text=${w.substring(0,3)}`})}}),m},[t,e]);return o.jsxs("div",{className:"space-y-6 fade-in",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Outfit Performance"}),o.jsxs("div",{className:"text-xs bg-white dark:bg-gray-950 px-3 py-1 rounded-full shadow font-bold text-gray-500 dark:text-gray-400 border dark:border-gray-800",children:[d.length," Items"]})]}),p.length>0&&o.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-xl",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(mx,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("h3",{className:"font-bold text-yellow-900 text-sm mb-2",children:[" Outfits Not in Inventory (",p.length,")"]}),o.jsx("p",{className:"text-xs text-yellow-800 mb-3",children:"These outfit names appear in orders but don't exist in your inventory. Add them to inventory or update order history to match existing outfit names."}),o.jsx("div",{className:"space-y-2",children:p.map((y,m)=>o.jsxs("div",{className:"bg-white dark:bg-gray-900 p-3 rounded-lg border border-yellow-200 dark:border-yellow-900 flex gap-3 items-center border dark:border-gray-800",children:[o.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-lg overflow-hidden flex-shrink-0",children:o.jsx("img",{src:y.imageUrl,className:"w-full h-full object-cover"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:"font-bold text-gray-900 dark:text-white text-sm truncate",children:y.name}),o.jsxs("p",{className:"text-xs text-gray-500",children:["Found in ",y.count," order",y.count>1?"s":"",": ",y.orderIds.slice(0,3).join(", "),y.orderIds.length>3&&` +${y.orderIds.length-3} more`]})]}),o.jsx("div",{className:"text-right",children:o.jsx("span",{className:"text-xs font-bold text-yellow-700 bg-yellow-100 px-2 py-1 rounded",children:"FIX"})})]},m))}),o.jsx("p",{className:"text-xs text-yellow-700 mt-3 font-bold",children:" Tip: Go to Inventory  Add Item to create these outfits, or edit orders to use existing outfit names."})]})]})}),o.jsx("div",{className:"grid grid-cols-1 gap-4",children:d.length>0?d.map((y,m)=>{const T=e.find(w=>w.type==="outfit"&&w.name===y.name);return o.jsxs("button",{onClick:()=>{r(y),i(T)},className:"bg-white dark:bg-gray-950 p-4 rounded-2xl shadow-card border dark:border-gray-800 flex gap-4 items-center border dark:border-gray-800 hover:shadow-lg hover:border-lime-glow transition-all cursor-pointer",children:[o.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-xl overflow-hidden flex-shrink-0",children:o.jsx("img",{src:y.imageUrl,className:"w-full h-full object-cover"})}),o.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[o.jsx("h4",{className:"font-bold text-gray-900 dark:text-white text-sm truncate",children:y.name}),o.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Stock: ",y.stock]})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("p",{className:"font-bold text-green-600",children:["",(y.revenue/1e3).toFixed(1),"k"]}),o.jsxs("p",{className:"text-[10px] text-gray-400 dark:text-gray-500 font-bold",children:[y.qty," SOLD"]})]})]},m)}):o.jsxs("div",{className:"text-center py-10 text-gray-400",children:[o.jsx("p",{children:"No outfits in inventory yet."}),o.jsx("p",{className:"text-xs mt-2",children:"Add outfits in the Inventory tab"})]})}),o.jsx(jA,{outfit:n,inventoryItem:s,onClose:()=>{r(null),i(null)}})]})}function RA({allOrders:t=[],onViewCustomer:e=()=>{},onDeleteCustomer:n=()=>{},onAddCustomer:r=()=>{},searchTerm:s="",setSearchTerm:i=()=>{}}){const[a,c]=F.useState(null),[u,d]=F.useState(!1),[p,y]=F.useState({name:"",phone:"",email:"",address:"",city:"",state:"",source:"Manual"}),m=()=>y({name:"",phone:"",email:"",address:"",city:"",state:"",source:"Manual"}),T=()=>{if(!p.name.trim()){alert("Name is required");return}r(p),m(),d(!1)},w=E=>{if(typeof E=="number")return E;if(!E)return 0;const x=String(E).replace(/[^0-9.-]/g,"");return parseFloat(x)||0},P=E=>{if(!E)return null;const x=E.toLowerCase().trim(),b=t.filter(M=>M.customerName&&M.customerName.toLowerCase().trim()===x),R=b.reduce((M,N)=>{var v;const f=w(N.orderTotal)||w(N.finalSellingPrice)||w((v=N.importedData)==null?void 0:v["Product Price"])||0;return M+f},0),L=b.length;return{history:b,totalSpent:R,totalItems:L}},I=F.useMemo(()=>{const E=new Map;t.forEach(b=>{var R;if(b.customerName){const L=b.customerName.toLowerCase().trim(),M=E.get(L)||{name:b.customerName,phone:b.phone||"",address:b.address||"",email:b.email||"",city:b.city||"",state:b.state||"",source:"Order History",customFields:b.importedData||{}};b.phone&&(M.phone=b.phone),b.address&&(M.address=b.address),b.city&&(M.city=b.city),b.state&&(M.state=b.state),(R=b.importedData)!=null&&R["Customer Email"]&&(M.email=b.importedData["Customer Email"]),E.set(L,M)}});let x=Array.from(E.values());if(s){const b=s.toLowerCase();x=x.filter(R=>R.name.toLowerCase().includes(b)||R.phone&&R.phone.includes(b))}return x.sort((b,R)=>b.name.localeCompare(R.name))},[t,s]);return o.jsxs("div",{className:"space-y-6 fade-in",children:[o.jsxs("div",{className:"flex justify-between items-center gap-3 mb-2",children:[o.jsx("h2",{className:"text-2xl font-bold text-lime-glow",children:"Customers"}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"text-xs text-emerald-pine font-bold bg-lime-glow px-3 py-1 rounded-full shadow-sm border border-emerald-pine/30",children:[I.length," Total"]}),o.jsxs("button",{onClick:()=>d(!0),className:"flex items-center gap-2 px-4 py-2 bg-emerald-pine text-lime-glow rounded-xl text-sm font-bold shadow-sm hover:shadow-md border border-lime-glow",children:[o.jsx(hx,{className:"w-4 h-4"}),"Add Customer"]})]})]}),o.jsxs("div",{className:"relative mb-4",children:[o.jsx("span",{className:"absolute inset-y-0 left-0 pl-3 flex items-center text-emerald-pine",children:o.jsx(px,{className:"w-5 h-5"})}),o.jsx("input",{className:"w-full pl-10 p-3 bg-white text-black rounded-xl border-2 border-lime-glow shadow-sm text-sm placeholder-gray-400",placeholder:"Search customers...",value:s,onChange:E=>i(E.target.value)})]}),o.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[I.map((E,x)=>{const b=P(E.name);return o.jsxs("div",{className:"bg-green-tea p-4 rounded-2xl shadow-card flex items-center justify-between border border-lime-glow/60",children:[o.jsxs("div",{onClick:()=>e(E),className:"flex items-center gap-3 flex-1 cursor-pointer hover:opacity-80",children:[o.jsx("div",{className:"h-10 w-10 rounded-full bg-emerald-pine/10 border border-lime-glow flex items-center justify-center text-emerald-pine font-bold text-sm",children:E.name.substring(0,2).toUpperCase()}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-bold text-emerald-pine text-sm",children:E.name}),o.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-emerald-pine/70",children:[E.phone&&o.jsxs("span",{children:[" ",E.phone]}),E.source==="Saved"&&o.jsx("span",{className:"bg-lime-glow text-emerald-pine px-1 rounded border border-emerald-pine/40",children:"Imported"})]})]})]}),o.jsxs("div",{className:"text-right flex items-center gap-3",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-lg font-bold text-emerald-pine",children:b.totalItems}),o.jsx("p",{className:"text-[10px] text-emerald-pine/60 uppercase",children:"Orders"})]}),o.jsx("button",{onClick:R=>{R.stopPropagation(),c(E.name)},className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition",title:"Delete customer and all orders",children:o.jsx(Zo,{className:"w-4 h-4"})})]})]},x)}),I.length===0&&o.jsxs("div",{className:"text-center py-10 text-emerald-pine/70",children:[o.jsx(gx,{className:"w-12 h-12 mx-auto mb-2 opacity-20 text-emerald-pine"}),o.jsx("p",{children:"No customers found."})]})]}),a&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:()=>c(null),children:o.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-sm mx-4 shadow-xl",onClick:E=>E.stopPropagation(),children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Delete Customer?"}),o.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["This will permanently delete ",o.jsx("strong",{children:a})," and all their orders. This action cannot be undone."]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>c(null),className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-semibold hover:bg-gray-200 transition",children:"Cancel"}),o.jsx("button",{onClick:()=>{n(a),c(null)},className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition",children:"Delete"})]})]})}),u&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",onClick:()=>d(!1),children:o.jsxs("div",{className:"bg-green-tea rounded-2xl p-6 w-full max-w-lg mx-4 shadow-2xl border-2 border-lime-glow",onClick:E=>E.stopPropagation(),children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"text-xl font-bold text-emerald-pine",children:"Add Customer"}),o.jsx("button",{onClick:()=>d(!1),className:"text-emerald-pine/60 hover:text-emerald-pine font-bold",children:""})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{className:"col-span-2",children:[o.jsx("label",{className:"text-xs font-bold text-emerald-pine uppercase",children:"Name *"}),o.jsx("input",{className:"w-full p-3 bg-white text-black rounded-xl mt-1 border-2 border-lime-glow font-semibold text-sm",value:p.name,onChange:E=>y({...p,name:E.target.value}),placeholder:"Customer name"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-emerald-pine uppercase",children:"Phone"}),o.jsx("input",{className:"w-full p-3 bg-white text-black rounded-xl mt-1 border-2 border-lime-glow font-semibold text-sm",value:p.phone,onChange:E=>y({...p,phone:E.target.value}),placeholder:"Phone"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-emerald-pine uppercase",children:"Email"}),o.jsx("input",{className:"w-full p-3 bg-white text-black rounded-xl mt-1 border-2 border-lime-glow font-semibold text-sm",value:p.email,onChange:E=>y({...p,email:E.target.value}),placeholder:"Email"})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsx("label",{className:"text-xs font-bold text-emerald-pine uppercase",children:"Address"}),o.jsx("input",{className:"w-full p-3 bg-white text-black rounded-xl mt-1 border-2 border-lime-glow font-semibold text-sm",value:p.address,onChange:E=>y({...p,address:E.target.value}),placeholder:"Street address"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-emerald-pine uppercase",children:"City"}),o.jsx("input",{className:"w-full p-3 bg-white text-black rounded-xl mt-1 border-2 border-lime-glow font-semibold text-sm",value:p.city,onChange:E=>y({...p,city:E.target.value}),placeholder:"City"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-emerald-pine uppercase",children:"State"}),o.jsx("input",{className:"w-full p-3 bg-white text-black rounded-xl mt-1 border-2 border-lime-glow font-semibold text-sm",value:p.state,onChange:E=>y({...p,state:E.target.value}),placeholder:"State"})]})]}),o.jsxs("div",{className:"flex gap-3 mt-5",children:[o.jsx("button",{onClick:()=>{m(),d(!1)},className:"flex-1 px-4 py-3 border-2 border-lime-glow text-emerald-pine font-bold rounded-xl",children:"Cancel"}),o.jsx("button",{onClick:T,className:"flex-1 px-4 py-3 bg-emerald-pine text-lime-glow font-bold rounded-xl shadow-sm hover:shadow-md",children:"Save Customer"})]})]})})]})}function DA({inventoryItems:t=[],allOrders:e=[]}){const n=c=>{if(typeof c=="number")return c;if(!c)return 0;const u=String(c).replace(/[^0-9.-]/g,"");return parseFloat(u)||0},r=F.useMemo(()=>{var H,K;const c=new Date,u=c.getMonth(),d=c.getFullYear(),p=e.filter(V=>V.status!=="Cancelled"),y=p.reduce((V,z)=>V+(n(z.finalSellingPrice)||n(z.orderTotal)||0),0),m=p.filter(V=>{var G;const z=(G=V.orderDate)!=null&&G.toDate?V.orderDate.toDate():new Date(V.orderDate);return z.getMonth()===u&&z.getFullYear()===d}).reduce((V,z)=>V+(n(z.finalSellingPrice)||n(z.orderTotal)||0),0),T=p.length>0?y/p.length:0,w=p.filter(V=>V.type==="fabric").reduce((V,z)=>V+(n(z.finalSellingPrice)||n(z.orderTotal)||0),0),P=p.filter(V=>V.type==="outfit"||V.outfitName).reduce((V,z)=>V+(n(z.finalSellingPrice)||n(z.orderTotal)||0),0),I=p.reduce((V,z)=>{const G=n(z.fabricCost)||0,se=n(z.stitchingCost)||0,ue=n(z.shippingCost)||0,Z=z.paymentMode==="COD"&&n(z.codCharge)||0;return V+G+se+ue+Z},0),E=y-I,x=y>0?E/y*100:0,b=e.filter(V=>V.paymentMode==="COD"&&V.status==="Shipped").reduce((V,z)=>V+(n(z.finalSellingPrice)||n(z.orderTotal)||0),0),R=p.filter(V=>V.paymentMode==="Prepaid").reduce((V,z)=>V+(n(z.finalSellingPrice)||n(z.orderTotal)||0),0),L=p.filter(V=>V.paymentMode==="COD").reduce((V,z)=>V+(n(z.finalSellingPrice)||n(z.orderTotal)||0),0),M=t.reduce((V,z)=>{if(z.type==="fabric"){const G=parseFloat(z.currentLength)||0,se=n(z.costPerMeter)||0;return V+G*se}else{const G=Object.values(z.stockBreakdown||{}).reduce((ue,Z)=>ue+(parseFloat(Z)||0),0),se=n(z.costPerMeter)||0;return V+G*se}},0),N=p.reduce((V,z)=>V+(n(z.fabricCost)||0),0),f=p.reduce((V,z)=>V+(n(z.stitchingCost)||0),0),v=p.reduce((V,z)=>V+(n(z.shippingCost)||0),0),_=p.reduce((V,z)=>z.paymentMode==="COD"?V+(n(z.codCharge)||0):V,0),k=new Set(p.map(V=>{var z;return(z=V.customerName)==null?void 0:z.toLowerCase().trim()}).filter(Boolean)),j=k.size>0?y/k.size:0,C={};p.forEach(V=>{if(V.customerName){const z=V.customerName,G=n(V.finalSellingPrice)||n(V.orderTotal)||0;C[z]=(C[z]||0)+G}});const ge=Object.entries(C).sort((V,z)=>z[1]-V[1]).slice(0,10),ae={};p.forEach(V=>{const z=V.outfitName||V.productName||V.fabricName||"Unknown",G=n(V.finalSellingPrice)||n(V.orderTotal)||0;ae[z]=(ae[z]||0)+G});const Se=Object.entries(ae).sort((V,z)=>z[1]-V[1]).slice(0,10),ne=[];for(let V=5;V>=0;V--){const z=new Date(d,u-V,1),G=p.filter(se=>{var Z;const ue=(Z=se.orderDate)!=null&&Z.toDate?se.orderDate.toDate():new Date(se.orderDate);return ue.getMonth()===z.getMonth()&&ue.getFullYear()===z.getFullYear()}).reduce((se,ue)=>se+(n(ue.finalSellingPrice)||n(ue.orderTotal)||0),0);ne.push({month:z.toLocaleDateString("en-US",{month:"short"}),revenue:G})}const O=((H=ne[4])==null?void 0:H.revenue)||0,$=((K=ne[5])==null?void 0:K.revenue)||0,ee=O>0?($-O)/O*100:0,X=Object.entries(C).sort((V,z)=>z[1]-V[1]).map(([V,z])=>{const G=p.filter(se=>se.customerName===V);return{name:V,revenue:z,orderCount:G.length,avgOrderValue:G.length>0?z/G.length:0}}),J=X.reduce((V,z)=>V+z.revenue,0),A=X.map(V=>({...V,percentage:J>0?V.revenue/J*100:0}));return{totalRevenue:y,monthlyRevenue:m,avgOrderValue:T,fabricRevenue:w,outfitRevenue:P,grossProfit:E,profitMargin:x,codPending:b,prepaidRevenue:R,codRevenue:L,totalInventoryValue:M,fabricCosts:N,stitchingCosts:f,shippingCosts:v,codCharges:_,totalCosts:I,uniqueCustomers:k.size,avgCustomerValue:j,topCustomers:ge,topProducts:Se,monthlyData:ne,growthRate:ee,customerRevenueData:A}},[t,e]),s=c=>`${(c/1e3).toFixed(1)}k`,[i,a]=F.useState(!1);return o.jsxs("div",{className:"space-y-6 fade-in pb-20",children:[o.jsx("div",{className:"flex justify-between items-center mb-4",children:o.jsx("h2",{className:"text-2xl font-bold text-lime-glow",children:"Financial Insights"})}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{className:"bg-emerald-pine p-4 rounded-2xl shadow-card text-lime-glow border-2 border-lime-glow/60",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(uN,{className:"w-5 h-5 text-lime-glow"}),o.jsx("p",{className:"text-xs opacity-90",children:"Total Revenue"})]}),o.jsx("p",{className:"text-2xl font-bold",children:s(r.totalRevenue)}),o.jsx("p",{className:"text-xs opacity-80 mt-1",children:"All time"})]}),o.jsxs("div",{className:"bg-green-tea p-4 rounded-2xl shadow-card text-emerald-pine border-2 border-lime-glow",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(XE,{className:"w-5 h-5 text-emerald-pine"}),o.jsx("p",{className:"text-xs font-semibold",children:"This Month"})]}),o.jsx("p",{className:"text-2xl font-bold",children:s(r.monthlyRevenue)}),o.jsxs("div",{className:"flex items-center gap-1 mt-1 text-emerald-pine/80",children:[r.growthRate>=0?o.jsx(yg,{className:"w-3 h-3"}):o.jsx(bN,{className:"w-3 h-3"}),o.jsxs("p",{className:"text-xs",children:[Math.abs(r.growthRate).toFixed(1),"% vs last month"]})]})]}),o.jsxs("div",{className:"bg-green-tea p-4 rounded-2xl shadow-card text-emerald-pine border-2 border-lime-glow",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(yg,{className:"w-5 h-5 text-emerald-pine"}),o.jsx("p",{className:"text-xs font-semibold",children:"Gross Profit"})]}),o.jsx("p",{className:"text-2xl font-bold",children:s(r.grossProfit)}),o.jsxs("p",{className:"text-xs text-emerald-pine/80 mt-1",children:["Margin: ",r.profitMargin.toFixed(1),"%"]})]}),o.jsxs("div",{className:"bg-green-tea p-4 rounded-2xl shadow-card text-emerald-pine border-2 border-lime-glow",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(mi,{className:"w-5 h-5 text-emerald-pine"}),o.jsx("p",{className:"text-xs font-semibold",children:"Avg Order Value"})]}),o.jsx("p",{className:"text-2xl font-bold",children:s(r.avgOrderValue)}),o.jsx("p",{className:"text-xs text-emerald-pine/80 mt-1",children:"Per transaction"})]})]}),o.jsxs("div",{className:"bg-emerald-pine p-5 rounded-2xl shadow-card border-2 border-lime-glow",children:[o.jsxs("h3",{className:"font-bold text-lime-glow mb-4 flex items-center gap-2",children:[o.jsx(eN,{className:"w-5 h-5 text-lime-glow"}),"Revenue by Category"]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between mb-1 text-lime-glow",children:[o.jsx("span",{className:"text-sm",children:"Outfits"}),o.jsx("span",{className:"text-sm font-bold",children:s(r.outfitRevenue)})]}),o.jsx("div",{className:"h-2 bg-emerald-pine/40 rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-lime-glow rounded-full",style:{width:`${r.outfitRevenue/r.totalRevenue*100}%`}})})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between mb-1 text-lime-glow",children:[o.jsx("span",{className:"text-sm",children:"Fabrics"}),o.jsx("span",{className:"text-sm font-bold",children:s(r.fabricRevenue)})]}),o.jsx("div",{className:"h-2 bg-emerald-pine/40 rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-green-tea rounded-full",style:{width:`${r.fabricRevenue/r.totalRevenue*100}%`}})})]})]})]}),o.jsxs("div",{className:"bg-green-tea p-5 rounded-2xl shadow-card border-2 border-lime-glow",children:[o.jsx("h3",{className:"font-bold text-emerald-pine mb-4",children:"Revenue Trend (Last 6 Months)"}),o.jsx("div",{className:"flex items-end justify-between gap-2 h-32",children:r.monthlyData.map((c,u)=>{const d=Math.max(...r.monthlyData.map(y=>y.revenue)),p=d>0?c.revenue/d*100:0;return o.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[o.jsxs("span",{className:"text-xs font-bold text-emerald-pine",children:[s(c.revenue/1e3),"k"]}),o.jsx("div",{className:"w-full bg-emerald-pine/30 rounded-t-lg",style:{height:`${p}%`,minHeight:"4px"},children:o.jsx("div",{className:"h-full w-full bg-lime-glow"})}),o.jsx("span",{className:"text-xs text-emerald-pine/70",children:c.month})]},u)})})]}),o.jsxs("div",{className:"bg-green-tea p-5 rounded-2xl shadow-card border-2 border-lime-glow",children:[o.jsx("h3",{className:"font-bold text-emerald-pine mb-4",children:"Expense Breakdown"}),o.jsxs("div",{className:"space-y-3 text-emerald-pine",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-emerald-pine/80",children:"Fabric Costs"}),o.jsx("span",{className:"text-sm font-bold",children:s(r.fabricCosts)})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-emerald-pine/80",children:"Stitching Costs"}),o.jsx("span",{className:"text-sm font-bold",children:s(r.stitchingCosts)})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-emerald-pine/80",children:"Shipping Costs"}),o.jsx("span",{className:"text-sm font-bold",children:s(r.shippingCosts)})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-emerald-pine/80",children:"COD Charges"}),o.jsx("span",{className:"text-sm font-bold",children:s(r.codCharges)})]}),o.jsxs("div",{className:"border-t border-emerald-pine/30 pt-2 flex justify-between items-center",children:[o.jsx("span",{className:"text-sm font-bold",children:"Total Expenses"}),o.jsx("span",{className:"text-sm font-bold text-emerald-pine",children:s(r.totalCosts)})]})]})]}),o.jsxs("div",{className:"bg-green-tea p-5 rounded-2xl shadow-card border-2 border-lime-glow",children:[o.jsx("h3",{className:"font-bold text-emerald-pine mb-4",children:"Cash Flow Overview"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between items-center p-3 bg-emerald-pine/10 border border-lime-glow rounded-xl text-emerald-pine",children:[o.jsx("span",{className:"text-sm",children:"Prepaid Revenue"}),o.jsx("span",{className:"text-sm font-bold",children:s(r.prepaidRevenue)})]}),o.jsxs("div",{className:"flex justify-between items-center p-3 bg-emerald-pine/10 border border-lime-glow rounded-xl text-emerald-pine",children:[o.jsx("span",{className:"text-sm",children:"COD Revenue"}),o.jsx("span",{className:"text-sm font-bold",children:s(r.codRevenue)})]}),o.jsxs("div",{className:"flex justify-between items-center p-3 bg-emerald-pine/10 border border-lime-glow rounded-xl text-emerald-pine",children:[o.jsx("span",{className:"text-sm",children:"Pending COD Collections"}),o.jsx("span",{className:"text-sm font-bold",children:s(r.codPending)})]})]})]}),o.jsxs("div",{className:"bg-gradient-to-br from-emerald-pine to-lime-glow p-5 rounded-2xl shadow-card text-emerald-pine",children:[o.jsxs("h3",{className:"font-bold mb-2 flex items-center gap-2 text-emerald-pine",children:[o.jsx(mi,{className:"w-5 h-5"}),"Total Inventory Value"]}),o.jsx("p",{className:"text-3xl font-bold text-emerald-pine",children:s(r.totalInventoryValue)}),o.jsx("p",{className:"text-xs text-emerald-pine/80 mt-1",children:"Current stock valuation"})]}),o.jsxs("div",{className:"bg-green-tea p-5 rounded-2xl shadow-card border-2 border-lime-glow",children:[o.jsxs("h3",{className:"font-bold text-emerald-pine mb-4 flex items-center gap-2",children:[o.jsx(gx,{className:"w-5 h-5 text-emerald-pine"}),"Customer Insights"]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-emerald-pine",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-emerald-pine/70 mb-1",children:"Total Customers"}),o.jsx("p",{className:"text-2xl font-bold",children:r.totalCustomers})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-emerald-pine/70 mb-1",children:"Avg Customer Value"}),o.jsx("p",{className:"text-2xl font-bold",children:s(r.avgCustomerValue)})]})]})]}),o.jsxs("div",{className:"bg-green-tea p-5 rounded-2xl shadow-card border-2 border-lime-glow",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("h3",{className:"font-bold text-emerald-pine flex items-center gap-2",children:[o.jsx(lN,{className:"w-5 h-5 text-lime-glow"}),"Customer Revenue Breakdown"]}),r.customerRevenueData.length>10&&o.jsx("button",{onClick:()=>a(!i),className:"text-xs text-emerald-pine underline-offset-2 hover:underline",children:i?"Show Top 10":`Show All ${r.customerRevenueData.length}`})]}),o.jsx("div",{className:"space-y-2",children:(i?r.customerRevenueData:r.customerRevenueData.slice(0,10)).map((c,u)=>o.jsxs("div",{className:"p-3 hover:bg-emerald-pine/5 rounded-lg transition-colors",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[o.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold ${u===0?"bg-lime-glow text-emerald-pine":u===1?"bg-emerald-pine/20 text-emerald-pine":u===2?"bg-green-tea text-emerald-pine":"bg-emerald-pine/10 text-emerald-pine"}`,children:u+1}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm font-bold text-emerald-pine truncate",children:c.name}),o.jsxs("p",{className:"text-xs text-emerald-pine/70",children:[c.orders," orders  Avg: ",(c.avgOrderValue/1e3).toFixed(1),"k"]})]})]}),o.jsxs("div",{className:"text-right ml-3",children:[o.jsx("p",{className:"text-sm font-bold text-emerald-pine",children:s(c.revenue)}),o.jsxs("p",{className:"text-xs text-emerald-pine/70",children:[(c.revenue/r.totalRevenue*100).toFixed(1),"%"]})]})]}),o.jsx("div",{className:"h-1.5 bg-emerald-pine/10 rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-pine to-lime-glow rounded-full transition-all",style:{width:`${c.percentage}%`}})})]},u))})]}),o.jsxs("div",{className:"bg-green-tea p-5 rounded-2xl shadow-card border-2 border-lime-glow",children:[o.jsx("h3",{className:"font-bold text-emerald-pine mb-4",children:"Top 10 Products by Revenue"}),o.jsx("div",{className:"space-y-2",children:r.topProducts.map(([c,u],d)=>o.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-emerald-pine/5 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-6 h-6 rounded-full bg-lime-glow text-emerald-pine text-xs font-bold flex items-center justify-center border border-emerald-pine/30",children:d+1}),o.jsx("span",{className:"text-sm text-emerald-pine truncate",children:c})]}),o.jsx("span",{className:"text-sm font-bold text-emerald-pine",children:s(u)})]},d))})]})]})}function OA({visible:t,onClose:e,inventoryItems:n=[],onDataChanged:r}){const[s,i]=F.useState({fabricId:"",outfitId:"",fabricPerPiece:"",fabricUsed:"",estimatedPieces:0,sizeS:"",sizeM:"",sizeL:"",sizeXL:"",sizeXXL:"",stitchingCostTotal:"",tailorName:"",notes:"",status:"In Progress",sentDate:new Date().toISOString().split("T")[0],receivedDate:""}),[a,c]=F.useState(!1),u=F.useMemo(()=>n.filter(x=>x.type==="fabric"&&parseFloat(x.currentLength)>0),[n]),d=F.useMemo(()=>n.filter(x=>x.type==="outfit"),[n]),p=u.find(x=>x.id===s.fabricId),y=d.find(x=>x.id===s.outfitId),m=F.useMemo(()=>{if(!s.fabricUsed||!s.fabricPerPiece)return 0;const x=parseFloat(s.fabricUsed)||0,b=parseFloat(s.fabricPerPiece)||0;return b===0?0:Math.floor(x/b)},[s.fabricUsed,s.fabricPerPiece]);ms.useEffect(()=>{if(m>0&&!s.sizeS&&!s.sizeM&&!s.sizeL){const x=Math.floor(m*.3),b=Math.floor(m*.4),R=m-x-b;i(L=>({...L,estimatedPieces:m,sizeS:x.toString(),sizeM:b.toString(),sizeL:R.toString(),sizeXL:"0",sizeXXL:"0"}))}},[m]);const T=[s.sizeS,s.sizeM,s.sizeL,s.sizeXL,s.sizeXXL].reduce((x,b)=>x+(parseInt(b)||0),0),w=F.useMemo(()=>{if(!p||!s.fabricUsed||T===0)return 0;const x=parseFloat(s.fabricUsed)||0,b=parseFloat(p.costPerMeter)||0;return x*b/T},[p,s.fabricUsed,T]),P=F.useMemo(()=>T===0?0:(parseFloat(s.stitchingCostTotal)||0)/T,[s.stitchingCostTotal,T]),I=w+P,E=async x=>{if(x.preventDefault(),!s.fabricId||!s.outfitId||!s.fabricUsed||!s.fabricPerPiece){alert("Please fill all required fields");return}if(T===0){alert("Please enter at least one piece in size breakdown");return}const b=parseFloat(s.fabricUsed);if(b>parseFloat(p.currentLength)){alert("Not enough fabric available!");return}c(!0);try{const R=Ue(),L=parseFloat(s.fabricPerPiece)||0,M=T>0?b/T:0,N=M-L,f=L>0?N/L*100:0;if(await Gt(Qe(R,"production_batches"),{fabricId:s.fabricId,fabricName:p.name,fabricUsed:b,fabricCostPerMeter:parseFloat(p.costPerMeter)||0,outfitId:s.outfitId,outfitName:y.name,outfitImageUrl:y.imageUrl||"",fabricPerPiece:L,estimatedPieces:m,actualFabricPerPiece:M,variance:N,variancePercent:f,sizeBreakdown:{S:parseInt(s.sizeS)||0,M:parseInt(s.sizeM)||0,L:parseInt(s.sizeL)||0,XL:parseInt(s.sizeXL)||0,XXL:parseInt(s.sizeXXL)||0},totalPieces:T,stitchingCostTotal:parseFloat(s.stitchingCostTotal)||0,stitchingCostPerPiece:P,fabricCostPerPiece:w,totalCostPerPiece:I,tailorName:s.tailorName||"Unknown",notes:s.notes||"",sentDate:new Date(s.sentDate),receivedDate:s.receivedDate?new Date(s.receivedDate):null,status:s.receivedDate?"Completed":"In Progress",createdAt:ke()}),await Ye(Re(R,"fabrics",s.fabricId),{currentLength:Ri(-b)}),s.receivedDate){const _=y.stockBreakdown||{};await Ye(Re(R,"fabrics",s.outfitId),{stockBreakdown:{S:(parseInt(_.S)||0)+(parseInt(s.sizeS)||0),M:(parseInt(_.M)||0)+(parseInt(s.sizeM)||0),L:(parseInt(_.L)||0)+(parseInt(s.sizeL)||0),XL:(parseInt(_.XL)||0)+(parseInt(s.sizeXL)||0),XXL:(parseInt(_.XXL)||0)+(parseInt(s.sizeXXL)||0)},productionCostPerPiece:I})}const v=s.receivedDate?` Production batch completed!
${T} pieces added to inventory
${b}m deducted from fabric`:` Production batch created!
Estimated: ${m} pieces
Actual: ${T} pieces (update when received)
${b}m deducted from fabric`;alert(v),r&&await r(),e(),i({fabricId:"",outfitId:"",fabricPerPiece:"",fabricUsed:"",estimatedPieces:0,sizeS:"",sizeM:"",sizeL:"",sizeXL:"",sizeXXL:"",stitchingCostTotal:"",tailorName:"",notes:"",status:"In Progress",sentDate:new Date().toISOString().split("T")[0],receivedDate:""})}catch(R){console.error("Production batch error:",R),alert("Error creating production batch: "+R.message)}finally{c(!1)}};return t?o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-end sm:items-center justify-center p-0 sm:p-4",children:o.jsxs("div",{className:"bg-white dark:bg-gray-950 w-full sm:max-w-2xl rounded-t-3xl sm:rounded-2xl shadow-2xl max-h-[90vh] overflow-y-auto border dark:border-gray-800",children:[o.jsxs("div",{className:"sticky top-0 bg-white dark:bg-gray-950 border-b border-gray-200 dark:border-gray-800 px-6 py-4 flex justify-between items-center",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Production Batch"}),o.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full",children:o.jsx(Wr,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:E,className:"p-6 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Select Fabric *"}),o.jsxs("select",{value:s.fabricId,onChange:x=>i({...s,fabricId:x.target.value}),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-xl",required:!0,children:[o.jsx("option",{value:"",children:"Choose fabric..."}),u.map(x=>o.jsxs("option",{value:x.id,children:[x.name," - ",parseFloat(x.currentLength).toFixed(1),"m @ ",x.costPerMeter,"/m"]},x.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Outfit Design *"}),o.jsxs("select",{value:s.outfitId,onChange:x=>i({...s,outfitId:x.target.value}),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-xl",required:!0,children:[o.jsx("option",{value:"",children:"Choose outfit design..."}),d.map(x=>o.jsx("option",{value:x.id,children:x.name},x.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Fabric Per Piece (meters) *"}),o.jsx("input",{type:"number",step:"0.01",value:s.fabricPerPiece,onChange:x=>i({...s,fabricPerPiece:x.target.value}),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-xl",placeholder:"e.g., 1.5",required:!0}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"How many meters needed per outfit?"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Fabric Sent to Tailor (meters) *"}),o.jsx("input",{type:"number",step:"0.1",value:s.fabricUsed,onChange:x=>i({...s,fabricUsed:x.target.value}),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-xl",placeholder:"e.g., 50",required:!0})]}),m>0&&o.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-200",children:[o.jsx("h4",{className:"font-bold text-blue-900 mb-2",children:" Estimated Production"}),o.jsxs("p",{className:"text-sm text-blue-800",children:[s.fabricUsed,"m  ",s.fabricPerPiece,"m/piece = ",o.jsxs("span",{className:"font-bold text-lg",children:["~",m," pieces"]})]}),o.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Sizes auto-distributed below (you can adjust)"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:["Actual Size Breakdown *",m>0&&T!==m&&o.jsxs("span",{className:"ml-2 text-xs font-normal text-orange-600",children:["(Estimated: ",m,", Actual: ",T,")"]})]}),o.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"S"}),o.jsx("input",{type:"number",min:"0",value:s.sizeS,onChange:x=>i({...s,sizeS:x.target.value}),className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg text-center dark:bg-gray-900 dark:text-white",placeholder:"0"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"M"}),o.jsx("input",{type:"number",min:"0",value:s.sizeM,onChange:x=>i({...s,sizeM:x.target.value}),className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg text-center dark:bg-gray-900 dark:text-white",placeholder:"0"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"L"}),o.jsx("input",{type:"number",min:"0",value:s.sizeL,onChange:x=>i({...s,sizeL:x.target.value}),className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg text-center dark:bg-gray-900 dark:text-white",placeholder:"0"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"XL"}),o.jsx("input",{type:"number",min:"0",value:s.sizeXL,onChange:x=>i({...s,sizeXL:x.target.value}),className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg text-center dark:bg-gray-900 dark:text-white",placeholder:"0"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"XXL"}),o.jsx("input",{type:"number",min:"0",value:s.sizeXXL,onChange:x=>i({...s,sizeXXL:x.target.value}),className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg text-center dark:bg-gray-900 dark:text-white",placeholder:"0"})]})]}),o.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:["Total Pieces: ",o.jsx("span",{className:"font-bold",children:T})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Total Stitching Cost *"}),o.jsx("input",{type:"number",step:"0.01",value:s.stitchingCostTotal,onChange:x=>i({...s,stitchingCostTotal:x.target.value}),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-xl",placeholder:"e.g., 5400",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Tailor Name"}),o.jsx("input",{type:"text",value:s.tailorName,onChange:x=>i({...s,tailorName:x.target.value}),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-xl",placeholder:"e.g., Ramesh Tailors"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Sent Date"}),o.jsx("input",{type:"date",value:s.sentDate,onChange:x=>i({...s,sentDate:x.target.value}),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-xl"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Received Date (Optional)"}),o.jsx("input",{type:"date",value:s.receivedDate,onChange:x=>i({...s,receivedDate:x.target.value}),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-xl"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Leave empty if not yet received"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Notes"}),o.jsx("textarea",{value:s.notes,onChange:x=>i({...s,notes:x.target.value}),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-xl",rows:"3",placeholder:"Any additional notes..."})]}),T>0&&o.jsxs("div",{className:"bg-green-50 p-4 rounded-xl border border-green-200",children:[o.jsx("h4",{className:"font-bold text-green-900 mb-2",children:"Cost Breakdown (Per Piece)"}),o.jsxs("div",{className:"space-y-1 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-green-700",children:"Fabric Cost:"}),o.jsxs("span",{className:"font-bold text-green-900",children:["",w.toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-green-700",children:"Stitching Cost:"}),o.jsxs("span",{className:"font-bold text-green-900",children:["",P.toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between border-t border-green-300 pt-1",children:[o.jsx("span",{className:"text-green-800 font-bold",children:"Total Cost/Piece:"}),o.jsxs("span",{className:"font-bold text-green-900",children:["",I.toFixed(2)]})]})]}),m>0&&T!==m&&o.jsxs("div",{className:"mt-3 pt-3 border-t border-green-300",children:[o.jsxs("p",{className:"text-xs text-green-800",children:[o.jsx("span",{className:"font-bold",children:"Variance:"})," ",T>m?"+":"",T-m," pieces (",((T-m)/m*100).toFixed(1),"%)"]}),o.jsx("p",{className:"text-xs text-green-600 mt-1",children:"This data will improve future predictions"})]})]}),o.jsx("button",{type:"submit",disabled:a,className:"w-full bg-brand hover:bg-brand-dark text-white font-bold py-4 rounded-xl disabled:opacity-50",children:a?"Creating...":s.receivedDate?"Complete Production Batch":"Create Production Batch (In Progress)"})]})]})}):null}function LA({visible:t,batch:e,onClose:n,onDataChanged:r,inventoryItems:s=[]}){const[i,a]=F.useState({S:"",M:"",L:"",XL:"",XXL:""}),[c,u]=F.useState("In Progress"),[d,p]=F.useState(!1),[y,m]=F.useState("");if(F.useEffect(()=>{e&&e.sizeBreakdown&&(u(e.status||"In Progress"),e.status!=="Completed"?a({S:(e.sizeBreakdown.S||0).toString(),M:(e.sizeBreakdown.M||0).toString(),L:(e.sizeBreakdown.L||0).toString(),XL:(e.sizeBreakdown.XL||0).toString(),XXL:(e.sizeBreakdown.XXL||0).toString()}):e.receivedBreakdown&&a({S:(e.receivedBreakdown.S||0).toString(),M:(e.receivedBreakdown.M||0).toString(),L:(e.receivedBreakdown.L||0).toString(),XL:(e.receivedBreakdown.XL||0).toString(),XXL:(e.receivedBreakdown.XXL||0).toString()}))},[e]),!t||!e)return null;const T=Object.values(i).reduce((E,x)=>E+(parseInt(x)||0),0),w=e.totalPieces||0,P=async()=>{if(T===0){m("Please enter at least one piece received");return}if(c==="Completed"&&T!==w){m(`Total received (${T}) must match estimated (${w}) pieces when marking as Received`);return}p(!0),m("");try{const E=Ue(),x={S:parseInt(i.S)||0,M:parseInt(i.M)||0,L:parseInt(i.L)||0,XL:parseInt(i.XL)||0,XXL:parseInt(i.XXL)||0};await Ye(Re(E,"production_batches",e.id),{status:c,receivedBreakdown:x,totalReceivedPieces:T,receivedDate:c==="Completed"?ke():e.receivedDate,updatedAt:ke()});const b=s.find(L=>L.id===e.outfitId);if(b&&c==="Completed"){const L=Re(E,"fabrics",e.outfitId),M=b.stockBreakdown||{},N={S:(parseInt(M.S)||0)+x.S,M:(parseInt(M.M)||0)+x.M,L:(parseInt(M.L)||0)+x.L,XL:(parseInt(M.XL)||0)+x.XL,XXL:(parseInt(M.XXL)||0)+x.XXL};await Ye(L,{stockBreakdown:N,productionCostPerPiece:e.totalCostPerPiece||0,updatedAt:ke()})}const R=c==="Completed"?` Production batch received!
${T} pieces added to ${e.outfitName} inventory`:` Production batch updated!
Status: ${c}
${T} pieces tracked`;alert(R),r&&await r(),n()}catch(E){console.error("Error receiving production batch:",E),m("Failed to receive batch: "+E.message)}finally{p(!1)}},I=e.status==="Completed";return o.jsx("div",{className:"fixed inset-0 bg-black/70 z-[60] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:o.jsxs("div",{className:"bg-gray-950 w-full sm:max-w-lg sm:rounded-3xl rounded-t-3xl shadow-2xl h-[85vh] sm:h-auto flex flex-col border-2 border-lime-glow/40",children:[o.jsxs("div",{className:"p-6 border-b border-lime-glow/40 bg-emerald-pine flex items-center justify-between flex-shrink-0",children:[o.jsx("h3",{className:"text-xl font-bold text-white",children:"Update Production Batch"}),o.jsx("button",{onClick:n,className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white",children:o.jsx("span",{className:"text-2xl",children:""})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[y&&o.jsx("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-500/50 text-red-200 text-sm rounded-xl",children:y}),o.jsxs("div",{className:"bg-emerald-pine/20 p-4 rounded-xl border border-lime-glow/30 mb-6",children:[o.jsxs("div",{className:"flex gap-3 mb-3",children:[e.outfitImageUrl&&o.jsx("div",{className:"w-16 h-16 bg-gray-800 rounded-xl overflow-hidden flex-shrink-0",children:o.jsx("img",{src:e.outfitImageUrl,className:"w-full h-full object-cover",alt:e.outfitName})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-bold text-white text-base",children:e.outfitName}),o.jsx("p",{className:"text-sm text-lime-glow",children:e.fabricName}),o.jsxs("p",{className:"text-xs text-white/70 mt-1",children:[e.fabricUsed,"m fabric used"]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-white/70 text-xs",children:"Estimated"}),o.jsxs("p",{className:"text-lime-glow font-bold",children:[w," pieces"]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-white/70 text-xs",children:"Cost/Piece"}),o.jsxs("p",{className:"text-lime-glow font-bold",children:["",(e.totalCostPerPiece||0).toFixed(2)]})]})]})]}),o.jsxs("div",{className:"bg-gray-900/80 p-4 rounded-xl border border-emerald-pine/60 mb-4",children:[o.jsx("h4",{className:"text-xs font-bold text-lime-glow uppercase mb-3",children:"Production Status"}),o.jsxs("select",{value:c,onChange:E=>u(E.target.value),disabled:d,className:"w-full p-3 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:[o.jsx("option",{value:"In Progress",children:"In Production"}),o.jsx("option",{value:"Completed",children:"Received"})]}),c==="Completed"&&o.jsx("p",{className:"text-xs text-lime-glow/80 mt-2",children:" Stock will be added to inventory"}),c==="In Progress"&&o.jsx("p",{className:"text-xs text-white/60 mt-2",children:"Stock will NOT be added to inventory yet"})]}),o.jsxs("div",{className:"bg-gray-900/80 p-4 rounded-xl border border-emerald-pine/60",children:[o.jsx("h4",{className:"text-xs font-bold text-lime-glow uppercase mb-3",children:I?"Update Received Quantities":"Enter Received Quantities"}),o.jsx("div",{className:"space-y-3",children:["S","M","L","XL","XXL"].map(E=>{var x;return o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsxs("label",{className:"text-white font-semibold text-sm w-12",children:["Size ",E]}),o.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[o.jsxs("span",{className:"text-xs text-white/60",children:["Est: ",((x=e.sizeBreakdown)==null?void 0:x[E])||0]}),o.jsx("input",{type:"number",min:"0",disabled:d,className:"flex-1 p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"0",value:i[E],onChange:b=>a({...i,[E]:b.target.value})})]})]},E)})}),o.jsxs("div",{className:"mt-4 pt-4 border-t border-lime-glow/30 flex justify-between items-center",children:[o.jsx("span",{className:"text-white font-bold",children:"Total Received:"}),o.jsxs("span",{className:`text-xl font-bold ${T===w?"text-lime-glow":"text-red-400"}`,children:[T," pieces"]})]}),T!==w&&c==="Completed"&&o.jsxs("div",{className:"mt-2 p-2 bg-red-900/30 border border-red-500/50 rounded-lg text-red-200 text-xs",children:[" Total must match estimated (",w," pieces) to mark as Received"]}),T!==w&&c!=="Completed"&&o.jsxs("div",{className:"mt-2 p-2 bg-amber-900/30 border border-amber-500/50 rounded-lg text-amber-200 text-xs",children:[" Total differs from estimated (",w," pieces)"]})]}),e.tailorName&&o.jsx("div",{className:"mt-4 text-sm text-white/80",children:o.jsxs("p",{children:[" Tailor: ",o.jsx("span",{className:"text-lime-glow",children:e.tailorName})]})})]}),o.jsx("div",{className:"p-6 pt-4 border-t border-lime-glow/40 flex gap-3 flex-shrink-0 bg-gray-950",children:o.jsx("button",{onClick:P,disabled:d||c==="Completed"&&T!==w,className:"flex-1 bg-lime-glow text-emerald-pine py-3 rounded-xl font-bold shadow-lg hover:bg-lime-glow/90 active:scale-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Saving...":"Update Batch"})})]})})}const q_=F.createContext(),MA={Adwait:{name:"Adwait",role:"admin"},Avani:{name:"Avani",role:"admin"},Binay:{name:"Binay",role:"staff"}};function VA(){return F.useContext(q_)}function FA({children:t}){const[e,n]=F.useState(()=>{const u=localStorage.getItem("poshakh-user");return u?JSON.parse(u):null}),[r,s]=F.useState(!1),c={userProfile:e,loading:r,login:async u=>{const d=u.trim(),p=MA[d];return p?(n(p),localStorage.setItem("poshakh-user",JSON.stringify(p)),{ok:!0}):{ok:!1,message:"User not found. Please use: Adwait, Avani, or Binay"}},logout:async()=>{n(null),localStorage.removeItem("poshakh-user")}};return o.jsx(q_.Provider,{value:c,children:t})}function UA({item:t,onClose:e,onOpenEdit:n,onOpenStock:r,onViewHistory:s,onDelete:i}){return t?o.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 w-full sm:max-w-md rounded-t-3xl sm:rounded-3xl h-[85vh] sm:h-auto overflow-hidden flex flex-col shadow-2xl border dark:border-gray-800 border dark:border-gray-800",children:[o.jsxs("div",{className:"p-6 border-b border-gray-100 dark:border-gray-800 flex justify-between items-center bg-gray-50 dark:bg-gray-900 flex-shrink-0",children:[o.jsx("h3",{className:"font-bold text-lg text-gray-900",children:"Item Details"}),o.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-100 text-gray-400 dark:text-gray-500 hover:text-gray-600",children:o.jsx("span",{className:"text-2xl",children:""})})]}),o.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[o.jsx("div",{className:"relative h-48 rounded-2xl overflow-hidden mb-6 bg-gray-100",children:t.imageUrl&&o.jsx("img",{src:t.imageUrl,className:"w-full h-full object-cover",alt:t.name})}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[o.jsx("button",{onClick:()=>{e(),n&&n(t)},className:"py-3 px-4 bg-white border-2 border-gray-200 dark:border-gray-700 rounded-xl font-semibold text-sm hover:border-brand dark:hover:border-green-500 active:bg-gray-50 dark:bg-gray-900 dark:active:bg-gray-700 transition text-gray-900 dark:text-white dark:text-white",children:"Edit"}),o.jsx("button",{onClick:()=>{e(),r&&r(t,"ADD")},className:"py-3 px-4 bg-white border-2 border-gray-200 dark:border-gray-700 rounded-xl font-semibold text-sm hover:border-brand dark:hover:border-green-500 active:bg-gray-50 dark:bg-gray-900 dark:active:bg-gray-700 transition text-gray-900 dark:text-white dark:text-white",children:"Adjust Stock"})]}),o.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 p-3 rounded-xl",children:t.type==="fabric"?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{children:"Cost / m"}),o.jsxs("span",{children:["",t.costPerMeter||0]})]}),o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{children:"Total Length"}),o.jsxs("span",{children:[t.currentLength||0," ",t.unit||"m"]})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{children:"Selling"}),o.jsxs("span",{children:["",t.sellingPrice||0]})]}),o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{children:"Stitching"}),o.jsxs("span",{children:["",t.stitchingCost||0]})]})]})}),t.type==="outfit"&&t.stockBreakdown&&o.jsxs("div",{className:"mt-4",children:[o.jsx("h4",{className:"font-semibold text-sm mb-2 text-gray-900 dark:text-white",children:"Stock by Size"}),o.jsx("div",{className:"grid grid-cols-5 gap-2",children:["XS","S","M","L","XL","XXL"].map(a=>o.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-2 text-center",children:[o.jsx("p",{className:"text-xs font-bold text-gray-600 dark:text-gray-400",children:a}),o.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:t.stockBreakdown[a]||0})]},a))})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("button",{onClick:()=>{s&&s(t)},className:"w-full py-3 bg-white border rounded-xl",children:"View Transaction History"}),o.jsx("button",{onClick:()=>{i&&i(t)},className:"w-full py-3 mt-2 text-red-600",children:"Delete Item"})]})]})]})}):null}function zA({order:t,onClose:e,onEdit:n,onShip:r}){return t?o.jsx("div",{className:"fixed inset-0 bg-black/70 z-[60] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:o.jsxs("div",{className:"bg-black w-full sm:max-w-md rounded-t-3xl sm:rounded-3xl h-[85vh] sm:h-auto overflow-hidden flex flex-col shadow-2xl border-2 border-lime-glow/40",children:[o.jsxs("div",{className:"bg-emerald-pine p-6 border-b border-lime-glow/40 flex justify-between items-center flex-shrink-0",children:[o.jsxs("h3",{className:"font-bold text-lg text-white",children:["Order #",t.orderNumber]}),o.jsx("button",{onClick:e,className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white",children:o.jsx("span",{className:"text-2xl",children:""})})]}),o.jsxs("div",{className:"p-6 overflow-y-auto flex-1 bg-gray-950",children:[o.jsxs("div",{className:"flex gap-4 mb-6",children:[o.jsx("div",{className:"w-20 h-20 rounded-xl overflow-hidden bg-gray-800 flex-shrink-0",children:t.imageUrl&&o.jsx("img",{src:t.imageUrl,className:"w-full h-full object-cover",alt:t.outfitName})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-bold text-base text-white",children:t.customerName}),o.jsx("p",{className:"text-sm text-lime-glow",children:t.outfitName}),o.jsxs("p",{className:"text-xs text-white/70 mt-1",children:["Size: ",t.size||"M"]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[o.jsx("button",{onClick:()=>{n&&n(t)},className:"py-3 px-4 bg-lime-glow text-emerald-pine rounded-xl font-semibold text-sm hover:bg-lime-glow/90 active:scale-95 transition",children:"Edit Order"}),o.jsx("button",{onClick:()=>{r&&r(t)},className:"py-3 px-4 bg-transparent border-2 border-lime-glow text-lime-glow rounded-xl font-semibold text-sm hover:bg-lime-glow/10 active:scale-95 transition",children:"Ship / Complete"})]}),o.jsxs("div",{className:"bg-emerald-pine/40 border border-lime-glow/30 p-4 rounded-xl space-y-2",children:[o.jsx("div",{className:"flex justify-between text-sm",children:o.jsxs("span",{className:"text-lime-glow font-semibold",children:["",t.finalSellingPrice||t.orderTotal||0]})}),o.jsx("div",{className:"flex justify-between text-sm",children:o.jsx("span",{className:"text-white font-semibold",children:t.status})})]})]})]})}):null}function BA({customer:t,onClose:e,allOrders:n=[],inventoryItems:r=[],onDataChanged:s}){const[i,a]=F.useState(!1),[c,u]=F.useState({name:(t==null?void 0:t.name)||"",phone:(t==null?void 0:t.phone)||"",address:(t==null?void 0:t.address)||"",email:(t==null?void 0:t.email)||"",city:(t==null?void 0:t.city)||"",state:(t==null?void 0:t.state)||""}),[d,p]=F.useState(!1),y=F.useMemo(()=>r.filter(b=>b.type==="outfit"),[r]),m=F.useMemo(()=>{if(!t)return[];const b=t.name.toLowerCase().trim();return n.filter(R=>R.customerName&&R.customerName.toLowerCase().trim()===b).map(R=>{const L=R.outfitName||R.productName||"",M=y.some(N=>N.name.toLowerCase()===L.toLowerCase());return{...R,matchesInventory:M,outfitName:L}}).sort((R,L)=>{var f,v;const M=(f=R.createdAt)!=null&&f.toMillis?R.createdAt.toMillis():0;return((v=L.createdAt)!=null&&v.toMillis?L.createdAt.toMillis():0)-M})},[t,n,y]),T=m.filter(b=>!b.matchesInventory&&b.outfitName),w=F.useMemo(()=>{const b=f=>{var v,_,k;if((v=f.importedData)!=null&&v["Order Total"]){const j=String(f.importedData["Order Total"]).replace(/[^0-9.-]/g,""),C=parseFloat(j);if(!isNaN(C)&&C>0)return C}if(f.orderTotal)return parseFloat(f.orderTotal);if(f.finalSellingPrice)return parseFloat(f.finalSellingPrice);if((_=f.importedData)!=null&&_["Product Price"]){const j=String(f.importedData["Product Price"]).replace(/[^0-9.-]/g,"");return parseFloat(j)||0}if((k=f.importedData)!=null&&k.Total){const j=String(f.importedData.Total).replace(/[^0-9.-]/g,"");return parseFloat(j)||0}return 0},R=m.reduce((f,v)=>f+b(v),0),L=m.length,M=L>0?R/L:0,N=m.filter(f=>f.status==="Order Shipped (Completed)").length;return{totalSpent:R,totalOrders:L,avgOrderValue:M,completedOrders:N}},[m]),P=F.useMemo(()=>{const b=N=>{var f,v,_;if((f=N.importedData)!=null&&f["Order Total"]){const k=String(N.importedData["Order Total"]).replace(/[^0-9.-]/g,""),j=parseFloat(k);if(!isNaN(j)&&j>0)return j}if(N.orderTotal)return parseFloat(N.orderTotal);if(N.finalSellingPrice)return parseFloat(N.finalSellingPrice);if((v=N.importedData)!=null&&v["Product Price"]){const k=String(N.importedData["Product Price"]).replace(/[^0-9.-]/g,"");return parseFloat(k)||0}if((_=N.importedData)!=null&&_.Total){const k=String(N.importedData.Total).replace(/[^0-9.-]/g,"");return parseFloat(k)||0}return 0},R=N=>(parseFloat(N.stitchingCost)||0)+(parseFloat(N.fabricCost)||0)+(parseFloat(N.deliveryCost)||0)+(parseFloat(N.acquisitionCost)||0),L={};m.forEach(N=>{const f=N.outfitName||"Unknown",v=b(N),_=R(N),k=v-_;L[f]||(L[f]={orders:[],totalProfit:0,totalSelling:0}),L[f].orders.push(N),L[f].totalProfit+=k,L[f].totalSelling+=v});const M={};return Object.entries(L).forEach(([N,f])=>{const v=f.totalSelling>0?f.totalProfit/f.totalSelling*100:0;M[N]={count:f.orders.length,avgProfitPercent:v,totalProfit:f.totalProfit}}),M},[m]),I=async()=>{if(!c.name.trim()){alert("Customer name is required");return}p(!0);try{const b=Ue(),R=m.map(L=>Ye(Re(b,"production_orders",L.id),{customerName:c.name,phone:c.phone||L.phone,address:c.address||L.address,email:c.email||L.email,city:c.city||L.city,state:c.state||L.state}));await Promise.all(R),alert("Customer information updated!"),a(!1)}catch(b){console.error("Error updating customer:",b),alert("Error updating customer: "+b.message)}finally{p(!1)}},E=async(b,R,L)=>{if(!R)return;const M=r.find(N=>N.type==="outfit"&&N.name.toLowerCase()===R.toLowerCase());try{const N=Ue(),f={outfitName:R,imageUrl:(M==null?void 0:M.imageUrl)||""};L&&(f.size=L),await Ye(Re(N,"production_orders",b),f),alert(`Order updated!
Outfit: ${R}${L?`
Size: ${L}`:""}

Note: Original order total has been preserved.`)}catch(N){console.error("Error updating order:",N),alert("Error: "+N.message)}},x=async(b,R)=>{if(window.confirm(`Are you sure you want to delete order #${R}?

This action cannot be undone.`))try{const M=Ue();await Ls(Re(M,"production_orders",b)),alert(`Order #${R} has been deleted successfully`)}catch(M){console.error("Error deleting order:",M),alert("Error deleting order: "+M.message)}};return t?o.jsx("div",{className:"fixed inset-0 bg-black/70 z-[60] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:o.jsxs("div",{className:"w-full sm:max-w-2xl rounded-t-3xl sm:rounded-3xl max-h-[90vh] overflow-hidden flex flex-col shadow-2xl border border-lime-glow/30 bg-black",children:[o.jsxs("div",{className:"bg-emerald-pine p-6 border-b border-lime-glow/40 flex justify-between items-center flex-shrink-0 text-white",children:[o.jsx("h3",{className:"font-bold text-lg",children:i?"Edit Customer":t.name}),o.jsxs("div",{className:"flex items-center gap-2",children:[!i&&o.jsx("button",{onClick:()=>a(!0),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white",children:o.jsx(dx,{className:"w-5 h-5"})}),o.jsx("button",{onClick:e,className:"p-2 rounded-full bg-white/5 hover:bg-white/15 text-white/80",children:o.jsx(Wr,{className:"w-5 h-5"})})]})]}),o.jsxs("div",{className:"p-6 overflow-y-auto flex-1 text-white",children:[i?o.jsxs("div",{className:"space-y-4 mb-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow",children:"Name *"}),o.jsx("input",{value:c.name,onChange:b=>u({...c,name:b.target.value}),className:"w-full p-3 border-2 border-lime-glow/70 rounded-xl mt-1 bg-gray-900/80 text-white",placeholder:"Customer name"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow",children:"Phone *"}),o.jsx("input",{value:c.phone,onChange:b=>u({...c,phone:b.target.value}),className:"w-full p-3 border-2 border-lime-glow/70 rounded-xl mt-1 bg-gray-900/80 text-white",placeholder:"Phone number"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow",children:"Email"}),o.jsx("input",{value:c.email,onChange:b=>u({...c,email:b.target.value}),className:"w-full p-3 border-2 border-lime-glow/70 rounded-xl mt-1 bg-gray-900/80 text-white",placeholder:"Email"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow",children:"Address"}),o.jsx("input",{value:c.address,onChange:b=>u({...c,address:b.target.value}),className:"w-full p-3 border-2 border-lime-glow/70 rounded-xl mt-1 bg-gray-900/80 text-white",placeholder:"Street address"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow",children:"City"}),o.jsx("input",{value:c.city,onChange:b=>u({...c,city:b.target.value}),className:"w-full p-3 border-2 border-lime-glow/70 rounded-xl mt-1 bg-gray-900/80 text-white",placeholder:"City"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-lime-glow",children:"State"}),o.jsx("input",{value:c.state,onChange:b=>u({...c,state:b.target.value}),className:"w-full p-3 border-2 border-lime-glow/70 rounded-xl mt-1 bg-gray-900/80 text-white",placeholder:"State"})]})]}),o.jsxs("div",{className:"flex gap-2 pt-2",children:[o.jsxs("button",{onClick:()=>I().catch(b=>console.error(b)),disabled:d,className:"flex-1 bg-lime-glow text-emerald-pine py-3 rounded-xl font-bold flex items-center justify-center gap-2 disabled:opacity-50",children:[o.jsx(fx,{className:"w-4 h-4"}),d?"Saving...":"Save Changes"]}),o.jsx("button",{onClick:()=>{a(!1),u({name:t.name,phone:t.phone||"",address:t.address||"",email:t.email||"",city:t.city||"",state:t.state||""})},className:"px-6 py-3 border-2 border-lime-glow rounded-xl font-bold text-lime-glow hover:bg-lime-glow/10",children:"Cancel"})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-emerald-pine p-5 rounded-2xl text-white mb-4 shadow-lg border border-lime-glow/40",children:[o.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[o.jsx("div",{className:"w-16 h-16 rounded-full bg-white backdrop-blur-sm flex items-center justify-center font-bold text-xl border-2 border-white/30",children:t.name.substring(0,2).toUpperCase()}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"font-bold text-lg text-white",children:t.name}),o.jsxs("div",{className:"flex flex-wrap gap-2 mt-1",children:[t.phone&&o.jsxs("span",{className:"text-xs bg-white text-emerald-pine px-2 py-0.5 rounded-full",children:[" ",t.phone]}),t.email&&o.jsxs("span",{className:"text-xs bg-white text-emerald-pine px-2 py-0.5 rounded-full",children:[" ",t.email]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[o.jsxs("div",{className:"bg-emerald-900/80 rounded-xl p-3 text-center border border-lime-glow/30",children:[o.jsxs("p",{className:"text-2xl font-bold text-white",children:["",(w.totalSpent/1e3).toFixed(1),"k"]}),o.jsx("p",{className:"text-xs text-lime-glow mt-1",children:"Total Spent"})]}),o.jsxs("div",{className:"bg-emerald-900/80 rounded-xl p-3 text-center border border-lime-glow/30",children:[o.jsx("p",{className:"text-2xl font-bold text-white",children:w.totalOrders}),o.jsx("p",{className:"text-xs text-lime-glow mt-1",children:"Total Orders"})]}),o.jsxs("div",{className:"bg-emerald-900/80 rounded-xl p-3 text-center border border-lime-glow/30",children:[o.jsxs("p",{className:"text-2xl font-bold text-white",children:["",w.avgOrderValue.toFixed(0)]}),o.jsx("p",{className:"text-xs text-lime-glow mt-1",children:"Avg Order"})]})]})]}),t.address&&o.jsxs("div",{className:"bg-gray-900/80 border border-emerald-pine/60 p-4 rounded-xl mb-4",children:[o.jsx("p",{className:"text-xs font-bold text-lime-glow uppercase mb-1",children:"Address"}),o.jsxs("p",{className:"text-sm text-white",children:[t.address,t.city&&`, ${t.city}`,t.state&&`, ${t.state}`]})]}),t.customFields&&Object.keys(t.customFields).length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsxs("h4",{className:"text-xs font-bold text-lime-glow uppercase tracking-wide mb-2 flex items-center gap-2",children:[o.jsx("span",{className:"w-1 h-4 bg-lime-glow rounded"}),"Imported Data"]}),o.jsx("div",{className:"bg-gray-900/80 border border-emerald-pine/60 p-4 rounded-xl",children:o.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:Object.entries(t.customFields).map(([b,R])=>o.jsxs("div",{className:"",children:[o.jsx("p",{className:"text-xs text-lime-glow font-semibold",children:b}),o.jsx("p",{className:"text-sm text-white",children:R})]},b))})})]})]}),!i&&T.length>0&&o.jsx("div",{className:"bg-amber-100 border-l-4 border-lime-glow p-4 rounded-xl mb-4 text-emerald-pine",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(mx,{className:"w-5 h-5 text-emerald-pine flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("h4",{className:"font-bold text-emerald-pine text-sm mb-1",children:[T.length," Order",T.length>1?"s":""," Need Outfit Matching"]}),o.jsx("p",{className:"text-xs text-emerald-pine/80",children:"Update outfit names below to match your inventory"})]})]})}),!i&&o.jsxs("div",{children:[o.jsxs("h4",{className:"text-sm font-bold text-lime-glow mb-3 flex items-center gap-2",children:[o.jsx(mi,{className:"w-4 h-4"}),"Order History (",m.length,")"]}),Object.keys(P).length>0&&o.jsx("div",{className:"mb-4 grid grid-cols-2 gap-2 sm:grid-cols-3 lg:grid-cols-4",children:Object.entries(P).map(([b,R])=>o.jsxs("div",{className:"bg-black/50 border border-emerald-pine/60 rounded-lg p-2",children:[o.jsx("p",{className:"text-xs text-lime-glow/70 font-semibold truncate",children:b}),o.jsxs("p",{className:"text-xs text-white/70",children:["Orders: ",R.count]}),o.jsxs("p",{className:`text-sm font-bold ${R.avgProfitPercent>=0?"text-lime-glow":"text-red-400"}`,children:[R.avgProfitPercent.toFixed(1),"% profit"]}),o.jsxs("p",{className:`text-xs font-semibold ${R.totalProfit>=0?"text-lime-glow":"text-red-400"}`,children:["",Math.round(R.totalProfit)]})]},b))}),o.jsxs("div",{className:"space-y-3",children:[m.map((b,R)=>o.jsx($A,{order:b,outfitOptions:y,onUpdateOutfit:E,onDeleteOrder:x,onDataChanged:s},R)),m.length===0&&o.jsx("div",{className:"text-center py-6 text-gray-400 dark:text-gray-500 text-sm",children:"No orders yet"})]})]})]})]})}):null}function $A({order:t,outfitOptions:e,onUpdateOutfit:n,onDeleteOrder:r,onDataChanged:s}){const i=()=>{var O,$,ee;if((O=t.importedData)!=null&&O["Order Total"]){const X=String(t.importedData["Order Total"]).replace(/[^0-9.-]/g,""),J=parseFloat(X);if(!isNaN(J)&&J>0)return J}if(t.orderTotal)return t.orderTotal;if(t.finalSellingPrice)return t.finalSellingPrice;if(($=t.importedData)!=null&&$["Product Price"]){const X=String(t.importedData["Product Price"]).replace(/[^0-9.-]/g,"");return parseFloat(X)||0}if((ee=t.importedData)!=null&&ee.Total){const X=String(t.importedData.Total).replace(/[^0-9.-]/g,"");return parseFloat(X)||0}return 0},[a,c]=F.useState(!1),[u,d]=F.useState(t.outfitName),[p,y]=F.useState(t.size||"M"),[m,T]=F.useState(!1),[w,P]=F.useState({stitchingCost:t.stitchingCost||0,fabricCost:t.fabricCost||0,deliveryCost:t.deliveryCost||0,acquisitionCost:t.acquisitionCost||0}),[I,E]=F.useState(!1),[x,b]=F.useState(!1),[R,L]=F.useState(i().toString()),[M,N]=F.useState(!1),[f,v]=F.useState(!1),[_,k]=F.useState(t.paymentMethod||"Prepaid"),[j,C]=F.useState(!1),ge=O=>O?(O.toDate?O.toDate():new Date(O)).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"N/A",ae=async()=>{if(!t||!t.id){alert("Error: Order ID not found");return}E(!0);try{const O=Ue();if(!O){alert("Error: Database not initialized");return}await Ye(Re(O,"production_orders",t.id),{stitchingCost:parseFloat(w.stitchingCost)||0,fabricCost:parseFloat(w.fabricCost)||0,deliveryCost:parseFloat(w.deliveryCost)||0,acquisitionCost:parseFloat(w.acquisitionCost)||0}),T(!1),s&&await s()}catch(O){console.error("Error updating costs:",O),alert("Error updating costs: "+O.message)}finally{E(!1)}},Se=async()=>{if(!t||!t.id){alert("Error: Order ID not found");return}const O=parseFloat(R);if(isNaN(O)||O<=0){alert("Please enter a valid price");return}N(!0);try{const $=Ue();if(!$){alert("Error: Database not initialized");return}await Ye(Re($,"production_orders",t.id),{orderTotal:O}),b(!1),s&&await s()}catch($){console.error("Error updating price:",$),alert("Error updating price: "+$.message)}finally{N(!1)}},ne=async()=>{if(!t||!t.id){alert("Error: Order ID not found");return}C(!0);try{const O=Ue();if(!O){alert("Error: Database not initialized");return}await Ye(Re(O,"production_orders",t.id),{paymentMethod:_}),v(!1),s&&await s()}catch(O){console.error("Error updating payment method:",O),alert("Error updating payment method: "+O.message)}finally{C(!1)}};return o.jsxs("div",{className:`${t.matchesInventory?"bg-gray-900/80 border-emerald-pine/60":"bg-gray-900/80 border-amber-500/60"} border-2 p-4 rounded-xl shadow-sm hover:shadow-md transition-shadow`,children:[o.jsxs("div",{className:"flex justify-between items-start gap-4",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[o.jsxs("span",{className:"font-mono text-sm font-bold text-lime-glow",children:["#",t.orderNumber]}),o.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-semibold ${t.status==="Order Shipped (Completed)"?"bg-emerald-700 text-white":t.status==="Received from Tailor"?"bg-emerald-800 text-lime-glow":t.status==="Sent to Tailor"?"bg-amber-600 text-white":"bg-gray-700 text-white"}`,children:t.status}),!t.matchesInventory&&t.outfitName&&o.jsx("span",{className:"text-xs bg-red-700 text-white px-2 py-1 rounded-full font-bold animate-pulse",children:" NEEDS FIX"}),o.jsx("button",{onClick:()=>r(t.id,t.orderNumber).catch(O=>console.error(O)),className:"ml-auto text-red-500 p-1.5 hover:bg-red-50/40 rounded-lg transition-colors",title:"Delete order",children:o.jsx(Zo,{className:"w-4 h-4"})})]}),a?o.jsxs("div",{className:"space-y-2 mt-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("select",{value:u,onChange:O=>d(O.target.value),className:"flex-1 p-2 border-2 border-lime-glow/50 rounded-lg text-sm font-medium bg-black/20 text-white focus:ring-2 focus:ring-lime-glow/30",children:[o.jsxs("option",{value:t.outfitName,children:[t.outfitName," (current)"]}),e.map(O=>o.jsx("option",{value:O.name,children:O.name},O.id))]}),o.jsxs("select",{value:p,onChange:O=>y(O.target.value),className:"p-2 border-2 border-lime-glow/50 rounded-lg text-sm font-medium bg-black/20 text-white focus:ring-2 focus:ring-lime-glow/30 w-20",children:[o.jsx("option",{value:"XS",children:"XS"}),o.jsx("option",{value:"S",children:"S"}),o.jsx("option",{value:"M",children:"M"}),o.jsx("option",{value:"L",children:"L"}),o.jsx("option",{value:"XL",children:"XL"}),o.jsx("option",{value:"XXL",children:"XXL"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>{n(t.id,u,p).catch(O=>console.error(O)),c(!1)},className:"bg-lime-glow text-emerald-pine px-4 py-2 rounded-lg text-xs font-bold hover:bg-lime-glow/90 shadow-sm flex-1",children:" Save"}),o.jsx("button",{onClick:()=>{d(t.outfitName),y(t.size||"M"),c(!1)},className:"text-white/70 px-4 py-2 hover:bg-white/10 rounded-lg",children:o.jsx(Wr,{className:"w-4 h-4"})})]})]}):o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("p",{className:"text-base font-bold text-white",children:t.outfitName||"Unknown"}),t.outfitName&&o.jsx("button",{onClick:()=>c(!0),className:"text-lime-glow p-1.5 hover:bg-lime-glow/20 rounded-lg transition-colors",title:"Edit outfit name",children:o.jsx(dx,{className:"w-3.5 h-3.5"})})]}),o.jsxs("div",{className:"flex items-center gap-3 text-xs text-white/70 flex-wrap",children:[o.jsxs("span",{children:[" ",ge(t.createdAt)]}),t.size&&o.jsxs("span",{className:"bg-black/20 border border-lime-glow/30 px-2 py-0.5 rounded font-semibold text-white",children:["Size ",t.size]}),f?o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsxs("select",{value:_,onChange:O=>k(O.target.value),className:"p-1 bg-black/50 border border-lime-glow/50 rounded text-xs text-white",children:[o.jsx("option",{value:"Prepaid",children:"Prepaid"}),o.jsx("option",{value:"COD",children:"COD"})]}),o.jsx("button",{onClick:()=>ne().catch(O=>console.error(O)),disabled:j,className:"bg-lime-glow text-emerald-pine px-1.5 py-0.5 rounded text-xs font-bold hover:bg-lime-glow/90 disabled:opacity-50",children:j?"...":""}),o.jsx("button",{onClick:()=>{k(t.paymentMethod||"Prepaid"),v(!1)},className:"border border-lime-glow text-lime-glow px-1.5 py-0.5 rounded text-xs font-bold hover:bg-lime-glow/10",children:""})]}):o.jsx("span",{className:`px-2 py-0.5 rounded font-semibold cursor-pointer hover:opacity-80 ${(t.paymentMethod||"Prepaid")==="COD"?"bg-amber-600/20 border border-amber-600/60 text-amber-300":"bg-emerald-700/20 border border-emerald-700/60 text-emerald-300"}`,onClick:()=>v(!0),title:"Click to edit",children:t.paymentMethod||"Prepaid"})]})]}),o.jsx("div",{className:"text-right flex-shrink-0",children:x?o.jsxs("div",{className:"flex flex-col gap-2 items-end",children:[o.jsx("input",{type:"number",value:R,onChange:O=>L(O.target.value),className:"w-24 p-1 bg-black/50 border border-lime-glow/50 rounded text-xs text-white font-bold text-right",placeholder:""}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:()=>Se().catch(O=>console.error(O)),disabled:M,className:"bg-lime-glow text-emerald-pine px-2 py-1 rounded text-xs font-bold hover:bg-lime-glow/90 disabled:opacity-50 disabled:cursor-not-allowed",children:M?"...":""}),o.jsx("button",{onClick:()=>{L(i().toString()),b(!1)},className:"border border-lime-glow text-lime-glow px-2 py-1 rounded text-xs font-bold hover:bg-lime-glow/10",children:""})]})]}):o.jsxs("div",{className:"flex flex-col items-end gap-1",children:[o.jsxs("p",{className:"text-2xl font-bold text-lime-glow",children:["",i()]}),o.jsx("button",{onClick:()=>b(!0),className:"text-lime-glow p-1 hover:bg-lime-glow/20 rounded-lg transition-colors text-xs",title:"Edit price",children:""})]})})]}),t.importedData&&Object.keys(t.importedData).length>0&&o.jsxs("div",{className:"mt-3 pt-3 border-t border-emerald-pine/60",children:[o.jsx("p",{className:"text-xs font-bold text-lime-glow uppercase mb-2",children:" Order Details"}),o.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:Object.entries(t.importedData).slice(0,6).map(([O,$])=>o.jsxs("div",{className:"bg-black/50 border border-emerald-pine/60 px-2 py-1 rounded",children:[o.jsx("p",{className:"text-xs text-lime-glow/80",children:O}),o.jsx("p",{className:"text-sm font-semibold text-white truncate",children:$})]},O))})]}),o.jsxs("div",{className:"mt-3 pt-3 border-t border-emerald-pine/60",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("p",{className:"text-xs font-bold text-lime-glow uppercase",children:" Costs"}),!m&&o.jsx("button",{onClick:()=>T(!0),className:"text-lime-glow p-1 hover:bg-lime-glow/20 rounded-lg transition-colors text-xs",title:"Edit costs",children:" Edit"})]}),m?o.jsxs("div",{className:"space-y-2 mb-2",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-lime-glow/70",children:"Stitching"}),o.jsx("input",{type:"number",value:w.stitchingCost,onChange:O=>P({...w,stitchingCost:O.target.value}),className:"w-full p-1 bg-black/50 border border-lime-glow/50 rounded text-xs text-white",placeholder:""})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-lime-glow/70",children:"Fabric"}),o.jsx("input",{type:"number",value:w.fabricCost,onChange:O=>P({...w,fabricCost:O.target.value}),className:"w-full p-1 bg-black/50 border border-lime-glow/50 rounded text-xs text-white",placeholder:""})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-lime-glow/70",children:"Delivery"}),o.jsx("input",{type:"number",value:w.deliveryCost,onChange:O=>P({...w,deliveryCost:O.target.value}),className:"w-full p-1 bg-black/50 border border-lime-glow/50 rounded text-xs text-white",placeholder:""})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-lime-glow/70",children:_==="COD"?"COD Charge":"Acq/Other"}),o.jsx("input",{type:"number",value:w.acquisitionCost,onChange:O=>P({...w,acquisitionCost:O.target.value}),className:`w-full p-1 rounded text-xs text-white ${_==="COD"?"bg-amber-900/30 border border-amber-500/50":"bg-black/50 border border-lime-glow/50"}`,placeholder:""})]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>ae().catch(O=>console.error(O)),disabled:I,className:"flex-1 bg-lime-glow text-emerald-pine px-2 py-1 rounded text-xs font-bold hover:bg-lime-glow/90 disabled:opacity-50 disabled:cursor-not-allowed",children:I?"Saving...":"Save"}),o.jsx("button",{onClick:()=>T(!1),className:"flex-1 border border-lime-glow text-lime-glow px-2 py-1 rounded text-xs font-bold hover:bg-lime-glow/10",children:"Cancel"})]})]}):o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsxs("div",{className:"bg-black/50 border border-emerald-pine/60 px-2 py-1 rounded",children:[o.jsx("p",{className:"text-lime-glow/70",children:"Stitching"}),o.jsxs("p",{className:"font-bold text-white",children:["",(w.stitchingCost||0).toFixed(0)]})]}),o.jsxs("div",{className:"bg-black/50 border border-emerald-pine/60 px-2 py-1 rounded",children:[o.jsx("p",{className:"text-lime-glow/70",children:"Fabric"}),o.jsxs("p",{className:"font-bold text-white",children:["",(w.fabricCost||0).toFixed(0)]})]}),o.jsxs("div",{className:"bg-black/50 border border-emerald-pine/60 px-2 py-1 rounded",children:[o.jsx("p",{className:"text-lime-glow/70",children:"Delivery"}),o.jsxs("p",{className:"font-bold text-white",children:["",(w.deliveryCost||0).toFixed(0)]})]}),o.jsxs("div",{className:`px-2 py-1 rounded ${_==="COD"?"bg-amber-900/20 border border-amber-500/60":"bg-black/50 border border-emerald-pine/60"}`,children:[o.jsx("p",{className:_==="COD"?"text-amber-300/70":"text-lime-glow/70",children:_==="COD"?"COD Charge":"Acq/Other"}),o.jsxs("p",{className:`font-bold ${_==="COD"?"text-amber-300":"text-white"}`,children:["",(w.acquisitionCost||0).toFixed(0)]})]})]})]})]})}function qA({visible:t,inventoryItems:e=[],userProfile:n,onClose:r,onDataChanged:s,editOrder:i=null,initialForm:a=null}){const[c,u]=F.useState(a||{orderNumber:"",customerName:"",outfitName:"",size:"M",fabricId:"",status:"Sent to Tailor",sellingPrice:"",deductStock:!1,cutAmount:"",notes:"",phone:"",address:"",discount:"",source:"",acquisitionCost:"",paymentMethod:"Prepaid",city:"",state:"",codCharge:"",shippingCost:"",codRemittanceDate:"",stitchingCost:"",fabricCost:"",deliveryCost:""}),[d,p]=F.useState(!1),[y,m]=F.useState("");if(ms.useEffect(()=>{i?u({orderNumber:i.orderNumber||"",customerName:i.customerName||"",outfitName:i.outfitName||"",size:i.size||"M",fabricId:i.fabricId||"",status:i.status||"Sent to Tailor",sellingPrice:i.finalSellingPrice||"",deductStock:!1,cutAmount:i.cutAmount||"",notes:i.notes||"",phone:i.phone||"",address:i.address||"",discount:i.discount||"",source:i.source||"",acquisitionCost:i.acquisitionCost||"",paymentMethod:i.paymentMethod||"Prepaid",city:i.city||"",state:i.state||"",codCharge:i.codCharge||"",shippingCost:i.shippingCost||"",codRemittanceDate:i.codRemittanceDate||"",stitchingCost:i.stitchingCost||"",fabricCost:i.fabricCost||"",deliveryCost:i.deliveryCost||""}):a&&u(a)},[i,a]),!t)return null;const T=async()=>{p(!0),m("");try{const{orderNumber:I,customerName:E,outfitName:x,size:b,fabricId:R,status:L,sellingPrice:M,deductStock:N,cutAmount:f,notes:v,phone:_,address:k,discount:j,source:C,acquisitionCost:ge,paymentMethod:ae,city:Se,state:ne,codCharge:O,shippingCost:$,codRemittanceDate:ee,stitchingCost:X,fabricCost:J,deliveryCost:A}=c;if(!I||!E)throw new Error("Order # and Customer Name are required");let H=null;if(x&&(H=e.find(z=>z.name.toLowerCase()===x.toLowerCase()&&z.type==="outfit"),!H))throw new Error(`Outfit '${x}' must be an existing outfit in Inventory.`);const K=Ue(),V={orderNumber:I,customerName:E,outfitName:H?H.name:x,size:b,status:L,notes:v,phone:_,address:k,discount:j,source:C,acquisitionCost:parseFloat(ge)||0,paymentMethod:ae||"Prepaid",city:Se||"",state:ne||"",codCharge:parseFloat(O)||0,shippingCost:parseFloat($)||0,codRemittanceDate:ee||"",stitchingCost:parseFloat(X)||0,fabricCost:parseFloat(J)||0,deliveryCost:parseFloat(A)||0,usedByEmail:(n==null?void 0:n.name)||"Unknown",createdAt:ke(),updatedAt:ke()};if(R){const z=e.find(G=>G.id===R);if(z){V.fabricId=R,V.fabricName=z.name,V.imageUrl=z.imageUrl;const G=parseFloat(f);if(N&&G>0){V.cutAmount=G;const se=Re(K,In,R);await Ye(se,{currentLength:Ri(-G),updatedAt:ke()}),await Gt(Qe(se,"history"),{amountUsed:G,orderNumber:I,productName:x,status:"Manual Entry",type:"CUT",usedByEmail:(n==null?void 0:n.name)||"Unknown",usedAt:ke()})}}}else V.imageUrl=H?H.imageUrl:`https://placehold.co/150x150/e2e8f0/64748b?text=${I}`;if(L==="Order Shipped (Completed)"){const z=parseFloat(M);if(z>0&&(V.finalSellingPrice=z),H){const G=Re(K,In,H.id),se=1;await Ye(G,{manualSoldCount:Ri(se),updatedAt:ke()}),await Gt(Qe(G,"history"),{type:"OUTFIT_SOLD_MANUAL",amountUsed:se,size:b,status:"Legacy Sold",orderNumber:I,usedByEmail:(n==null?void 0:n.name)||"Unknown",usedAt:ke()})}}!V.finalSellingPrice&&M&&(V.finalSellingPrice=parseFloat(M)),i&&i.id?await Ye(Re(K,dn,i.id),{...V,updatedAt:ke()}):await Gt(Qe(K,dn),V),u({orderNumber:"",customerName:"",outfitName:"",size:"M",fabricId:"",status:"Sent to Tailor",sellingPrice:"",deductStock:!1,cutAmount:"",notes:"",phone:"",address:"",discount:"",source:"",acquisitionCost:"",paymentMethod:"Prepaid",city:"",state:"",codCharge:"",shippingCost:"",codRemittanceDate:"",stitchingCost:"",fabricCost:"",deliveryCost:""}),s&&await s(),r()}catch(I){console.error(I),m(I.message||"Failed to add order")}finally{p(!1)}},w=e.filter(I=>I.type==="fabric"),P=e.filter(I=>I.type==="outfit");return o.jsx("div",{className:"fixed inset-0 bg-black/70 z-[60] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:o.jsxs("div",{className:"bg-gray-950 w-full sm:max-w-lg sm:rounded-3xl rounded-t-3xl shadow-2xl h-[92vh] sm:h-auto flex flex-col border-2 border-lime-glow/40",children:[o.jsxs("div",{className:"p-6 border-b border-lime-glow/40 bg-emerald-pine flex items-center justify-between flex-shrink-0",children:[o.jsx("h3",{className:"text-xl font-bold text-white",children:i?"Edit Order":"Past Order"}),o.jsx("button",{onClick:r,className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white",children:o.jsx("span",{className:"text-2xl",children:""})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[y&&o.jsx("div",{className:"m-4 mb-0 p-3 bg-red-900/50 border border-red-500/50 text-red-200 text-sm rounded-xl",children:y}),o.jsxs("div",{className:"space-y-4 p-6 pt-4",children:[o.jsxs("div",{className:"bg-gray-900/80 p-3 rounded-xl border border-emerald-pine/60",children:[o.jsx("h4",{className:"text-xs font-bold text-lime-glow uppercase mb-2",children:"Customer Details"}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-2",children:[o.jsx("input",{className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm",placeholder:"Order # (Required)",value:c.orderNumber,onChange:I=>u({...c,orderNumber:I.target.value})}),o.jsx("input",{className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm",placeholder:"Customer Name (Required)",value:c.customerName,onChange:I=>u({...c,customerName:I.target.value})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsx("input",{className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm",placeholder:"Phone",value:c.phone,onChange:I=>u({...c,phone:I.target.value})}),o.jsx("input",{className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm",placeholder:"Address",value:c.address,onChange:I=>u({...c,address:I.target.value})})]})]}),o.jsxs("div",{className:"bg-gray-900/80 p-3 rounded-xl border border-emerald-pine/60",children:[o.jsx("h4",{className:"text-xs font-bold text-lime-glow uppercase mb-2",children:"Product Info"}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-2",children:[o.jsxs("select",{className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm",value:c.outfitName,onChange:I=>u({...c,outfitName:I.target.value}),children:[o.jsx("option",{value:"",children:" Select Outfit "}),P.map(I=>o.jsx("option",{value:I.name,children:I.name},I.id))]}),o.jsxs("select",{className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm",value:c.size,onChange:I=>u({...c,size:I.target.value}),children:[o.jsx("option",{children:"S"}),o.jsx("option",{children:"M"}),o.jsx("option",{children:"L"}),o.jsx("option",{children:"XL"}),o.jsx("option",{children:"XXL"})]})]}),o.jsxs("select",{className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm mb-2",value:c.fabricId,onChange:I=>u({...c,fabricId:I.target.value}),children:[o.jsx("option",{value:"",children:" Select Fabric (Optional) "}),w.map(I=>o.jsx("option",{value:I.id,children:I.name},I.id))]}),c.fabricId&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("label",{className:"flex items-center gap-2 text-xs cursor-pointer text-white",children:[o.jsx("input",{type:"checkbox",checked:c.deductStock,onChange:I=>u({...c,deductStock:I.target.checked})}),"Deduct Stock"]}),c.deductStock&&o.jsx("input",{type:"number",step:"0.1",className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm",placeholder:"Cut Amount (m)",value:c.cutAmount,onChange:I=>u({...c,cutAmount:I.target.value})})]}),o.jsx("textarea",{className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm mt-2",rows:"2",placeholder:"Notes",value:c.notes,onChange:I=>u({...c,notes:I.target.value})})]}),o.jsxs("div",{className:"bg-gray-900/80 p-3 rounded-xl border border-emerald-pine/60",children:[o.jsx("h4",{className:"text-xs font-bold text-lime-glow uppercase mb-2",children:"Status & Pricing"}),o.jsxs("select",{className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm mb-2",value:c.status,onChange:I=>u({...c,status:I.target.value}),children:[o.jsx("option",{children:"Sent to Tailor"}),o.jsx("option",{children:"Received from Tailor"}),o.jsx("option",{children:"Order Shipped (Completed)"}),o.jsx("option",{children:"Cancelled"})]}),o.jsxs("select",{className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm mb-2",value:c.paymentMethod,onChange:I=>u({...c,paymentMethod:I.target.value}),children:[o.jsx("option",{value:"Prepaid",children:"Prepaid"}),o.jsx("option",{value:"COD",children:"COD"})]}),c.paymentMethod==="COD"&&o.jsx("input",{type:"number",className:"w-full p-2 bg-amber-900/30 text-white rounded-lg border-2 border-amber-500/40 text-sm mb-2",placeholder:"COD Charges ()",value:c.acquisitionCost,onChange:I=>u({...c,acquisitionCost:I.target.value})}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-2",children:[o.jsx("input",{type:"number",className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm",placeholder:"Selling Price ()",value:c.sellingPrice,onChange:I=>u({...c,sellingPrice:I.target.value})}),o.jsx("input",{type:"number",className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm",placeholder:"Discount ()",value:c.discount,onChange:I=>u({...c,discount:I.target.value})})]})]}),o.jsxs("div",{className:"bg-gray-900/80 p-3 rounded-xl border border-emerald-pine/60",children:[o.jsx("h4",{className:"text-xs font-bold text-lime-glow uppercase mb-2",children:"Costs"}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-2",children:[o.jsx("input",{type:"number",className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm",placeholder:"Stitching Cost ()",value:c.stitchingCost,onChange:I=>u({...c,stitchingCost:I.target.value})}),o.jsx("input",{type:"number",className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm",placeholder:"Fabric Cost ()",value:c.fabricCost,onChange:I=>u({...c,fabricCost:I.target.value})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsx("input",{type:"number",className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm",placeholder:"Delivery Cost ()",value:c.deliveryCost,onChange:I=>u({...c,deliveryCost:I.target.value})}),o.jsx("input",{type:"number",className:"w-full p-2 bg-gray-800 text-white rounded-lg border-2 border-lime-glow/40 text-sm",placeholder:"Acquisition/COD ()",value:c.acquisitionCost,onChange:I=>u({...c,acquisitionCost:I.target.value})})]})]})]}),o.jsx("div",{className:"p-6 pt-4 border-t border-lime-glow/40 flex gap-3 flex-shrink-0 bg-gray-950",children:o.jsx("button",{onClick:T,disabled:d,className:"flex-1 bg-lime-glow text-emerald-pine py-3 rounded-xl font-bold shadow-lg hover:bg-lime-glow/90 active:scale-95 transition-all",children:d?"Saving...":i?"Update Order":"Add Record"})})]})]})})}function HA({item:t,type:e,onClose:n,userProfile:r,onDataChanged:s}){const[i,a]=F.useState(""),[c,u]=F.useState("M"),[d,p]=F.useState(!1),[y,m]=F.useState("");if(!t)return null;t.type;const T=async w=>{var I;w.preventDefault();const P=parseFloat(i);if(!(!P||P<=0)){p(!0),m("");try{const E=Ue(),x=Re(E,In,t.id),b=e==="ADD";if(t.type==="fabric"){const R=b?t.currentLength+P:t.currentLength-P;if(!b&&R<0){m("Cannot deduct more than available."),p(!1);return}await Ye(x,{currentLength:R,updatedAt:ke()}),await Gt(Qe(x,"history"),{type:b?"ADJUST_ADD":"ADJUST_DEDUCT",amountUsed:P,isAddition:b,status:"Manual Adjustment",orderNumber:"MANUAL",usedByEmail:r==null?void 0:r.name,usedAt:ke()})}else{const R=((I=t.stockBreakdown)==null?void 0:I[c])||0,L=b?R+P:R-P;if(!b&&L<0){m("Cannot deduct more than available."),p(!1);return}const M={...t.stockBreakdown,[c]:L};await Ye(x,{stockBreakdown:M,updatedAt:ke()}),await Gt(Qe(x,"history"),{type:b?"OUTFIT_ADD":"OUTFIT_SOLD",amountUsed:P,isAddition:b,size:c,status:`Stock ${b?"In":"Out"}`,orderNumber:"MANUAL",usedByEmail:r==null?void 0:r.name,usedAt:ke()})}a(""),s&&await s(),n()}catch(E){console.error(E),m("Failed to adjust stock")}p(!1)}};return o.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 w-full sm:max-w-sm sm:rounded-2xl rounded-t-3xl p-6 pb-8 shadow-2xl border dark:border-gray-800 border dark:border-gray-800",children:[o.jsx("h3",{className:"text-lg font-bold mb-4 text-center",children:e==="ADD"?"Add Stock":"Deduct Stock"}),t.type==="outfit"&&o.jsx("div",{className:"flex justify-center gap-2 mb-4",children:["S","M","L","XL","XXL"].map(w=>o.jsx("button",{onClick:()=>u(w),className:`w-10 h-10 rounded-full font-bold text-sm ${c===w?"bg-outfit-600 text-white":"bg-gray-100 text-gray-500"}`,children:w},w))}),y&&o.jsx("div",{className:"mb-4 text-center text-red-600 text-sm",children:y}),o.jsx("div",{className:"mb-4",children:o.jsx("input",{type:"number",step:"0.1",className:"w-full p-4 border-2 border-brand-100 rounded-2xl text-2xl text-center font-bold focus:border-brand outline-none",autoFocus:!0,value:i,onChange:w=>a(w.target.value),placeholder:"0.0",disabled:d})}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:T,className:"flex-1 bg-brand text-white py-3 rounded-xl font-bold shadow-lg shadow-brand/30",disabled:d||!i,children:"Confirm"}),o.jsx("button",{onClick:n,className:"flex-1 bg-gray-100 text-gray-600 dark:text-gray-400 dark:text-gray-500 py-3 rounded-xl font-bold",disabled:d,children:"Cancel"})]})]})})}function WA({item:t,inventoryItems:e,db:n,onClose:r,onDataChanged:s}){if(!t)return null;const[i,a]=F.useState(t),[c,u]=F.useState(null),[d,p]=F.useState(!1),y=F.useRef(null),m=F.useRef(null),T=(I,E)=>{if(!I.parentFabricId)return 0;const x=E.find(L=>L.id===I.parentFabricId);if(!x)return 0;const b=(parseFloat(x.costPerMeter)||0)*(parseFloat(I.lengthRequiredPerOutfit)||0),R=parseFloat(I.stitchingCost)||0;return b+R},w=I=>new Promise((E,x)=>{const b=new FileReader;b.readAsDataURL(I),b.onload=()=>E(b.result),b.onerror=R=>x(R)}),P=async()=>{if(!(!i||!n)){p(!0);try{const I=Re(n,"fabrics",i.id),E={...i,updatedAt:ke()};if(c){const x=await w(c);E.imageUrl=x}i.type==="outfit"&&(E.stitchingCost=parseFloat(i.stitchingCost)||0,E.sellingPrice=parseFloat(i.sellingPrice)||0,E.lengthRequiredPerOutfit=parseFloat(i.lengthRequiredPerOutfit)||0,E.manualSoldCount=parseInt(i.manualSoldCount)||0),await Ye(I,E),s&&await s(),r()}catch(I){console.error("Update Failed:",I.message)}p(!1)}};return o.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm overflow-y-auto",children:o.jsxs("div",{className:"bg-white w-full sm:max-w-lg rounded-t-3xl sm:rounded-3xl h-[92vh] sm:h-auto overflow-hidden flex flex-col shadow-2xl my-0 sm:my-10 border dark:border-gray-800",children:[o.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 p-6 border-b border-gray-100 dark:border-gray-800 flex justify-between items-center flex-shrink-0",children:[o.jsx("h3",{className:"font-bold text-lg",children:"Edit Details"}),o.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-white text-gray-400 dark:text-gray-500 hover:text-gray-600",children:o.jsx(Wr,{className:"w-6 h-6"})})]}),o.jsxs("div",{className:"p-6 overflow-y-auto flex-1 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 dark:text-gray-500 uppercase",children:"Internal Name"}),o.jsx("input",{className:"w-full p-3 bg-gray-50 dark:bg-gray-900 rounded-xl mt-1 border border-transparent focus:bg-white focus:border-brand",value:i.name,onChange:I=>a({...i,name:I.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 dark:text-gray-500 uppercase",children:"Location"}),o.jsx("input",{className:"w-full p-3 bg-gray-50 dark:bg-gray-900 rounded-xl mt-1 border border-transparent focus:bg-white focus:border-brand",value:i.location,onChange:I=>a({...i,location:I.target.value})})]}),i.type==="outfit"?o.jsxs("div",{className:"bg-purple-50 p-4 rounded-xl border border-purple-100",children:[o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{className:"text-xs font-bold text-purple-800 uppercase block mb-1",children:"Linked Fabric"}),o.jsxs("select",{className:"w-full p-3 bg-white rounded-lg border border-purple-200 text-sm",value:i.parentFabricId||"",onChange:I=>a({...i,parentFabricId:I.target.value}),children:[o.jsx("option",{value:"",children:"-- No Fabric Linked --"}),e.filter(I=>I.type==="fabric").map(I=>o.jsx("option",{value:I.id,children:I.name},I.id))]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] font-bold text-purple-800 uppercase block mb-1",children:"Fabric Req (m)"}),o.jsx("input",{type:"number",step:"0.1",className:"w-full p-2 bg-white rounded-lg border border-purple-200 text-sm",value:i.lengthRequiredPerOutfit,onChange:I=>a({...i,lengthRequiredPerOutfit:I.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] font-bold text-purple-800 uppercase block mb-1",children:"Stitching "}),o.jsx("input",{type:"number",className:"w-full p-2 bg-white rounded-lg border border-purple-200 text-sm",value:i.stitchingCost,onChange:I=>a({...i,stitchingCost:I.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] font-bold text-purple-800 uppercase block mb-1",children:"Sell Price "}),o.jsx("input",{type:"number",className:"w-full p-2 bg-white rounded-lg border border-purple-200 text-sm",value:i.sellingPrice,onChange:I=>a({...i,sellingPrice:I.target.value})})]})]}),o.jsxs("div",{className:"pt-3 border-t border-purple-200 text-xs flex justify-between text-purple-900 mb-3",children:[o.jsxs("span",{children:["Raw Cost: ",T({...i,stitchingCost:0},e).toFixed(0)]}),o.jsxs("span",{className:"font-bold",children:["Total Make: ",T(i,e).toFixed(0)]})]}),o.jsxs("div",{className:"pt-3 border-t border-purple-200 mb-3",children:[o.jsx("p",{className:"text-xs font-bold text-purple-800 uppercase mb-2",children:"Manual Sold Count (Legacy)"}),o.jsx("input",{type:"number",className:"w-full p-2 bg-white rounded-lg border border-purple-200 text-sm",value:i.manualSoldCount||0,onChange:I=>a({...i,manualSoldCount:I.target.value}),placeholder:"0"})]}),o.jsxs("div",{className:"pt-3 border-t border-purple-200",children:[o.jsx("p",{className:"text-xs font-bold text-purple-800 uppercase mb-2",children:"Stock Breakdown"}),o.jsx("div",{className:"grid grid-cols-5 gap-2",children:["S","M","L","XL","XXL"].map(I=>{var E;return o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] font-bold text-gray-400 dark:text-gray-500 mb-1 text-center",children:I}),o.jsx("input",{type:"number",className:"w-full p-2 text-center bg-white rounded-lg border border-purple-200 text-xs",value:((E=i.stockBreakdown)==null?void 0:E[I])||0,onChange:x=>a({...i,stockBreakdown:{...i.stockBreakdown,[I]:parseInt(x.target.value)||0}})})]},I)})})]})]}):o.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-100",children:[o.jsxs("label",{className:"text-xs font-bold text-blue-800 uppercase flex items-center gap-1 mb-2",children:[o.jsx(KE,{className:"w-3 h-3"})," Stock Correction"]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"number",step:"0.1",className:"flex-1 p-3 bg-white rounded-lg border border-blue-200",value:i.currentLength,onChange:I=>a({...i,currentLength:I.target.value})}),o.jsx("span",{className:"p-3 text-blue-800 font-bold self-center",children:i.unit})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 dark:text-gray-500 uppercase block mb-2",children:"Update Image"}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{onClick:()=>{var I;return(I=y.current)==null?void 0:I.click()},className:"h-20 bg-gray-50 dark:bg-gray-900 rounded-xl border-dashed border-2 border-gray-300 dark:border-gray-600 flex flex-col items-center justify-center text-gray-400 dark:text-gray-500 cursor-pointer hover:border-brand active:bg-gray-100",children:[o.jsx(JE,{className:"w-6 h-6 mb-1"}),o.jsx("span",{className:"text-xs",children:"Camera"})]}),o.jsxs("div",{onClick:()=>{var I;return(I=m.current)==null?void 0:I.click()},className:"h-20 bg-gray-50 dark:bg-gray-900 rounded-xl border-dashed border-2 border-gray-300 dark:border-gray-600 flex flex-col items-center justify-center text-gray-400 dark:text-gray-500 cursor-pointer hover:border-brand active:bg-gray-100",children:[o.jsx(hN,{className:"w-6 h-6 mb-1"}),o.jsx("span",{className:"text-xs",children:"Gallery"})]})]}),o.jsx("input",{type:"file",hidden:!0,ref:y,capture:"environment",accept:"image/*",onChange:I=>u(I.target.files[0])}),o.jsx("input",{type:"file",hidden:!0,ref:m,accept:"image/*",onChange:I=>u(I.target.files[0])}),c&&o.jsx("p",{className:"text-xs text-green-600 font-bold mt-2 text-center",children:"New Image Selected"})]})]}),o.jsx("div",{className:"p-6 border-t border-gray-100 dark:border-gray-800 flex-shrink-0",children:o.jsx("button",{onClick:P,disabled:d,className:"w-full bg-brand text-white py-4 rounded-xl font-bold shadow-lg flex justify-center items-center gap-2 active:bg-brand-dark disabled:opacity-50",children:d?"Saving...":o.jsxs(o.Fragment,{children:[o.jsx(fx,{className:"w-5 h-5"})," Save Changes"]})})})]})})}function GA({visible:t,orderId:e,onClose:n,onDataChanged:r}){const[s,i]=F.useState(""),[a,c]=F.useState(""),[u,d]=F.useState(!1);if(console.log("DeleteConfirmModal render:",{visible:t,orderId:e}),!t||!e)return null;const p=async()=>{if(console.log("handleDelete called, password:",s),s!=="posh123"){c("Incorrect Password!");return}d(!0),c("");try{const y=Ue();await Ls(Re(y,dn,e)),i(""),r&&await r(),n()}catch(y){console.error(y),c("Delete failed: "+y.message)}d(!1)};return o.jsx("div",{className:"fixed inset-0 bg-black/70 z-[70] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:o.jsxs("div",{className:"bg-gray-900 w-full sm:max-w-sm sm:rounded-2xl rounded-t-3xl p-6 pb-8 shadow-2xl border-2 border-red-500/50",children:[o.jsxs("h3",{className:"text-lg font-bold mb-4 text-red-500 flex items-center gap-2",children:[o.jsx("span",{children:""})," Delete Record?"]}),o.jsx("p",{className:"text-sm text-white/80 mb-4",children:"Enter admin password to permanently delete this order history."}),a&&o.jsx("div",{className:"mb-3 p-2 bg-red-900/50 border border-red-500/50 text-red-200 text-sm rounded",children:a}),o.jsx("input",{type:"password",className:"w-full p-3 bg-gray-800 border-2 border-lime-glow/40 text-white rounded-xl mb-4",placeholder:"Password",value:s,onChange:y=>i(y.target.value),autoFocus:!0,disabled:u}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:p,disabled:u,className:"flex-1 bg-red-600 text-white py-3 rounded-xl font-bold hover:bg-red-700 disabled:opacity-50",children:u?"Deleting...":"Delete"}),o.jsx("button",{onClick:()=>{i(""),n()},disabled:u,className:"flex-1 bg-gray-700 text-white py-3 rounded-xl font-bold hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]})]})})}function KA({visible:t,orderId:e,onClose:n,onDataChanged:r}){const[s,i]=F.useState({sellingPrice:"",shippingCost:"",otherExpenses:""}),[a,c]=F.useState(""),[u,d]=F.useState(!1);if(!t||!e)return null;const p=async()=>{const y=parseFloat(s.sellingPrice);if(isNaN(y)||y<=0){c("Valid selling price required.");return}d(!0),c("");try{const m=Ue();await Ye(Re(m,dn,e),{status:"Order Shipped (Completed)",finalSellingPrice:y,shippingCost:parseFloat(s.shippingCost)||0,otherExpenses:parseFloat(s.otherExpenses)||0,updatedAt:ke()}),i({sellingPrice:"",shippingCost:"",otherExpenses:""}),r&&await r(),n()}catch(m){console.error(m),c("Failed to ship order")}d(!1)};return o.jsx("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 w-full sm:max-w-sm sm:rounded-2xl rounded-t-3xl p-6 pb-8 shadow-2xl border dark:border-gray-800 border dark:border-gray-800",children:[o.jsx("h3",{className:"text-lg font-bold mb-4",children:"Complete Shipping"}),a&&o.jsx("div",{className:"mb-3 p-2 bg-red-50 text-red-600 text-sm rounded",children:a}),o.jsxs("div",{className:"space-y-3 mb-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 dark:text-gray-500",children:"Selling Price ()"}),o.jsx("input",{type:"number",className:"w-full p-2 border rounded-xl mt-1",value:s.sellingPrice,onChange:y=>i({...s,sellingPrice:y.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 dark:text-gray-500",children:"Shipping Cost ()"}),o.jsx("input",{type:"number",className:"w-full p-2 border rounded-xl mt-1",value:s.shippingCost,onChange:y=>i({...s,shippingCost:y.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 dark:text-gray-500",children:"Additional Expenses ()"}),o.jsx("input",{type:"number",className:"w-full p-2 border rounded-xl mt-1",value:s.otherExpenses,onChange:y=>i({...s,otherExpenses:y.target.value})})]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:p,disabled:u,className:"flex-1 bg-brand text-white py-3 rounded-xl font-bold",children:"Confirm Ship"}),o.jsx("button",{onClick:n,disabled:u,className:"flex-1 bg-gray-100 text-gray-600 dark:text-gray-400 dark:text-gray-500 py-3 rounded-xl font-bold",children:"Cancel"})]})]})})}function QA({url:t,onClose:e}){return t?o.jsxs("div",{className:"fixed inset-0 bg-black/95 z-[60] flex items-center justify-center p-4 backdrop-blur-sm modal-enter",onClick:e,children:[o.jsx("img",{src:t,className:"max-w-full max-h-[85vh] rounded-2xl shadow-2xl",alt:"Full size",onClick:n=>n.stopPropagation()}),o.jsx("button",{className:"absolute top-6 right-6 text-white p-3 bg-white rounded-full hover:bg-white active:bg-white dark:bg-gray-950/40",onClick:e,children:o.jsx(Wr,{className:"w-6 h-6"})})]}):null}function XA({itemId:t,onClose:e}){const[n,r]=F.useState([]),[s,i]=F.useState(null);F.useEffect(()=>{if(!t){r([]);return}const u=Ue(),d=bA(up(Qe(Re(u,In,t),"history")),p=>{const y=p.docs.map(m=>({id:m.id,...m.data()})).sort((m,T)=>{var w,P;return(((w=T.usedAt)==null?void 0:w.toMillis())||0)-(((P=m.usedAt)==null?void 0:P.toMillis())||0)});r(y)},p=>console.error("History fetch error:",p));return()=>d()},[t]);const a=async(u,d)=>{const p=Ue();await Ls(Re(p,In,u,"history",d)),i(null)},c=u=>{if(!u||!u.toDate)return"N/A";const d=u.toDate();return d.toLocaleDateString()+" "+d.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};return t?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 bg-black/60 z-[70] flex items-end sm:items-center justify-center modal-enter backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white dark:bg-gray-950 w-full sm:max-w-2xl rounded-t-3xl sm:rounded-3xl h-[90vh] sm:h-[85vh] overflow-hidden flex flex-col shadow-2xl border dark:border-gray-800",children:[o.jsxs("div",{className:"p-6 border-b border-gray-100 dark:border-gray-800 flex justify-between items-center bg-gray-50 dark:bg-gray-900 flex-shrink-0",children:[o.jsx("h3",{className:"font-bold text-lg text-gray-900 dark:text-white",children:"History"}),o.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-400 dark:text-gray-500 hover:text-gray-600 transition",children:o.jsx(Wr,{className:"w-6 h-6"})})]}),o.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:n.length===0?o.jsx("div",{className:"text-center py-12 text-gray-400",children:o.jsx("p",{children:"No transaction history recorded"})}):o.jsx("div",{className:"space-y-3",children:n.map(u=>o.jsx("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 dark:border-gray-700 rounded-xl p-4 hover:shadow-md transition border dark:border-gray-800",children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold ${u.type==="CUT"?"bg-red-100 text-red-700":u.type==="ADJUST_ADD"||u.type==="OUTFIT_ADD"?"bg-green-100 text-green-700":u.type==="ADJUST_DEDUCT"||u.type==="OUTFIT_SOLD"?"bg-orange-100 text-orange-700":u.type==="CANCEL_RETURN"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:u.type}),u.size&&o.jsx("span",{className:"text-xs font-bold text-gray-500 dark:text-gray-400",children:u.size})]}),o.jsxs("div",{className:"text-sm space-y-1",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx("span",{className:"text-gray-500",children:"Amount:"}),o.jsxs("span",{className:"font-bold text-gray-900 dark:text-white",children:[parseFloat(u.amountUsed||0).toFixed(2)," ",u.size?"pcs":"m"]})]}),u.orderNumber&&o.jsxs("div",{className:"flex gap-2",children:[o.jsx("span",{className:"text-gray-500",children:"Order:"}),o.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:u.orderNumber})]}),u.productName&&o.jsxs("div",{className:"flex gap-2",children:[o.jsx("span",{className:"text-gray-500",children:"Product:"}),o.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:u.productName})]}),u.status&&o.jsxs("div",{className:"flex gap-2",children:[o.jsx("span",{className:"text-gray-500",children:"Status:"}),o.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:u.status})]}),u.usedByEmail&&o.jsxs("div",{className:"flex gap-2",children:[o.jsx("span",{className:"text-gray-500",children:"By:"}),o.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:u.usedByEmail})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("span",{className:"text-gray-500",children:"Date:"}),o.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:c(u.usedAt)})]})]})]}),o.jsx("button",{onClick:()=>i(u.id),className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition",title:"Delete log",children:o.jsx(Zo,{className:"w-4 h-4"})})]})},u.id))})})]})}),s&&o.jsx("div",{className:"fixed inset-0 bg-black/50 z-[80] flex items-center justify-center p-4 modal-enter",children:o.jsxs("div",{className:"bg-white dark:bg-gray-950 p-6 rounded-2xl w-full max-w-sm shadow-2xl border dark:border-gray-800 border dark:border-gray-800",children:[o.jsxs("h3",{className:"text-lg font-bold mb-4 text-red-600 flex items-center gap-2",children:[o.jsx(Zo,{className:"w-5 h-5"})," Delete Log Entry?"]}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 dark:text-gray-500 mb-4",children:"This will permanently remove this transaction from the history."}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:()=>a(t,s),className:"flex-1 bg-red-600 text-white py-3 rounded-xl font-bold",children:"Delete"}),o.jsx("button",{onClick:()=>i(null),className:"flex-1 bg-gray-100 text-gray-600 dark:text-gray-400 dark:text-gray-500 py-3 rounded-xl font-bold",children:"Cancel"})]})]})})]}):null}function YA({visible:t,onClose:e}){const[n,r]=F.useState([]),[s,i]=F.useState(!1),[a,c]=F.useState("all");F.useEffect(()=>{t&&u()},[t]);const u=async()=>{i(!0);try{const w=Ue();if(!w)return;const P=up(Qe(w,"change_history"),vA("timestamp","desc")),E=(await yr(P)).docs.map(x=>{var b,R;return{id:x.id,...x.data(),timestamp:((R=(b=x.data().timestamp)==null?void 0:b.toDate)==null?void 0:R.call(b))||new Date}});r(E)}catch(w){console.error("Error loading change history:",w)}finally{i(!1)}},d=async w=>{if(window.confirm("Delete this change history record?"))try{const P=Ue();await Ls(Re(P,"change_history",w)),r(I=>I.filter(E=>E.id!==w))}catch(P){console.error("Error deleting change:",P),alert("Failed to delete change history")}},p=async()=>{if(window.confirm("Are you sure you want to delete ALL change history? This cannot be undone."))try{const w=Ue(),P=n.map(I=>Ls(Re(w,"change_history",I.id)));await Promise.all(P),r([])}catch(w){console.error("Error clearing history:",w),alert("Failed to clear change history")}},y=a==="all"?n:n.filter(w=>w.type===a),m=w=>{switch(w){case"orders":return"bg-blue-100 text-blue-800";case"inventory":return"bg-purple-100 text-purple-800";case"customers":return"bg-green-100 text-green-800";case"production":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},T=w=>{switch(w){case"created":return"text-emerald-600";case"updated":return"text-blue-600";case"deleted":return"text-red-600";default:return"text-gray-600"}};return t?o.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-end sm:items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white w-full sm:max-w-2xl rounded-t-3xl sm:rounded-3xl shadow-2xl max-h-[80vh] flex flex-col",children:[o.jsxs("div",{className:"flex justify-between items-center p-4 sm:p-6 border-b-2 border-lime-glow",children:[o.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-emerald-pine",children:"Change History"}),o.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-2xl",children:""})]}),o.jsx("div",{className:"flex gap-2 px-4 sm:px-6 pt-4 flex-wrap",children:["all","orders","inventory","customers","production"].map(w=>o.jsx("button",{onClick:()=>c(w),className:`px-3 py-1 rounded-full text-xs font-semibold transition-all ${a===w?"bg-emerald-pine text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:w.charAt(0).toUpperCase()+w.slice(1)},w))}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6",children:s?o.jsx("div",{className:"flex items-center justify-center h-32",children:o.jsx("div",{className:"animate-spin w-6 h-6 border-3 border-emerald-pine border-t-lime-glow rounded-full"})}):y.length===0?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:"No changes recorded"})}):o.jsx("div",{className:"space-y-3",children:y.map(w=>o.jsx("div",{className:"bg-gray-50 p-4 rounded-2xl border-l-4 border-lime-glow hover:shadow-md transition-all",children:o.jsxs("div",{className:"flex justify-between items-start gap-2",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex gap-2 items-center flex-wrap mb-2",children:[o.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${m(w.type)}`,children:w.type}),o.jsx("span",{className:`text-xs font-semibold ${T(w.action)}`,children:w.action.toUpperCase()})]}),o.jsx("p",{className:"text-sm font-semibold text-gray-800 break-words",children:w.description}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["By: ",w.user||"Unknown"]}),w.details&&o.jsxs("details",{className:"mt-2",children:[o.jsx("summary",{className:"text-xs text-emerald-pine cursor-pointer hover:underline",children:"Details"}),o.jsx("pre",{className:"bg-white p-2 rounded mt-1 text-xs overflow-auto max-h-40 border border-gray-200",children:typeof w.details=="string"?w.details:JSON.stringify(w.details,null,2)})]}),o.jsx("p",{className:"text-xs text-gray-400 mt-2",children:w.timestamp.toLocaleString()})]}),o.jsx("button",{onClick:()=>d(w.id),className:"text-red-500 hover:text-red-700 text-sm font-semibold flex-shrink-0",children:"Delete"})]})},w.id))})}),n.length>0&&o.jsxs("div",{className:"border-t-2 border-lime-glow p-4 sm:p-6 flex justify-end gap-2",children:[o.jsx("button",{onClick:e,className:"px-4 py-2 rounded-xl bg-gray-200 text-gray-800 font-semibold hover:bg-gray-300 transition",children:"Close"}),o.jsx("button",{onClick:p,className:"px-4 py-2 rounded-xl bg-red-500 text-white font-semibold hover:bg-red-600 transition",children:"Clear All"})]})]})}):null}const Wn={Home:()=>o.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"})}),Box:()=>o.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})}),Plus:()=>o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),Clipboard:()=>o.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M4 4a2 2 0 012-2h6a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V4z"})}),Table:()=>o.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"})}),LogOut:()=>o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),ShoppingBag:()=>o.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 10a4 4 0 0 1-8 0"})]}),Users:()=>o.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 21v-2a4 4 0 0 0-4-4H7a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"9",cy:"7",r:"4",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})]}),TrendingUp:()=>o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})};function JA({login:t}){const[e,n]=F.useState(""),[r,s]=F.useState(""),[i,a]=F.useState(!1),c=async u=>{u.preventDefault(),s(""),a(!0);try{const d=await t(e);d.ok||s(d.message)}catch(d){s(d.message)}finally{a(!1)}};return o.jsxs("form",{onSubmit:c,className:"space-y-4",children:[r&&o.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-3 text-sm text-red-700",children:r}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-2",children:"Your Name"}),o.jsx("input",{type:"text",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-2xl focus:border-emerald-pine focus:ring-2 focus:ring-emerald-pine/20 focus:outline-none transition",value:e,onChange:u=>n(u.target.value),required:!0})]}),o.jsx("button",{type:"submit",disabled:i,className:"w-full bg-gradient-to-r from-lime-glow to-green-tea text-emerald-pine font-bold py-3 rounded-2xl hover:shadow-xl hover:scale-[1.02] transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:i?"Please wait...":"Sign In"})]})}function ZA(){const[t,e]=F.useState("home"),{userProfile:n,login:r,logout:s,loading:i}=VA(),[a,c]=F.useState(""),[u,d]=F.useState([]),[p,y]=F.useState([]),[m,T]=F.useState([]),[w,P]=F.useState(!1),[I,E]=F.useState(null),[x,b]=F.useState(!1),[R,L]=F.useState(null),[M,N]=F.useState(null),[f,v]=F.useState(null),[_,k]=F.useState(!1),[j,C]=F.useState(null),[ge,ae]=F.useState({orderNumber:"",customerName:"",outfitName:"",size:"M",fabricId:"",status:"Sent to Tailor",sellingPrice:"",deductStock:!1,cutAmount:"",notes:"",phone:"",address:"",discount:"",source:"",acquisitionCost:"",paymentMethod:"Prepaid",city:"",state:"",codCharge:"",shippingCost:"",codRemittanceDate:""}),[Se,ne]=F.useState(null),[O,$]=F.useState(null),[ee,X]=F.useState(null),[J,A]=F.useState(null),[H,K]=F.useState(""),[V,z]=F.useState(null),[G,se]=F.useState(""),[ue,Z]=F.useState({sellingPrice:"",shippingCost:"",otherExpenses:""}),[ye,we]=F.useState(null),[_e,ve]=F.useState(!1),[le,Lt]=F.useState(null),[pe,Oe]=F.useState(null);ms.useEffect(()=>{try{mp();const Q=Ue();Lt(Q),TA().then(()=>{console.log("Firebase authenticated anonymously"),yr(Qe(Q,"fabrics")).then(ie=>{console.log("Direct fabrics query result:",ie.size,"documents"),ie.empty||console.log("Sample fabric:",ie.docs[0].data())}).catch(ie=>console.error("Direct fabrics query error:",ie)),yr(Qe(Q,"production_orders")).then(ie=>{console.log("Direct production_orders query result:",ie.size,"documents"),ie.empty||console.log("Sample order:",ie.docs[0].data())}).catch(ie=>console.error("Direct production_orders query error:",ie)),yr(Qe(Q,"customers")).then(ie=>{console.log("Direct customers query result:",ie.size,"documents"),ie.empty||console.log("Sample customer:",ie.docs[0].data())}).catch(ie=>console.error("Direct customers query error:",ie))}).catch(ie=>{console.error("Auth error:",ie)})}catch(Q){console.error("Firebase init error:",Q)}},[]),ms.useEffect(()=>{le&&gt()},[le]);const gt=async()=>{try{const ie=(await yr(Qe(le,"fabrics"))).docs.map(Ie=>({id:Ie.id,...Ie.data()})).filter(Ie=>Ie&&Ie.name);d(ie),console.log("Loaded",ie.length,"inventory items")}catch(Q){console.error("Error loading inventory:",Q)}};ms.useEffect(()=>{le&&Yt()},[le]);const Yt=async()=>{try{const ie=(await yr(Qe(le,"production_orders"))).docs.map(Ie=>({id:Ie.id,...Ie.data()})).filter(Ie=>Ie&&(Ie.orderNumber||Ie.customerName));y(ie),console.log("Loaded",ie.length,"orders")}catch(Q){console.error("Error loading orders:",Q)}},Bt=async Q=>{if(!le)return;const ie={customerName:Q.name,phone:Q.phone||"",address:Q.address||"",email:Q.email||"",city:Q.city||"",state:Q.state||"",status:"Saved",orderTotal:0,finalSellingPrice:0,paymentMode:"Prepaid",createdAt:ke(),updatedAt:ke(),source:Q.source||"Manual Customer",importedData:{"Customer Email":Q.email||"",Address:Q.address||"",City:Q.city||"",State:Q.state||""}};try{const Ie=await Gt(Qe(le,dn),ie);y(gn=>[{id:Ie.id,...ie,createdAt:new Date,updatedAt:new Date},...gn])}catch(Ie){console.error("Error adding customer",Ie),alert("Could not add customer: "+Ie.message)}},mn=async Q=>{if(!(!le||!Q))try{const ie=up(Qe(le,dn),yA("customerName","==",Q)),Ie=await yr(ie);await Promise.all(Ie.docs.map(gn=>Ls(gn.ref))),y(gn=>gn.filter(Hi=>(Hi.customerName||"").toLowerCase().trim()!==Q.toLowerCase().trim()))}catch(ie){console.error("Error deleting customer",ie),alert("Could not delete customer: "+ie.message)}};ms.useEffect(()=>{le&&Ke()},[le]);const Ke=async()=>{try{const ie=(await yr(Qe(le,"production_batches"))).docs.map(Ie=>({id:Ie.id,...Ie.data()}));T(ie),console.log("Loaded",ie.length,"production batches")}catch(Q){console.error("Error loading production batches:",Q)}},ze=async()=>{await Promise.all([gt(),Yt(),Ke()])},be=Q=>{X(Q.id)},je=(Q,ie)=>{ne(Q),$(ie)},Nt=async Q=>{if(confirm("Cancel this order?"))try{const ie=Ue();if(await Ye(Re(ie,dn,Q.id),{status:"Cancelled",updatedAt:ke()}),Q.fabricId&&Q.cutAmount>0){const Ie=Re(ie,In,Q.fabricId);await Ye(Ie,{currentLength:Ri(Math.abs(parseFloat(Q.cutAmount)||0)),updatedAt:ke()}),await Gt(Qe(Ie,"history"),{amountUsed:Q.cutAmount,orderNumber:`CANCEL-${Q.orderNumber}`,type:"CANCEL_RETURN",status:"Cancelled",usedAt:ke()})}await Promise.all([Yt(),gt()])}catch(ie){console.error(ie)}},dr=async Q=>{if(confirm("Delete this item?"))try{const ie=Ue();await Ls(Re(ie,In,Q.id)),L(null),await gt()}catch(ie){console.error(ie)}};if(!n)return o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-emerald-pine via-emerald-800 to-emerald-900 p-4",children:o.jsxs("div",{className:"w-full max-w-sm bg-gray-900 rounded-3xl shadow-2xl p-8",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-lime-glow to-green-tea rounded-3xl mx-auto mb-4 flex items-center justify-center shadow-lg",children:o.jsx("svg",{className:"w-12 h-12 text-emerald-pine",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),o.jsx("h1",{className:"text-3xl font-extrabold text-emerald-pine mb-2",children:"Poshakh Manager"}),o.jsx("p",{className:"text-gray-500 text-sm",children:"Stock & Production Tracking"})]}),o.jsx(JA,{login:r})]})});const as=[{id:"home",label:"Home",icon:Wn.Home},{id:"inventory",label:"Inventory",icon:Wn.Box},{id:"orders",label:"Orders",icon:Wn.Clipboard},{id:"add",label:"Add",icon:Wn.Plus},{id:"outfits",label:"Outfits",icon:Wn.ShoppingBag},{id:"customers",label:"Customers",icon:Wn.Users},...(n==null?void 0:n.role)==="admin"?[{id:"financial",label:"Financial",icon:Wn.TrendingUp}]:[]];return o.jsxs("div",{className:"min-h-screen bg-black pb-24",children:[o.jsx("header",{className:"bg-gradient-to-r from-emerald-pine to-emerald-800 border-b border-emerald-900 sticky top-0 z-40 shadow-lg",children:o.jsxs("div",{className:"px-4 sm:px-6 py-3 sm:py-4 flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[o.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-2xl bg-gradient-to-br from-lime-glow to-green-tea flex items-center justify-center",children:o.jsx("svg",{className:"w-6 h-6 sm:w-7 sm:h-7 text-emerald-pine",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-base sm:text-lg font-bold text-white",children:"Poshakh Manager"}),o.jsx("p",{className:"text-[10px] sm:text-xs text-emerald-100",children:"Connected"})]})]}),o.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[o.jsx("button",{onClick:ze,className:"h-9 w-9 sm:h-10 sm:w-10 bg-emerald-600 text-lime-glow rounded-2xl flex items-center justify-center hover:bg-emerald-500 active:scale-95 transition-all shadow-lg",title:"Refresh Data",children:o.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),((n==null?void 0:n.name)==="Adwait"||(n==null?void 0:n.name)==="Avani")&&o.jsx("button",{onClick:()=>b(!0),className:"h-9 w-9 sm:h-10 sm:w-10 bg-emerald-600 text-lime-glow rounded-2xl flex items-center justify-center hover:bg-emerald-500 active:scale-95 transition-all shadow-lg",title:"View Change History",children:o.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(n==null?void 0:n.role)==="admin"&&o.jsx("button",{onClick:()=>e("import"),className:"h-9 w-9 sm:h-10 sm:w-10 bg-emerald-600 text-lime-glow rounded-2xl flex items-center justify-center hover:bg-emerald-500 active:scale-95 transition-all shadow-lg",title:"Import",children:o.jsx(Wn.Table,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),o.jsxs("div",{className:"text-right hidden sm:block",children:[o.jsx("p",{className:"text-sm font-semibold text-gray-900",children:n.name}),o.jsx("p",{className:"text-xs text-gray-500 capitalize",children:n.role})]}),o.jsx("button",{onClick:s,className:"p-2 rounded-lg hover:bg-red-50 active:bg-red-100 text-red-600 transition",title:"Logout",children:o.jsx(Wn.LogOut,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]})}),o.jsxs("main",{className:"px-4 sm:px-6 py-4 sm:py-6 max-w-7xl mx-auto pb-24",children:[t==="home"&&o.jsx(AA,{allOrders:p,inventoryItems:u,userRole:n==null?void 0:n.role}),t==="inventory"&&o.jsx(kN,{onViewItem:Q=>L(Q),inventoryItems:u,soldCounts:{},onAddClick:()=>e("add"),userRole:n==null?void 0:n.role}),t==="orders"&&o.jsx(SA,{allOrders:p,inventoryItems:u,productionBatches:m,onViewOrder:Q=>N(Q),onShowLegacyModal:()=>k(!0),onCancelOrder:Nt,onDeleteOrder:Q=>{console.log("onDeleteOrder called with id:",Q),A(Q)},onOpenShipping:Q=>z(Q),onCreateProductionBatch:()=>P(!0),onReceiveBatch:Q=>E(Q),userProfile:n,onDataChanged:ze}),t==="outfits"&&o.jsx(PA,{allOrders:p,inventoryItems:u}),t==="customers"&&o.jsx(RA,{allOrders:p,onViewCustomer:Q=>v(Q),searchTerm:G,setSearchTerm:se,onAddCustomer:Bt,onDeleteCustomer:mn}),t==="financial"&&o.jsx(DA,{inventoryItems:u,allOrders:p,userRole:n==null?void 0:n.role}),t==="add"&&o.jsx(IA,{onSuccess:()=>e("inventory"),onDataChanged:ze}),t==="import"&&(n==null?void 0:n.role)==="admin"&&o.jsx(kA,{}),o.jsx(UA,{item:R,onClose:()=>L(null),onOpenEdit:be,onOpenStock:je,onViewHistory:Q=>{L(null),Oe(Q.id)},onDelete:dr}),o.jsx(zA,{order:M,onClose:()=>N(null),onEdit:Q=>{N(null),C(Q),k(!0)},onShip:Q=>{z(Q.id)}}),o.jsx(BA,{customer:f,onClose:()=>v(null),allOrders:p,inventoryItems:u,userRole:n==null?void 0:n.role,onDataChanged:ze}),o.jsx(qA,{visible:_,onClose:()=>{k(!1),C(null)},inventoryItems:u,userProfile:n,onDataChanged:ze,editOrder:j}),o.jsx(HA,{item:Se,type:O,onClose:()=>{ne(null),$(null)},onDataChanged:ze,userProfile:n}),o.jsx(WA,{item:ee?u.find(Q=>Q.id===ee):null,inventoryItems:u,db:le,onClose:()=>X(null),onDataChanged:ze}),o.jsx(GA,{visible:!!J,orderId:J,onClose:()=>{A(null)},onDataChanged:ze}),o.jsx(KA,{visible:!!V,orderId:V,onClose:()=>z(null),onDataChanged:ze}),o.jsx(QA,{url:ye,onClose:()=>we(null)}),o.jsx(XA,{itemId:pe,onClose:()=>Oe(null)}),o.jsx(YA,{visible:x,onClose:()=>b(!1)}),o.jsx(OA,{visible:w,onClose:()=>P(!1),inventoryItems:u,onDataChanged:ze}),o.jsx(LA,{visible:!!I,batch:I,onClose:()=>E(null),onDataChanged:ze,inventoryItems:u})]}),o.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-black border-t-2 border-lime-glow px-2 sm:px-4 py-2 sm:py-3 flex justify-around items-center shadow-2xl safe-area-inset-bottom",children:as.map(Q=>{const ie=t===Q.id;return Q.id==="add"?o.jsx("button",{onClick:()=>e(Q.id),className:"w-14 h-14 sm:w-16 sm:h-16 rounded-full bg-emerald-pine text-lime-glow flex items-center justify-center shadow-2xl hover:scale-110 active:scale-105 transition-all -mt-8 border-4 border-black",children:o.jsx(Q.icon,{className:"w-6 h-6"})},Q.id):o.jsxs("button",{onClick:()=>e(Q.id),className:`flex flex-col items-center gap-1 py-2 px-2 sm:px-3 rounded-2xl transition-all min-w-[60px] ${ie?"text-emerald-pine bg-lime-glow shadow-lg":"text-gray-600 hover:text-lime-glow"}`,children:[o.jsx(Q.icon,{className:"w-5 h-5"}),o.jsx("span",{className:"text-[10px] sm:text-xs font-medium",children:Q.label})]},Q.id)})})]})}function ej(){return o.jsx(FA,{children:o.jsx(ZA,{})})}cx(document.getElementById("root")).render(o.jsx(ms.StrictMode,{children:o.jsx(ej,{})}));
